CREATE OR REPLACE PROCEDURE "ANALESTA"."P_ANE_CARGMERM" IS
--DECLARE
   vErrores VARCHAR2(2000);
   --
   CURSOR cOt IS
      SELECT EMPRESA, NUMERO, NUMEPEDI, FEC_MODI
         FROM FIC_CABEOTRE O
            WHERE 
            --TO_CHAR(O.FEC_MODI,'YYYY') IN  ('2015','2016')
				--AND NOT EXISTS (SELECT 'X' FROM ANALESTA.ANE_MER_MATERIAL_OT M WHERE M.EMPRESA = O.EMPRESA AND M.NUMEOTRE = O.NUMERO AND M.FEC_MODI >= TO_DATE('20161116 16:41','YYYYMMDD HH24:MI'));
            --NUMERO = 2014000488 AND EMPRESA = '10'
            --NUMERO = 2014000618 AND EMPRESA = '10'
            --EMPRESA = '05' AND NUMERO = 2015000686;--2016000205;
            /*EMPRESA = '05' AND NUMERO IN (
2015000338,
2015000254,
2015000346,
2015000348,
2015000472,
2015000350,
2015000340,
2015000474,
2015000342
);*/
				--EMPRESA = '05' AND NUMERO = 2016000205;
            --EMPRESA||'-'||NUMERO IN ('10-2013001902','10-2014001818');
			TRUNC(O.FEC_MODI) = TRUNC(SYSDATE-1);
				--TRUNC(O.FEC_MODI) >= TO_DATE('15-11-2016','DD-MM-YYYY');
			/*SELECT DISTINCT O.EMPRESA, O.NUMERO, O.NUMEPEDI, O.FEC_MODI FROM FIC_CABEOTRE O, PRD_MEFAEVEN E 
			WHERE E.CAMPVA02 = 'RE' AND (O.NUMERO LIKE '2015%' OR O.NUMERO LIKE '2016%')
			  AND E.EMPRESA = O.EMPRESA
			  AND E.NUMEOTRE = O.NUMERO;*/
   --Tipo Evento de Maquina
   vTievMaqu VARIABLES.VALOR%TYPE := P_UTILIDAD.F_VALODEVA('TIEVMAQU');
   --
   vTipoRecu VARIABLES.VALOR%TYPE := P_UTILIDAD.F_VALODEVA('TIPORECU');
   --
   vP_EXCLEEML VARIABLES.VALOR%TYPE := P_Utilidad.F_ValoDeva('EXCLEEML');
   --Tipo de Merma Tirada
   vTimeTira VARIABLES.VALOR%TYPE := P_UTILIDAD.F_VALODEVA('TIMETIRA');
   --Tipo de Merma de Saneamiento
   vTimeSane VARIABLES.VALOR%TYPE := P_UTILIDAD.F_VALODEVA('TIMESANE');
   --
   vTIARREST VARIABLES.VALOR%TYPE := P_Utilidad.F_ValoDeva('TIARREST');
   --
   vP_TIARMPF4 VARIABLES.VALOR%TYPE := P_Utilidad.F_ValoDeva('TIARMPF4');
   vP_TIARFIF4 VARIABLES.VALOR%TYPE := P_Utilidad.F_ValoDeva('TIARFIF4');
   --
   vTiarCosc VARIABLES.VALOR%TYPE := P_UTILIDAD.F_VALODEVA('TIARCOSC');
   --
   vP_TIARPROI VARIABLES.VALOR%TYPE := P_Utilidad.F_ValoDeva('TIARPROI');
   --
   vTiarMpF4 VARIABLES.VALOR%TYPE := P_UTILIDAD.F_VALODEVA('TIARMPF4');
   --
   vP_TIPOUNML VARIABLES.VALOR%TYPE := P_Utilidad.F_ValoDeva('TIPOUNML');
   --
   vTiarSeF4 VARIABLES.VALOR%TYPE := P_UTILIDAD.F_VALODEVA('TIARSEF4');
   --
   vTiarCose VARIABLES.VALOR%TYPE := P_UTILIDAD.F_VALODEVA('TIARCOSE');
   --Coheficiente Corrector de Colores Formulados
   vCoefCoCf VARIABLES.VALOR%TYPE := P_UTILIDAD.F_VALODEVA('COEFCOCF');
   --
   vMatBase HFICTEC.MATBASE%TYPE;
   --
   vPos_Macula HFTGESTI.POS_MACULA%TYPE := NULL;
   --
   nNumeColo NUMBER;
   --
   nFactorML NUMBER;
   --
   nContMaev NUMBER; --Controla el orden de uso de los Materiles, basicamente establece cual fue el primero para tenerlo en cuenta para lo de Enhebrado y Ajuste
   --
   nPrecMere NUMBER;
   nCantPrme NUMBER;
   nPrecPrme NUMBER;
   --
   nAncho1 ARTICULO.ANCHO%TYPE;
   nAncho2 ARTICULO.ANCHO%TYPE;
   --
   nFCKG LFS.FCKG%TYPE;
   nFCKG1 LFS.FCKG%TYPE;
   nFCKG2 LFS.FCKG%TYPE;
   --
   nMermPlan NUMBER;
   --
   nNumePedi FIC_CABEOTRE.NUMEPEDI%TYPE;
   --
   dFecha_Cierre DATE;
   --
   CURSOR cAncho_Corte(vEmpresa PRD_BOBIMAQU.EMPRESA%TYPE, nNumeOtre PRD_BOBIMAQU.NUMEOTRE%TYPE, nContador PRD_MAQURUTA.CONTADOR%TYPE, nNumeCort PRD_LIBOCORT.NUMECORT%TYPE) IS
      SELECT 1 CONTADOR, L.ANCHO, L.DESBARBE, DECODE(L.DESBARBE,'C',' -> SI',' -> [NO]') GENEETIQ, C.ANCHO ANCHO_TOTAL, LC.NUMERO_BOBINAS_CORTE  
         FROM (SELECT MR.EMPRESA, MR.NUMEOTRE, MR.FASESEQU, MR.CONTADOR FROM PRD_MAQURUTA MR
               WHERE NOT EXISTS (SELECT 'X' FROM PRD_HCABEOTR OTC WHERE OTC.EMPRESA = MR.EMPRESA AND OTC.NUMEOTRE = MR.NUMEOTRE)
               UNION
               SELECT MR.EMPRESA, MR.NUMEOTRE, MR.FASESEQU, MR.CONTADOR FROM PRD_HMAQURUT MR) M, 
              FIC_LIPCORTR L, FIC_CAPCORTR C,
              (SELECT EMPRESA, NUMERO, ANNO, TIP_ARES, COD_ARES, FASE, SECUENCI, COUNT(*) NUMERO_BOBINAS_CORTE 
               FROM FIC_LIPCORTR 
               WHERE DESBARBE != 'C'
               GROUP BY EMPRESA, NUMERO, ANNO, TIP_ARES, COD_ARES, FASE, SECUENCI) LC
         WHERE C.EMPRESA = L.EMPRESA
           AND C.NUMERO = L.NUMERO
           AND C.ANNO = L.ANNO
           AND C.TIP_ARES = L.TIP_ARES
           AND C.COD_ARES = L.COD_ARES
           AND C.FASE = L.FASE
           AND C.SECUENCI = L.SECUENCI
           AND C.EMPRESA = LC.EMPRESA(+)
           AND C.NUMERO = LC.NUMERO(+)
           AND C.ANNO = LC.ANNO(+)
           AND C.TIP_ARES = LC.TIP_ARES(+)
           AND C.COD_ARES = LC.COD_ARES(+)
           AND C.FASE = LC.FASE(+)
           AND C.SECUENCI = LC.SECUENCI(+)
           AND M.EMPRESA = L.EMPRESA
           AND M.NUMEOTRE = L.NUMERO
           AND SUBSTR(M.NUMEOTRE,1,4) = L.ANNO
           AND M.FASESEQU = (L.FASE * 100) + L.SECUENCI
           AND L.COD_ARES LIKE 'CORTADORA%'
           AND M.EMPRESA = vEmpresa
           AND M.NUMEOTRE = nNumeOtre
           AND M.CONTADOR = nContador
           AND L.NUM_CORTE = nNumeCort
      UNION
      SELECT 3 CONTADOR, DECODE(N_VECES,0,0,TOTAL/N_VECES) ANCHO, 'C' DESBARBE, ' -> SI' GENEETIQ, TOTAL ANCHO_TOTAL, N_VECES NUMERO_BOBINAS_CORTE
         FROM FIC_INFOPROD 
         WHERE EMPRESA = vEmpresa
           AND NUMERO = nNumeOtre
           AND ANNO = SUBSTR(nNumeOtre,1,4)
           AND TIPOMAQU = 'CORTADORA'
           AND TOTAL IS NOT NULL
      ORDER BY CONTADOR;         
   --
   rAncho_Corte cAncho_Corte%ROWTYPE;
   --
   CURSOR cArticulo(vEmpresa ARTICULO.EMPRESA%TYPE, vTip_Arti ARTICULO.TIP_ARTI%TYPE, vCod_Arti ARTICULO.COD_ARTI%TYPE, vLote PRD_MAPAMAQU.LOTE%TYPE) IS--575
      SELECT A.COD_LFS, 
             ANALESTA.P_ANE_MERMLAMI_PRAG.F_Ancho_Semielaborado(A.EMPRESA, A.TIP_ARTI, A.COD_ARTI, A.ANCHO, vLote, A.ANCHREAL) ANCHO,
             A.UNIDSTOC, A.PCMPCOMP, L.FCKG
      FROM ARTICULO A, LFS L
         WHERE A.EMPRESA = L.EMPRESA
           AND A.COD_LFS = L.COD_LFS
           AND A.EMPRESA = vEmpresa
           AND A.TIP_ARTI = vTip_Arti
           AND A.COD_ARTI = vCod_Arti;
   --
   rArticulo cArticulo%ROWTYPE;
   --Verifica si la MP es propiedad del Cliente
   CURSOR cFIC_LICHOBOT(vEmpresa FIC_CABEOTRE.EMPRESA%TYPE, nNumero FIC_CABEOTRE.NUMERO%TYPE, nAnno FIC_CABEOTRE.ANNO%TYPE) IS--607
      SELECT MATERIAL_PROPIEDAD_CLIENTE
      FROM ANALESTA.ANE_ORDENES_DE_TRABAJO_P1
      WHERE EMPRESA = vEmpresa
        AND NUMERO_OT = nNumero
        AND ANNO_OT = nAnno;
   --Materia Prima Propiedad del cliente
   vMaprPrCl FIC_LICHOBOT.VALOR%TYPE;
   --
   CURSOR cMermPlan(vEmpresa PRD_MAPAMAQU.EMPRESA%TYPE, nNumeOtre PRD_MAPAMAQU.NUMEOTRE%TYPE) IS
      SELECT MERMA FROM ANALESTA.ANE_MER_MERMAS_PLANIF_OT
         WHERE EMPRESA = vEmpresa
           AND NUMEOTRE = nNumeOtre;
	--
	TYPE ST_MATERIAL IS RECORD
		(
		  EMPRESA PRD_BOBIMAQU.EMPRESA%TYPE,
		  NUMEOTRE PRD_BOBIMAQU.NUMEOTRE%TYPE,
		  CONTADOR PRD_BOBIMAQU.CONTADOR%TYPE,
		  CONTMATE NUMBER, --Puede ser 1 para todas las Máquinas excepto para la Laminadora que puede tener 1 y 2
		  CONTMAEV NUMBER, --Contador para controlar que materiales se utilizaron en orden de uso
		  IDENTIFICADOR Binary_Integer,
		  TIP_ARTI PRD_BOBIMAQU.TIP_ARTI%TYPE,
		  COD_ARTI PRD_BOBIMAQU.COD_ARTI%TYPE,
		  LOTE VARCHAR2(250),--PRD_BOBIMAQU.LOTE%TYPE, --En el lote se utilizará todo el identificador del Material
		  CANTCONS PRD_BOBIMAQU.CANTCONS%TYPE,
		  CANTCONS_BOBINAS NUMBER,
		  CANTPROD PRD_BOBIMAQU.CANTPROD%TYPE,
		  CANTAJUS PRD_BOBIMAQU.CANTAJUS%TYPE,
		  MERMENHE NUMBER,
		  MERMAJUS NUMBER,
		  MERMCABO NUMBER,
		  MERMPICO NUMBER,
		  MERMTIRA NUMBER,
		  MERMSANE NUMBER,
		  CONTFSMU_01 NUMBER,--Contadores de Fases Siguientes Multiples
		  CONTFSMU_02 NUMBER,
		  CONTFSMU_03 NUMBER,
		  CONTFSMU_04 NUMBER,
		  CONTFSMU_05 NUMBER,
		  CONTFSMU_06 NUMBER,
		  CONTFSMU_07 NUMBER,
		  CONTFSMU_08 NUMBER,
		  CONTFSMU_09 NUMBER,
		  CONTFSMU_10 NUMBER,
		  CANTFSMU_01 NUMBER, --Cantidad Consumida en Fase Siguiente Multiple Final
		  CANTFSMU_02 NUMBER,
		  CANTFSMU_03 NUMBER,
		  CANTFSMU_04 NUMBER,
		  CANTFSMU_05 NUMBER,
		  CANTFSMU_06 NUMBER,
		  CANTFSMU_07 NUMBER,
		  CANTFSMU_08 NUMBER,
		  CANTFSMU_09 NUMBER,
		  CANTFSMU_10 NUMBER,
		  CATOFSMU NUMBER,  --Cantidad Total Cosumida en Fases Siguientes Multiples
		  MM_MERMPLAN_01 NUMBER,--mm de Mermas de Planificación (Por defecto sera la que el sistema de, pero esto puede cambiar si es menor o igual a 0)
		  MM_MERMPLAN_02 NUMBER,
		  MM_MERMPLAN_03 NUMBER,
		  MM_MERMPLAN_04 NUMBER,
		  MM_MERMPLAN_05 NUMBER,
		  MM_MERMPLAN_06 NUMBER,
		  MM_MERMPLAN_07 NUMBER,
		  MM_MERMPLAN_08 NUMBER,
		  MM_MERMPLAN_09 NUMBER,
		  MM_MERMPLAN_10 NUMBER,
		  MM_MERMPLAN NUMBER,--mm de Mermas de Planificación General (Por defecto sera la que el sistema de, pero esto puede cambiar si es menor o igual a 0) PARA CALCULOS DEL ANCHO RESULTANTE PROMEDIO DE TODAS LAS MERMAS
		  MERMPLAN NUMBER, --Merma de Planificación General
		  MM_MERMPLAN_EXESO_01 NUMBER,--Exesos de las Mermas de Planificación 
		  MM_MERMPLAN_EXESO_02 NUMBER,
		  MM_MERMPLAN_EXESO_03 NUMBER,
		  MM_MERMPLAN_EXESO_04 NUMBER,
		  MM_MERMPLAN_EXESO_05 NUMBER,
		  MM_MERMPLAN_EXESO_06 NUMBER,
		  MM_MERMPLAN_EXESO_07 NUMBER,
		  MM_MERMPLAN_EXESO_08 NUMBER,
		  MM_MERMPLAN_EXESO_09 NUMBER,
		  MM_MERMPLAN_EXESO_10 NUMBER,
		  MM_MERMPLAN_EXESO NUMBER,
		  MERMPLAN_EXESO NUMBER,
		  PRE_CORTE VARCHAR2(1),--Esta definido como Pre-Corte
		  NUMECORT_01 NUMBER,--Numero de Cortes definido en Sus Fases Multiples Siguientes (APLICA PARA TOLERANCIAS DE MERMAS POR PRE-CORTE O ESCESOS)
		  NUMECORT_02 NUMBER,
		  NUMECORT_03 NUMBER,
		  NUMECORT_04 NUMBER,
		  NUMECORT_05 NUMBER,
		  NUMECORT_06 NUMBER,
		  NUMECORT_07 NUMBER,
		  NUMECORT_08 NUMBER,
		  NUMECORT_09 NUMBER,
		  NUMECORT_10 NUMBER,
		  NUMECORT NUMBER,
		  --MM_MERMA_DEFINIDA_CORTADORA NUMBER,
		  MM_MERMPRCO_01 NUMBER,
		  MM_MERMPRCO_02 NUMBER,
		  MM_MERMPRCO_03 NUMBER,
		  MM_MERMPRCO_04 NUMBER,
		  MM_MERMPRCO_05 NUMBER,
		  MM_MERMPRCO_06 NUMBER,
		  MM_MERMPRCO_07 NUMBER,
		  MM_MERMPRCO_08 NUMBER,
		  MM_MERMPRCO_09 NUMBER,
		  MM_MERMPRCO_10 NUMBER,
		  MM_MERMPRCO NUMBER,
		  MERMPRCO NUMBER,
		  CANTCONS_E NUMBER,--Cantidad consumida total en el Contador Actual para con esto calcular los ML de Mermas de Tirada y Saneamiento Estandar
		  MERMENHE_E NUMBER,
		  MERMAJUS_E NUMBER,
		  MERMCABO_E NUMBER,
		  MERMPICO_E NUMBER,
		  MERMTIRA_E NUMBER,
		  MERMSANE_E NUMBER,
		  MM_MERMPLAN_E NUMBER,
		  MERMPLAN_E NUMBER,
		  ANCHO ARTICULO.ANCHO%TYPE,
		  ANCHO_BUENO_OT_01 ARTICULO.ANCHO%TYPE,
		  ANCHO_BUENO_TOTAL_01 ARTICULO.ANCHO%TYPE,
		  ANCHO_BUENO_OT_02 ARTICULO.ANCHO%TYPE,
		  ANCHO_BUENO_TOTAL_02 ARTICULO.ANCHO%TYPE,
		  ANCHO_BUENO_OT_03 ARTICULO.ANCHO%TYPE,
		  ANCHO_BUENO_TOTAL_03 ARTICULO.ANCHO%TYPE,
		  ANCHO_BUENO_OT_04 ARTICULO.ANCHO%TYPE,
		  ANCHO_BUENO_TOTAL_04 ARTICULO.ANCHO%TYPE,
		  ANCHO_BUENO_OT_05 ARTICULO.ANCHO%TYPE,
		  ANCHO_BUENO_TOTAL_05 ARTICULO.ANCHO%TYPE,
		  ANCHO_BUENO_OT_06 ARTICULO.ANCHO%TYPE,
		  ANCHO_BUENO_TOTAL_06 ARTICULO.ANCHO%TYPE,
		  ANCHO_BUENO_OT_07 ARTICULO.ANCHO%TYPE,
		  ANCHO_BUENO_TOTAL_07 ARTICULO.ANCHO%TYPE,
		  ANCHO_BUENO_OT_08 ARTICULO.ANCHO%TYPE,
		  ANCHO_BUENO_TOTAL_08 ARTICULO.ANCHO%TYPE,
		  ANCHO_BUENO_OT_09 ARTICULO.ANCHO%TYPE,
		  ANCHO_BUENO_TOTAL_09 ARTICULO.ANCHO%TYPE,
		  ANCHO_BUENO_OT_10 ARTICULO.ANCHO%TYPE,
		  ANCHO_BUENO_TOTAL_10 ARTICULO.ANCHO%TYPE,
															 --                                                              = CANTFSMU_01
		  ANCHO_BUENO_TOTAL ARTICULO.ANCHO%TYPE,--Valor calculado Ej:     (ANCHO_BUENO_TOTAL_01)       (CANTIDAD_CONSUMIDA_ULTIMA_FASE_01)            (ANCHO_BUENO_TOTAL_02)       (CANTIDAD_CONSUMIDA_ULTIMA_FASE_01)
															 --                    ( ( ---------------------  * -------------------------------------------- ) + ( ---------------------  * -------------------------------------------- ) + ....) * 1000 --Se encuentran los mm de ANCH_TOTAL patiendo de los ANCHOS encontrados y los Consumos de Material en la Ultima Fase
															 --                                 1000            (TOTAL_DE_CANTIDADES_CONSUMIDAS_ULTIMA_FASE)                1000            (TOTAL_DE_CANTIDADES_CONSUMIDAS_ULTIMA_FASE)
															 --                                                              = CATOFSMU
		  ANCHO_BUENO_OT ARTICULO.ANCHO%TYPE,
		  CANTIDAD_CONSUMIDA_FINAL_01 NUMBER,
		  CANTIDAD_CONSUMIDA_FINAL_02 NUMBER,
		  CANTIDAD_CONSUMIDA_FINAL_03 NUMBER,
		  CANTIDAD_CONSUMIDA_FINAL_04 NUMBER,
		  CANTIDAD_CONSUMIDA_FINAL_05 NUMBER,
		  CANTIDAD_CONSUMIDA_FINAL_06 NUMBER,
		  CANTIDAD_CONSUMIDA_FINAL_07 NUMBER,
		  CANTIDAD_CONSUMIDA_FINAL_08 NUMBER,
		  CANTIDAD_CONSUMIDA_FINAL_09 NUMBER,
		  CANTIDAD_CONSUMIDA_FINAL_10 NUMBER,
		  CANTIDAD_CONSUMIDA_FINAL_TOTAL NUMBER,
		  PRECIO_ML NUMBER,
		  PRECIO_ML_E NUMBER,
		  FACTOR_CONVERSION_M2_KG NUMBER,
		  LOG_PRECIO VARCHAR2(2000)
		);
	-- Definicion de tabla PL de Precios
	TYPE tMATERIAL IS TABLE OF ST_MATERIAL Index By Binary_Integer;
	--t_MATERIAL   tMATERIAL;
	--
	rMATERIAL ST_MATERIAL;--Registro de Busqueda e Insercion
	rMATERIAL_B1 ST_MATERIAL;--Registro de Busqueda
	rMATERIAL_B2 ST_MATERIAL;--Registro de Busqueda
	rMATERIAL_B1R ST_MATERIAL;--Registro de Busqueda
	rMATERIAL_B2R ST_MATERIAL;--Registro de Busqueda
	--
	TYPE ST_ANCHO_UTIL IS RECORD--929
		(
		  EMPRESA PRD_BOBIMAQU.EMPRESA%TYPE,
		  NUMEOTRE PRD_BOBIMAQU.NUMEOTRE%TYPE,
		  CONTADOR PRD_BOBIMAQU.CONTADOR%TYPE,--De la Maquina Actual
		  FASESIGU NUMBER,--Define varios anchos buenos en caso de existir varios tipos de corte en Fases Siguinetes Multiples definidas para la Maquina Actual (RECORDAR QUE DESPUES DE LAS FASES SIGUIENTES MULTIPLES NO PUEDEN EXISTIR FASES SIGUIENTES)
		  ANCHO_UTILIZADO_OT ARTICULO.ANCHO%TYPE,
		  ANCHO_USADO_Y_EXPEDIDO_OT ARTICULO.ANCHO%TYPE,
		  ANCHO_UTILIZADO_UTIL_BOBINA ARTICULO.ANCHO%TYPE,
		  PRE_CORTE VARCHAR2(1),--Se ha definido un Pre-Corte en la Maquina
		  --Solo estara definida en FASESIGU = 1 Que es la primera verificación de si existen Fases Siguientes Multiples (SI SE ESTA ANALIZANDO LA MAQUINA ACTUAL Y ES CORTADORA)
		  NUMECORT NUMBER, --Numero de Cortes
		  CONTFSMU NUMBER, --Contador de Fase Siguiente Multiple Final
		  CANTFSMU NUMBER, --Cantidad Consumida en Fase Siguiente Multiple Final
		  CATOFSMU NUMBER  --Cantidad Total Cosumida en Fases Siguientes Multiples
		  --MM_MERMA_DEFINIDA_CORTADORA --Solo aplica cuando se analizan Materiales que estan asignados a una Cortadora que tiene definidos los Cortes y no se apoyan en el plan de corte convensional de PCORTE
		);
	-- Definicion de tabla PL de Precios
	TYPE tANCHO_UTIL IS TABLE OF ST_ANCHO_UTIL Index By Binary_Integer;
	t_ANCHO_UTIL tANCHO_UTIL;
	--
	TYPE ST_BOBIMAQU IS RECORD
	(
	  EMPRESA PRD_BOBIMAQU.EMPRESA%TYPE,
	  NUMEOTRE PRD_BOBIMAQU.NUMEOTRE%TYPE,
	  CONTADOR PRD_BOBIMAQU.CONTADOR%TYPE,
	  CONTBOBI PRD_BOBIMAQU.CONTBOBI%TYPE,
	  IDENTIFICADOR Binary_Integer,
	  CANTCONS PRD_BOBIMAQU.CANTCONS%TYPE,
	  CANTPROD PRD_BOBIMAQU.CANTPROD%TYPE,
	  CANTAJUS PRD_BOBIMAQU.CANTAJUS%TYPE,
	  MERMTIRA NUMBER,
	  MERMSANE NUMBER,
	  TIP_ARTI PRD_BOBIMAQU.TIP_ARTI%TYPE,
	  COD_ARTI PRD_BOBIMAQU.COD_ARTI%TYPE,
	  LOTE PRD_BOBIMAQU.LOTE%TYPE,
	  COBOPADR PRD_BOBIMAQU.COBOPADR%TYPE,
	  ESTADO PRD_BOBIMAQU.ESTADO%TYPE,
	  ANCHO ARTICULO.ANCHO%TYPE,
	  ANCHO_BUENO ARTICULO.ANCHO%TYPE,
	  ANCHO_TOTAL ARTICULO.ANCHO%TYPE,
	  NUMERO_BOBINAS_CORTE NUMBER,
	  PRECIO_ML NUMBER,
	  PRECIO_ML_E NUMBER,
	  NUMECORT PRD_LIBOCORT.NUMECORT%TYPE,
	  DESBARBE FIC_LIPCORTR.DESBARBE%TYPE,
	  FACTOR_CONVERSION_M2_KG NUMBER
	);
	-- Definicion de tabla PL de Precios
	TYPE tBOBIMAQU IS TABLE OF ST_BOBIMAQU Index By Binary_Integer;
	t_BOBIMAQU   tBOBIMAQU;
	--
	rBOBIMAQU ST_BOBIMAQU;--Registro de Busqueda
	rBOBIMAQU_U ST_BOBIMAQU;--Registro de Utilizacion
	rBOBIMAQU_C ST_BOBIMAQU;--Registro de carga de Cortes
	--Tipo para Buscar Pasadas Anteriores
	TYPE ST_PASADAS IS RECORD
		(
		  CONTADOR PRD_PASAMAQU.CONTADOR%TYPE
		);
	-- Definicion de tabla PL de Precios
	TYPE tPASADAS IS TABLE OF ST_PASADAS Index By Binary_Integer;
	t_PASADAS   tPASADAS;
	t_PASADAS_C tPASADAS;
	--
	rPASADAS ST_PASADAS;
	rPASADAS_B ST_PASADAS;
	--
   --
   TYPE ST_MAQUINA_FASESIMU IS RECORD --Maquinas de Fases Siguientes Multiples
      (
        EMPRESA PRD_BOBIMAQU.EMPRESA%TYPE,
        NUMEOTRE PRD_BOBIMAQU.NUMEOTRE%TYPE,
        CONTADOR_ANTERIOR PRD_BOBIMAQU.CONTADOR%TYPE,--De la Maquina Que configura las Fases Siguientes Multiples
        CONTADOR PRD_BOBIMAQU.CONTADOR%TYPE--De la Maquina de Fases Siguientes Multiples
      );
   -- Definicion de tabla PL de Precios
   TYPE tMAQUINA_FASESIMU IS TABLE OF ST_MAQUINA_FASESIMU Index By Binary_Integer;
   t_MAQUINA_FASESIMU tMAQUINA_FASESIMU;
   rMAQUINA_FASESIMU ST_MAQUINA_FASESIMU;
   --
   biIndice Binary_Integer := 0;
   biIndice_M Binary_Integer := 0;
   --Maquinas lanzadas a OTRF
   CURSOR cMaquinas(vEmpresa FIC_CABEOTRE.EMPRESA%TYPE, nNumeOtre FIC_CABEOTRE.NUMERO%TYPE) IS--22
      SELECT M.CONTADOR, M.MAQUTIPO, M.MAQUCODI, M.FASESEQU FROM PRD_MAQURUTA M
         WHERE M.EMPRESA = vEmpresa
           AND M.NUMEOTRE = nNumeOtre
           AND NOT EXISTS (SELECT 'X' FROM PRD_HCABEOTR OTC WHERE OTC.EMPRESA = M.EMPRESA AND OTC.NUMEOTRE = M.NUMEOTRE)
      UNION
      SELECT M.CONTADOR, M.MAQUTIPO, M.MAQUCODI, FASESEQU FROM PRD_HMAQURUT M
         WHERE M.EMPRESA = vEmpresa
           AND M.NUMEOTRE = nNumeOtre
      ORDER BY CONTADOR;
   --
   CURSOR cPre_Corte(vEmpresa PRD_MAPAMAQU.EMPRESA%TYPE, nNumeOtre PRD_MAPAMAQU.NUMEOTRE%TYPE, nContador PRD_MAQURUTA.CONTADOR%TYPE) IS--319
      SELECT P_UTILIDAD.F_VALOCAMPO(V.VALOR,'PRE-CORTE') PRE_CORTE
            FROM VALORES_LISTA V, 
                 (SELECT MR.EMPRESA, MR.NUMEOTRE, MR.FASESEQU, MR.CONTADOR FROM PRD_MAQURUTA MR
                  WHERE NOT EXISTS (SELECT 'X' FROM PRD_HCABEOTR OTC WHERE OTC.EMPRESA = MR.EMPRESA AND OTC.NUMEOTRE = MR.NUMEOTRE)
                  UNION
                  SELECT MR.EMPRESA, MR.NUMEOTRE, MR.FASESEQU, MR.CONTADOR FROM PRD_HMAQURUT MR) MA, 
                 FIC_LINEOTRE L
               WHERE L.EMPRESA = MA.EMPRESA
                 AND L.NUMERO = MA.NUMEOTRE
                 AND L.TIP_ARES = vTIPORECU
                 AND MA.FASESEQU = (L.FASE * 100) + L.SECUENCI
                 AND V.CODIGO = 'FIC_TIPIRECU'
                 AND INSTR(L.COD_ARES,P_UTILIDAD.F_VALOCAMPO(V.VALOR,'RECURSO')) != 0
                 AND P_UTILIDAD.F_VALOCAMPO(V.VALOR,'CODIGO') = L.TIPIRECU
                 AND MA.EMPRESA = vEmpresa
                 AND MA.NUMEOTRE = nNumeOtre
                 AND MA.CONTADOR = nContador;
   --
   vPre_Corte VALORES_LISTA.VALOR%TYPE;
   --
   CURSOR cMaquActu(vEmpresa PRD_MAPAMAQU.EMPRESA%TYPE, nNumeOtre PRD_MAPAMAQU.NUMEOTRE%TYPE, nContador PRD_MAPAMAQU.CONTADOR%TYPE) IS--226
      SELECT M.MAQUTIPO, M.MAQUCODI FROM PRD_MAQURUTA M
         WHERE M.EMPRESA = vEmpresa
           AND M.NUMEOTRE = nNumeOtre
           AND M.CONTADOR = nContador
           AND NOT EXISTS (SELECT 'X' FROM PRD_HCABEOTR OTC WHERE OTC.EMPRESA = M.EMPRESA AND OTC.NUMEOTRE = M.NUMEOTRE)
      UNION
      SELECT M.MAQUTIPO, M.MAQUCODI FROM PRD_HMAQURUT M
         WHERE M.EMPRESA = vEmpresa
           AND M.NUMEOTRE = nNumeOtre
           AND M.CONTADOR = nContador;
   --
   rMaquActu cMaquActu%ROWTYPE;
   --01072012 Se adiciona el parametro nNumeFaSi Para Buscar en concreto en una Fase Siguiente
   CURSOR cContSigu(vEmpresa PRD_MAPAMAQU.EMPRESA%TYPE, nNumeOtre PRD_MAPAMAQU.NUMEOTRE%TYPE, nContador PRD_MAPAMAQU.CONTADOR%TYPE, nNumeFaSi NUMBER) IS
      SELECT MS.CONTADOR, M.MAQUCODI, MS.MAQUTIPO MAQUTIPO_SIGUIENTE, MS.MAQUCODI MAQUCODI_SIGUIENTE, O.ARTICODI 
         FROM FIC_LINEOTRE L, 
              (SELECT MR.EMPRESA, MR.NUMEOTRE, MR.FASESEQU, MR.CONTADOR, MR.MAQUCODI FROM PRD_MAQURUTA MR
               WHERE NOT EXISTS (SELECT 'X' FROM PRD_HCABEOTR OTC WHERE OTC.EMPRESA = MR.EMPRESA AND OTC.NUMEOTRE = MR.NUMEOTRE)
               UNION
               SELECT MR.EMPRESA, MR.NUMEOTRE, MR.FASESEQU, MR.CONTADOR, MR.MAQUCODI FROM PRD_HMAQURUT MR) M, 
              (SELECT MRA.EMPRESA, MRA.NUMEOTRE, MRA.FASESEQU, MRA.CONTADOR, MRA.MAQUTIPO, MRA.MAQUCODI FROM PRD_MAQURUTA MRA
               WHERE NOT EXISTS (SELECT 'X' FROM PRD_HCABEOTR OTC WHERE OTC.EMPRESA = MRA.EMPRESA AND OTC.NUMEOTRE = MRA.NUMEOTRE)
               UNION
               SELECT MRA.EMPRESA, MRA.NUMEOTRE, MRA.FASESEQU, MRA.CONTADOR, MRA.MAQUTIPO, MRA.MAQUCODI FROM PRD_HMAQURUT MRA) MS, 
              (SELECT OT.EMPRESA, OT.NUMEOTRE, OT.ARTICODI FROM PRD_CABEOTRE OT
               WHERE NOT EXISTS (SELECT 'X' FROM PRD_HCABEOTR OTC WHERE OTC.EMPRESA = OT.EMPRESA AND OTC.NUMEOTRE = OT.NUMEOTRE)
               UNION
               SELECT OT.EMPRESA, OT.NUMEOTRE, OT.ARTICODI FROM PRD_HCABEOTR OT) O
            WHERE L.EMPRESA = M.EMPRESA
              AND L.NUMERO = M.NUMEOTRE
              AND L.TIP_ARES = vTipoRecu
              AND L.COD_ARES NOT LIKE 'MONTADOR%'
              AND M.FASESEQU = (L.FASE * 100) + L.SECUENCI
              AND L.EMPRESA = MS.EMPRESA
              AND L.NUMERO = MS.NUMEOTRE
              AND (
                   (MS.FASESEQU BETWEEN L.FASESI01 * 100 AND ((L.FASESI01 + 1) * 100) - 1 AND L.FASE != L.FASESI01 AND nNumeFaSi = 1) OR
                   (MS.FASESEQU BETWEEN L.FASESI02 * 100 AND ((L.FASESI02 + 1) * 100) - 1 AND L.FASE != L.FASESI02 AND nNumeFaSi = 2) OR
                   (MS.FASESEQU BETWEEN L.FASESI03 * 100 AND ((L.FASESI03 + 1) * 100) - 1 AND L.FASE != L.FASESI03 AND nNumeFaSi = 3) OR
                   (MS.FASESEQU BETWEEN L.FASESI04 * 100 AND ((L.FASESI04 + 1) * 100) - 1 AND L.FASE != L.FASESI04 AND nNumeFaSi = 4) OR
                   (MS.FASESEQU BETWEEN L.FASESI05 * 100 AND ((L.FASESI05 + 1) * 100) - 1 AND L.FASE != L.FASESI05 AND nNumeFaSi = 5) OR
                   (MS.FASESEQU BETWEEN L.FASESI06 * 100 AND ((L.FASESI06 + 1) * 100) - 1 AND L.FASE != L.FASESI06 AND nNumeFaSi = 6) OR
                   (MS.FASESEQU BETWEEN L.FASESI07 * 100 AND ((L.FASESI07 + 1) * 100) - 1 AND L.FASE != L.FASESI07 AND nNumeFaSi = 7) OR
                   (MS.FASESEQU BETWEEN L.FASESI08 * 100 AND ((L.FASESI08 + 1) * 100) - 1 AND L.FASE != L.FASESI08 AND nNumeFaSi = 8) OR
                   (MS.FASESEQU BETWEEN L.FASESI09 * 100 AND ((L.FASESI09 + 1) * 100) - 1 AND L.FASE != L.FASESI09 AND nNumeFaSi = 9) OR
                   (MS.FASESEQU BETWEEN L.FASESI10 * 100 AND ((L.FASESI10 + 1) * 100) - 1 AND L.FASE != L.FASESI10 AND nNumeFaSi = 10)
                  )
              AND L.EMPRESA = O.EMPRESA
              AND L.NUMERO = O.NUMEOTRE
              AND M.EMPRESA = vEmpresa
              AND M.NUMEOTRE = nNumeOtre
              AND M.CONTADOR = nContador;
   --
   rContSigu cContSigu%ROWTYPE;
   rContSiguN cContSigu%ROWTYPE;
   rContSigu_PorcMerm cContSigu%ROWTYPE;
   rContSigu_PorcMermN cContSigu%ROWTYPE;
   --
   nContSigu PRD_MAPAMAQU.CONTADOR%TYPE;
   --
   nCp_Ancho_Mm_Prod FIC_INFOPROD.TOTAL%TYPE;
   nCp_N_Veces FIC_INFOPROD.N_VECES%TYPE;
	--Tolerancia en mm de Mermas de Planificaci¿(Por si la Merma da Negativa)
	vTolemmMP VARIABLES.VALOR%TYPE := P_UTILIDAD.F_VALODEVA('TOLEMMMP');
	--
		vPrecio VARCHAR2(5000); 
		--nPrecio NUMBER;
		--vLogPre VARCHAR2(2000);
		vLogPreci VARCHAR2(5000); 
      --
		PROCEDURE P_ERRORES(vEmpresa FIC_CABEOTRE.EMPRESA%TYPE,nNumeOtre FIC_CABEOTRE.NUMERO%TYPE, vCodigo ANE_MATCON_ERRORES_OBJECOST.CODIGO%TYPE, vParametr VARCHAR2, vTipo ANE_MATCON_ERRORES_OBJECOST.TIPO%TYPE, vErroAvis ANE_MATCON_ERRORES_OBJECOST.ERROR_O_AVISO%TYPE) IS
			vMensaje  VARCHAR2(700);
			-- Manejo de Mensaje de Error
			FUNCTION F_Alerta (nAlerta IN NUMBER, nModo  IN NUMBER := 0)
			RETURN VARCHAR2
			IS
				vMensaje    VARCHAR2(2000);
				--
				CURSOR cAlertas IS
					SELECT Descripcion
					FROM Alertas_Generales
					WHERE Codigo = nAlerta;
			BEGIN
				OPEN cAlertas;
				FETCH cAlertas INTO vMensaje;
				--
				IF (cAlertas%NOTFOUND) THEN
					vMensaje := 'Alerta de la Aplicación no definida';
				END IF;
				--
				CLOSE cAlertas;
				--
				IF nModo = 0 THEN
					-- retorna con este formato '[xxxx]  Texto de la Alerta'
					vMensaje := '[' || TO_CHAR(nAlerta) || ']   ' || vMensaje;
				ELSIF nModo = 1 THEN
					-- retorna con este formato ':xxxx:Texto error'
					vMensaje := ':' || TO_CHAR(nAlerta) || ':' || vMensaje;
				ELSE
					-- retorna con este formato 'Texto error'
					vMensaje := vMensaje;
				END IF;
				--
				RETURN '[IB] '||vMensaje;
			END;
				--
			FUNCTION F_AlerPara (nCodiAler IN NUMBER,
										vParametr IN VARCHAR2,
										nModo     IN NUMBER,
										vSepPrm   IN VARCHAR2 := '|' )
			RETURN VARCHAR2
			IS
				vMensaje  VARCHAR2(700);
				vPara     VARCHAR2(400);
				vIndi     VARCHAR2(2);
				vColu     VARCHAR2(250);
				nPosi     NUMBER(5) :=1;
				nIndi     NUMBER(5) :=1;
			BEGIN
				vMensaje := F_Alerta (nCodiAler, nModo);
				-- DecodIFica Parametro
				IF ((vParametr IS NOT NULL) AND
					(INSTR (vMensaje, '@', 1, 1) > 0 )) THEN
					vPara := RTrim (vParametr);
					--
					LOOP
						IF (vPara IS NOT NULL) THEN
							nPosi := INSTR (vPara, vSepPrm, 1, 1);
						ELSE
							nPosi:= 0;
						END IF;
						--
						IF (nPosi = 0) Then
							vIndi := '@' || TO_CHAR (nIndi);
							vMensaje := REPLACE (vMensaje, vIndi, RTrim (vPara));
							EXIT;
						END IF;
						--
						vColu    := SubStr (vPara, 1, nPosi - 1);
						vIndi    := '@' || TO_CHAR (nIndi);
						vMensaje := REPLACE (vMensaje, vIndi, RTrim (vColu));
						vPara    := SubStr (vPara, nPosi + 1, Length (vPara) - nPosi);
						nIndi    := nIndi + 1;
					END LOOP;
				END IF;
				--
				RETURN (vMensaje);
			END;
		BEGIN
			IF ((vP_EXCLEEML = 'N' AND vTipo = 'E') OR vTipo = 'R') THEN
				/*
				IF bRetorno AND vErroAvis = 'E' THEN
					bRetorno := FALSE;
				END IF;
				*/
				--
				vMensaje := F_AlerPara (vCodigo,vParametr,2);
				--
				IF vParametr IS NOT NULL Then
					vMensaje := F_AlerPara (vCodigo,vParametr,2);
				ELSE
					vMensaje := F_Alerta (vCodigo,2);
				END IF;
				--18-06-2012 --Por posible error de exceso de longitud
				vMensaje := SUBSTR(vMensaje,1,250);
				--
				BEGIN
               INSERT INTO ANALESTA.ANE_MER_MATCON_ERRORES_OBJE(EMPRESA,NUMERO_OT,TIPO,CODIGO,MENSAJE,ERROR_O_AVISO,PARTE_PROCESO)
               VALUES(vEmpresa, nNumeOtre, vTipo, vCodigo, vMensaje,vErroAvis,13);
            EXCEPTION
               WHEN OTHERS THEN
                  BEGIN
                     INSERT INTO ANALESTA.ANE_MER_MATCON_ERRORES_OBJE(EMPRESA,NUMERO_OT,TIPO,CODIGO,MENSAJE,ERROR_O_AVISO,PARTE_PROCESO)
                     VALUES(vEmpresa, nNumeOtre, vTipo, vCodigo, 'ERROR INSERTANDO EL ERROR/AVISO',vErroAvis,13);
                  EXCEPTION
                     WHEN OTHERS THEN
                        NULL;
                  END;
            END;
            --
				IF NVL(LENGTH(vErrores),0) <= 1800 THEN
					IF vErrores IS NULL THEN
						vErrores := vTipo||'-'||vCodigo||'-'||vErroAvis||': '||vMensaje;
					ELSE
						vErrores := vErrores||CHR(10)||vTipo||'-'||vCodigo||'-'||vErroAvis||': '||vMensaje;
					END IF;
				END IF;
			END IF;
		END;
      --
      PROCEDURE P_MAQUINA_FASESIMU(vEmpresa PRD_BOBIMAQU.EMPRESA%TYPE, nNumeOtre PRD_BOBIMAQU.NUMEOTRE%TYPE, nContador_Busqueda_Anterior PRD_BOBIMAQU.CONTADOR%TYPE, nContador PRD_BOBIMAQU.CONTADOR%TYPE) IS
         rMAQUINA_FASESIMU_B ST_MAQUINA_FASESIMU;
         rMAQUINA_FASESIMU_R ST_MAQUINA_FASESIMU;
         --
         bExiste BOOLEAN := FALSE;
      BEGIN
         FOR nI In 1..T_MAQUINA_FASESIMU.COUNT LOOP
            biIndice   := nI;
            rMAQUINA_FASESIMU_B := T_MAQUINA_FASESIMU(biIndice);
            --
            IF  rMAQUINA_FASESIMU_B.EMPRESA = vEmpresa 
            AND rMAQUINA_FASESIMU_B.NUMEOTRE = nNumeOtre 
            AND rMAQUINA_FASESIMU_B.CONTADOR_ANTERIOR = nContador_Busqueda_Anterior
            AND rMAQUINA_FASESIMU_B.CONTADOR = nContador THEN
               bExiste := TRUE;
               --
               EXIT WHEN TRUE;
            END IF;
         END LOOP;
         --
         IF NOT (bExiste) THEN
            rMAQUINA_FASESIMU_R.EMPRESA := vEmpresa;
            rMAQUINA_FASESIMU_R.NUMEOTRE := nNumeOtre;
            rMAQUINA_FASESIMU_R.CONTADOR_ANTERIOR := nContador_Busqueda_Anterior;
            rMAQUINA_FASESIMU_R.CONTADOR := nContador;
            --
            T_MAQUINA_FASESIMU(T_MAQUINA_FASESIMU.COUNT + 1) := rMAQUINA_FASESIMU_R;
         END IF;
      END;
      --
      FUNCTION F_MAQUINA_FASESIMU_CONTANTE(vEmpresa PRD_BOBIMAQU.EMPRESA%TYPE, nNumeOtre PRD_BOBIMAQU.NUMEOTRE%TYPE, nContador PRD_BOBIMAQU.CONTADOR%TYPE) 
      RETURN PRD_BOBIMAQU.CONTADOR%TYPE IS
         rMAQUINA_FASESIMU_B ST_MAQUINA_FASESIMU;
         --
         nContador_Busqueda_Anterior PRD_BOBIMAQU.CONTADOR%TYPE;
      BEGIN
         FOR nI In 1..T_MAQUINA_FASESIMU.COUNT LOOP
            biIndice   := nI;
            rMAQUINA_FASESIMU_B := T_MAQUINA_FASESIMU(biIndice);
            --
            IF  rMAQUINA_FASESIMU_B.EMPRESA = vEmpresa 
            AND rMAQUINA_FASESIMU_B.NUMEOTRE = nNumeOtre 
            AND rMAQUINA_FASESIMU_B.CONTADOR = nContador THEN
               nContador_Busqueda_Anterior := rMAQUINA_FASESIMU_B.CONTADOR_ANTERIOR;
               --
               EXIT WHEN TRUE;
            END IF;
         END LOOP;
         --
         RETURN nContador_Busqueda_Anterior;
      END;
		--
		PROCEDURE P_MATERIAL(rMATERIAL IN OUT ST_MATERIAL,vInserta_Actualiza VARCHAR2,--Para Insert and Update
		                     --Valores para UPDATE
									nCantProd NUMBER,
									nCantCons_E NUMBER,
									nCantCons NUMBER,
									nCantAjus NUMBER,
									nAncho NUMBER,
									nFACTOR_CONVERSION_M2_KG NUMBER,
									nPrecio_ML_E NUMBER,
									vLog_Precio VARCHAR2,
									nMermEnhe_E NUMBER,
									nMermEnhe NUMBER,
									nMermAjus_E NUMBER,
									nMermAjus NUMBER,
									nMermCabo_E NUMBER,
									nMermCabo NUMBER,
									nMermPico_E NUMBER,
									nMermPico NUMBER,
									nMermTira NUMBER,
									nMermSane NUMBER,
									nCantCons_Bobinas NUMBER,
                           --
                           nCONTFSMU_01 NUMBER,
                           nCANTFSMU_01 NUMBER,
                           nCATOFSMU NUMBER,
                           nCONTFSMU_02 NUMBER,
                           nCANTFSMU_02 NUMBER,
                           nCONTFSMU_03 NUMBER,
                           nCANTFSMU_03 NUMBER,
                           nCONTFSMU_04 NUMBER,
                           nCANTFSMU_04 NUMBER,
                           nCONTFSMU_05 NUMBER,
                           nCANTFSMU_05 NUMBER,
                           nCONTFSMU_06 NUMBER,
                           nCANTFSMU_06 NUMBER,
                           nCONTFSMU_07 NUMBER,
                           nCANTFSMU_07 NUMBER,
                           nCONTFSMU_08 NUMBER,
                           nCANTFSMU_08 NUMBER,
                           nCONTFSMU_09 NUMBER,
                           nCANTFSMU_09 NUMBER,
                           nCONTFSMU_10 NUMBER,
                           nCANTFSMU_10 NUMBER,
                           nANCHO_BUENO_TOTAL_01 NUMBER,
                           nANCHO_BUENO_OT_01 NUMBER,
                           nANCHO_BUENO_TOTAL_02 NUMBER,
                           nANCHO_BUENO_OT_02 NUMBER,
                           nANCHO_BUENO_TOTAL_03 NUMBER,
                           nANCHO_BUENO_OT_03 NUMBER,
                           nANCHO_BUENO_TOTAL_04 NUMBER,
                           nANCHO_BUENO_OT_04 NUMBER,
                           nANCHO_BUENO_TOTAL_05 NUMBER,
                           nANCHO_BUENO_OT_05 NUMBER,
                           nANCHO_BUENO_TOTAL_06 NUMBER,
                           nANCHO_BUENO_OT_06 NUMBER,
                           nANCHO_BUENO_TOTAL_07 NUMBER,
                           nANCHO_BUENO_OT_07 NUMBER,
                           nANCHO_BUENO_TOTAL_08 NUMBER,
                           nANCHO_BUENO_OT_08 NUMBER,
                           nANCHO_BUENO_TOTAL_09 NUMBER,
                           nANCHO_BUENO_OT_09 NUMBER,
                           nANCHO_BUENO_TOTAL_10 NUMBER,
                           nANCHO_BUENO_OT_10 NUMBER,
                           nANCHO_BUENO_TOTAL NUMBER,
                           nANCHO_BUENO_OT NUMBER,
                           nNUMECORT NUMBER,
                           nMM_MERMPRCO_01 NUMBER,
                           nMM_MERMPLAN_EXESO_01 NUMBER,
                           nMM_MERMPLAN_01 NUMBER,
                           nMM_MERMPRCO_02 NUMBER,
                           nMM_MERMPLAN_EXESO_02 NUMBER,
                           nMM_MERMPLAN_02 NUMBER,
                           nMM_MERMPRCO_03 NUMBER,
                           nMM_MERMPLAN_EXESO_03 NUMBER,
                           nMM_MERMPLAN_03 NUMBER,
                           nMM_MERMPRCO_04 NUMBER,
                           nMM_MERMPLAN_EXESO_04 NUMBER,
                           nMM_MERMPLAN_04 NUMBER,
                           nMM_MERMPRCO_05 NUMBER,
                           nMM_MERMPLAN_EXESO_05 NUMBER,
                           nMM_MERMPLAN_05 NUMBER,
                           nMM_MERMPRCO_06 NUMBER,
                           nMM_MERMPLAN_EXESO_06 NUMBER,
                           nMM_MERMPLAN_06 NUMBER,
                           nMM_MERMPRCO_07 NUMBER,
                           nMM_MERMPLAN_EXESO_07 NUMBER,
                           nMM_MERMPLAN_07 NUMBER,
                           nMM_MERMPRCO_08 NUMBER,
                           nMM_MERMPLAN_EXESO_08 NUMBER,
                           nMM_MERMPLAN_08 NUMBER,
                           nMM_MERMPRCO_09 NUMBER,
                           nMM_MERMPLAN_EXESO_09 NUMBER,
                           nMM_MERMPLAN_09 NUMBER,
                           nMM_MERMPRCO_10 NUMBER,
                           nMM_MERMPLAN_EXESO_10 NUMBER,
                           nMM_MERMPLAN_10 NUMBER,
                           nMM_MERMPRCO NUMBER,
                           nMM_MERMPLAN_EXESO NUMBER,
                           nMM_MERMPLAN NUMBER
		                    ) IS
		BEGIN
		   IF rMATERIAL.IDENTIFICADOR IS NULL THEN
            P_ERRORES(rMATERIAL.Empresa, rMATERIAL.NumeOtre, '1001','Fallo en la actualización de Materiales Contador:'||rMATERIAL.CONTADOR||' ContMate:'||rMATERIAL.CONTMATE||' ContMaev:'||rMATERIAL.CONTMAEV||
                                                                    ' Tip_Arti:'||rMATERIAL.TIP_ARTI||' Cod_Arti:'||rMATERIAL.COD_ARTI||' Lote:'||rMATERIAL.LOTE,'R','E');
         END IF;              
         --
         IF vInserta_Actualiza  = 'I' THEN
				INSERT INTO ANALESTA.ANE_MER_MATERIAL_OT(EMPRESA,NUMEOTRE,CONTADOR,CONTMATE,CONTMAEV,
                     IDENTIFICADOR,
                     TIP_ARTI,COD_ARTI,LOTE,CANTCONS,CANTCONS_BOBINAS,CANTPROD,CANTAJUS,MERMENHE,MERMAJUS,MERMCABO,MERMPICO,MERMTIRA,MERMSANE,
							CONTFSMU_01,CONTFSMU_02,CONTFSMU_03,CONTFSMU_04,CONTFSMU_05,CONTFSMU_06,CONTFSMU_07,CONTFSMU_08,CONTFSMU_09,CONTFSMU_10,
							CANTFSMU_01,CANTFSMU_02,CANTFSMU_03,CANTFSMU_04,CANTFSMU_05,CANTFSMU_06,CANTFSMU_07,CANTFSMU_08,CANTFSMU_09,CANTFSMU_10,
							CATOFSMU,MM_MERMPLAN_01,MM_MERMPLAN_02,MM_MERMPLAN_03,MM_MERMPLAN_04,MM_MERMPLAN_05,MM_MERMPLAN_06,MM_MERMPLAN_07,MM_MERMPLAN_08,MM_MERMPLAN_09,MM_MERMPLAN_10,
							MM_MERMPLAN,MERMPLAN,
							MM_MERMPLAN_EXESO_01,MM_MERMPLAN_EXESO_02,MM_MERMPLAN_EXESO_03,MM_MERMPLAN_EXESO_04,MM_MERMPLAN_EXESO_05,MM_MERMPLAN_EXESO_06,MM_MERMPLAN_EXESO_07,MM_MERMPLAN_EXESO_08,MM_MERMPLAN_EXESO_09,MM_MERMPLAN_EXESO_10,
							MM_MERMPLAN_EXESO,MERMPLAN_EXESO,
							PRE_CORTE,
							NUMECORT_01,NUMECORT_02,NUMECORT_03,NUMECORT_04,NUMECORT_05,NUMECORT_06,NUMECORT_07,NUMECORT_08,NUMECORT_09,NUMECORT_10,
							NUMECORT,
							MM_MERMPRCO_01,MM_MERMPRCO_02,MM_MERMPRCO_03,MM_MERMPRCO_04,MM_MERMPRCO_05,MM_MERMPRCO_06,MM_MERMPRCO_07,MM_MERMPRCO_08,MM_MERMPRCO_09,MM_MERMPRCO_10,
							MM_MERMPRCO,MERMPRCO,
							CANTCONS_E,MERMENHE_E,MERMAJUS_E,MERMCABO_E,MERMPICO_E,MERMTIRA_E,MERMSANE_E,MM_MERMPLAN_E,MERMPLAN_E,
							ANCHO,
							ANCHO_BUENO_OT_01,ANCHO_BUENO_TOTAL_01,ANCHO_BUENO_OT_02,ANCHO_BUENO_TOTAL_02,ANCHO_BUENO_OT_03,ANCHO_BUENO_TOTAL_03,ANCHO_BUENO_OT_04,ANCHO_BUENO_TOTAL_04,ANCHO_BUENO_OT_05,ANCHO_BUENO_TOTAL_05,
							ANCHO_BUENO_OT_06,ANCHO_BUENO_TOTAL_06,ANCHO_BUENO_OT_07,ANCHO_BUENO_TOTAL_07,ANCHO_BUENO_OT_08,ANCHO_BUENO_TOTAL_08,ANCHO_BUENO_OT_09,ANCHO_BUENO_TOTAL_09,ANCHO_BUENO_OT_10,ANCHO_BUENO_TOTAL_10,
							ANCHO_BUENO_TOTAL,ANCHO_BUENO_OT,
							CANTIDAD_CONSUMIDA_FINAL_01,CANTIDAD_CONSUMIDA_FINAL_02,CANTIDAD_CONSUMIDA_FINAL_03,CANTIDAD_CONSUMIDA_FINAL_04,CANTIDAD_CONSUMIDA_FINAL_05,CANTIDAD_CONSUMIDA_FINAL_06,CANTIDAD_CONSUMIDA_FINAL_07,CANTIDAD_CONSUMIDA_FINAL_08,CANTIDAD_CONSUMIDA_FINAL_09,CANTIDAD_CONSUMIDA_FINAL_10,
							CANTIDAD_CONSUMIDA_FINAL_TOTAL,
							PRECIO_ML,PRECIO_ML_E,FACTOR_CONVERSION_M2_KG)
				VALUES(rMATERIAL.EMPRESA,rMATERIAL.NUMEOTRE,rMATERIAL.CONTADOR,rMATERIAL.CONTMATE,rMATERIAL.CONTMAEV,
                     rMATERIAL.IDENTIFICADOR,--nIdentificador,
                     rMATERIAL.TIP_ARTI,rMATERIAL.COD_ARTI,rMATERIAL.LOTE,rMATERIAL.CANTCONS,rMATERIAL.CANTCONS_BOBINAS,rMATERIAL.CANTPROD,rMATERIAL.CANTAJUS,rMATERIAL.MERMENHE,rMATERIAL.MERMAJUS,rMATERIAL.MERMCABO,rMATERIAL.MERMPICO,rMATERIAL.MERMTIRA,rMATERIAL.MERMSANE,
							rMATERIAL.CONTFSMU_01,rMATERIAL.CONTFSMU_02,rMATERIAL.CONTFSMU_03,rMATERIAL.CONTFSMU_04,rMATERIAL.CONTFSMU_05,rMATERIAL.CONTFSMU_06,rMATERIAL.CONTFSMU_07,rMATERIAL.CONTFSMU_08,rMATERIAL.CONTFSMU_09,rMATERIAL.CONTFSMU_10,
							rMATERIAL.CANTFSMU_01,rMATERIAL.CANTFSMU_02,rMATERIAL.CANTFSMU_03,rMATERIAL.CANTFSMU_04,rMATERIAL.CANTFSMU_05,rMATERIAL.CANTFSMU_06,rMATERIAL.CANTFSMU_07,rMATERIAL.CANTFSMU_08,rMATERIAL.CANTFSMU_09,rMATERIAL.CANTFSMU_10,
							rMATERIAL.CATOFSMU,rMATERIAL.MM_MERMPLAN_01,rMATERIAL.MM_MERMPLAN_02,rMATERIAL.MM_MERMPLAN_03,rMATERIAL.MM_MERMPLAN_04,rMATERIAL.MM_MERMPLAN_05,rMATERIAL.MM_MERMPLAN_06,rMATERIAL.MM_MERMPLAN_07,rMATERIAL.MM_MERMPLAN_08,rMATERIAL.MM_MERMPLAN_09,rMATERIAL.MM_MERMPLAN_10,
							rMATERIAL.MM_MERMPLAN,rMATERIAL.MERMPLAN,
							rMATERIAL.MM_MERMPLAN_EXESO_01,rMATERIAL.MM_MERMPLAN_EXESO_02,rMATERIAL.MM_MERMPLAN_EXESO_03,rMATERIAL.MM_MERMPLAN_EXESO_04,rMATERIAL.MM_MERMPLAN_EXESO_05,rMATERIAL.MM_MERMPLAN_EXESO_06,rMATERIAL.MM_MERMPLAN_EXESO_07,rMATERIAL.MM_MERMPLAN_EXESO_08,rMATERIAL.MM_MERMPLAN_EXESO_09,rMATERIAL.MM_MERMPLAN_EXESO_10,
							rMATERIAL.MM_MERMPLAN_EXESO,rMATERIAL.MERMPLAN_EXESO,
							rMATERIAL.PRE_CORTE,
							rMATERIAL.NUMECORT_01,rMATERIAL.NUMECORT_02,rMATERIAL.NUMECORT_03,rMATERIAL.NUMECORT_04,rMATERIAL.NUMECORT_05,rMATERIAL.NUMECORT_06,rMATERIAL.NUMECORT_07,rMATERIAL.NUMECORT_08,rMATERIAL.NUMECORT_09,rMATERIAL.NUMECORT_10,
							rMATERIAL.NUMECORT,
							rMATERIAL.MM_MERMPRCO_01,rMATERIAL.MM_MERMPRCO_02,rMATERIAL.MM_MERMPRCO_03,rMATERIAL.MM_MERMPRCO_04,rMATERIAL.MM_MERMPRCO_05,rMATERIAL.MM_MERMPRCO_06,rMATERIAL.MM_MERMPRCO_07,rMATERIAL.MM_MERMPRCO_08,rMATERIAL.MM_MERMPRCO_09,rMATERIAL.MM_MERMPRCO_10,
							rMATERIAL.MM_MERMPRCO,rMATERIAL.MERMPRCO,
							rMATERIAL.CANTCONS_E,rMATERIAL.MERMENHE_E,rMATERIAL.MERMAJUS_E,rMATERIAL.MERMCABO_E,rMATERIAL.MERMPICO_E,rMATERIAL.MERMTIRA_E,rMATERIAL.MERMSANE_E,rMATERIAL.MM_MERMPLAN_E,rMATERIAL.MERMPLAN_E,
							rMATERIAL.ANCHO,
							rMATERIAL.ANCHO_BUENO_OT_01,rMATERIAL.ANCHO_BUENO_TOTAL_01,rMATERIAL.ANCHO_BUENO_OT_02,rMATERIAL.ANCHO_BUENO_TOTAL_02,rMATERIAL.ANCHO_BUENO_OT_03,rMATERIAL.ANCHO_BUENO_TOTAL_03,rMATERIAL.ANCHO_BUENO_OT_04,rMATERIAL.ANCHO_BUENO_TOTAL_04,rMATERIAL.ANCHO_BUENO_OT_05,rMATERIAL.ANCHO_BUENO_TOTAL_05,
							rMATERIAL.ANCHO_BUENO_OT_06,rMATERIAL.ANCHO_BUENO_TOTAL_06,rMATERIAL.ANCHO_BUENO_OT_07,rMATERIAL.ANCHO_BUENO_TOTAL_07,rMATERIAL.ANCHO_BUENO_OT_08,rMATERIAL.ANCHO_BUENO_TOTAL_08,rMATERIAL.ANCHO_BUENO_OT_09,rMATERIAL.ANCHO_BUENO_TOTAL_09,rMATERIAL.ANCHO_BUENO_OT_10,rMATERIAL.ANCHO_BUENO_TOTAL_10,
							rMATERIAL.ANCHO_BUENO_TOTAL,rMATERIAL.ANCHO_BUENO_OT,
							rMATERIAL.CANTIDAD_CONSUMIDA_FINAL_01,rMATERIAL.CANTIDAD_CONSUMIDA_FINAL_02,rMATERIAL.CANTIDAD_CONSUMIDA_FINAL_03,rMATERIAL.CANTIDAD_CONSUMIDA_FINAL_04,rMATERIAL.CANTIDAD_CONSUMIDA_FINAL_05,rMATERIAL.CANTIDAD_CONSUMIDA_FINAL_06,rMATERIAL.CANTIDAD_CONSUMIDA_FINAL_07,rMATERIAL.CANTIDAD_CONSUMIDA_FINAL_08,rMATERIAL.CANTIDAD_CONSUMIDA_FINAL_09,rMATERIAL.CANTIDAD_CONSUMIDA_FINAL_10,
							rMATERIAL.CANTIDAD_CONSUMIDA_FINAL_TOTAL,
						rMATERIAL.PRECIO_ML,rMATERIAL.PRECIO_ML_E,rMATERIAL.FACTOR_CONVERSION_M2_KG);
			ELSIF vInserta_Actualiza  = 'U' THEN
			   IF nCantProd IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET CantProd = NVL(CantProd,0) + NVL(nCantProd,0) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.CantProd := NVL(rMaterial.CantProd,0) + NVL(nCantProd,0);
				END IF;
            --
            IF nCantCons_E IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET CantCons_E = NVL(CantCons_E,0) + NVL(nCantCons_E,0) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.CantCons_E := NVL(rMaterial.CantCons_E,0) + NVL(nCantCons_E,0);
				END IF;
            --
            IF nCantCons IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET CantCons = NVL(CantCons,0) + NVL(nCantCons,0) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.CantCons := NVL(rMaterial.CantCons,0) + NVL(nCantCons,0);
				END IF;
            --
            IF nCantAjus IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET CantAjus = NVL(CantAjus,0) + NVL(nCantAjus,0) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.CantAjus := NVL(rMaterial.CantAjus,0) + NVL(nCantAjus,0);
				END IF;
            --
            IF nAncho IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET Ancho = NVL(Ancho,nAncho) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.Ancho := NVL(rMaterial.Ancho,nAncho);
				END IF;
            --
            IF nFACTOR_CONVERSION_M2_KG IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET FACTOR_CONVERSION_M2_KG = NVL(FACTOR_CONVERSION_M2_KG,nFACTOR_CONVERSION_M2_KG) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR AND (FACTOR_CONVERSION_M2_KG IS NULL OR (FACTOR_CONVERSION_M2_KG IS NOT NULL AND FACTOR_CONVERSION_M2_KG != nFACTOR_CONVERSION_M2_KG));
					 --
					 rMaterial.FACTOR_CONVERSION_M2_KG := NVL(rMaterial.FACTOR_CONVERSION_M2_KG,nFACTOR_CONVERSION_M2_KG);
				END IF;
            --
            IF nPrecio_ML_E IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET Precio_ML_E = NVL(Precio_ML_E,nPrecio_ML_E) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.Precio_ML_E := NVL(rMaterial.Precio_ML_E,nPrecio_ML_E);
				END IF;
            --
            IF P_UTILIDAD.F_VALOCAMPO(vLog_Precio,'PRECIO') IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT 
                SET Precio_ML = NVL(Precio_ML,P_UTILIDAD.F_VALOCAMPO(vLog_Precio,'PRECIO')), 
                    LOG_PRECIO = NVL(LOG_PRECIO,SUBSTR(P_UTILIDAD.F_VALOCAMPO(vLog_Precio,'TRAZA'),1,2000))
                WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.Precio_ML := NVL(rMaterial.Precio_ML,P_UTILIDAD.F_VALOCAMPO(vLog_Precio,'PRECIO'));
					 --
					 rMaterial.LOG_PRECIO := NVL(rMaterial.LOG_PRECIO,P_UTILIDAD.F_VALOCAMPO(vLog_Precio,'TRAZA'));
				END IF;
            --
            IF nMermEnhe_E IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET MermEnhe_E = NVL(MermEnhe_E,0) + NVL(nMermEnhe_E,0) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.MermEnhe_E := NVL(rMaterial.MermEnhe_E,0) + NVL(nMermEnhe_E,0);
				END IF;
            --
            IF nMermEnhe IS NOT NULL THEN
--dbms_output.put_line('ENHEBRAD0: INSERTA '||rMATERIAL.CONTADOR||','||nMermEnhe);
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET MermEnhe = NVL(MermEnhe,0) + NVL(nMermEnhe,0) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.MermEnhe := NVL(rMaterial.MermEnhe,0) + NVL(nMermEnhe,0);
				END IF;
            --
            IF nMermAjus_E IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET MermAjus_E = NVL(MermAjus_E,0) + NVL(nMermAjus_E,0) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.MermAjus_E := NVL(rMaterial.MermAjus_E,0) + NVL(nMermAjus_E,0);
				END IF;
            --
            IF nMermAjus IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET MermAjus = NVL(MermAjus,0) + NVL(nMermAjus,0) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.MermAjus := NVL(rMaterial.MermAjus,0) + NVL(nMermAjus,0);
				END IF;
            --
            IF nMermCabo_E IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET MermCabo_E = NVL(MermCabo_E,0) + NVL(nMermCabo_E,0) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.MermCabo_E := NVL(rMaterial.MermCabo_E,0) + NVL(nMermCabo_E,0);
				END IF;
            --
            IF nMermCabo IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET MermCabo = NVL(MermCabo,0) + NVL(nMermCabo,0) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.MermCabo := NVL(rMaterial.MermCabo,0) + NVL(nMermCabo,0);
				END IF;
            --
            IF nMermPico_E IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET MermPico_E = NVL(MermPico_E,0) + NVL(nMermPico_E,0) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.MermPico_E := NVL(rMaterial.MermPico_E,0) + NVL(nMermPico_E,0);
				END IF;
            --
            IF nMermPico IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET MermPico = NVL(MermPico,0) + NVL(nMermPico,0) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.MermPico := NVL(rMaterial.MermPico,0) + NVL(nMermPico,0);
				END IF;
            --
            IF nMermTira IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET MermTira = NVL(MermTira,0) + NVL(nMermTira,0) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.MermTira := NVL(rMaterial.MermTira,0) + NVL(nMermTira,0);
				END IF;
            --
            IF nMermSane IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET MermSane = NVL(MermSane,0) + NVL(nMermSane,0) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.MermSane := NVL(rMaterial.MermSane,0) + NVL(nMermSane,0);
				END IF;
            --
            IF nCantCons_Bobinas IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET CantCons_Bobinas = NVL(CantCons_Bobinas,0) + NVL(nCantCons_Bobinas,0) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.CantCons_Bobinas := NVL(rMaterial.CantCons_Bobinas,0) + NVL(nCantCons_Bobinas,0);
            END IF;
            --
            IF nCONTFSMU_01 IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET CONTFSMU_01 = NVL(CONTFSMU_01,nCONTFSMU_01) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.CONTFSMU_01 := NVL(rMaterial.CONTFSMU_01,nCONTFSMU_01);
            END IF;
            --
            IF nCANTFSMU_01 IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET CANTFSMU_01 = NVL(CANTFSMU_01,nCANTFSMU_01) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.CANTFSMU_01 := NVL(rMaterial.CANTFSMU_01,nCANTFSMU_01);
            END IF;
            --
            IF nCATOFSMU IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET CATOFSMU = NVL(CATOFSMU,nCATOFSMU) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.CATOFSMU := NVL(rMaterial.CATOFSMU,nCATOFSMU);
            END IF;
            --
            IF nCONTFSMU_02 IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET CONTFSMU_02 = NVL(CONTFSMU_02,nCONTFSMU_02) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.CONTFSMU_02 := NVL(rMaterial.CONTFSMU_02,nCONTFSMU_02);
            END IF;
            --
            IF nCANTFSMU_02 IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET CANTFSMU_02 = NVL(CANTFSMU_02,nCANTFSMU_02) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.CANTFSMU_02 := NVL(rMaterial.CANTFSMU_02,nCANTFSMU_02);
            END IF;
            --
            IF nCONTFSMU_03 IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET CONTFSMU_03 = NVL(CONTFSMU_03,nCONTFSMU_03) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.CONTFSMU_03 := NVL(rMaterial.CONTFSMU_03,nCONTFSMU_03);
            END IF;
            --
            IF nCANTFSMU_03 IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET CANTFSMU_03 = NVL(CANTFSMU_03,nCANTFSMU_03) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.CANTFSMU_03 := NVL(rMaterial.CANTFSMU_03,nCANTFSMU_03);
            END IF;
            --
            IF nCONTFSMU_04 IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET CONTFSMU_04 = NVL(CONTFSMU_04,nCONTFSMU_04) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.CONTFSMU_04 := NVL(rMaterial.CONTFSMU_04,nCONTFSMU_04);
            END IF;
            --
            IF nCANTFSMU_04 IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET CANTFSMU_04 = NVL(CANTFSMU_04,nCANTFSMU_04) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.CANTFSMU_04 := NVL(rMaterial.CANTFSMU_04,nCANTFSMU_04);
            END IF;
            --
            IF nCONTFSMU_05 IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET CONTFSMU_05 = NVL(CONTFSMU_05,nCONTFSMU_05) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.CONTFSMU_05 := NVL(rMaterial.CONTFSMU_05,nCONTFSMU_05);
            END IF;
            --
            IF nCANTFSMU_05 IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET CANTFSMU_05 = NVL(CANTFSMU_05,nCANTFSMU_05) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.CANTFSMU_05 := NVL(rMaterial.CANTFSMU_05,nCANTFSMU_05);
            END IF;
            --
            IF nCONTFSMU_06 IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET CONTFSMU_06 = NVL(CONTFSMU_06,nCONTFSMU_06) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.CONTFSMU_06 := NVL(rMaterial.CONTFSMU_06,nCONTFSMU_06);
            END IF;
            --
            IF nCANTFSMU_06 IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET CANTFSMU_06 = NVL(CANTFSMU_06,nCANTFSMU_06) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.CANTFSMU_06 := NVL(rMaterial.CANTFSMU_06,nCANTFSMU_06);
            END IF;
            --
            IF nCONTFSMU_07 IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET CONTFSMU_07 = NVL(CONTFSMU_07,nCONTFSMU_07) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.CONTFSMU_07 := NVL(rMaterial.CONTFSMU_07,nCONTFSMU_07);
            END IF;
            --
            IF nCANTFSMU_07 IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET CANTFSMU_07 = NVL(CANTFSMU_07,nCANTFSMU_07) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.CANTFSMU_07 := NVL(rMaterial.CANTFSMU_07,nCANTFSMU_07);
            END IF;
            --
            IF nCONTFSMU_08 IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET CONTFSMU_08 = NVL(CONTFSMU_08,nCONTFSMU_08) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.CONTFSMU_08 := NVL(rMaterial.CONTFSMU_08,nCONTFSMU_08);
            END IF;
            --
            IF nCANTFSMU_08 IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET CANTFSMU_08 = NVL(CANTFSMU_08,nCANTFSMU_08) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.CANTFSMU_08 := NVL(rMaterial.CANTFSMU_08,nCANTFSMU_08);
            END IF;
            --
            IF nCONTFSMU_09 IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET CONTFSMU_09 = NVL(CONTFSMU_09,nCONTFSMU_09) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.CONTFSMU_09 := NVL(rMaterial.CONTFSMU_09,nCONTFSMU_09);
            END IF;
            --
            IF nCANTFSMU_09 IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET CANTFSMU_09 = NVL(CANTFSMU_09,nCANTFSMU_09) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.CANTFSMU_09 := NVL(rMaterial.CANTFSMU_09,nCANTFSMU_09);
            END IF;
            --
            IF nCONTFSMU_10 IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET CONTFSMU_10 = NVL(CONTFSMU_10,nCONTFSMU_10) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.CONTFSMU_10 := NVL(rMaterial.CONTFSMU_10,nCONTFSMU_10);
            END IF;
            --
            IF nCANTFSMU_10 IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET CANTFSMU_10 = NVL(CANTFSMU_10,nCANTFSMU_10) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.CANTFSMU_10 := NVL(rMaterial.CANTFSMU_10,nCANTFSMU_10);
            END IF;
            --
            IF nANCHO_BUENO_TOTAL_01 IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET ANCHO_BUENO_TOTAL_01 = NVL(ANCHO_BUENO_TOTAL_01,nANCHO_BUENO_TOTAL_01) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.ANCHO_BUENO_TOTAL_01 := NVL(rMaterial.ANCHO_BUENO_TOTAL_01,nANCHO_BUENO_TOTAL_01);
            END IF;
            --
            IF nANCHO_BUENO_OT_01 IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET ANCHO_BUENO_OT_01 = NVL(ANCHO_BUENO_OT_01,nANCHO_BUENO_OT_01) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.ANCHO_BUENO_OT_01 := NVL(rMaterial.ANCHO_BUENO_OT_01,nANCHO_BUENO_OT_01);
            END IF;
            --
            IF nANCHO_BUENO_TOTAL_02 IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET ANCHO_BUENO_TOTAL_02 = NVL(ANCHO_BUENO_TOTAL_02,nANCHO_BUENO_TOTAL_02) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.ANCHO_BUENO_TOTAL_02 := NVL(rMaterial.ANCHO_BUENO_TOTAL_02,nANCHO_BUENO_TOTAL_02);
            END IF;
            --
            IF nANCHO_BUENO_OT_02 IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET ANCHO_BUENO_OT_02 = NVL(ANCHO_BUENO_OT_02,nANCHO_BUENO_OT_02) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.ANCHO_BUENO_OT_02 := NVL(rMaterial.ANCHO_BUENO_OT_02,nANCHO_BUENO_OT_02);
            END IF;
            --
            IF nANCHO_BUENO_TOTAL_03 IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET ANCHO_BUENO_TOTAL_03 = NVL(ANCHO_BUENO_TOTAL_03,nANCHO_BUENO_TOTAL_03) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.ANCHO_BUENO_TOTAL_03 := NVL(rMaterial.ANCHO_BUENO_TOTAL_03,nANCHO_BUENO_TOTAL_03);
            END IF;
            --
            IF nANCHO_BUENO_OT_03 IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET ANCHO_BUENO_OT_03 = NVL(ANCHO_BUENO_OT_03,nANCHO_BUENO_OT_03) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.ANCHO_BUENO_OT_03 := NVL(rMaterial.ANCHO_BUENO_OT_03,nANCHO_BUENO_OT_03);
            END IF;
            --
            IF nANCHO_BUENO_TOTAL_04 IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET ANCHO_BUENO_TOTAL_04 = NVL(ANCHO_BUENO_TOTAL_04,nANCHO_BUENO_TOTAL_04) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.ANCHO_BUENO_TOTAL_04 := NVL(rMaterial.ANCHO_BUENO_TOTAL_04,nANCHO_BUENO_TOTAL_04);
            END IF;
            --
            IF nANCHO_BUENO_OT_04 IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET ANCHO_BUENO_OT_04 = NVL(ANCHO_BUENO_OT_04,nANCHO_BUENO_OT_04) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.ANCHO_BUENO_OT_04 := NVL(rMaterial.ANCHO_BUENO_OT_04,nANCHO_BUENO_OT_04);
            END IF;
            --
            IF nANCHO_BUENO_TOTAL_05 IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET ANCHO_BUENO_TOTAL_05 = NVL(ANCHO_BUENO_TOTAL_05,nANCHO_BUENO_TOTAL_05) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.ANCHO_BUENO_TOTAL_05 := NVL(rMaterial.ANCHO_BUENO_TOTAL_05,nANCHO_BUENO_TOTAL_05);
            END IF;
            --
            IF nANCHO_BUENO_OT_05 IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET ANCHO_BUENO_OT_05 = NVL(ANCHO_BUENO_OT_05,nANCHO_BUENO_OT_05) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.ANCHO_BUENO_OT_05 := NVL(rMaterial.ANCHO_BUENO_OT_05,nANCHO_BUENO_OT_05);
            END IF;
            --
            IF nANCHO_BUENO_TOTAL_06 IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET ANCHO_BUENO_TOTAL_06 = NVL(ANCHO_BUENO_TOTAL_06,nANCHO_BUENO_TOTAL_06) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.ANCHO_BUENO_TOTAL_06 := NVL(rMaterial.ANCHO_BUENO_TOTAL_06,nANCHO_BUENO_TOTAL_06);
            END IF;
            --
            IF nANCHO_BUENO_OT_06 IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET ANCHO_BUENO_OT_06 = NVL(ANCHO_BUENO_OT_06,nANCHO_BUENO_OT_06) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.ANCHO_BUENO_OT_06 := NVL(rMaterial.ANCHO_BUENO_OT_06,nANCHO_BUENO_OT_06);
            END IF;
            --
            IF nANCHO_BUENO_TOTAL_07 IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET ANCHO_BUENO_TOTAL_07 = NVL(ANCHO_BUENO_TOTAL_07,nANCHO_BUENO_TOTAL_07) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.ANCHO_BUENO_TOTAL_07 := NVL(rMaterial.ANCHO_BUENO_TOTAL_07,nANCHO_BUENO_TOTAL_07);
            END IF;
            --
            IF nANCHO_BUENO_OT_07 IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET ANCHO_BUENO_OT_07 = NVL(ANCHO_BUENO_OT_07,nANCHO_BUENO_OT_07) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.ANCHO_BUENO_OT_07 := NVL(rMaterial.ANCHO_BUENO_OT_07,nANCHO_BUENO_OT_07);
            END IF;
            --
            IF nANCHO_BUENO_TOTAL_08 IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET ANCHO_BUENO_TOTAL_08 = NVL(ANCHO_BUENO_TOTAL_08,nANCHO_BUENO_TOTAL_08) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.ANCHO_BUENO_TOTAL_08 := NVL(rMaterial.ANCHO_BUENO_TOTAL_08,nANCHO_BUENO_TOTAL_08);
            END IF;
            --
            IF nANCHO_BUENO_OT_08 IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET ANCHO_BUENO_OT_08 = NVL(ANCHO_BUENO_OT_08,nANCHO_BUENO_OT_08) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.ANCHO_BUENO_OT_08 := NVL(rMaterial.ANCHO_BUENO_OT_08,nANCHO_BUENO_OT_08);
            END IF;
            --
            IF nANCHO_BUENO_TOTAL_09 IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET ANCHO_BUENO_TOTAL_09 = NVL(ANCHO_BUENO_TOTAL_09,nANCHO_BUENO_TOTAL_09) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.ANCHO_BUENO_TOTAL_09 := NVL(rMaterial.ANCHO_BUENO_TOTAL_09,nANCHO_BUENO_TOTAL_09);
            END IF;
            --
            IF nANCHO_BUENO_OT_09 IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET ANCHO_BUENO_OT_09 = NVL(ANCHO_BUENO_OT_09,nANCHO_BUENO_OT_09) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.ANCHO_BUENO_OT_09 := NVL(rMaterial.ANCHO_BUENO_OT_09,nANCHO_BUENO_OT_09);
            END IF;
            --
            IF nANCHO_BUENO_TOTAL_10 IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET ANCHO_BUENO_TOTAL_10 = NVL(ANCHO_BUENO_TOTAL_10,nANCHO_BUENO_TOTAL_10) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.ANCHO_BUENO_TOTAL_10 := NVL(rMaterial.ANCHO_BUENO_TOTAL_10,nANCHO_BUENO_TOTAL_10);
            END IF;
            --
            IF nANCHO_BUENO_OT_10 IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET ANCHO_BUENO_OT_10 = NVL(ANCHO_BUENO_OT_10,nANCHO_BUENO_OT_10) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.ANCHO_BUENO_OT_10 := NVL(rMaterial.ANCHO_BUENO_OT_10,nANCHO_BUENO_OT_10);
            END IF;
            --
            IF nANCHO_BUENO_TOTAL IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET ANCHO_BUENO_TOTAL = NVL(ANCHO_BUENO_TOTAL,nANCHO_BUENO_TOTAL) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.ANCHO_BUENO_TOTAL := NVL(rMaterial.ANCHO_BUENO_TOTAL,nANCHO_BUENO_TOTAL);
            END IF;
            --
            IF nANCHO_BUENO_OT IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET ANCHO_BUENO_OT = NVL(ANCHO_BUENO_OT,nANCHO_BUENO_OT) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.ANCHO_BUENO_OT := NVL(rMaterial.ANCHO_BUENO_OT,nANCHO_BUENO_OT);
            END IF;
            --
            IF nNUMECORT IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET NUMECORT = NVL(NUMECORT,nNUMECORT) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.NUMECORT := NVL(rMaterial.NUMECORT,nNUMECORT);
            END IF;
            --
            IF nMM_MERMPRCO_01 IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET MM_MERMPRCO_01 = NVL(MM_MERMPRCO_01,nMM_MERMPRCO_01) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.MM_MERMPRCO_01 := NVL(rMaterial.MM_MERMPRCO_01,nMM_MERMPRCO_01);
            END IF;
            --
            IF nMM_MERMPLAN_EXESO_01 IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET MM_MERMPLAN_EXESO_01 = NVL(MM_MERMPLAN_EXESO_01,nMM_MERMPLAN_EXESO_01) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.MM_MERMPLAN_EXESO_01 := NVL(rMaterial.MM_MERMPLAN_EXESO_01,nMM_MERMPLAN_EXESO_01);
            END IF;
            --
            IF nMM_MERMPLAN_01 IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET MM_MERMPLAN_01 = NVL(MM_MERMPLAN_01,nMM_MERMPLAN_01) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.MM_MERMPLAN_01 := NVL(rMaterial.MM_MERMPLAN_01,nMM_MERMPLAN_01);
            END IF;
            --
            IF nMM_MERMPRCO_02 IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET MM_MERMPRCO_02 = NVL(MM_MERMPRCO_02,nMM_MERMPRCO_02) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.MM_MERMPRCO_02 := NVL(rMaterial.MM_MERMPRCO_02,nMM_MERMPRCO_02);
            END IF;
            --
            IF nMM_MERMPLAN_EXESO_02 IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET MM_MERMPLAN_EXESO_02 = NVL(MM_MERMPLAN_EXESO_02,nMM_MERMPLAN_EXESO_02) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.MM_MERMPLAN_EXESO_02 := NVL(rMaterial.MM_MERMPLAN_EXESO_02,nMM_MERMPLAN_EXESO_02);
            END IF;
            --
            IF nMM_MERMPLAN_02 IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET MM_MERMPLAN_02 = NVL(MM_MERMPLAN_02,nMM_MERMPLAN_02) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.MM_MERMPLAN_02 := NVL(rMaterial.MM_MERMPLAN_02,nMM_MERMPLAN_02);
            END IF;
            --
            IF nMM_MERMPRCO_03 IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET MM_MERMPRCO_03 = NVL(MM_MERMPRCO_03,nMM_MERMPRCO_03) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.MM_MERMPRCO_03 := NVL(rMaterial.MM_MERMPRCO_03,nMM_MERMPRCO_03);
            END IF;
            --
            IF nMM_MERMPLAN_EXESO_03 IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET MM_MERMPLAN_EXESO_03 = NVL(MM_MERMPLAN_EXESO_03,nMM_MERMPLAN_EXESO_03) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.MM_MERMPLAN_EXESO_03 := NVL(rMaterial.MM_MERMPLAN_EXESO_03,nMM_MERMPLAN_EXESO_03);
            END IF;
            --
            IF nMM_MERMPLAN_03 IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET MM_MERMPLAN_03 = NVL(MM_MERMPLAN_03,nMM_MERMPLAN_03) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.MM_MERMPLAN_03 := NVL(rMaterial.MM_MERMPLAN_03,nMM_MERMPLAN_03);
            END IF;
            --
            IF nMM_MERMPRCO_04 IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET MM_MERMPRCO_04 = NVL(MM_MERMPRCO_04,nMM_MERMPRCO_04) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.MM_MERMPRCO_04 := NVL(rMaterial.MM_MERMPRCO_04,nMM_MERMPRCO_04);
            END IF;
            --
            IF nMM_MERMPLAN_EXESO_04 IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET MM_MERMPLAN_EXESO_04 = NVL(MM_MERMPLAN_EXESO_04,nMM_MERMPLAN_EXESO_04) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.MM_MERMPLAN_EXESO_04 := NVL(rMaterial.MM_MERMPLAN_EXESO_04,nMM_MERMPLAN_EXESO_04);
            END IF;
            --
            IF nMM_MERMPLAN_04 IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET MM_MERMPLAN_04 = NVL(MM_MERMPLAN_04,nMM_MERMPLAN_04) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.MM_MERMPLAN_04 := NVL(rMaterial.MM_MERMPLAN_04,nMM_MERMPLAN_04);
            END IF;
            --
            IF nMM_MERMPRCO_05 IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET MM_MERMPRCO_05 = NVL(MM_MERMPRCO_05,nMM_MERMPRCO_05) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.MM_MERMPRCO_05 := NVL(rMaterial.MM_MERMPRCO_05,nMM_MERMPRCO_05);
            END IF;
            --
            IF nMM_MERMPLAN_EXESO_05 IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET MM_MERMPLAN_EXESO_05 = NVL(MM_MERMPLAN_EXESO_05,nMM_MERMPLAN_EXESO_05) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.MM_MERMPLAN_EXESO_05 := NVL(rMaterial.MM_MERMPLAN_EXESO_05,nMM_MERMPLAN_EXESO_05);
            END IF;
            --
            IF nMM_MERMPLAN_05 IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET MM_MERMPLAN_05 = NVL(MM_MERMPLAN_05,nMM_MERMPLAN_05) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.MM_MERMPLAN_05 := NVL(rMaterial.MM_MERMPLAN_05,nMM_MERMPLAN_05);
            END IF;
            --
            IF nMM_MERMPRCO_06 IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET MM_MERMPRCO_06 = NVL(MM_MERMPRCO_06,nMM_MERMPRCO_06) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.MM_MERMPRCO_06 := NVL(rMaterial.MM_MERMPRCO_06,nMM_MERMPRCO_06);
            END IF;
            --
            IF nMM_MERMPLAN_EXESO_06 IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET MM_MERMPLAN_EXESO_06 = NVL(MM_MERMPLAN_EXESO_06,nMM_MERMPLAN_EXESO_06) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.MM_MERMPLAN_EXESO_06 := NVL(rMaterial.MM_MERMPLAN_EXESO_06,nMM_MERMPLAN_EXESO_06);
            END IF;
            --
            IF nMM_MERMPLAN_06 IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET MM_MERMPLAN_06 = NVL(MM_MERMPLAN_06,nMM_MERMPLAN_06) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.MM_MERMPLAN_06 := NVL(rMaterial.MM_MERMPLAN_06,nMM_MERMPLAN_06);
            END IF;
            --
            IF nMM_MERMPRCO_07 IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET MM_MERMPRCO_07 = NVL(MM_MERMPRCO_07,nMM_MERMPRCO_07) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.MM_MERMPRCO_07 := NVL(rMaterial.MM_MERMPRCO_07,nMM_MERMPRCO_07);
            END IF;
            --
            IF nMM_MERMPLAN_EXESO_07 IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET MM_MERMPLAN_EXESO_07 = NVL(MM_MERMPLAN_EXESO_07,nMM_MERMPLAN_EXESO_07) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.MM_MERMPLAN_EXESO_07 := NVL(rMaterial.MM_MERMPLAN_EXESO_07,nMM_MERMPLAN_EXESO_07);
            END IF;
            --
            IF nMM_MERMPLAN_07 IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET MM_MERMPLAN_07 = NVL(MM_MERMPLAN_07,nMM_MERMPLAN_07) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.MM_MERMPLAN_07 := NVL(rMaterial.MM_MERMPLAN_07,nMM_MERMPLAN_07);
            END IF;
            --
            IF nMM_MERMPRCO_08 IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET MM_MERMPRCO_08 = NVL(MM_MERMPRCO_08,nMM_MERMPRCO_08) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.MM_MERMPRCO_08 := NVL(rMaterial.MM_MERMPRCO_08,nMM_MERMPRCO_08);
            END IF;
            --
            IF nMM_MERMPLAN_EXESO_08 IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET MM_MERMPLAN_EXESO_08 = NVL(MM_MERMPLAN_EXESO_08,nMM_MERMPLAN_EXESO_08) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.MM_MERMPLAN_EXESO_08 := NVL(rMaterial.MM_MERMPLAN_EXESO_08,nMM_MERMPLAN_EXESO_08);
            END IF;
            --
            IF nMM_MERMPLAN_08 IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET MM_MERMPLAN_08 = NVL(MM_MERMPLAN_08,nMM_MERMPLAN_08) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.MM_MERMPLAN_08 := NVL(rMaterial.MM_MERMPLAN_08,nMM_MERMPLAN_08);
            END IF;
            --
            IF nMM_MERMPRCO_09 IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET MM_MERMPRCO_09 = NVL(MM_MERMPRCO_09,nMM_MERMPRCO_09) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.MM_MERMPRCO_09 := NVL(rMaterial.MM_MERMPRCO_09,nMM_MERMPRCO_09);
            END IF;
            --
            IF nMM_MERMPLAN_EXESO_09 IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET MM_MERMPLAN_EXESO_09 = NVL(MM_MERMPLAN_EXESO_09,nMM_MERMPLAN_EXESO_09) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.MM_MERMPLAN_EXESO_09 := NVL(rMaterial.MM_MERMPLAN_EXESO_09,nMM_MERMPLAN_EXESO_09);
            END IF;
            --
            IF nMM_MERMPLAN_09 IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET MM_MERMPLAN_09 = NVL(MM_MERMPLAN_09,nMM_MERMPLAN_09) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.MM_MERMPLAN_09 := NVL(rMaterial.MM_MERMPLAN_09,nMM_MERMPLAN_09);
            END IF;
            --
            IF nMM_MERMPRCO_10 IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET MM_MERMPRCO_10 = NVL(MM_MERMPRCO_10,nMM_MERMPRCO_10) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.MM_MERMPRCO_10 := NVL(rMaterial.MM_MERMPRCO_10,nMM_MERMPRCO_10);
            END IF;
            --
            IF nMM_MERMPLAN_EXESO_10 IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET MM_MERMPLAN_EXESO_10 = NVL(MM_MERMPLAN_EXESO_10,nMM_MERMPLAN_EXESO_10) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.MM_MERMPLAN_EXESO_10 := NVL(rMaterial.MM_MERMPLAN_EXESO_10,nMM_MERMPLAN_EXESO_10);
            END IF;
            --
            IF nMM_MERMPLAN_10 IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET MM_MERMPLAN_10 = NVL(MM_MERMPLAN_10,nMM_MERMPLAN_10) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.MM_MERMPLAN_10 := NVL(rMaterial.MM_MERMPLAN_10,nMM_MERMPLAN_10);
            END IF;
            --
            IF nMM_MERMPRCO IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET MM_MERMPRCO = NVL(MM_MERMPRCO,nMM_MERMPRCO) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.MM_MERMPRCO := NVL(rMaterial.MM_MERMPRCO,nMM_MERMPRCO);
            END IF;
            --
            IF nMM_MERMPLAN_EXESO IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET MM_MERMPLAN_EXESO = NVL(MM_MERMPLAN_EXESO,nMM_MERMPLAN_EXESO) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.MM_MERMPLAN_EXESO := NVL(rMaterial.MM_MERMPLAN_EXESO,nMM_MERMPLAN_EXESO);
            END IF;
            --
            IF nMM_MERMPLAN IS NOT NULL THEN
				    UPDATE ANALESTA.ANE_MER_MATERIAL_OT SET MM_MERMPLAN = NVL(MM_MERMPLAN,nMM_MERMPLAN) WHERE IDENTIFICADOR = rMATERIAL.IDENTIFICADOR;
					 --
					 rMaterial.MM_MERMPLAN := NVL(rMaterial.MM_MERMPLAN,nMM_MERMPLAN);
            END IF;
			END IF;
		END;
		--
		FUNCTION F_ANCHO_UTIL(vEmpresa PRD_BOBIMAQU.EMPRESA%TYPE, nNumeOtre PRD_BOBIMAQU.NUMEOTRE%TYPE, nContador PRD_BOBIMAQU.CONTADOR%TYPE, nFaseSigu NUMBER)--1389
		RETURN ST_ANCHO_UTIL IS
			--rANCHO_UTIL_B ST_ANCHO_UTIL;
			rANCHO_UTIL_R ST_ANCHO_UTIL;
			--
			CURSOR cANE_MER_ANCHO_UTIL_OT IS
			   SELECT EMPRESA,NUMEOTRE,CONTADOR,FASESIGU,ANCHO_UTILIZADO_OT,ANCHO_USADO_Y_EXPEDIDO_OT,PRE_CORTE,NUMECORT,CONTFSMU,CANTFSMU,CATOFSMU
				   FROM ANALESTA.ANE_MER_ANCHO_UTIL_OT
					   WHERE EMPRESA = vEmpresa
						  AND NUMEOTRE = nNumeOtre
						  AND CONTADOR = nContador
						  AND FASESIGU = nFaseSigu;
			--
			rANE_MER_ANCHO_UTIL_OT cANE_MER_ANCHO_UTIL_OT%ROWTYPE;
		BEGIN--F_ANCHO_UTIL
			/*
			FOR nI In 1..T_ANCHO_UTIL.COUNT LOOP
				biIndice   := nI;
				rANCHO_UTIL_B := T_ANCHO_UTIL(biIndice);
				--
				IF  rANCHO_UTIL_B.EMPRESA = vEmpresa 
				AND rANCHO_UTIL_B.NUMEOTRE = nNumeOtre 
				AND rANCHO_UTIL_B.CONTADOR = nContador 
				AND rANCHO_UTIL_B.FASESIGU = nFaseSigu THEN
					rANCHO_UTIL_R := rANCHO_UTIL_B;
					--
					EXIT WHEN TRUE;
				END IF;
			END LOOP;
			*/
			OPEN cANE_MER_ANCHO_UTIL_OT;
			FETCH cANE_MER_ANCHO_UTIL_OT INTO rANE_MER_ANCHO_UTIL_OT;
			CLOSE cANE_MER_ANCHO_UTIL_OT;
			--
			rANCHO_UTIL_R.EMPRESA := rANE_MER_ANCHO_UTIL_OT.EMPRESA;
			rANCHO_UTIL_R.NUMEOTRE := rANE_MER_ANCHO_UTIL_OT.NUMEOTRE;
			rANCHO_UTIL_R.CONTADOR := rANE_MER_ANCHO_UTIL_OT.CONTADOR;
			rANCHO_UTIL_R.FASESIGU := rANE_MER_ANCHO_UTIL_OT.FASESIGU;
			rANCHO_UTIL_R.ANCHO_UTILIZADO_OT := rANE_MER_ANCHO_UTIL_OT.ANCHO_UTILIZADO_OT;
			rANCHO_UTIL_R.ANCHO_USADO_Y_EXPEDIDO_OT := rANE_MER_ANCHO_UTIL_OT.ANCHO_USADO_Y_EXPEDIDO_OT;
			rANCHO_UTIL_R.PRE_CORTE := rANE_MER_ANCHO_UTIL_OT.PRE_CORTE;
			rANCHO_UTIL_R.NUMECORT := rANE_MER_ANCHO_UTIL_OT.NUMECORT;
			rANCHO_UTIL_R.CONTFSMU := rANE_MER_ANCHO_UTIL_OT.CONTFSMU;
			rANCHO_UTIL_R.CANTFSMU := rANE_MER_ANCHO_UTIL_OT.CANTFSMU;
			rANCHO_UTIL_R.CATOFSMU := rANE_MER_ANCHO_UTIL_OT.CATOFSMU;
			--
			RETURN rANCHO_UTIL_R;
		END;--F_ANCHO_UTIL
--
		PROCEDURE P_BOBIMAQU(nIdentificador ANALESTA.ANE_MER_BOBIMAQU_OT.IDENTIFICADOR%TYPE,
									nAncho ANALESTA.ANE_MER_BOBIMAQU_OT.ANCHO%TYPE,
									nAncho_Total ANALESTA.ANE_MER_BOBIMAQU_OT.ANCHO_TOTAL%TYPE,
									vDesbarbe ANALESTA.ANE_MER_BOBIMAQU_OT.DESBARBE%TYPE,
									nNumero_Bobinas_Corte ANALESTA.ANE_MER_BOBIMAQU_OT.NUMERO_BOBINAS_CORTE%TYPE,
									nFACTOR_CONVERSION_M2_KG ANALESTA.ANE_MER_BOBIMAQU_OT.FACTOR_CONVERSION_M2_KG%TYPE,
                           nPrecio_ML ANALESTA.ANE_MER_BOBIMAQU_OT.PRECIO_ML%TYPE,
                           nAncho_Bueno ANALESTA.ANE_MER_BOBIMAQU_OT.ANCHO_BUENO%TYPE) IS
		BEGIN--P_BOBIMAQU
		   IF nAncho IS NOT NULL THEN
				UPDATE ANALESTA.ANE_MER_BOBIMAQU_OT SET ANCHO = NVL(ANCHO,nAncho) WHERE IDENTIFICADOR = nIdentificador;
			ELSIF nAncho_Total IS NOT NULL THEN
				UPDATE ANALESTA.ANE_MER_BOBIMAQU_OT SET ANCHO_TOTAL = NVL(ANCHO_TOTAL,nAncho_Total) WHERE IDENTIFICADOR = nIdentificador;
			ELSIF vDesbarbe IS NOT NULL THEN
				UPDATE ANALESTA.ANE_MER_BOBIMAQU_OT SET DESBARBE = NVL(DESBARBE,vDesbarbe) WHERE IDENTIFICADOR = nIdentificador;
			ELSIF nNumero_Bobinas_Corte IS NOT NULL THEN
				UPDATE ANALESTA.ANE_MER_BOBIMAQU_OT SET NUMERO_BOBINAS_CORTE = NVL(NUMERO_BOBINAS_CORTE,nNumero_Bobinas_Corte) WHERE IDENTIFICADOR = nIdentificador;
			ELSIF nFACTOR_CONVERSION_M2_KG IS NOT NULL THEN--IF t_BOBIMAQU(rBOBIMAQU.IDENTIFICADOR).FACTOR_CONVERSION_M2_KG IS NULL OR t_BOBIMAQU(rBOBIMAQU.IDENTIFICADOR).FACTOR_CONVERSION_M2_KG != nFCKG THEN
				UPDATE ANALESTA.ANE_MER_BOBIMAQU_OT SET FACTOR_CONVERSION_M2_KG = nFACTOR_CONVERSION_M2_KG WHERE IDENTIFICADOR = nIdentificador AND (FACTOR_CONVERSION_M2_KG IS NULL OR (FACTOR_CONVERSION_M2_KG IS NOT NULL AND FACTOR_CONVERSION_M2_KG != nFACTOR_CONVERSION_M2_KG)); --Siempre modifica porque el codigo tenia codificado de que si el valor era nulo no actulalizar
         ELSIF nPrecio_ML IS NOT NULL THEN
				UPDATE ANALESTA.ANE_MER_BOBIMAQU_OT SET PRECIO_ML = NVL(PRECIO_ML,nPrecio_ML) WHERE IDENTIFICADOR = nIdentificador;
         ELSIF nAncho_Bueno IS NOT NULL THEN
				UPDATE ANALESTA.ANE_MER_BOBIMAQU_OT SET ANCHO_BUENO = NVL(ANCHO_BUENO,nAncho_Bueno) WHERE IDENTIFICADOR = nIdentificador;
			END IF;
		END;--P_BOBIMAQU
		--
		FUNCTION F_BOBIMAQU(vEmpresa PRD_BOBIMAQU.EMPRESA%TYPE, nNumeOtre PRD_BOBIMAQU.NUMEOTRE%TYPE, nContador PRD_BOBIMAQU.CONTADOR%TYPE, nContBobi PRD_BOBIMAQU.CONTBOBI%TYPE)--1294
		RETURN ST_BOBIMAQU IS
			rBOBIMAQU_B ST_BOBIMAQU;
			rBOBIMAQU_R ST_BOBIMAQU;
			--
			CURSOR cPRD_BOBIMAQU IS
				SELECT CANTCONS, CANTPROD, CANTAJUS, TIP_ARTI, COD_ARTI, LOTE, COBOPADR, ESTADO FROM PRD_BOBIMAQU
				WHERE EMPRESA = vEmpresa
				  AND NUMEOTRE = nNumeOtre
				  AND CONTADOR = nContador
				  AND CONTBOBI = nContBobi;
			--
			rPRD_BOBIMAQU cPRD_BOBIMAQU%ROWTYPE;
			--
			CURSOR cMERMA(vTipoMerm PRD_SEGUBOBI.TIPOMERM%TYPE) IS
				SELECT SUM(NVL(M.CAMPNU08,0)) MERMA FROM PRD_SEGUBOBI S, PRD_MEFAEVEN M
				WHERE S.EMPRESA = M.EMPRESA
				  AND S.NUMEOTRE = M.NUMEOTRE
				  AND M.ORVAREAL = S.TIPOMERM||'-'||S.CONTADOR||'-'||S.CONTBOBI||'-'||S.CONTSEGU
				  AND S.EMPRESA = vEmpresa
				  AND S.NUMEOTRE = nNumeOtre
				  AND S.CONTADOR = nContador
				  AND S.CONTBOBI = nContBobi
				  AND S.TIPOMERM = vTipoMerm;
			--
			nMerma NUMBER;
			--
			CURSOR cANE_MER_BOBIMAQU_OT IS
			   SELECT EMPRESA,NUMEOTRE,CONTADOR,CONTBOBI,IDENTIFICADOR,
						 CANTCONS,CANTPROD,CANTAJUS,MERMTIRA,MERMSANE,TIP_ARTI,COD_ARTI,
						 LOTE,COBOPADR,ESTADO,ANCHO,ANCHO_BUENO,ANCHO_TOTAL,NUMERO_BOBINAS_CORTE,
						 PRECIO_ML,PRECIO_ML_E,NUMECORT,DESBARBE,FACTOR_CONVERSION_M2_KG
				FROM ANALESTA.ANE_MER_BOBIMAQU_OT
				WHERE EMPRESA = vEmpresa
				  AND NUMEOTRE = nNumeOtre
				  AND CONTADOR = nContador
			     AND CONTBOBI = nContBobi;
			--
			rANE_MER_BOBIMAQU_OT cANE_MER_BOBIMAQU_OT%ROWTYPE;
			--
			CURSOR cANE_MER_BOBIMAQU_OT_I IS
			   SELECT MAX(IDENTIFICADOR) IDENTIFICADOR FROM ANALESTA.ANE_MER_BOBIMAQU_OT;
			--
			nIdentificador ANALESTA.ANE_MER_BOBIMAQU_OT.IDENTIFICADOR%TYPE;
		BEGIN--F_BOBIMAQU
			OPEN cANE_MER_BOBIMAQU_OT;
			FETCH cANE_MER_BOBIMAQU_OT INTO rANE_MER_BOBIMAQU_OT;
			CLOSE cANE_MER_BOBIMAQU_OT;
			--
			rBOBIMAQU_R.EMPRESA := rANE_MER_BOBIMAQU_OT.EMPRESA;
			rBOBIMAQU_R.NUMEOTRE := rANE_MER_BOBIMAQU_OT.NUMEOTRE;
			rBOBIMAQU_R.CONTADOR := rANE_MER_BOBIMAQU_OT.CONTADOR;
			rBOBIMAQU_R.CONTBOBI := rANE_MER_BOBIMAQU_OT.CONTBOBI;
			rBOBIMAQU_R.IDENTIFICADOR := rANE_MER_BOBIMAQU_OT.IDENTIFICADOR;
			rBOBIMAQU_R.CANTCONS := rANE_MER_BOBIMAQU_OT.CANTCONS;
			rBOBIMAQU_R.CANTPROD := rANE_MER_BOBIMAQU_OT.CANTPROD;
			rBOBIMAQU_R.CANTAJUS := rANE_MER_BOBIMAQU_OT.CANTAJUS;
			rBOBIMAQU_R.MERMTIRA := rANE_MER_BOBIMAQU_OT.MERMTIRA;
			rBOBIMAQU_R.MERMSANE := rANE_MER_BOBIMAQU_OT.MERMSANE;
			rBOBIMAQU_R.TIP_ARTI := rANE_MER_BOBIMAQU_OT.TIP_ARTI;
			rBOBIMAQU_R.COD_ARTI := rANE_MER_BOBIMAQU_OT.COD_ARTI;
			rBOBIMAQU_R.LOTE := rANE_MER_BOBIMAQU_OT.LOTE;
			rBOBIMAQU_R.COBOPADR := rANE_MER_BOBIMAQU_OT.COBOPADR;
			rBOBIMAQU_R.ESTADO := rANE_MER_BOBIMAQU_OT.ESTADO;
			rBOBIMAQU_R.ANCHO := rANE_MER_BOBIMAQU_OT.ANCHO;
			rBOBIMAQU_R.ANCHO_BUENO := rANE_MER_BOBIMAQU_OT.ANCHO_BUENO;
			rBOBIMAQU_R.ANCHO_TOTAL := rANE_MER_BOBIMAQU_OT.ANCHO_TOTAL;
			rBOBIMAQU_R.NUMERO_BOBINAS_CORTE := rANE_MER_BOBIMAQU_OT.NUMERO_BOBINAS_CORTE;
			rBOBIMAQU_R.PRECIO_ML := rANE_MER_BOBIMAQU_OT.PRECIO_ML;
			rBOBIMAQU_R.PRECIO_ML_E := rANE_MER_BOBIMAQU_OT.PRECIO_ML_E;
			rBOBIMAQU_R.NUMECORT := rANE_MER_BOBIMAQU_OT.NUMECORT;
			rBOBIMAQU_R.DESBARBE := rANE_MER_BOBIMAQU_OT.DESBARBE;
			rBOBIMAQU_R.FACTOR_CONVERSION_M2_KG := rANE_MER_BOBIMAQU_OT.FACTOR_CONVERSION_M2_KG;
			--
			/*FOR nI In 1..T_BOBIMAQU.COUNT LOOP
				biIndice   := nI;
				rBOBIMAQU_B := T_BOBIMAQU(biIndice);
				--
				IF  rBOBIMAQU_B.EMPRESA = vEmpresa 
				AND rBOBIMAQU_B.NUMEOTRE = nNumeOtre 
				AND rBOBIMAQU_B.CONTADOR = nContador 
				AND rBOBIMAQU_B.CONTBOBI = nContBobi 
				THEN
					rBOBIMAQU_R := rBOBIMAQU_B;
					--
					EXIT WHEN TRUE;
				END IF;
			END LOOP;*/
			--
			IF rBOBIMAQU_R.EMPRESA IS NULL THEN
				rPRD_BOBIMAQU.ESTADO := NULL;
				--
				OPEN cPRD_BOBIMAQU;
				FETCH cPRD_BOBIMAQU INTO rPRD_BOBIMAQU;
				CLOSE cPRD_BOBIMAQU;
				--
				IF rPRD_BOBIMAQU.ESTADO IS NOT NULL THEN
					rBOBIMAQU_R.EMPRESA := vEmpresa;
					rBOBIMAQU_R.NUMEOTRE := nNumeOtre;
					rBOBIMAQU_R.CONTADOR := nContador;
					rBOBIMAQU_R.CONTBOBI := nContBobi;
					rBOBIMAQU_R.CANTCONS := rPRD_BOBIMAQU.CANTCONS;
					rBOBIMAQU_R.CANTPROD := rPRD_BOBIMAQU.CANTPROD;
					rBOBIMAQU_R.CANTAJUS := rPRD_BOBIMAQU.CANTAJUS;
					rBOBIMAQU_R.TIP_ARTI := rPRD_BOBIMAQU.TIP_ARTI;
					rBOBIMAQU_R.COD_ARTI := rPRD_BOBIMAQU.COD_ARTI;
					rBOBIMAQU_R.LOTE := rPRD_BOBIMAQU.LOTE;
					rBOBIMAQU_R.COBOPADR := rPRD_BOBIMAQU.COBOPADR;
					rBOBIMAQU_R.ESTADO := rPRD_BOBIMAQU.ESTADO;
					--Se busca la Merma de Tirada
					nMerma := NULL;
					--
					OPEN cMERMA(vTimeTira);
					FETCH cMERMA INTO nMerma;
					CLOSE cMERMA;
					--
					rBOBIMAQU_R.MERMTIRA := NVL(nMerma,0);
					--Se busca la Merma de Saneamiento
					nMerma := NULL;
					--
--BMERMA
--dbms_output.put_line('MERMA DE SANEAMIENTO');
					OPEN cMERMA(vTimeSane);
					FETCH cMERMA INTO nMerma;
					CLOSE cMERMA;
--dbms_output.put_line('->'||nMerma);
					--
					rBOBIMAQU_R.MERMSANE := NVL(nMerma,0);
				ELSE
					rBOBIMAQU_R.EMPRESA := vEmpresa;
					rBOBIMAQU_R.NUMEOTRE := nNumeOtre;
					rBOBIMAQU_R.CONTADOR := nContador;
					rBOBIMAQU_R.CONTBOBI := nContBobi;
					--
					rBOBIMAQU_R.ESTADO := 'X'; --Bobina no encontrada ERROR
				END IF;
				--
				--rBOBIMAQU_R.IDENTIFICADOR := T_BOBIMAQU.COUNT + 1;
				--
				--T_BOBIMAQU(rBOBIMAQU_R.IDENTIFICADOR) := rBOBIMAQU_R;
				OPEN cANE_MER_BOBIMAQU_OT_I;
				FETCH cANE_MER_BOBIMAQU_OT_I INTO nIdentificador;
				CLOSE cANE_MER_BOBIMAQU_OT_I;
				--
				nIdentificador := NVL(nIdentificador,0) + 1;
				--
            rBOBIMAQU_R.IDENTIFICADOR := nIdentificador;
            --
				INSERT INTO ANALESTA.ANE_MER_BOBIMAQU_OT(EMPRESA,NUMEOTRE,CONTADOR,CONTBOBI,IDENTIFICADOR,
																	  CANTCONS,CANTPROD,CANTAJUS,MERMTIRA,MERMSANE,TIP_ARTI,COD_ARTI,
																	  LOTE,COBOPADR,ESTADO,ANCHO,ANCHO_BUENO,ANCHO_TOTAL,NUMERO_BOBINAS_CORTE,
																	  PRECIO_ML,PRECIO_ML_E,NUMECORT,DESBARBE,FACTOR_CONVERSION_M2_KG)
				VALUES(rBOBIMAQU_R.EMPRESA,rBOBIMAQU_R.NUMEOTRE,rBOBIMAQU_R.CONTADOR,rBOBIMAQU_R.CONTBOBI,nIdentificador,
						 rBOBIMAQU_R.CANTCONS,rBOBIMAQU_R.CANTPROD,rBOBIMAQU_R.CANTAJUS,rBOBIMAQU_R.MERMTIRA,rBOBIMAQU_R.MERMSANE,rBOBIMAQU_R.TIP_ARTI,rBOBIMAQU_R.COD_ARTI,
						 rBOBIMAQU_R.LOTE,rBOBIMAQU_R.COBOPADR,rBOBIMAQU_R.ESTADO,rBOBIMAQU_R.ANCHO,rBOBIMAQU_R.ANCHO_BUENO,rBOBIMAQU_R.ANCHO_TOTAL,rBOBIMAQU_R.NUMERO_BOBINAS_CORTE,
						 rBOBIMAQU_R.PRECIO_ML,rBOBIMAQU_R.PRECIO_ML_E,rBOBIMAQU_R.NUMECORT,rBOBIMAQU_R.DESBARBE,rBOBIMAQU_R.FACTOR_CONVERSION_M2_KG);
			END IF;
			--
			RETURN rBOBIMAQU_R;
		END;--F_BOBIMAQU	
		--
		FUNCTION F_MATERIAL(vEmpresa PRD_BOBIMAQU.EMPRESA%TYPE, nNumeOtre PRD_BOBIMAQU.NUMEOTRE%TYPE, nContador PRD_BOBIMAQU.CONTADOR%TYPE, --1463
								  vTip_Arti PRD_BOBIMAQU.TIP_ARTI%TYPE, vCod_Arti PRD_BOBIMAQU.COD_ARTI%TYPE, vLote VARCHAR2,
								  nContMate NUMBER, nContMaev NUMBER,
								  bInserta BOOLEAN DEFAULT TRUE)
		RETURN ST_MATERIAL IS
			--rMATERIAL_B ST_MATERIAL;
			rMATERIAL_R ST_MATERIAL;
			nContMaRe NUMBER := 0; --Utilizado para Incrementar la Busqueda del Primer Material cuando este es de Restos
			--
			rANCHO_UTIL_B ST_ANCHO_UTIL;
			--
			CURSOR cANE_MER_MATERIAL_OT IS
				SELECT EMPRESA,NUMEOTRE,CONTADOR,CONTMATE,CONTMAEV,IDENTIFICADOR,TIP_ARTI,COD_ARTI,LOTE,CANTCONS,CANTCONS_BOBINAS,CANTPROD,CANTAJUS,MERMENHE,MERMAJUS,MERMCABO,MERMPICO,MERMTIRA,MERMSANE,
						CONTFSMU_01,CONTFSMU_02,CONTFSMU_03,CONTFSMU_04,CONTFSMU_05,CONTFSMU_06,CONTFSMU_07,CONTFSMU_08,CONTFSMU_09,CONTFSMU_10,
						CANTFSMU_01,CANTFSMU_02,CANTFSMU_03,CANTFSMU_04,CANTFSMU_05,CANTFSMU_06,CANTFSMU_07,CANTFSMU_08,CANTFSMU_09,CANTFSMU_10,
						CATOFSMU,MM_MERMPLAN_01,MM_MERMPLAN_02,MM_MERMPLAN_03,MM_MERMPLAN_04,MM_MERMPLAN_05,MM_MERMPLAN_06,MM_MERMPLAN_07,MM_MERMPLAN_08,MM_MERMPLAN_09,MM_MERMPLAN_10,
						MM_MERMPLAN,MERMPLAN,
						MM_MERMPLAN_EXESO_01,MM_MERMPLAN_EXESO_02,MM_MERMPLAN_EXESO_03,MM_MERMPLAN_EXESO_04,MM_MERMPLAN_EXESO_05,MM_MERMPLAN_EXESO_06,MM_MERMPLAN_EXESO_07,MM_MERMPLAN_EXESO_08,MM_MERMPLAN_EXESO_09,MM_MERMPLAN_EXESO_10,
						MM_MERMPLAN_EXESO,MERMPLAN_EXESO,
						PRE_CORTE,
						NUMECORT_01,NUMECORT_02,NUMECORT_03,NUMECORT_04,NUMECORT_05,NUMECORT_06,NUMECORT_07,NUMECORT_08,NUMECORT_09,NUMECORT_10,
						NUMECORT,
						MM_MERMPRCO_01,MM_MERMPRCO_02,MM_MERMPRCO_03,MM_MERMPRCO_04,MM_MERMPRCO_05,MM_MERMPRCO_06,MM_MERMPRCO_07,MM_MERMPRCO_08,MM_MERMPRCO_09,MM_MERMPRCO_10,
						MM_MERMPRCO,MERMPRCO,
						CANTCONS_E,MERMENHE_E,MERMAJUS_E,MERMCABO_E,MERMPICO_E,MERMTIRA_E,MERMSANE_E,MM_MERMPLAN_E,MERMPLAN_E,
						ANCHO,
						ANCHO_BUENO_OT_01,ANCHO_BUENO_TOTAL_01,ANCHO_BUENO_OT_02,ANCHO_BUENO_TOTAL_02,ANCHO_BUENO_OT_03,ANCHO_BUENO_TOTAL_03,ANCHO_BUENO_OT_04,ANCHO_BUENO_TOTAL_04,ANCHO_BUENO_OT_05,ANCHO_BUENO_TOTAL_05,
						ANCHO_BUENO_OT_06,ANCHO_BUENO_TOTAL_06,ANCHO_BUENO_OT_07,ANCHO_BUENO_TOTAL_07,ANCHO_BUENO_OT_08,ANCHO_BUENO_TOTAL_08,ANCHO_BUENO_OT_09,ANCHO_BUENO_TOTAL_09,ANCHO_BUENO_OT_10,ANCHO_BUENO_TOTAL_10,
						ANCHO_BUENO_TOTAL,ANCHO_BUENO_OT,
						CANTIDAD_CONSUMIDA_FINAL_01,CANTIDAD_CONSUMIDA_FINAL_02,CANTIDAD_CONSUMIDA_FINAL_03,CANTIDAD_CONSUMIDA_FINAL_04,CANTIDAD_CONSUMIDA_FINAL_05,CANTIDAD_CONSUMIDA_FINAL_06,CANTIDAD_CONSUMIDA_FINAL_07,CANTIDAD_CONSUMIDA_FINAL_08,CANTIDAD_CONSUMIDA_FINAL_09,CANTIDAD_CONSUMIDA_FINAL_10,
						CANTIDAD_CONSUMIDA_FINAL_TOTAL,
						PRECIO_ML,PRECIO_ML_E,FACTOR_CONVERSION_M2_KG
				FROM ANALESTA.ANE_MER_MATERIAL_OT
				   WHERE EMPRESA = vEmpresa 
					  AND NUMEOTRE = nNumeOtre
					  AND CONTADOR = nContador
					  AND TIP_ARTI = vTip_Arti
					  AND COD_ARTI = vCod_Arti
					  AND LOTE = vLote;
			--
			rANE_MER_MATERIAL_OT cANE_MER_MATERIAL_OT%ROWTYPE;
			--
			CURSOR cANE_MER_MATERIAL_OT_CM IS
				SELECT EMPRESA,NUMEOTRE,CONTADOR,CONTMATE,CONTMAEV,IDENTIFICADOR,TIP_ARTI,COD_ARTI,LOTE,CANTCONS,CANTCONS_BOBINAS,CANTPROD,CANTAJUS,MERMENHE,MERMAJUS,MERMCABO,MERMPICO,MERMTIRA,MERMSANE,
						CONTFSMU_01,CONTFSMU_02,CONTFSMU_03,CONTFSMU_04,CONTFSMU_05,CONTFSMU_06,CONTFSMU_07,CONTFSMU_08,CONTFSMU_09,CONTFSMU_10,
						CANTFSMU_01,CANTFSMU_02,CANTFSMU_03,CANTFSMU_04,CANTFSMU_05,CANTFSMU_06,CANTFSMU_07,CANTFSMU_08,CANTFSMU_09,CANTFSMU_10,
						CATOFSMU,MM_MERMPLAN_01,MM_MERMPLAN_02,MM_MERMPLAN_03,MM_MERMPLAN_04,MM_MERMPLAN_05,MM_MERMPLAN_06,MM_MERMPLAN_07,MM_MERMPLAN_08,MM_MERMPLAN_09,MM_MERMPLAN_10,
						MM_MERMPLAN,MERMPLAN,
						MM_MERMPLAN_EXESO_01,MM_MERMPLAN_EXESO_02,MM_MERMPLAN_EXESO_03,MM_MERMPLAN_EXESO_04,MM_MERMPLAN_EXESO_05,MM_MERMPLAN_EXESO_06,MM_MERMPLAN_EXESO_07,MM_MERMPLAN_EXESO_08,MM_MERMPLAN_EXESO_09,MM_MERMPLAN_EXESO_10,
						MM_MERMPLAN_EXESO,MERMPLAN_EXESO,
						PRE_CORTE,
						NUMECORT_01,NUMECORT_02,NUMECORT_03,NUMECORT_04,NUMECORT_05,NUMECORT_06,NUMECORT_07,NUMECORT_08,NUMECORT_09,NUMECORT_10,
						NUMECORT,
						MM_MERMPRCO_01,MM_MERMPRCO_02,MM_MERMPRCO_03,MM_MERMPRCO_04,MM_MERMPRCO_05,MM_MERMPRCO_06,MM_MERMPRCO_07,MM_MERMPRCO_08,MM_MERMPRCO_09,MM_MERMPRCO_10,
						MM_MERMPRCO,MERMPRCO,
						CANTCONS_E,MERMENHE_E,MERMAJUS_E,MERMCABO_E,MERMPICO_E,MERMTIRA_E,MERMSANE_E,MM_MERMPLAN_E,MERMPLAN_E,
						ANCHO,
						ANCHO_BUENO_OT_01,ANCHO_BUENO_TOTAL_01,ANCHO_BUENO_OT_02,ANCHO_BUENO_TOTAL_02,ANCHO_BUENO_OT_03,ANCHO_BUENO_TOTAL_03,ANCHO_BUENO_OT_04,ANCHO_BUENO_TOTAL_04,ANCHO_BUENO_OT_05,ANCHO_BUENO_TOTAL_05,
						ANCHO_BUENO_OT_06,ANCHO_BUENO_TOTAL_06,ANCHO_BUENO_OT_07,ANCHO_BUENO_TOTAL_07,ANCHO_BUENO_OT_08,ANCHO_BUENO_TOTAL_08,ANCHO_BUENO_OT_09,ANCHO_BUENO_TOTAL_09,ANCHO_BUENO_OT_10,ANCHO_BUENO_TOTAL_10,
						ANCHO_BUENO_TOTAL,ANCHO_BUENO_OT,
						CANTIDAD_CONSUMIDA_FINAL_01,CANTIDAD_CONSUMIDA_FINAL_02,CANTIDAD_CONSUMIDA_FINAL_03,CANTIDAD_CONSUMIDA_FINAL_04,CANTIDAD_CONSUMIDA_FINAL_05,CANTIDAD_CONSUMIDA_FINAL_06,CANTIDAD_CONSUMIDA_FINAL_07,CANTIDAD_CONSUMIDA_FINAL_08,CANTIDAD_CONSUMIDA_FINAL_09,CANTIDAD_CONSUMIDA_FINAL_10,
						CANTIDAD_CONSUMIDA_FINAL_TOTAL,
						PRECIO_ML,PRECIO_ML_E,FACTOR_CONVERSION_M2_KG
				FROM ANALESTA.ANE_MER_MATERIAL_OT
				   WHERE EMPRESA = vEmpresa 
					  AND NUMEOTRE = nNumeOtre
					  AND CONTADOR = nContador
					  AND CONTMATE = nContMate
					  AND CONTMAEV = (nContMaev + nContMaRe);
		--
		CURSOR cANE_MER_MATERIAL_OT_MAX IS
			SELECT MAX(IDENTIFICADOR) IDENTIFICADOR FROM ANALESTA.ANE_MER_MATERIAL_OT;
      --
		nIdentificador ANALESTA.ANE_MER_MATERIAL_OT.IDENTIFICADOR%TYPE;
   BEGIN--F_MATERIAL
			--FOR nI In 1..T_MATERIAL.COUNT LOOP
				--biIndice   := nI;
				--rMATERIAL_B := T_MATERIAL(biIndice);
				/*IF vLote = '|EMPRBOBI:10|NUOTBOBI:2013000672|CONTBOBI:1|COBOBOBI:2|LOTE:2013000672' THEN
				dbms_output.put_line('->'||rMATERIAL_B.EMPRESA||','||rMATERIAL_B.NUMEOTRE||','||rMATERIAL_B.CONTADOR||','||rMATERIAL_B.TIP_ARTI||','||rMATERIAL_B.COD_ARTI||','||rMATERIAL_B.LOTE);
				END IF;*/
				--
				IF vTip_Arti IS NOT NULL AND vCod_Arti IS NOT NULL AND vLote IS NOT NULL THEN
				   OPEN cANE_MER_MATERIAL_OT;
					FETCH cANE_MER_MATERIAL_OT INTO rANE_MER_MATERIAL_OT;
					CLOSE cANE_MER_MATERIAL_OT;
					--
					/*
					IF  rMATERIAL_B.EMPRESA = vEmpresa 
					AND rMATERIAL_B.NUMEOTRE = nNumeOtre 
					AND rMATERIAL_B.CONTADOR = nContador 
					AND rMATERIAL_B.TIP_ARTI = vTip_Arti
					AND rMATERIAL_B.COD_ARTI = vCod_Arti
					AND rMATERIAL_B.LOTE = vLote
					THEN
						rMATERIAL_R := rMATERIAL_B;
						--
						EXIT WHEN TRUE;
					END IF;
					*/
					IF rANE_MER_MATERIAL_OT.EMPRESA IS NOT NULL THEN
						rMATERIAL_R.EMPRESA := rANE_MER_MATERIAL_OT.EMPRESA;
						rMATERIAL_R.NUMEOTRE := rANE_MER_MATERIAL_OT.NUMEOTRE;
						rMATERIAL_R.CONTADOR := rANE_MER_MATERIAL_OT.CONTADOR;
						rMATERIAL_R.CONTMATE := rANE_MER_MATERIAL_OT.CONTMATE;
						rMATERIAL_R.CONTMAEV := rANE_MER_MATERIAL_OT.CONTMAEV;
						rMATERIAL_R.IDENTIFICADOR := rANE_MER_MATERIAL_OT.IDENTIFICADOR;
						rMATERIAL_R.TIP_ARTI := rANE_MER_MATERIAL_OT.TIP_ARTI;
						rMATERIAL_R.COD_ARTI := rANE_MER_MATERIAL_OT.COD_ARTI;
						rMATERIAL_R.LOTE := rANE_MER_MATERIAL_OT.LOTE;
						rMATERIAL_R.CANTCONS := rANE_MER_MATERIAL_OT.CANTCONS;
						rMATERIAL_R.CANTCONS_BOBINAS := rANE_MER_MATERIAL_OT.CANTCONS_BOBINAS;
						rMATERIAL_R.CANTPROD := rANE_MER_MATERIAL_OT.CANTPROD;
						rMATERIAL_R.CANTAJUS := rANE_MER_MATERIAL_OT.CANTAJUS;
						rMATERIAL_R.MERMENHE := rANE_MER_MATERIAL_OT.MERMENHE;
						rMATERIAL_R.MERMAJUS := rANE_MER_MATERIAL_OT.MERMAJUS;
						rMATERIAL_R.MERMCABO := rANE_MER_MATERIAL_OT.MERMCABO;
						rMATERIAL_R.MERMPICO := rANE_MER_MATERIAL_OT.MERMPICO;
						rMATERIAL_R.MERMTIRA := rANE_MER_MATERIAL_OT.MERMTIRA;
						rMATERIAL_R.MERMSANE := rANE_MER_MATERIAL_OT.MERMSANE;
						rMATERIAL_R.CONTFSMU_01 := rANE_MER_MATERIAL_OT.CONTFSMU_01;
						rMATERIAL_R.CONTFSMU_02 := rANE_MER_MATERIAL_OT.CONTFSMU_02;
						rMATERIAL_R.CONTFSMU_03 := rANE_MER_MATERIAL_OT.CONTFSMU_03;
						rMATERIAL_R.CONTFSMU_04 := rANE_MER_MATERIAL_OT.CONTFSMU_04;
						rMATERIAL_R.CONTFSMU_05 := rANE_MER_MATERIAL_OT.CONTFSMU_05;
						rMATERIAL_R.CONTFSMU_06 := rANE_MER_MATERIAL_OT.CONTFSMU_06;
						rMATERIAL_R.CONTFSMU_07 := rANE_MER_MATERIAL_OT.CONTFSMU_07;
						rMATERIAL_R.CONTFSMU_08 := rANE_MER_MATERIAL_OT.CONTFSMU_08;
						rMATERIAL_R.CONTFSMU_09 := rANE_MER_MATERIAL_OT.CONTFSMU_09;
						rMATERIAL_R.CONTFSMU_10 := rANE_MER_MATERIAL_OT.CONTFSMU_10;
						rMATERIAL_R.CANTFSMU_01 := rANE_MER_MATERIAL_OT.CANTFSMU_01;
						rMATERIAL_R.CANTFSMU_02 := rANE_MER_MATERIAL_OT.CANTFSMU_02;
						rMATERIAL_R.CANTFSMU_03 := rANE_MER_MATERIAL_OT.CANTFSMU_03;
						rMATERIAL_R.CANTFSMU_04 := rANE_MER_MATERIAL_OT.CANTFSMU_04;
						rMATERIAL_R.CANTFSMU_05 := rANE_MER_MATERIAL_OT.CANTFSMU_05;
						rMATERIAL_R.CANTFSMU_06 := rANE_MER_MATERIAL_OT.CANTFSMU_06;
						rMATERIAL_R.CANTFSMU_07 := rANE_MER_MATERIAL_OT.CANTFSMU_07;
						rMATERIAL_R.CANTFSMU_08 := rANE_MER_MATERIAL_OT.CANTFSMU_08;
						rMATERIAL_R.CANTFSMU_09 := rANE_MER_MATERIAL_OT.CANTFSMU_09;
						rMATERIAL_R.CANTFSMU_10 := rANE_MER_MATERIAL_OT.CANTFSMU_10;
						rMATERIAL_R.CATOFSMU := rANE_MER_MATERIAL_OT.CATOFSMU;
						rMATERIAL_R.MM_MERMPLAN_01 := rANE_MER_MATERIAL_OT.MM_MERMPLAN_01;
						rMATERIAL_R.MM_MERMPLAN_02 := rANE_MER_MATERIAL_OT.MM_MERMPLAN_02;
						rMATERIAL_R.MM_MERMPLAN_03 := rANE_MER_MATERIAL_OT.MM_MERMPLAN_03;
						rMATERIAL_R.MM_MERMPLAN_04 := rANE_MER_MATERIAL_OT.MM_MERMPLAN_04;
						rMATERIAL_R.MM_MERMPLAN_05 := rANE_MER_MATERIAL_OT.MM_MERMPLAN_05;
						rMATERIAL_R.MM_MERMPLAN_06 := rANE_MER_MATERIAL_OT.MM_MERMPLAN_06;
						rMATERIAL_R.MM_MERMPLAN_07 := rANE_MER_MATERIAL_OT.MM_MERMPLAN_07;
						rMATERIAL_R.MM_MERMPLAN_08 := rANE_MER_MATERIAL_OT.MM_MERMPLAN_08;
						rMATERIAL_R.MM_MERMPLAN_09 := rANE_MER_MATERIAL_OT.MM_MERMPLAN_09;
						rMATERIAL_R.MM_MERMPLAN_10 := rANE_MER_MATERIAL_OT.MM_MERMPLAN_10;
						rMATERIAL_R.MM_MERMPLAN := rANE_MER_MATERIAL_OT.MM_MERMPLAN;
						rMATERIAL_R.MERMPLAN := rANE_MER_MATERIAL_OT.MERMPLAN;
						rMATERIAL_R.MM_MERMPLAN_EXESO_01 := rANE_MER_MATERIAL_OT.MM_MERMPLAN_EXESO_01;
						rMATERIAL_R.MM_MERMPLAN_EXESO_02 := rANE_MER_MATERIAL_OT.MM_MERMPLAN_EXESO_02;
						rMATERIAL_R.MM_MERMPLAN_EXESO_03 := rANE_MER_MATERIAL_OT.MM_MERMPLAN_EXESO_03;
						rMATERIAL_R.MM_MERMPLAN_EXESO_04 := rANE_MER_MATERIAL_OT.MM_MERMPLAN_EXESO_04;
						rMATERIAL_R.MM_MERMPLAN_EXESO_05 := rANE_MER_MATERIAL_OT.MM_MERMPLAN_EXESO_05;
						rMATERIAL_R.MM_MERMPLAN_EXESO_06 := rANE_MER_MATERIAL_OT.MM_MERMPLAN_EXESO_06;
						rMATERIAL_R.MM_MERMPLAN_EXESO_07 := rANE_MER_MATERIAL_OT.MM_MERMPLAN_EXESO_07;
						rMATERIAL_R.MM_MERMPLAN_EXESO_08 := rANE_MER_MATERIAL_OT.MM_MERMPLAN_EXESO_08;
						rMATERIAL_R.MM_MERMPLAN_EXESO_09 := rANE_MER_MATERIAL_OT.MM_MERMPLAN_EXESO_09;
						rMATERIAL_R.MM_MERMPLAN_EXESO_10 := rANE_MER_MATERIAL_OT.MM_MERMPLAN_EXESO_10;
						rMATERIAL_R.MM_MERMPLAN_EXESO := rANE_MER_MATERIAL_OT.MM_MERMPLAN_EXESO;
						rMATERIAL_R.MERMPLAN_EXESO := rANE_MER_MATERIAL_OT.MERMPLAN_EXESO;
						rMATERIAL_R.PRE_CORTE := rANE_MER_MATERIAL_OT.PRE_CORTE;
						rMATERIAL_R.NUMECORT_01 := rANE_MER_MATERIAL_OT.NUMECORT_01;
						rMATERIAL_R.NUMECORT_02 := rANE_MER_MATERIAL_OT.NUMECORT_02;
						rMATERIAL_R.NUMECORT_03 := rANE_MER_MATERIAL_OT.NUMECORT_03;
						rMATERIAL_R.NUMECORT_04 := rANE_MER_MATERIAL_OT.NUMECORT_04;
						rMATERIAL_R.NUMECORT_05 := rANE_MER_MATERIAL_OT.NUMECORT_05;
						rMATERIAL_R.NUMECORT_06 := rANE_MER_MATERIAL_OT.NUMECORT_06;
						rMATERIAL_R.NUMECORT_07 := rANE_MER_MATERIAL_OT.NUMECORT_07;
						rMATERIAL_R.NUMECORT_08 := rANE_MER_MATERIAL_OT.NUMECORT_08;
						rMATERIAL_R.NUMECORT_09 := rANE_MER_MATERIAL_OT.NUMECORT_09;
						rMATERIAL_R.NUMECORT_10 := rANE_MER_MATERIAL_OT.NUMECORT_10;
						rMATERIAL_R.NUMECORT := rANE_MER_MATERIAL_OT.NUMECORT;
						rMATERIAL_R.MM_MERMPRCO_01 := rANE_MER_MATERIAL_OT.MM_MERMPRCO_01;
						rMATERIAL_R.MM_MERMPRCO_02 := rANE_MER_MATERIAL_OT.MM_MERMPRCO_02;
						rMATERIAL_R.MM_MERMPRCO_03 := rANE_MER_MATERIAL_OT.MM_MERMPRCO_03;
						rMATERIAL_R.MM_MERMPRCO_04 := rANE_MER_MATERIAL_OT.MM_MERMPRCO_04;
						rMATERIAL_R.MM_MERMPRCO_05 := rANE_MER_MATERIAL_OT.MM_MERMPRCO_05;
						rMATERIAL_R.MM_MERMPRCO_06 := rANE_MER_MATERIAL_OT.MM_MERMPRCO_06;
						rMATERIAL_R.MM_MERMPRCO_07 := rANE_MER_MATERIAL_OT.MM_MERMPRCO_07;
						rMATERIAL_R.MM_MERMPRCO_08 := rANE_MER_MATERIAL_OT.MM_MERMPRCO_08;
						rMATERIAL_R.MM_MERMPRCO_09 := rANE_MER_MATERIAL_OT.MM_MERMPRCO_09;
						rMATERIAL_R.MM_MERMPRCO_10 := rANE_MER_MATERIAL_OT.MM_MERMPRCO_10;
						rMATERIAL_R.MM_MERMPRCO := rANE_MER_MATERIAL_OT.MM_MERMPRCO;
						rMATERIAL_R.MERMPRCO := rANE_MER_MATERIAL_OT.MERMPRCO;
						rMATERIAL_R.CANTCONS_E := rANE_MER_MATERIAL_OT.CANTCONS_E;
						rMATERIAL_R.MERMENHE_E := rANE_MER_MATERIAL_OT.MERMENHE_E;
						rMATERIAL_R.MERMAJUS_E := rANE_MER_MATERIAL_OT.MERMAJUS_E;
						rMATERIAL_R.MERMCABO_E := rANE_MER_MATERIAL_OT.MERMCABO_E;
						rMATERIAL_R.MERMPICO_E := rANE_MER_MATERIAL_OT.MERMPICO_E;
						rMATERIAL_R.MERMTIRA_E := rANE_MER_MATERIAL_OT.MERMTIRA_E;
						rMATERIAL_R.MERMSANE_E := rANE_MER_MATERIAL_OT.MERMSANE_E;
						rMATERIAL_R.MM_MERMPLAN_E := rANE_MER_MATERIAL_OT.MM_MERMPLAN_E;
						rMATERIAL_R.MERMPLAN_E := rANE_MER_MATERIAL_OT.MERMPLAN_E;
						rMATERIAL_R.ANCHO := rANE_MER_MATERIAL_OT.ANCHO;
						rMATERIAL_R.ANCHO_BUENO_OT_01 := rANE_MER_MATERIAL_OT.ANCHO_BUENO_OT_01;
						rMATERIAL_R.ANCHO_BUENO_TOTAL_01 := rANE_MER_MATERIAL_OT.ANCHO_BUENO_TOTAL_01;
						rMATERIAL_R.ANCHO_BUENO_OT_02 := rANE_MER_MATERIAL_OT.ANCHO_BUENO_OT_02;
						rMATERIAL_R.ANCHO_BUENO_TOTAL_02 := rANE_MER_MATERIAL_OT.ANCHO_BUENO_TOTAL_02;
						rMATERIAL_R.ANCHO_BUENO_OT_03 := rANE_MER_MATERIAL_OT.ANCHO_BUENO_OT_03;
						rMATERIAL_R.ANCHO_BUENO_TOTAL_03 := rANE_MER_MATERIAL_OT.ANCHO_BUENO_TOTAL_03;
						rMATERIAL_R.ANCHO_BUENO_OT_04 := rANE_MER_MATERIAL_OT.ANCHO_BUENO_OT_04;
						rMATERIAL_R.ANCHO_BUENO_TOTAL_04 := rANE_MER_MATERIAL_OT.ANCHO_BUENO_TOTAL_04;
						rMATERIAL_R.ANCHO_BUENO_OT_05 := rANE_MER_MATERIAL_OT.ANCHO_BUENO_OT_05;
						rMATERIAL_R.ANCHO_BUENO_TOTAL_05 := rANE_MER_MATERIAL_OT.ANCHO_BUENO_TOTAL_05;
						rMATERIAL_R.ANCHO_BUENO_OT_06 := rANE_MER_MATERIAL_OT.ANCHO_BUENO_OT_06;
						rMATERIAL_R.ANCHO_BUENO_TOTAL_06 := rANE_MER_MATERIAL_OT.ANCHO_BUENO_TOTAL_06;
						rMATERIAL_R.ANCHO_BUENO_OT_07 := rANE_MER_MATERIAL_OT.ANCHO_BUENO_OT_07;
						rMATERIAL_R.ANCHO_BUENO_TOTAL_07 := rANE_MER_MATERIAL_OT.ANCHO_BUENO_TOTAL_07;
						rMATERIAL_R.ANCHO_BUENO_OT_08 := rANE_MER_MATERIAL_OT.ANCHO_BUENO_OT_08;
						rMATERIAL_R.ANCHO_BUENO_TOTAL_08 := rANE_MER_MATERIAL_OT.ANCHO_BUENO_TOTAL_08;
						rMATERIAL_R.ANCHO_BUENO_OT_09 := rANE_MER_MATERIAL_OT.ANCHO_BUENO_OT_09;
						rMATERIAL_R.ANCHO_BUENO_TOTAL_09 := rANE_MER_MATERIAL_OT.ANCHO_BUENO_TOTAL_09;
						rMATERIAL_R.ANCHO_BUENO_OT_10 := rANE_MER_MATERIAL_OT.ANCHO_BUENO_OT_10;
						rMATERIAL_R.ANCHO_BUENO_TOTAL_10 := rANE_MER_MATERIAL_OT.ANCHO_BUENO_TOTAL_10;
						rMATERIAL_R.ANCHO_BUENO_TOTAL := rANE_MER_MATERIAL_OT.ANCHO_BUENO_TOTAL;
						rMATERIAL_R.ANCHO_BUENO_OT := rANE_MER_MATERIAL_OT.ANCHO_BUENO_OT;
						rMATERIAL_R.CANTIDAD_CONSUMIDA_FINAL_01 := rANE_MER_MATERIAL_OT.CANTIDAD_CONSUMIDA_FINAL_01;
						rMATERIAL_R.CANTIDAD_CONSUMIDA_FINAL_02 := rANE_MER_MATERIAL_OT.CANTIDAD_CONSUMIDA_FINAL_02;
						rMATERIAL_R.CANTIDAD_CONSUMIDA_FINAL_03 := rANE_MER_MATERIAL_OT.CANTIDAD_CONSUMIDA_FINAL_03;
						rMATERIAL_R.CANTIDAD_CONSUMIDA_FINAL_04 := rANE_MER_MATERIAL_OT.CANTIDAD_CONSUMIDA_FINAL_04;
						rMATERIAL_R.CANTIDAD_CONSUMIDA_FINAL_05 := rANE_MER_MATERIAL_OT.CANTIDAD_CONSUMIDA_FINAL_05;
						rMATERIAL_R.CANTIDAD_CONSUMIDA_FINAL_06 := rANE_MER_MATERIAL_OT.CANTIDAD_CONSUMIDA_FINAL_06;
						rMATERIAL_R.CANTIDAD_CONSUMIDA_FINAL_07 := rANE_MER_MATERIAL_OT.CANTIDAD_CONSUMIDA_FINAL_07;
						rMATERIAL_R.CANTIDAD_CONSUMIDA_FINAL_08 := rANE_MER_MATERIAL_OT.CANTIDAD_CONSUMIDA_FINAL_08;
						rMATERIAL_R.CANTIDAD_CONSUMIDA_FINAL_09 := rANE_MER_MATERIAL_OT.CANTIDAD_CONSUMIDA_FINAL_09;
						rMATERIAL_R.CANTIDAD_CONSUMIDA_FINAL_10 := rANE_MER_MATERIAL_OT.CANTIDAD_CONSUMIDA_FINAL_10;
						rMATERIAL_R.CANTIDAD_CONSUMIDA_FINAL_TOTAL := rANE_MER_MATERIAL_OT.CANTIDAD_CONSUMIDA_FINAL_TOTAL;
						rMATERIAL_R.PRECIO_ML := rANE_MER_MATERIAL_OT.PRECIO_ML;
						rMATERIAL_R.PRECIO_ML_E := rANE_MER_MATERIAL_OT.PRECIO_ML_E;
						rMATERIAL_R.FACTOR_CONVERSION_M2_KG := rANE_MER_MATERIAL_OT.FACTOR_CONVERSION_M2_KG;
					END IF;
				ELSIF nContMate IS NOT NULL AND nContMaev IS NOT NULL THEN --Se utiliza para buscar consumos basados en el Estandar para la Parte Real, donde se imputan estos consumos al primer material consumido en Pasadas, es la forma de identificarlo
					OPEN cANE_MER_MATERIAL_OT_CM;
					FETCH cANE_MER_MATERIAL_OT_CM INTO rANE_MER_MATERIAL_OT;
					CLOSE cANE_MER_MATERIAL_OT_CM;
					--
					/*
					IF  rMATERIAL_B.EMPRESA = vEmpresa 
					AND rMATERIAL_B.NUMEOTRE = nNumeOtre 
					AND rMATERIAL_B.CONTADOR = nContador 
					AND rMATERIAL_B.CONTMATE = nContMate
					AND rMATERIAL_B.CONTMAEV = (nContMaev + nContMaRe)
					THEN
						IF rMATERIAL_B.Tip_Arti = vTIARREST THEN --Material de Restos No se tiene en cuenta para entregarlo en las Busquedas
							nContMaRe := nContMaRe + 1;
						ELSE
							rMATERIAL_R := rMATERIAL_B;
						END IF;
						--
						EXIT WHEN TRUE;
					END IF;
					IF rMATERIAL_B.Tip_Arti = vTIARREST THEN --Material de Restos No se tiene en cuenta para entregarlo en las Busquedas*/
               IF rANE_MER_MATERIAL_OT.Tip_Arti = vTIARREST THEN --Material de Restos No se tiene en cuenta para entregarlo en las Busquedas
						nContMaRe := nContMaRe + 1;
					ELSIF rANE_MER_MATERIAL_OT.EMPRESA IS NOT NULL THEN
						rMATERIAL_R.EMPRESA := rANE_MER_MATERIAL_OT.EMPRESA;
						rMATERIAL_R.NUMEOTRE := rANE_MER_MATERIAL_OT.NUMEOTRE;
						rMATERIAL_R.CONTADOR := rANE_MER_MATERIAL_OT.CONTADOR;
						rMATERIAL_R.CONTMATE := rANE_MER_MATERIAL_OT.CONTMATE;
						rMATERIAL_R.CONTMAEV := rANE_MER_MATERIAL_OT.CONTMAEV;
						rMATERIAL_R.IDENTIFICADOR := rANE_MER_MATERIAL_OT.IDENTIFICADOR;
						rMATERIAL_R.TIP_ARTI := rANE_MER_MATERIAL_OT.TIP_ARTI;
						rMATERIAL_R.COD_ARTI := rANE_MER_MATERIAL_OT.COD_ARTI;
						rMATERIAL_R.LOTE := rANE_MER_MATERIAL_OT.LOTE;
						rMATERIAL_R.CANTCONS := rANE_MER_MATERIAL_OT.CANTCONS;
						rMATERIAL_R.CANTCONS_BOBINAS := rANE_MER_MATERIAL_OT.CANTCONS_BOBINAS;
						rMATERIAL_R.CANTPROD := rANE_MER_MATERIAL_OT.CANTPROD;
						rMATERIAL_R.CANTAJUS := rANE_MER_MATERIAL_OT.CANTAJUS;
						rMATERIAL_R.MERMENHE := rANE_MER_MATERIAL_OT.MERMENHE;
						rMATERIAL_R.MERMAJUS := rANE_MER_MATERIAL_OT.MERMAJUS;
						rMATERIAL_R.MERMCABO := rANE_MER_MATERIAL_OT.MERMCABO;
						rMATERIAL_R.MERMPICO := rANE_MER_MATERIAL_OT.MERMPICO;
						rMATERIAL_R.MERMTIRA := rANE_MER_MATERIAL_OT.MERMTIRA;
						rMATERIAL_R.MERMSANE := rANE_MER_MATERIAL_OT.MERMSANE;
						rMATERIAL_R.CONTFSMU_01 := rANE_MER_MATERIAL_OT.CONTFSMU_01;
						rMATERIAL_R.CONTFSMU_02 := rANE_MER_MATERIAL_OT.CONTFSMU_02;
						rMATERIAL_R.CONTFSMU_03 := rANE_MER_MATERIAL_OT.CONTFSMU_03;
						rMATERIAL_R.CONTFSMU_04 := rANE_MER_MATERIAL_OT.CONTFSMU_04;
						rMATERIAL_R.CONTFSMU_05 := rANE_MER_MATERIAL_OT.CONTFSMU_05;
						rMATERIAL_R.CONTFSMU_06 := rANE_MER_MATERIAL_OT.CONTFSMU_06;
						rMATERIAL_R.CONTFSMU_07 := rANE_MER_MATERIAL_OT.CONTFSMU_07;
						rMATERIAL_R.CONTFSMU_08 := rANE_MER_MATERIAL_OT.CONTFSMU_08;
						rMATERIAL_R.CONTFSMU_09 := rANE_MER_MATERIAL_OT.CONTFSMU_09;
						rMATERIAL_R.CONTFSMU_10 := rANE_MER_MATERIAL_OT.CONTFSMU_10;
						rMATERIAL_R.CANTFSMU_01 := rANE_MER_MATERIAL_OT.CANTFSMU_01;
						rMATERIAL_R.CANTFSMU_02 := rANE_MER_MATERIAL_OT.CANTFSMU_02;
						rMATERIAL_R.CANTFSMU_03 := rANE_MER_MATERIAL_OT.CANTFSMU_03;
						rMATERIAL_R.CANTFSMU_04 := rANE_MER_MATERIAL_OT.CANTFSMU_04;
						rMATERIAL_R.CANTFSMU_05 := rANE_MER_MATERIAL_OT.CANTFSMU_05;
						rMATERIAL_R.CANTFSMU_06 := rANE_MER_MATERIAL_OT.CANTFSMU_06;
						rMATERIAL_R.CANTFSMU_07 := rANE_MER_MATERIAL_OT.CANTFSMU_07;
						rMATERIAL_R.CANTFSMU_08 := rANE_MER_MATERIAL_OT.CANTFSMU_08;
						rMATERIAL_R.CANTFSMU_09 := rANE_MER_MATERIAL_OT.CANTFSMU_09;
						rMATERIAL_R.CANTFSMU_10 := rANE_MER_MATERIAL_OT.CANTFSMU_10;
						rMATERIAL_R.CATOFSMU := rANE_MER_MATERIAL_OT.CATOFSMU;
						rMATERIAL_R.MM_MERMPLAN_01 := rANE_MER_MATERIAL_OT.MM_MERMPLAN_01;
						rMATERIAL_R.MM_MERMPLAN_02 := rANE_MER_MATERIAL_OT.MM_MERMPLAN_02;
						rMATERIAL_R.MM_MERMPLAN_03 := rANE_MER_MATERIAL_OT.MM_MERMPLAN_03;
						rMATERIAL_R.MM_MERMPLAN_04 := rANE_MER_MATERIAL_OT.MM_MERMPLAN_04;
						rMATERIAL_R.MM_MERMPLAN_05 := rANE_MER_MATERIAL_OT.MM_MERMPLAN_05;
						rMATERIAL_R.MM_MERMPLAN_06 := rANE_MER_MATERIAL_OT.MM_MERMPLAN_06;
						rMATERIAL_R.MM_MERMPLAN_07 := rANE_MER_MATERIAL_OT.MM_MERMPLAN_07;
						rMATERIAL_R.MM_MERMPLAN_08 := rANE_MER_MATERIAL_OT.MM_MERMPLAN_08;
						rMATERIAL_R.MM_MERMPLAN_09 := rANE_MER_MATERIAL_OT.MM_MERMPLAN_09;
						rMATERIAL_R.MM_MERMPLAN_10 := rANE_MER_MATERIAL_OT.MM_MERMPLAN_10;
						rMATERIAL_R.MM_MERMPLAN := rANE_MER_MATERIAL_OT.MM_MERMPLAN;
						rMATERIAL_R.MERMPLAN := rANE_MER_MATERIAL_OT.MERMPLAN;
						rMATERIAL_R.MM_MERMPLAN_EXESO_01 := rANE_MER_MATERIAL_OT.MM_MERMPLAN_EXESO_01;
						rMATERIAL_R.MM_MERMPLAN_EXESO_02 := rANE_MER_MATERIAL_OT.MM_MERMPLAN_EXESO_02;
						rMATERIAL_R.MM_MERMPLAN_EXESO_03 := rANE_MER_MATERIAL_OT.MM_MERMPLAN_EXESO_03;
						rMATERIAL_R.MM_MERMPLAN_EXESO_04 := rANE_MER_MATERIAL_OT.MM_MERMPLAN_EXESO_04;
						rMATERIAL_R.MM_MERMPLAN_EXESO_05 := rANE_MER_MATERIAL_OT.MM_MERMPLAN_EXESO_05;
						rMATERIAL_R.MM_MERMPLAN_EXESO_06 := rANE_MER_MATERIAL_OT.MM_MERMPLAN_EXESO_06;
						rMATERIAL_R.MM_MERMPLAN_EXESO_07 := rANE_MER_MATERIAL_OT.MM_MERMPLAN_EXESO_07;
						rMATERIAL_R.MM_MERMPLAN_EXESO_08 := rANE_MER_MATERIAL_OT.MM_MERMPLAN_EXESO_08;
						rMATERIAL_R.MM_MERMPLAN_EXESO_09 := rANE_MER_MATERIAL_OT.MM_MERMPLAN_EXESO_09;
						rMATERIAL_R.MM_MERMPLAN_EXESO_10 := rANE_MER_MATERIAL_OT.MM_MERMPLAN_EXESO_10;
						rMATERIAL_R.MM_MERMPLAN_EXESO := rANE_MER_MATERIAL_OT.MM_MERMPLAN_EXESO;
						rMATERIAL_R.MERMPLAN_EXESO := rANE_MER_MATERIAL_OT.MERMPLAN_EXESO;
						rMATERIAL_R.PRE_CORTE := rANE_MER_MATERIAL_OT.PRE_CORTE;
						rMATERIAL_R.NUMECORT_01 := rANE_MER_MATERIAL_OT.NUMECORT_01;
						rMATERIAL_R.NUMECORT_02 := rANE_MER_MATERIAL_OT.NUMECORT_02;
						rMATERIAL_R.NUMECORT_03 := rANE_MER_MATERIAL_OT.NUMECORT_03;
						rMATERIAL_R.NUMECORT_04 := rANE_MER_MATERIAL_OT.NUMECORT_04;
						rMATERIAL_R.NUMECORT_05 := rANE_MER_MATERIAL_OT.NUMECORT_05;
						rMATERIAL_R.NUMECORT_06 := rANE_MER_MATERIAL_OT.NUMECORT_06;
						rMATERIAL_R.NUMECORT_07 := rANE_MER_MATERIAL_OT.NUMECORT_07;
						rMATERIAL_R.NUMECORT_08 := rANE_MER_MATERIAL_OT.NUMECORT_08;
						rMATERIAL_R.NUMECORT_09 := rANE_MER_MATERIAL_OT.NUMECORT_09;
						rMATERIAL_R.NUMECORT_10 := rANE_MER_MATERIAL_OT.NUMECORT_10;
						rMATERIAL_R.NUMECORT := rANE_MER_MATERIAL_OT.NUMECORT;
						rMATERIAL_R.MM_MERMPRCO_01 := rANE_MER_MATERIAL_OT.MM_MERMPRCO_01;
						rMATERIAL_R.MM_MERMPRCO_02 := rANE_MER_MATERIAL_OT.MM_MERMPRCO_02;
						rMATERIAL_R.MM_MERMPRCO_03 := rANE_MER_MATERIAL_OT.MM_MERMPRCO_03;
						rMATERIAL_R.MM_MERMPRCO_04 := rANE_MER_MATERIAL_OT.MM_MERMPRCO_04;
						rMATERIAL_R.MM_MERMPRCO_05 := rANE_MER_MATERIAL_OT.MM_MERMPRCO_05;
						rMATERIAL_R.MM_MERMPRCO_06 := rANE_MER_MATERIAL_OT.MM_MERMPRCO_06;
						rMATERIAL_R.MM_MERMPRCO_07 := rANE_MER_MATERIAL_OT.MM_MERMPRCO_07;
						rMATERIAL_R.MM_MERMPRCO_08 := rANE_MER_MATERIAL_OT.MM_MERMPRCO_08;
						rMATERIAL_R.MM_MERMPRCO_09 := rANE_MER_MATERIAL_OT.MM_MERMPRCO_09;
						rMATERIAL_R.MM_MERMPRCO_10 := rANE_MER_MATERIAL_OT.MM_MERMPRCO_10;
						rMATERIAL_R.MM_MERMPRCO := rANE_MER_MATERIAL_OT.MM_MERMPRCO;
						rMATERIAL_R.MERMPRCO := rANE_MER_MATERIAL_OT.MERMPRCO;
						rMATERIAL_R.CANTCONS_E := rANE_MER_MATERIAL_OT.CANTCONS_E;
						rMATERIAL_R.MERMENHE_E := rANE_MER_MATERIAL_OT.MERMENHE_E;
						rMATERIAL_R.MERMAJUS_E := rANE_MER_MATERIAL_OT.MERMAJUS_E;
						rMATERIAL_R.MERMCABO_E := rANE_MER_MATERIAL_OT.MERMCABO_E;
						rMATERIAL_R.MERMPICO_E := rANE_MER_MATERIAL_OT.MERMPICO_E;
						rMATERIAL_R.MERMTIRA_E := rANE_MER_MATERIAL_OT.MERMTIRA_E;
						rMATERIAL_R.MERMSANE_E := rANE_MER_MATERIAL_OT.MERMSANE_E;
						rMATERIAL_R.MM_MERMPLAN_E := rANE_MER_MATERIAL_OT.MM_MERMPLAN_E;
						rMATERIAL_R.MERMPLAN_E := rANE_MER_MATERIAL_OT.MERMPLAN_E;
						rMATERIAL_R.ANCHO := rANE_MER_MATERIAL_OT.ANCHO;
						rMATERIAL_R.ANCHO_BUENO_OT_01 := rANE_MER_MATERIAL_OT.ANCHO_BUENO_OT_01;
						rMATERIAL_R.ANCHO_BUENO_TOTAL_01 := rANE_MER_MATERIAL_OT.ANCHO_BUENO_TOTAL_01;
						rMATERIAL_R.ANCHO_BUENO_OT_02 := rANE_MER_MATERIAL_OT.ANCHO_BUENO_OT_02;
						rMATERIAL_R.ANCHO_BUENO_TOTAL_02 := rANE_MER_MATERIAL_OT.ANCHO_BUENO_TOTAL_02;
						rMATERIAL_R.ANCHO_BUENO_OT_03 := rANE_MER_MATERIAL_OT.ANCHO_BUENO_OT_03;
						rMATERIAL_R.ANCHO_BUENO_TOTAL_03 := rANE_MER_MATERIAL_OT.ANCHO_BUENO_TOTAL_03;
						rMATERIAL_R.ANCHO_BUENO_OT_04 := rANE_MER_MATERIAL_OT.ANCHO_BUENO_OT_04;
						rMATERIAL_R.ANCHO_BUENO_TOTAL_04 := rANE_MER_MATERIAL_OT.ANCHO_BUENO_TOTAL_04;
						rMATERIAL_R.ANCHO_BUENO_OT_05 := rANE_MER_MATERIAL_OT.ANCHO_BUENO_OT_05;
						rMATERIAL_R.ANCHO_BUENO_TOTAL_05 := rANE_MER_MATERIAL_OT.ANCHO_BUENO_TOTAL_05;
						rMATERIAL_R.ANCHO_BUENO_OT_06 := rANE_MER_MATERIAL_OT.ANCHO_BUENO_OT_06;
						rMATERIAL_R.ANCHO_BUENO_TOTAL_06 := rANE_MER_MATERIAL_OT.ANCHO_BUENO_TOTAL_06;
						rMATERIAL_R.ANCHO_BUENO_OT_07 := rANE_MER_MATERIAL_OT.ANCHO_BUENO_OT_07;
						rMATERIAL_R.ANCHO_BUENO_TOTAL_07 := rANE_MER_MATERIAL_OT.ANCHO_BUENO_TOTAL_07;
						rMATERIAL_R.ANCHO_BUENO_OT_08 := rANE_MER_MATERIAL_OT.ANCHO_BUENO_OT_08;
						rMATERIAL_R.ANCHO_BUENO_TOTAL_08 := rANE_MER_MATERIAL_OT.ANCHO_BUENO_TOTAL_08;
						rMATERIAL_R.ANCHO_BUENO_OT_09 := rANE_MER_MATERIAL_OT.ANCHO_BUENO_OT_09;
						rMATERIAL_R.ANCHO_BUENO_TOTAL_09 := rANE_MER_MATERIAL_OT.ANCHO_BUENO_TOTAL_09;
						rMATERIAL_R.ANCHO_BUENO_OT_10 := rANE_MER_MATERIAL_OT.ANCHO_BUENO_OT_10;
						rMATERIAL_R.ANCHO_BUENO_TOTAL_10 := rANE_MER_MATERIAL_OT.ANCHO_BUENO_TOTAL_10;
						rMATERIAL_R.ANCHO_BUENO_TOTAL := rANE_MER_MATERIAL_OT.ANCHO_BUENO_TOTAL;
						rMATERIAL_R.ANCHO_BUENO_OT := rANE_MER_MATERIAL_OT.ANCHO_BUENO_OT;
						rMATERIAL_R.CANTIDAD_CONSUMIDA_FINAL_01 := rANE_MER_MATERIAL_OT.CANTIDAD_CONSUMIDA_FINAL_01;
						rMATERIAL_R.CANTIDAD_CONSUMIDA_FINAL_02 := rANE_MER_MATERIAL_OT.CANTIDAD_CONSUMIDA_FINAL_02;
						rMATERIAL_R.CANTIDAD_CONSUMIDA_FINAL_03 := rANE_MER_MATERIAL_OT.CANTIDAD_CONSUMIDA_FINAL_03;
						rMATERIAL_R.CANTIDAD_CONSUMIDA_FINAL_04 := rANE_MER_MATERIAL_OT.CANTIDAD_CONSUMIDA_FINAL_04;
						rMATERIAL_R.CANTIDAD_CONSUMIDA_FINAL_05 := rANE_MER_MATERIAL_OT.CANTIDAD_CONSUMIDA_FINAL_05;
						rMATERIAL_R.CANTIDAD_CONSUMIDA_FINAL_06 := rANE_MER_MATERIAL_OT.CANTIDAD_CONSUMIDA_FINAL_06;
						rMATERIAL_R.CANTIDAD_CONSUMIDA_FINAL_07 := rANE_MER_MATERIAL_OT.CANTIDAD_CONSUMIDA_FINAL_07;
						rMATERIAL_R.CANTIDAD_CONSUMIDA_FINAL_08 := rANE_MER_MATERIAL_OT.CANTIDAD_CONSUMIDA_FINAL_08;
						rMATERIAL_R.CANTIDAD_CONSUMIDA_FINAL_09 := rANE_MER_MATERIAL_OT.CANTIDAD_CONSUMIDA_FINAL_09;
						rMATERIAL_R.CANTIDAD_CONSUMIDA_FINAL_10 := rANE_MER_MATERIAL_OT.CANTIDAD_CONSUMIDA_FINAL_10;
						rMATERIAL_R.CANTIDAD_CONSUMIDA_FINAL_TOTAL := rANE_MER_MATERIAL_OT.CANTIDAD_CONSUMIDA_FINAL_TOTAL;
						rMATERIAL_R.PRECIO_ML := rANE_MER_MATERIAL_OT.PRECIO_ML;
						rMATERIAL_R.PRECIO_ML_E := rANE_MER_MATERIAL_OT.PRECIO_ML_E;
						rMATERIAL_R.FACTOR_CONVERSION_M2_KG := rANE_MER_MATERIAL_OT.FACTOR_CONVERSION_M2_KG;
					END IF;
				END IF;
			--END LOOP;
			--
			IF vTip_Arti IS NOT NULL AND vCod_Arti IS NOT NULL AND vLote IS NOT NULL AND bInserta THEN
				IF rMATERIAL_R.EMPRESA IS NULL THEN
					rMATERIAL_R.EMPRESA := vEmpresa;
					rMATERIAL_R.NUMEOTRE := nNumeOtre;
					rMATERIAL_R.CONTADOR := nContador;
					rMATERIAL_R.TIP_ARTI := vTip_Arti;
					rMATERIAL_R.COD_ARTI := vCod_Arti;
					rMATERIAL_R.LOTE := vLote;
					rMATERIAL_R.CONTMATE := nContMate;
					rMATERIAL_R.CONTMAEV := nContMaev;
					--
					IF rMATERIAL_R.Tip_Arti = vTIARREST THEN --Material de Restos
						rMATERIAL_R.ANCHO_BUENO_TOTAL_01 := 0;
						rMATERIAL_R.ANCHO_BUENO_OT_01 := 0;
						rMATERIAL_R.ANCHO_BUENO_TOTAL_02 := 0;
						rMATERIAL_R.ANCHO_BUENO_OT_02 := 0;
						rMATERIAL_R.ANCHO_BUENO_TOTAL_03 := 0;
						rMATERIAL_R.ANCHO_BUENO_OT_03 := 0;
						rMATERIAL_R.ANCHO_BUENO_TOTAL_04 := 0;
						rMATERIAL_R.ANCHO_BUENO_OT_04 := 0;
						rMATERIAL_R.ANCHO_BUENO_TOTAL_05 := 0;
						rMATERIAL_R.ANCHO_BUENO_OT_05 := 0;
						rMATERIAL_R.ANCHO_BUENO_TOTAL_06 := 0;
						rMATERIAL_R.ANCHO_BUENO_OT_06 := 0;
						rMATERIAL_R.ANCHO_BUENO_TOTAL_07 := 0;
						rMATERIAL_R.ANCHO_BUENO_OT_07 := 0;
						rMATERIAL_R.ANCHO_BUENO_TOTAL_08 := 0;
						rMATERIAL_R.ANCHO_BUENO_OT_08 := 0;
						rMATERIAL_R.ANCHO_BUENO_TOTAL_09 := 0;
						rMATERIAL_R.ANCHO_BUENO_OT_09 := 0;
						rMATERIAL_R.ANCHO_BUENO_TOTAL_10 := 0;
						rMATERIAL_R.ANCHO_BUENO_OT_10 := 0;
						rMATERIAL_R.PRE_CORTE := 'N';
						rMATERIAL_R.NUMECORT_01 := 0;
						rMATERIAL_R.NUMECORT_02 := 0;
						rMATERIAL_R.NUMECORT_03 := 0;
						rMATERIAL_R.NUMECORT_04 := 0;
						rMATERIAL_R.NUMECORT_05 := 0;
						rMATERIAL_R.NUMECORT_06 := 0;
						rMATERIAL_R.NUMECORT_07 := 0;
						rMATERIAL_R.NUMECORT_01 := 0;
						rMATERIAL_R.NUMECORT_09 := 0;
						rMATERIAL_R.NUMECORT_10 := 0;
						--Actualización de la Merma de Planificacion 
						rMATERIAL_R.MM_MERMPLAN_01 := 0;
						rMATERIAL_R.MM_MERMPLAN_02 := 0;
						rMATERIAL_R.MM_MERMPLAN_03 := 0;
						rMATERIAL_R.MM_MERMPLAN_04 := 0;
						rMATERIAL_R.MM_MERMPLAN_05 := 0;
						rMATERIAL_R.MM_MERMPLAN_06 := 0;
						rMATERIAL_R.MM_MERMPLAN_07 := 0;
						rMATERIAL_R.MM_MERMPLAN_08 := 0;
						rMATERIAL_R.MM_MERMPLAN_09 := 0;
						rMATERIAL_R.MM_MERMPLAN_10 := 0;
						--
						rMATERIAL_R.MM_MERMPLAN := 0;
						--
						rMATERIAL_R.MM_MERMPLAN_E := 0;
						--
						rMATERIAL_R.MM_MERMPLAN_EXESO_01 := 0;
						rMATERIAL_R.MM_MERMPLAN_EXESO_02 := 0;
						rMATERIAL_R.MM_MERMPLAN_EXESO_03 := 0;
						rMATERIAL_R.MM_MERMPLAN_EXESO_04 := 0;
						rMATERIAL_R.MM_MERMPLAN_EXESO_05 := 0;
						rMATERIAL_R.MM_MERMPLAN_EXESO_06 := 0;
						rMATERIAL_R.MM_MERMPLAN_EXESO_07 := 0;
						rMATERIAL_R.MM_MERMPLAN_EXESO_08 := 0;
						rMATERIAL_R.MM_MERMPLAN_EXESO_09 := 0;
						rMATERIAL_R.MM_MERMPLAN_EXESO_10 := 0;
						--
						rMATERIAL_R.MM_MERMPLAN_EXESO := 0;
						--
						rMATERIAL_R.MM_MERMPRCO_01 := 0;
						rMATERIAL_R.MM_MERMPRCO_02 := 0;
						rMATERIAL_R.MM_MERMPRCO_03 := 0;
						rMATERIAL_R.MM_MERMPRCO_04 := 0;
						rMATERIAL_R.MM_MERMPRCO_05 := 0;
						rMATERIAL_R.MM_MERMPRCO_06 := 0;
						rMATERIAL_R.MM_MERMPRCO_07 := 0;
						rMATERIAL_R.MM_MERMPRCO_08 := 0;
						rMATERIAL_R.MM_MERMPRCO_09 := 0;
						rMATERIAL_R.MM_MERMPRCO_10 := 0;
						--
						rMATERIAL_R.MM_MERMPRCO := 0;
					ELSE--1595
						--Actualización de la Merma de Planificacion 
						rMATERIAL_R.MM_MERMPLAN_01 := nMermPlan;
						rMATERIAL_R.MM_MERMPLAN_02 := nMermPlan;
						rMATERIAL_R.MM_MERMPLAN_03 := nMermPlan;
						rMATERIAL_R.MM_MERMPLAN_04 := nMermPlan;
						rMATERIAL_R.MM_MERMPLAN_05 := nMermPlan;
						rMATERIAL_R.MM_MERMPLAN_06 := nMermPlan;
						rMATERIAL_R.MM_MERMPLAN_07 := nMermPlan;
						rMATERIAL_R.MM_MERMPLAN_08 := nMermPlan;
						rMATERIAL_R.MM_MERMPLAN_09 := nMermPlan;
						rMATERIAL_R.MM_MERMPLAN_10 := nMermPlan;
						--
						rMATERIAL_R.MM_MERMPLAN := nMermPlan;
						--
						rMATERIAL_R.MM_MERMPLAN_E := nMermPlan;
						------------
						-----1------
						------------
						rANCHO_UTIL_B := F_ANCHO_UTIL(vEmpresa,nNumeOtre,nContador,1);--1614
						--
						rMATERIAL_R.ANCHO_BUENO_TOTAL_01 := rANCHO_UTIL_B.ANCHO_UTILIZADO_OT;
						rMATERIAL_R.ANCHO_BUENO_OT_01 := rANCHO_UTIL_B.ANCHO_USADO_Y_EXPEDIDO_OT;
						--Merma definida en el Corte si Existe
						--rMATERIAL_R.MM_MERMA_DEFINIDA_CORTADORA := rANCHO_UTIL_B.MM_MERMA_DEFINIDA_CORTADORA;
						--Si es un Pre_Corte
						rMATERIAL_R.PRE_CORTE := NVL(rANCHO_UTIL_B.PRE_CORTE,'N');
						--Numero de Cortes de Fase Propia
						--rMATERIAL_R.NUMECORT := NVL(rANCHO_UTIL_B.NUMECORT,1);
						--Numero de Cortes de Fase Siguiente Multiple
						rMATERIAL_R.NUMECORT_01 := NVL(rANCHO_UTIL_B.NUMECORT,1);
						rMATERIAL_R.CONTFSMU_01 := rANCHO_UTIL_B.CONTFSMU;
						rMATERIAL_R.CANTFSMU_01 := rANCHO_UTIL_B.CANTFSMU;
						rMATERIAL_R.CATOFSMU := rANCHO_UTIL_B.CATOFSMU;
						----------------
						-----FIN 1------
						----------------
						rANCHO_UTIL_B := F_ANCHO_UTIL(vEmpresa,nNumeOtre,nContador,2);
						--
						rMATERIAL_R.ANCHO_BUENO_TOTAL_02 := rANCHO_UTIL_B.ANCHO_UTILIZADO_OT;
						rMATERIAL_R.ANCHO_BUENO_OT_02 := rANCHO_UTIL_B.ANCHO_USADO_Y_EXPEDIDO_OT;
						--Numero de Cortes de Fase Siguiente Multiple
						IF NVL(rANCHO_UTIL_B.CONTFSMU,0) != 0 THEN
							rMATERIAL_R.NUMECORT_02 := NVL(rANCHO_UTIL_B.NUMECORT,1);
						ELSE
							rMATERIAL_R.NUMECORT_02 := 0;
						END IF;
						--rMATERIAL_R.NUMECORT_02 := NVL(rANCHO_UTIL_B.NUMECORT,1);
						rMATERIAL_R.CONTFSMU_02 := rANCHO_UTIL_B.CONTFSMU;
						rMATERIAL_R.CANTFSMU_02 := rANCHO_UTIL_B.CANTFSMU;
						--
						rANCHO_UTIL_B := F_ANCHO_UTIL(vEmpresa,nNumeOtre,nContador,3);
						--
						rMATERIAL_R.ANCHO_BUENO_TOTAL_03 := rANCHO_UTIL_B.ANCHO_UTILIZADO_OT;
						rMATERIAL_R.ANCHO_BUENO_OT_03 := rANCHO_UTIL_B.ANCHO_USADO_Y_EXPEDIDO_OT;
						--Numero de Cortes de Fase Siguiente Multiple
						IF NVL(rANCHO_UTIL_B.CONTFSMU,0) != 0 THEN
							rMATERIAL_R.NUMECORT_03 := NVL(rANCHO_UTIL_B.NUMECORT,1);
						ELSE
							rMATERIAL_R.NUMECORT_03 := 0;
						END IF;
						--rMATERIAL_R.NUMECORT_03 := NVL(rANCHO_UTIL_B.NUMECORT,1);
						rMATERIAL_R.CONTFSMU_03 := rANCHO_UTIL_B.CONTFSMU;
						rMATERIAL_R.CANTFSMU_03 := rANCHO_UTIL_B.CANTFSMU;
						--
						rANCHO_UTIL_B := F_ANCHO_UTIL(vEmpresa,nNumeOtre,nContador,4);
						--
						rMATERIAL_R.ANCHO_BUENO_TOTAL_04 := rANCHO_UTIL_B.ANCHO_UTILIZADO_OT;
						rMATERIAL_R.ANCHO_BUENO_OT_04 := rANCHO_UTIL_B.ANCHO_USADO_Y_EXPEDIDO_OT;
						--Numero de Cortes de Fase Siguiente Multiple
						IF NVL(rANCHO_UTIL_B.CONTFSMU,0) != 0 THEN
							rMATERIAL_R.NUMECORT_04 := NVL(rANCHO_UTIL_B.NUMECORT,1);
						ELSE
							rMATERIAL_R.NUMECORT_04 := 0;
						END IF;
						--rMATERIAL_R.NUMECORT_04 := NVL(rANCHO_UTIL_B.NUMECORT,1);
						rMATERIAL_R.CONTFSMU_04 := rANCHO_UTIL_B.CONTFSMU;
						rMATERIAL_R.CANTFSMU_04 := rANCHO_UTIL_B.CANTFSMU;
						--
						rANCHO_UTIL_B := F_ANCHO_UTIL(vEmpresa,nNumeOtre,nContador,5);
						--
						rMATERIAL_R.ANCHO_BUENO_TOTAL_05 := rANCHO_UTIL_B.ANCHO_UTILIZADO_OT;
						rMATERIAL_R.ANCHO_BUENO_OT_05 := rANCHO_UTIL_B.ANCHO_USADO_Y_EXPEDIDO_OT;
						--Numero de Cortes de Fase Siguiente Multiple
						IF NVL(rANCHO_UTIL_B.CONTFSMU,0) != 0 THEN
							rMATERIAL_R.NUMECORT_05 := NVL(rANCHO_UTIL_B.NUMECORT,1);
						ELSE
							rMATERIAL_R.NUMECORT_05 := 0;
						END IF;
						--rMATERIAL_R.NUMECORT_05 := NVL(rANCHO_UTIL_B.NUMECORT,1);
						rMATERIAL_R.CONTFSMU_05 := rANCHO_UTIL_B.CONTFSMU;
						rMATERIAL_R.CANTFSMU_05 := rANCHO_UTIL_B.CANTFSMU;
						--
						rANCHO_UTIL_B := F_ANCHO_UTIL(vEmpresa,nNumeOtre,nContador,6);
						--
						rMATERIAL_R.ANCHO_BUENO_TOTAL_06 := rANCHO_UTIL_B.ANCHO_UTILIZADO_OT;
						rMATERIAL_R.ANCHO_BUENO_OT_06 := rANCHO_UTIL_B.ANCHO_USADO_Y_EXPEDIDO_OT;
						--Numero de Cortes de Fase Siguiente Multiple
						IF NVL(rANCHO_UTIL_B.CONTFSMU,0) != 0 THEN
							rMATERIAL_R.NUMECORT_06 := NVL(rANCHO_UTIL_B.NUMECORT,1);
						ELSE
							rMATERIAL_R.NUMECORT_06 := 0;
						END IF;
						--rMATERIAL_R.NUMECORT_06 := NVL(rANCHO_UTIL_B.NUMECORT,1);
						rMATERIAL_R.CONTFSMU_06 := rANCHO_UTIL_B.CONTFSMU;
						rMATERIAL_R.CANTFSMU_06 := rANCHO_UTIL_B.CANTFSMU;
						--
						rANCHO_UTIL_B := F_ANCHO_UTIL(vEmpresa,nNumeOtre,nContador,7);
						--
						rMATERIAL_R.ANCHO_BUENO_TOTAL_07 := rANCHO_UTIL_B.ANCHO_UTILIZADO_OT;
						rMATERIAL_R.ANCHO_BUENO_OT_07 := rANCHO_UTIL_B.ANCHO_USADO_Y_EXPEDIDO_OT;
						--Numero de Cortes de Fase Siguiente Multiple
						IF NVL(rANCHO_UTIL_B.CONTFSMU,0) != 0 THEN
							rMATERIAL_R.NUMECORT_07 := NVL(rANCHO_UTIL_B.NUMECORT,1);
						ELSE
							rMATERIAL_R.NUMECORT_07 := 0;
						END IF;
						--rMATERIAL_R.NUMECORT_07 := NVL(rANCHO_UTIL_B.NUMECORT,1);
						rMATERIAL_R.CONTFSMU_07 := rANCHO_UTIL_B.CONTFSMU;
						rMATERIAL_R.CANTFSMU_07 := rANCHO_UTIL_B.CANTFSMU;
						--
						rANCHO_UTIL_B := F_ANCHO_UTIL(vEmpresa,nNumeOtre,nContador,8);
						--
						rMATERIAL_R.ANCHO_BUENO_TOTAL_08 := rANCHO_UTIL_B.ANCHO_UTILIZADO_OT;
						rMATERIAL_R.ANCHO_BUENO_OT_08 := rANCHO_UTIL_B.ANCHO_USADO_Y_EXPEDIDO_OT;
						--Numero de Cortes de Fase Siguiente Multiple
						IF NVL(rANCHO_UTIL_B.CONTFSMU,0) != 0 THEN
							rMATERIAL_R.NUMECORT_08 := NVL(rANCHO_UTIL_B.NUMECORT,1);
						ELSE
							rMATERIAL_R.NUMECORT_08 := 0;
						END IF;
						--rMATERIAL_R.NUMECORT_08 := NVL(rANCHO_UTIL_B.NUMECORT,1);
						rMATERIAL_R.CONTFSMU_08 := rANCHO_UTIL_B.CONTFSMU;
						rMATERIAL_R.CANTFSMU_08 := rANCHO_UTIL_B.CANTFSMU;
						--
						rANCHO_UTIL_B := F_ANCHO_UTIL(vEmpresa,nNumeOtre,nContador,9);
						--
						rMATERIAL_R.ANCHO_BUENO_TOTAL_09 := rANCHO_UTIL_B.ANCHO_UTILIZADO_OT;
						rMATERIAL_R.ANCHO_BUENO_OT_09 := rANCHO_UTIL_B.ANCHO_USADO_Y_EXPEDIDO_OT;
						--Numero de Cortes de Fase Siguiente Multiple
						IF NVL(rANCHO_UTIL_B.CONTFSMU,0) != 0 THEN
							rMATERIAL_R.NUMECORT_09 := NVL(rANCHO_UTIL_B.NUMECORT,1);
						ELSE
							rMATERIAL_R.NUMECORT_09 := 0;
						END IF;
						--rMATERIAL_R.NUMECORT_09 := NVL(rANCHO_UTIL_B.NUMECORT,1);
						rMATERIAL_R.CONTFSMU_09 := rANCHO_UTIL_B.CONTFSMU;
						rMATERIAL_R.CANTFSMU_09 := rANCHO_UTIL_B.CANTFSMU;
						--
						rANCHO_UTIL_B := F_ANCHO_UTIL(vEmpresa,nNumeOtre,nContador,10);
						--
						rMATERIAL_R.ANCHO_BUENO_TOTAL_10 := rANCHO_UTIL_B.ANCHO_UTILIZADO_OT;
						rMATERIAL_R.ANCHO_BUENO_OT_10 := rANCHO_UTIL_B.ANCHO_USADO_Y_EXPEDIDO_OT;
						--Numero de Cortes de Fase Siguiente Multiple
						IF NVL(rANCHO_UTIL_B.CONTFSMU,0) != 0 THEN
							rMATERIAL_R.NUMECORT_10 := NVL(rANCHO_UTIL_B.NUMECORT,1);
						ELSE
							rMATERIAL_R.NUMECORT_10 := 0;
						END IF;
						--rMATERIAL_R.NUMECORT_10 := NVL(rANCHO_UTIL_B.NUMECORT,1);
						rMATERIAL_R.CONTFSMU_10 := rANCHO_UTIL_B.CONTFSMU;
						rMATERIAL_R.CANTFSMU_10 := rANCHO_UTIL_B.CANTFSMU;
					END IF;
					--
					--rMATERIAL_R.IDENTIFICADOR := T_MATERIAL.COUNT + 1;
					--
					--T_MATERIAL(rMATERIAL_R.IDENTIFICADOR) := rMATERIAL_R;
               OPEN cANE_MER_MATERIAL_OT_MAX;
               FETCH cANE_MER_MATERIAL_OT_MAX INTO nIdentificador;
               CLOSE cANE_MER_MATERIAL_OT_MAX;
               --
               rMATERIAL_R.Identificador := NVL(nIdentificador,0) + 1;
					--Se inserta
					P_MATERIAL(rMATERIAL_R,'I',
					           NULL,
								  NULL,
								  NULL,
								  NULL,
								  NULL,
								  NULL,
								  NULL,
								  NULL,
								  NULL,
								  NULL,
								  NULL,
								  NULL,
								  NULL,
								  NULL,
								  NULL,
								  NULL,
								  NULL,
								  NULL,
								  NULL,
                           --
                           NULL, --nCONTFSMU_01 
                           NULL, --nCANTFSMU_01 
                           NULL, --nCATOFSMU 
                           NULL, --nCONTFSMU_02 
                           NULL, --nCANTFSMU_02 
                           NULL, --nCONTFSMU_03 
                           NULL, --nCANTFSMU_03 
                           NULL, --nCONTFSMU_04 
                           NULL, --nCANTFSMU_04 
                           NULL, --nCONTFSMU_05 
                           NULL, --nCANTFSMU_05 
                           NULL, --nCONTFSMU_06 
                           NULL, --nCANTFSMU_06 
                           NULL, --nCONTFSMU_07 
                           NULL, --nCANTFSMU_07 
                           NULL, --nCONTFSMU_08 
                           NULL, --nCANTFSMU_08 
                           NULL, --nCONTFSMU_09 
                           NULL, --nCANTFSMU_09 
                           NULL, --nCONTFSMU_10 
                           NULL, --nCANTFSMU_10 
                           NULL, --nANCHO_BUENO_TOTAL_01 
                           NULL, --nANCHO_BUENO_OT_01 
                           NULL, --nANCHO_BUENO_TOTAL_02 
                           NULL, --nANCHO_BUENO_OT_02 
                           NULL, --nANCHO_BUENO_TOTAL_03 
                           NULL, --nANCHO_BUENO_OT_03 
                           NULL, --nANCHO_BUENO_TOTAL_04 
                           NULL, --nANCHO_BUENO_OT_04 
                           NULL, --nANCHO_BUENO_TOTAL_05 
                           NULL, --nANCHO_BUENO_OT_05 
                           NULL, --nANCHO_BUENO_TOTAL_06 
                           NULL, --nANCHO_BUENO_OT_06 
                           NULL, --nANCHO_BUENO_TOTAL_07 
                           NULL, --nANCHO_BUENO_OT_07 
                           NULL, --nANCHO_BUENO_TOTAL_08 
                           NULL, --nANCHO_BUENO_OT_08 
                           NULL, --nANCHO_BUENO_TOTAL_09 
                           NULL, --nANCHO_BUENO_OT_09 
                           NULL, --nANCHO_BUENO_TOTAL_10 
                           NULL, --nANCHO_BUENO_OT_10 
                           NULL, --nANCHO_BUENO_TOTAL 
                           NULL, --nANCHO_BUENO_OT 
                           NULL, --nNUMECORT 
                           NULL, --nMM_MERMPRCO_01 
                           NULL, --nMM_MERMPLAN_EXESO_01 
                           NULL, --nMM_MERMPLAN_01 
                           NULL, --nMM_MERMPRCO_02 
                           NULL, --nMM_MERMPLAN_EXESO_02 
                           NULL, --nMM_MERMPLAN_02 
                           NULL, --nMM_MERMPRCO_03 
                           NULL, --nMM_MERMPLAN_EXESO_03 
                           NULL, --nMM_MERMPLAN_03 
                           NULL, --nMM_MERMPRCO_04 
                           NULL, --nMM_MERMPLAN_EXESO_04 
                           NULL, --nMM_MERMPLAN_04 
                           NULL, --nMM_MERMPRCO_05 
                           NULL, --nMM_MERMPLAN_EXESO_05 
                           NULL, --nMM_MERMPLAN_05 
                           NULL, --nMM_MERMPRCO_06 
                           NULL, --nMM_MERMPLAN_EXESO_06 
                           NULL, --nMM_MERMPLAN_06 
                           NULL, --nMM_MERMPRCO_07 
                           NULL, --nMM_MERMPLAN_EXESO_07 
                           NULL, --nMM_MERMPLAN_07 
                           NULL, --nMM_MERMPRCO_08 
                           NULL, --nMM_MERMPLAN_EXESO_08 
                           NULL, --nMM_MERMPLAN_08 
                           NULL, --nMM_MERMPRCO_09 
                           NULL, --nMM_MERMPLAN_EXESO_09 
                           NULL, --nMM_MERMPLAN_09 
                           NULL, --nMM_MERMPRCO_10 
                           NULL, --nMM_MERMPLAN_EXESO_10 
                           NULL, --nMM_MERMPLAN_10 
                           NULL, --nMM_MERMPRCO 
                           NULL, --nMM_MERMPLAN_EXESO 
                           NULL); --nMM_MERMPLAN 
				END IF;
			END IF;		
			--
			RETURN rMATERIAL_R;
		END;--F_MATERIAL
--
		FUNCTION F_PRECIO(vEmpresa PRD_BOBIMAQU.EMPRESA%TYPE, nNumeOtre PRD_BOBIMAQU.NUMEOTRE%TYPE, 
								vTip_Arti PRD_BOBIMAQU.TIP_ARTI%TYPE, vCod_Arti PRD_BOBIMAQU.COD_ARTI%TYPE, vLote VARCHAR2,
								vCod_LFS_P ARTICULO.COD_LFS%TYPE, nAncho_P ARTICULO.ANCHO%TYPE, vUnidStoc_P ARTICULO.UNIDSTOC%TYPE, nFCKG_P LFS.FCKG%TYPE)
		RETURN VARCHAR2 IS
			--Busqueda de Precio Real contra calculo de Precios de Semielaborados realizados en Pharma
			CURSOR cFIC_ENMAMATE(vEmpresa FIC_ENMAMATE.EMPRESA%TYPE, vTip_Arti FIC_ENMAMATE.TIP_ARTI%TYPE,vCod_Arti FIC_ENMAMATE.COD_ARTI%TYPE,vLote FIC_ENMAMATE.LOTE%TYPE) IS 
				SELECT UNIDAD, PRECIO, UNIDCALC, PRECCALC, ERROR FROM FIC_ENMAMATE
					WHERE EMPRESA = vEmpresa
					  AND TIP_ARTI = vTip_Arti
					  AND COD_ARTI = vCod_Arti
					  AND LOTE = vLote
				ORDER BY FECHCALC DESC;
			--
			rFIC_ENMAMATE cFIC_ENMAMATE%ROWTYPE;
			--
			CURSOR cCompras(vEmpresa FIC_CABEOTRE.EMPRESA%TYPE, vTip_Arti ARTICULO.TIP_ARTI%TYPE,vCod_Arti ARTICULO.COD_ARTI%TYPE,vLote FV_ASCOAL02.ASLOTE%TYPE) IS
				SELECT ALUNST, DECODE(C.ALUPRE,0,DECODE(C.ALCANT, 0, 0,((C.ALPREU * D.CAMBIO) * C.ALCAEQ) / C.ALCANT),
															DECODE(C.ALCANT, 0, 0,(((C.ALPREU * D.CAMBIO) * C.ALCAEQ) / C.ALCANT) / C.ALUPRE) 
											) ALPREU  
				FROM FV_ASCOAL02 C, GNR_DICOTIZA D, FV_ASCOAL01 CA
					WHERE CA.EMCODI = C.EMCODI
					  AND CA.DICODI = C.DICODI
					  AND CA.ACANYA = C.ACANYA
					  AND CA.ACNROA = C.ACNROA
					  AND CA.TIPDOC IS NULL
					  AND C.DIVISA = D.DIVISA
					  AND D.DIVISAMA = P_Utilidad.F_ValoDeva ('DIVIEURO')
					  AND TRUNC(C.ACFENT) BETWEEN TRUNC(DESDFECH) AND TRUNC(HASTFECH)
					  AND (C.VATCOD != vP_TIARMPF4 OR (C.VATCOD = vP_TIARMPF4 AND C.VNACOD IN ('1','43','16','46')))
					  AND C.EMCODI = vEmpresa
					  AND C.VATCOD = vTip_Arti
					  AND C.ARCARF = vCod_Arti
					  AND C.ASLOTE = vLote;
			--
			rCompras cCompras%ROWTYPE;
			--
			nPrecComp FV_ASCOAL02.ALPREU%TYPE;
			--
			vCod_LFS ARTICULO.COD_LFS%TYPE; 
			nAncho ARTICULO.ANCHO%TYPE;
			nFCKG LFS.FCKG%TYPE;
			vUnidStoc ARTICULO.UNIDSTOC%TYPE;
			vUnidStMP ARTICULO.UNIDSTOC%TYPE;
			--Materiales que intervienen en la Fabricación de la Bobina
			CURSOR cMateBobi(nContMate PRD_MAPAMAQU.CONTMATE%TYPE) IS
				SELECT M.EMPRESA, M.NUMEOTRE, M.CONTADOR, M.EMPRBOBI, M.NUOTBOBI, M.CONTBOBI, DECODE(SIGN(M.COBOBOBI), -1, -1,M.COBOBOBI) COBOBOBI, M.TIP_ARTI, M.COD_ARTI, M.LOTE, SUM(M.CANTCONS) CANTCONS, --Se realiza lo del DECODE para no tener que buscar el precio de la MP por cada pasada del mismo tirpo de material M o S ya que cada que se utiliza se asigna un consecutivo negativo
				       M.COBOBOBI BOBIMATE -- 11-11-2016 Solo para materiales tipo M
				FROM PRD_MAPAMAQU M
				WHERE M.EMPRESA = P_Utilidad.f_ValoCampo(vLote,'EMPRBOBI')
				  AND M.NUMEOTRE = P_Utilidad.f_ValoCampo(vLote,'NUOTBOBI')
				  AND M.CONTADOR = P_Utilidad.f_ValoCampo(vLote,'CONTBOBI')
				  AND (
						 (vTip_Arti != vTiarCosc AND M.COBOGENE = P_Utilidad.f_ValoCampo(vLote,'COBOBOBI')) OR
						 (vTip_Arti = vTiarCosc AND EXISTS (SELECT 'X' FROM PRD_COMPBOBI C
																		 WHERE C.EMPRESA = M.EMPRESA
																			AND C.NUMEOTRE = M.NUMEOTRE
																			AND C.CONTADOR = M.CONTADOR
																			AND C.CONTBOBI = P_Utilidad.f_ValoCampo(vLote,'COBOBOBI')
																			AND C.EMPRCOMP = M.EMPRESA
																			AND C.NUOTCOMP = M.NUMEOTRE
																			AND C.CONTCOMP = M.CONTADOR
																			AND C.COBOCOMP = M.COBOGENE
																		)
						 )
						)
				  AND M.MARCPASA = 'N'
				  AND M.CONTMATE = nContMate
				GROUP BY M.EMPRESA, M.NUMEOTRE, M.CONTADOR, M.EMPRBOBI, M.NUOTBOBI, M.CONTBOBI, DECODE(SIGN(M.COBOBOBI), -1, -1,M.COBOBOBI), M.TIP_ARTI, M.COD_ARTI, M.LOTE, M.COBOBOBI;
			--
			bExisMaBo BOOLEAN := FALSE;
			--
			nCantTota NUMBER := 0;
			nPrecTota NUMBER := 0;
			--
			nPrecio NUMBER;
			--
			nCantTota_L2 NUMBER := 0;
			nPrecTota_L2 NUMBER := 0;
			--
			nPrecio_L2 NUMBER;
			--
			nPrecio_Mat NUMBER;
			--
			rMATERIAL ST_MATERIAL;--Registro de Busqueda
			rBOBIMAQU_U ST_BOBIMAQU;--Registro de Utilizacion
			--Calcula el Precio segun Algoritmo de Precios
			FUNCTION F_CalcPrec(vEmpresa PRD_BOBIMAQU.EMPRESA%TYPE, vTip_Arti PRD_BOBIMAQU.TIP_ARTI%TYPE, vCod_Arti PRD_BOBIMAQU.COD_ARTI%TYPE, 
									  vCod_LFS_P ARTICULO.COD_LFS%TYPE, nAncho_P ARTICULO.ANCHO%TYPE, vUnidStoc_P ARTICULO.UNIDSTOC%TYPE, nFCKG_P LFS.FCKG%TYPE)
			RETURN VARCHAR2 IS
				nPrecReFS NUMBER := 0;--Acumula el Precio Real de la Fase Secuencia
				--
				PROCEDURE P_RECURSIVO_MATERIALES(vTip_Arti FIC_LINEEOTT.TIP_ARES%TYPE, vCod_Arti FIC_LINEEOTT.COD_ARES%TYPE) IS
					CURSOR cEstructura_Niv IS --Niveles
					  SELECT LE.TIP_ARES, LE.COD_ARES, LE.FASE
					  FROM FIC_LINEESTR LE, FIC_CABEESTR CE
						  WHERE LE.EMPRESA = CE.EMPRESA
							 AND LE.TIP_ARTI = CE.TIP_ARTI
							 AND LE.COD_ARTI = CE.COD_ARTI
							 AND LE.NUMEESTR = CE.NUMEESTR
							 AND LE.EMPRESA = vEmpresa
							 AND LE.TIP_ARTI = vTip_Arti
							 AND LE.COD_ARTI = vCod_Arti
							 AND LE.CLASTIAR IN ('M', 'X')
							 AND CE.ESTRDEFI = 'S'
						UNION
						SELECT LE.TIP_ARES, LE.COD_ARES, LE.FASE
						FROM FIC_LINEESSE LE, FIC_CABEESSE CE
						  WHERE LE.EMPRESA = CE.EMPRESA
							 AND LE.TIP_ARTI = CE.TIP_ARTI
							 AND LE.COD_ARTI = CE.COD_ARTI
							 AND LE.NUMEESTR = CE.NUMEESTR
							 AND LE.EMPRESA = vEmpresa
							 AND LE.TIP_ARTI = vTip_Arti
							 AND LE.COD_ARTI = vCod_Arti
							 AND LE.CLASTIAR IN ('M', 'X')
							 AND CE.ESTRDEFI = 'S'
						UNION
						SELECT LE.TIP_ARES, LE.COD_ARES, LE.FASE
						FROM FIC_HPILIEST LE, FIC_HPICAEST CE
						  WHERE LE.EMPRESA = CE.EMPRESA
							 AND LE.NUMEPEDI = CE.NUMEPEDI
							 AND LE.NUMEESTR = CE.NUMEESTR
							 AND LE.EMPRESA = vEmpresa
							 AND LE.NUMEPEDI = nNumePedi
							 AND vTip_Arti = vP_TIARPROI
							 AND LE.CLASTIAR IN ('M', 'X')
							 AND CE.ESTRDEFI = 'S'
						ORDER BY FASE;
					--
					bExisMate BOOLEAN := FALSE;
				BEGIN
--dbms_output.put_line('E1');            
					FOR rEstructura_Niv IN cEstructura_Niv LOOP
--dbms_output.put_line('E2');            
						IF NOT(bExisMate) THEN
							bExisMate := TRUE;
						END IF;
						--Busqueda del Precio de la MP de la Estructura
						IF rEstructura_Niv.Tip_Ares = vTiarMpF4 THEN
							IF NVL(nPrecMere,0) = 0 THEN
								vPrecio := ANALESTA.P_ANE_MERMLAMI_PRAG.F_PRECIO(vEmpresa, rEstructura_Niv.Tip_Ares, rEstructura_Niv.Cod_Ares, dFecha_Cierre);
								nPrecMere := P_UTILIDAD.F_VALOCAMPO(vPrecio,'PRECIO');
								--
								IF vLogPreci IS NULL THEN
									vLogPreci := SUBSTR(P_UTILIDAD.F_VALOCAMPO(vPrecio,'TRAZA'),1,2000); 
--dbms_output.put_line('vLogPreci 1:'||vLogPreci);
								ELSIF LENGTH(vLogPreci) <= 2000 THEN
									vLogPreci := vLogPreci||SUBSTR(CHR(10)||P_UTILIDAD.F_VALOCAMPO(vPrecio,'TRAZA'),1,2000-LENGTH(vLogPreci)); 
--dbms_output.put_line('vLogPreci 2:'||vLogPreci);
								END IF;
							END IF;
							--
							IF NVL(nPrecMere,0) = 0 AND vMaprPrCl = 'N' THEN
								P_ERRORES(vEmpresa, nNumeOtre, '602',rEstructura_Niv.Tip_Ares||'-'||rEstructura_Niv.Cod_Ares||'|no existen movimientos de entrada para este material valoradas a un precio|5.2','R','E');
							END IF;
							--Acumula el Precio Real de la Fase Secuencia
							nPrecReFS := nPrecReFS + NVL(nPrecMere,0);
						ELSE
							P_RECURSIVO_MATERIALES(rEstructura_Niv.Tip_Ares, rEstructura_Niv.Cod_Ares);
						END IF;
					END LOOP;
--dbms_output.put_line('E3');
					--
					IF NOT(bExisMate) THEN
						--P_ERRORES(vEmpresa, nNumeOtre, '7.2- No existe la estructura para la MP: '||vTip_Arti||'-'||vCod_Arti);
						--No existe la estructura para la MP: @1-@2. [Contador @3]	
						--No se han definido estructuras para esta MP en planificación	
						--Notificar a planificación para que cree estas estructuras y volver a calcular el Objetivo de Coste para la OT
						P_ERRORES(vEmpresa, nNumeOtre, '603',vTip_Arti||'|'||vCod_Arti||'|1','R','E');
					END IF;
				END;--P_RECURSIVO_MATERIALES
			BEGIN
				IF vCod_LFS_P IS NULL THEN
					rArticulo.ANCHO := NULL;
					rArticulo.COD_LFS := NULL;
					rArticulo.UNIDSTOC := NULL;
					rArticulo.FCKG := NULL;
					--
					OPEN cArticulo(vEmpresa, vTip_Arti, vCod_Arti, vLote);
					FETCH cArticulo INTO rArticulo;
					CLOSE cArticulo;
					--
					vCod_LFS := rArticulo.COD_LFS; 
					nAncho := rArticulo.ANCHO;
					vUnidStoc := rArticulo.UNIDSTOC;
					nFCKG := rArticulo.FCKG;
				ELSE
					vCod_LFS := vCod_LFS_P; 
					nAncho := nAncho_P;
					vUnidStoc := vUnidStoc_P;
					nFCKG := nFCKG_P;
				END IF;
				--Calculo de Factor en ML
				nFactorML := 0;
				--
				BEGIN
					--Calculo del Factor de Conversion desde la Unidad de Stock
					nFactorML := P_Articulo.F_Factor (vEmpresa,vCod_LFS,
																 nAncho, NULL,
																 vUnidStoc, vP_TIPOUNML);
				EXCEPTION 
					WHEN OTHERS THEN
						nFactorML := 0;
						--Posiblemente falte algun dato como LFS, Ancho, Largo, ó alguna unidad para el calculo
						--Verificar el dato que falta, si es LFS, Ancho ó largo se tendrá que verificar la Ficha Tecnica asociada, si es una unidad ver por que no se envia este parametro
						--605 No se puede calcular FC de: @1-@2. [Contador @3]
						P_ERRORES(vEmpresa, nNumeOtre, '605','Material: '||vTip_Arti||'-'||vCod_Arti||' Unidades: '||vUnidStoc||'|'||vP_TIPOUNML||'|1','R','E');
						--dbms_output.put_line('Error: 605 '||vTip_Arti||'-'||vCod_Arti);
				END;
				--Si no es correcto el Factor no tiene sentido calcular precios
				IF NVL(nFactorML,0) != 0 THEN
					--Precios Reales de Materias Primas
					nPrecMere := NULL;
					nCantPrme := 0;
					nPrecPrme := 0;
					--Parte Nueva de Precios Reales
					rFIC_ENMAMATE.UNIDAD := NULL;
					rFIC_ENMAMATE.PRECIO := NULL;
					--
					OPEN cFIC_ENMAMATE(vEmpresa, vTip_Arti, vCod_Arti, vLote);
					FETCH cFIC_ENMAMATE INTO rFIC_ENMAMATE;
					CLOSE cFIC_ENMAMATE;
					--
					IF rFIC_ENMAMATE.UNIDAD IS NOT NULL THEN
						IF rFIC_ENMAMATE.UNIDAD != vUnidStoc THEN
							IF vMaprPrCl = 'N' THEN
								--602 No se puede establecer el precio para la MP: @1-@2. [Contador @3]
								P_ERRORES(vEmpresa, nNumeOtre, '602',vTip_Arti||'-'||vCod_Arti||' en precio de Semielaborado, Unidad de Precio Calculado de Semielaborado en Unidad de Stock diferente a la del Articulo |'||rFIC_ENMAMATE.UNIDAD||' != '||vUnidStoc||'|2','R','E');
								--dbms_output.put_line('Error 602: '||vTip_Arti||'-'||vCod_Arti||' en precio de Semielaborado, Unidad de Precio Calculado de Semielaborado en Unidad de Stock diferente a la del Articulo '||rFIC_ENMAMATE.UNIDAD||' != '||vUnidStoc);
							END IF;
						ELSE
							nPrecPrme := rFIC_ENMAMATE.PRECIO;
							--
							IF rFIC_ENMAMATE.ERROR = 'E' THEN
								--602 No se puede establecer el precio para la MP: @1-@2. [Contador @3]
								P_ERRORES(vEmpresa, nNumeOtre, '602',vEmpresa||'-'||vTip_Arti||'-'||vCod_Arti||'-'||vLote||' en precio de Semielaborado, |Calculo de Precio por OT Interna con Errores|2.1','R','A');
							ELSIF rFIC_ENMAMATE.ERROR = 'I' THEN
								--602 No se puede establecer el precio para la MP: @1-@2. [Contador @3]
								P_ERRORES(vEmpresa, nNumeOtre, '602',vEmpresa||'-'||vTip_Arti||'-'||vCod_Arti||'-'||vLote||' en precio de Semielaborado, |Calculo de Precio por OT Interna con Unidad no Estandar|2.2','R','A');
							ELSIF rFIC_ENMAMATE.ERROR = 'X' THEN
								--602 No se puede establecer el precio para la MP: @1-@2. [Contador @3]
								P_ERRORES(vEmpresa, nNumeOtre, '602',vEmpresa||'-'||vTip_Arti||'-'||vCod_Arti||'-'||vLote||' en precio de Semielaborado, |Calculo de Precio por OT Interna con Errores|2.3','R','A');
							END IF;
							--
							IF rFIC_ENMAMATE.PRECCALC IS NOT NULL AND rFIC_ENMAMATE.PRECIO != rFIC_ENMAMATE.PRECCALC THEN
								--219 @1 Diferente(s)
								P_ERRORES(vEmpresa, nNumeOtre, '219','(Contador: 2.4) Se ha detectado que el en el momento de dar de alta el lote de MP de Semielaborado '||vEmpresa||'-'||vTip_Arti||'-'||vCod_Arti||'-'||vLote||' el precio asignado al lote es '||rFIC_ENMAMATE.PRECIO||' '||rFIC_ENMAMATE.UNIDAD||' y el precio calculado fue '||rFIC_ENMAMATE.PRECCALC||' '||rFIC_ENMAMATE.UNIDCALC||'. Precios','R','A');
							END IF;
--dbms_output.put_line('Precio 1');                  
						END IF;
					END IF;
               --
               IF vLogPreci IS NULL THEN
                  vLogPreci := 'Se verifica el precio directamente contra el Lote de Compra: '||vLote; 
--dbms_output.put_line('vLogPreci 3.0:'||vLogPreci);
               ELSIF LENGTH(vLogPreci) <= 2000 THEN
                  vLogPreci := vLogPreci||SUBSTR(CHR(10)||'Se verifica el precio directamente contra el Lote de Compra: '||vLote,1,2000-LENGTH(vLogPreci));  
--dbms_output.put_line('vLogPreci 4.0:'||vLogPreci);
               END IF;
					--Se busca si existe la compra del Lote especifico de Fichajes
					rCompras.ALUNST := NULL;
					rCompras.ALPREU := NULL;
					--
					OPEN cCompras(vEmpresa, vTip_Arti, vCod_Arti, vLote);
					FETCH cCompras INTO rCompras;
					CLOSE cCompras;
					--
					IF rCompras.ALUNST IS NOT NULL THEN
                  IF vLogPreci IS NULL THEN
                     vLogPreci := 'Compra Encontrada para el Lote: '||vLote; 
--dbms_output.put_line('vLogPreci 3.1:'||vLogPreci);
                  ELSIF LENGTH(vLogPreci) <= 2000 THEN
                     vLogPreci := vLogPreci||SUBSTR(CHR(10)||'Compra Encontrada para el Lote: '||vLote,1,2000-LENGTH(vLogPreci));   
--dbms_output.put_line('vLogPreci 4.1:'||vLogPreci);
                  END IF;
                  --
						IF rCompras.ALUNST != vUnidStoc THEN
							IF vLogPreci IS NULL THEN
                        vLogPreci := 'Unidad de Stock para el Lote diferente: '||vLote||': '||rCompras.ALUNST||' != '||vUnidStoc; 
--dbms_output.put_line('vLogPreci 3.2:'||vLogPreci);
                     ELSIF LENGTH(vLogPreci) <= 2000 THEN
                        vLogPreci := vLogPreci||SUBSTR(CHR(10)||'Unidad de Stock para el Lote diferente: '||vLote||': '||rCompras.ALUNST||' != '||vUnidStoc,1,2000-LENGTH(vLogPreci)); 
--dbms_output.put_line('vLogPreci 4.2:'||vLogPreci);
                     END IF;
                     --
                     IF vMaprPrCl = 'N' THEN
								--602 No se puede establecer el precio para la MP: @1-@2. [Contador @3]
								P_ERRORES(vEmpresa, nNumeOtre, '602',vTip_Arti||'-'||vCod_Arti||' Unidad de Precio en Existencias del periodo en Unidad de Stock diferente a la del Articulo |'||rCompras.ALUNST||' != '||vUnidStoc||'|3.1.2','R','E');
								--dbms_output.put_line('Error 602: '||vTip_Arti||'-'||vCod_Arti||' Unidad de Precio en Existencias del periodo en Unidad de Stock diferente a la del Articulo '||rCompras.ALUNST||' != '||vUnidStoc);
							END IF;
						ELSE
--dbms_output.put_line('Precio 2.1');
							nPrecMere := rCompras.ALPREU;
						END IF;
					END IF;
					--Fin de la Parte Nueva de Precios Reales
					--Si no encuentra precio continua mediante metodo antiguo
					IF vTip_Arti = vTiarMpF4 THEN
						IF NVL(nPrecMere,0) = 0 THEN
							IF vLogPreci IS NULL THEN
                        vLogPreci := 'Precio no Encontrado para el Lote: '||vLote||' por el metodo directo de busqueda, de busca entonces por el algoritmo de compras';  
--dbms_output.put_line('vLogPreci 3.3:'||vLogPreci);
                     ELSIF LENGTH(vLogPreci) <= 2000 THEN
                        vLogPreci := vLogPreci||SUBSTR(CHR(10)||'Precio no Encontrado para el Lote: '||vLote||' por el metodo directo de busqueda, de busca entonces por el algoritmo de compras',1,2000-LENGTH(vLogPreci));
--dbms_output.put_line('vLogPreci 4.3:'||vLogPreci);
                     END IF;
                     --
                     vPrecio := ANALESTA.P_ANE_MERMLAMI_PRAG.F_PRECIO(vEmpresa, vTip_Arti, vCod_Arti, dFecha_Cierre);
							nPrecMere := P_UTILIDAD.F_VALOCAMPO(vPrecio,'PRECIO');
							--
                     IF vLogPreci IS NULL THEN
                        vLogPreci := P_UTILIDAD.F_VALOCAMPO(vPrecio,'TRAZA'); 
--dbms_output.put_line('vLogPreci 3:'||vLogPreci);
                     ELSIF LENGTH(vLogPreci) <= 2000 THEN
                        vLogPreci := vLogPreci||SUBSTR(CHR(10)||P_UTILIDAD.F_VALOCAMPO(vPrecio,'TRAZA'),1,2000-LENGTH(vLogPreci)); 
--dbms_output.put_line('vLogPreci 4:'||vLogPreci);
                     END IF;
						END IF;
						--
						IF NVL(nPrecMere,0) = 0 AND vMaprPrCl = 'N' THEN
							--602 No se puede establecer el precio para la MP: @1-@2. [Contador @3]
							--Posiblemente no existen movimientos de entrada para este material valoradas a un precio	
							--Realizar un movimiento Manual de Entrada valorado con precio y realizar un movimiento de Salida por la misma cantidad
							P_ERRORES(vEmpresa, nNumeOtre, '602',vTip_Arti||'-'||vCod_Arti||'|no existen movimientos de entrada para este material valoradas a un precio|5.3','R','E');
							--dbms_output.put_line('Error 602: '||vTip_Arti||'-'||vCod_Arti||'|no existen movimientos de entrada para este material valoradas a un precio');
						END IF;
					ELSE
						IF NVL(nPrecMere,0) = 0 THEN
							--647 No se encuentra @1. [Contador @1]
							P_ERRORES(vEmpresa, nNumeOtre, '647','el precio del Material  '||vTip_Arti||'-'||vCod_Arti||' en el tratamiento de OTs de Semielaborados, se calcula con Metodo Antiguo|5.4','R','A');
							--dbms_output.put_line('Advertencia 647: No se encuentra el precio del material  '||vTip_Arti||'-'||vCod_Arti||' en el tratamiento de OTs de Semielaborados');
							--
							nPrecReFS := 0;--Acumula el Precio Real de la Fase Secuencia
							vUnidStMP := NULL;
							--
							P_RECURSIVO_MATERIALES(vTip_Arti, vCod_Arti);
							--
							nPrecMere := nPrecReFS;
						END IF;
					END IF;
					--Se convierte el precio a ML
					IF NVL(nPrecMere,0) != 0 THEN
--dbms_output.put_line('Precio: '||nPrecMere||' * '||nFactorML);
						nPrecMere := nPrecMere * nFactorML;
					END IF;
				END IF;
				--
				RETURN '|PRECIO:'||nPrecMere||'|TRAZA:'||vLogPreci;
			END;--F_CalcPrec
		BEGIN
			IF vTip_Arti = vTIARREST THEN
				nPrecio := 0;
			ELSIF vTip_Arti IN (vTiarMpF4,vTiarSeF4,vP_TiarFiF4) THEN --Si es Materia Prima
         
--dbms_output.put_line('vLogPreci 5.0:'||vTip_Arti||'-'||vCod_Arti);
				vPrecio := F_CalcPrec(vEmpresa, vTip_Arti, vCod_Arti,
											 vCod_LFS_P, nAncho_P, vUnidStoc_P, nFCKG_P);
				nPrecio := P_UTILIDAD.F_VALOCAMPO(vPrecio,'PRECIO');
            --
            IF vLogPreci IS NULL THEN
               vLogPreci := P_UTILIDAD.F_VALOCAMPO(vPrecio,'TRAZA'); 
--dbms_output.put_line('vLogPreci 5:'||nPrecio||'->'||vLogPreci);
            ELSIF LENGTH(vLogPreci) <= 2000 THEN
               vLogPreci := vLogPreci||SUBSTR(CHR(10)||P_UTILIDAD.F_VALOCAMPO(vPrecio,'TRAZA'),1,2000-LENGTH(vLogPreci)); 
--dbms_output.put_line('vLogPreci 6:'||nPrecio||'->'||vLogPreci);
            END IF;
			ELSE
				--dbms_Output.put_line('Calculo de Precios de: '||vEmpresa||', '||vTip_Arti||', '||vCod_Arti||', '||vLote);     
				--LOOP PARA LA PRIMER LAMINA
				FOR rMateBobi IN cMateBobi(1) LOOP --Para el Material de Lamina 1
					IF NOT (bExisMabo) THEN
						bExisMabo := TRUE;
					END IF;
					--
					nCantTota := nCantTota + rMateBobi.CANTCONS;
					--
					IF rMateBobi.CoboBobi > 0 THEN --Se trata de una Bobina Generada
						--dbms_Output.put_line('   *** Bobinas Materiales de Precios: '||rMateBobi.Empresa||', '||rMateBobi.Tip_Arti||', '||rMateBobi.Cod_Arti||', '||rMateBobi.Contador||'->'||'|EMPRBOBI:'||rMateBobi.EmprBobi||'|NUOTBOBI:'||rMateBobi.NuotBobi||'|CONTBOBI:'||rMateBobi.ContBobi||'|COBOBOBI:'||rMateBobi.CoboBobi||'|LOTE:'||rMateBobi.Lote);                          
						rMaterial := F_MATERIAL(rMateBobi.Empresa, rMateBobi.NumeOtre, rMateBobi.Contador, 
														rMateBobi.Tip_Arti, rMateBobi.Cod_Arti, '|EMPRBOBI:'||rMateBobi.EmprBobi||'|NUOTBOBI:'||rMateBobi.NuotBobi||'|CONTBOBI:'||rMateBobi.ContBobi||'|COBOBOBI:'||rMateBobi.CoboBobi||'|LOTE:'||rMateBobi.Lote,
														NULL, NULL);
					ELSE --Es un material de Almacen
						--dbms_Output.put_line('   *** Materiales de Precios: '||rMateBobi.Empresa||', '||rMateBobi.Tip_Arti||', '||rMateBobi.Cod_Arti||', '||rMateBobi.Contador||'->'||'|EMPRBOBI:'||rMateBobi.EmprBobi||'|NUOTBOBI:'||rMateBobi.NuotBobi||'|LOTE:'||rMateBobi.Lote);                                      
						rMaterial := F_MATERIAL(rMateBobi.Empresa, rMateBobi.NumeOtre, rMateBobi.Contador, 
														rMateBobi.Tip_Arti, rMateBobi.Cod_Arti, '|EMPRBOBI:'||rMateBobi.EmprBobi||'|NUOTBOBI:'||rMateBobi.NuotBobi||'|LOTE:'||rMateBobi.Lote||
														'|COBOMATE:'||rMateBobi.ContBobi||'|BOBIMATE:'||rMateBobi.BobiMate, -- 11-11-2016 Solo para materiales tipo M
														NULL, NULL);
					END IF;
					--
					IF rMaterial.PRECIO_ML IS NULL THEN
						IF vTip_Arti IN (vTiarMpF4,vTiarSeF4,vP_TiarFiF4) THEN --Si es Materia Prima
							--dbms_Output.put_line('      --- No Encuentra Precio Busca en MP');                           
                     vPrecio := F_CalcPrec(rMateBobi.Empresa, rMateBobi.Tip_Arti, rMateBobi.Cod_Arti,
                                            NULL, NULL, NULL, NULL);
                     nPrecio_Mat := P_UTILIDAD.F_VALOCAMPO(vPrecio,'PRECIO');
                     --
                     IF vLogPreci IS NULL THEN
                        vLogPreci := P_UTILIDAD.F_VALOCAMPO(vPrecio,'TRAZA'); 
--dbms_output.put_line('vLogPreci 7:'||vLogPreci);
                     ELSIF LENGTH(vLogPreci) <= 2000 THEN
                        vLogPreci := vLogPreci||SUBSTR(CHR(10)||P_UTILIDAD.F_VALOCAMPO(vPrecio,'TRAZA'),1,2000-LENGTH(vLogPreci));
--dbms_output.put_line('vLogPreci 8:'||vLogPreci);
                     END IF;
						ELSE
							--dbms_Output.put_line('      --- No Encuentra Precio Busca en Recursivo por que es Bobina');                           
                     vPrecio := F_PRECIO(rMateBobi.Empresa, rMateBobi.NumeOtre, 
                                         rMateBobi.Tip_Arti, rMateBobi.Cod_Arti, '|EMPRBOBI:'||rMateBobi.EmprBobi||'|NUOTBOBI:'||rMateBobi.NuotBobi||'|CONTBOBI:'||rMateBobi.ContBobi||'|COBOBOBI:'||rMateBobi.CoboBobi||'|LOTE:'||rMateBobi.Lote,
                                         NULL, NULL, NULL, NULL);
                     nPrecio_Mat := P_UTILIDAD.F_VALOCAMPO(vPrecio,'PRECIO');
                     --
                     IF vLogPreci IS NULL THEN
                        vLogPreci := P_UTILIDAD.F_VALOCAMPO(vPrecio,'TRAZA'); 
--dbms_output.put_line('vLogPreci 9:'||vLogPreci);
                     ELSIF LENGTH(vLogPreci) <= 2000 THEN
                        vLogPreci := vLogPreci||SUBSTR(CHR(10)||P_UTILIDAD.F_VALOCAMPO(vPrecio,'TRAZA'),1,2000-LENGTH(vLogPreci));
--dbms_output.put_line('vLogPreci 10:'||vLogPreci);
                     END IF;
						END IF;
						--
						--dbms_Output.put_line('         --- Acumula nPrecTota1: '||nPrecTota||' + ('||rMateBobi.CANTCONS||' * '||nPrecio_Mat||')');
						nPrecTota := nPrecTota + (rMateBobi.CANTCONS * NVL(nPrecio_Mat,0));
					ELSE
						--dbms_Output.put_line('      --- Encuentra Precio: '||rMaterial.PRECIO_ML);
						--dbms_Output.put_line('         --- Acumula nPrecTota2: '||nPrecTota||' + ('||rMateBobi.CANTCONS||' * '||rMaterial.PRECIO_ML||')');
						nPrecTota := nPrecTota + (rMateBobi.CANTCONS * rMaterial.PRECIO_ML);
						--dbms_Output.put_line('            --- nPrecTota: '||nPrecTota);
					END IF;
				END LOOP;
				--
				IF NOT (bExisMabo) THEN
					--602 No se puede establecer el precio para la MP: @1-@2. [Contador @3]
					P_ERRORES(vEmpresa, nNumeOtre, '602',vTip_Arti||'-'||vCod_Arti||' Lote: '||REPLACE(vLote,'|','-')||'| no se encontraron materiales en la bobina|6','R','E');
					--dbms_output.put_line('Error 602: '||vEmpresa||', '||vTip_Arti||', '||vCod_Arti||', '||vLote||'| no se encontraron materiales en la bobina');
				END IF;
				--
				IF NVL(nCantTota,0) != 0 THEN
					nPrecio := nPrecTota / nCantTota; --Se realiza el Precio Medio de la Primera Lamina
					--dbms_Output.put_line('         --- Precio de Cantidades Utilizadas '||nPrecTota||' / '||nCantTota||' = '||nPrecio);                           
				END IF;
				--LOOP PARA LA SEGUNDA LAMINA EN CASO DE EXISTIR
				FOR rMateBobi IN cMateBobi(2) LOOP --Para el Material de Lamina 2
					nCantTota_L2 := nCantTota_L2 + rMateBobi.CANTCONS;
					--
					IF rMateBobi.CoboBobi > 0 THEN --Se trata de una Bobina Generada
						--dbms_Output.put_line('   *** Bobinas Materiales de Precios L2: '||rMateBobi.Empresa||', '||rMateBobi.Tip_Arti||', '||rMateBobi.Cod_Arti||', '||rMateBobi.Contador||'->'||'|EMPRBOBI:'||rMateBobi.EmprBobi||'|NUOTBOBI:'||rMateBobi.NuotBobi||'|CONTBOBI:'||rMateBobi.ContBobi||'|COBOBOBI:'||rMateBobi.CoboBobi||'|LOTE:'||rMateBobi.Lote);                          
						rMaterial := F_MATERIAL(rMateBobi.Empresa, rMateBobi.NumeOtre, rMateBobi.Contador, 
														rMateBobi.Tip_Arti, rMateBobi.Cod_Arti, '|EMPRBOBI:'||rMateBobi.EmprBobi||'|NUOTBOBI:'||rMateBobi.NuotBobi||'|CONTBOBI:'||rMateBobi.ContBobi||'|COBOBOBI:'||rMateBobi.CoboBobi||'|LOTE:'||rMateBobi.Lote,
														NULL, NULL);
					ELSE --Es un material de Almacen
						--dbms_Output.put_line('   *** Materiales de Precios L2: '||rMateBobi.Empresa||', '||rMateBobi.Tip_Arti||', '||rMateBobi.Cod_Arti||', '||rMateBobi.Contador||'->'||'|EMPRBOBI:'||rMateBobi.EmprBobi||'|NUOTBOBI:'||rMateBobi.NuotBobi||'|LOTE:'||rMateBobi.Lote);                                      
						rMaterial := F_MATERIAL(rMateBobi.Empresa, rMateBobi.NumeOtre, rMateBobi.Contador, 
														rMateBobi.Tip_Arti, rMateBobi.Cod_Arti, '|EMPRBOBI:'||rMateBobi.EmprBobi||'|NUOTBOBI:'||rMateBobi.NuotBobi||'|LOTE:'||rMateBobi.Lote||
														'|COBOMATE:'||rMateBobi.ContBobi||'|BOBIMATE:'||rMateBobi.BobiMate, -- 11-11-2016 Solo para materiales tipo M,
														NULL, NULL);
					END IF;
					--
					IF rMaterial.PRECIO_ML IS NULL THEN
						IF vTip_Arti IN (vTiarMpF4,vTiarSeF4,vP_TiarFiF4) THEN --Si es Materia Prima
							--dbms_Output.put_line('      --- No Encuentra Precio Busca en MP L2');                           
							vPrecio := F_CalcPrec(rMateBobi.Empresa, rMateBobi.Tip_Arti, rMateBobi.Cod_Arti,
                                            NULL, NULL, NULL, NULL);
                     nPrecio_Mat := P_UTILIDAD.F_VALOCAMPO(vPrecio,'PRECIO');
                     --
                     IF vLogPreci IS NULL THEN
                        vLogPreci := P_UTILIDAD.F_VALOCAMPO(vPrecio,'TRAZA'); 
--dbms_output.put_line('vLogPreci 11:'||vLogPreci);
                     ELSIF LENGTH(vLogPreci) <= 2000 THEN
                        vLogPreci := vLogPreci||SUBSTR(CHR(10)||P_UTILIDAD.F_VALOCAMPO(vPrecio,'TRAZA'),1,2000-LENGTH(vLogPreci));
--dbms_output.put_line('vLogPreci 12:'||vLogPreci);
                     END IF;
						ELSE
							--dbms_Output.put_line('      --- No Encuentra Precio Busca en Recursivo por que es Bobina L2');                           
                     vPrecio := F_PRECIO(rMateBobi.Empresa, rMateBobi.NumeOtre, 
                                         rMateBobi.Tip_Arti, rMateBobi.Cod_Arti, '|EMPRBOBI:'||rMateBobi.EmprBobi||'|NUOTBOBI:'||rMateBobi.NuotBobi||'|CONTBOBI:'||rMateBobi.ContBobi||'|COBOBOBI:'||rMateBobi.CoboBobi||'|LOTE:'||rMateBobi.Lote,
                                         NULL, NULL, NULL, NULL);
                     nPrecio_Mat := P_UTILIDAD.F_VALOCAMPO(vPrecio,'PRECIO');
                     --
                     IF vLogPreci IS NULL THEN
                        vLogPreci := P_UTILIDAD.F_VALOCAMPO(vPrecio,'TRAZA'); 
--dbms_output.put_line('vLogPreci 13:'||vLogPreci);
                     ELSIF LENGTH(vLogPreci) <= 2000 THEN
                        vLogPreci := vLogPreci||SUBSTR(CHR(10)||P_UTILIDAD.F_VALOCAMPO(vPrecio,'TRAZA'),1,2000-LENGTH(vLogPreci)); 
--dbms_output.put_line('vLogPreci 14:'||vLogPreci);
                     END IF;
						END IF;
						--
						--dbms_Output.put_line('         --- Acumula nPrecTota1 L2: '||nPrecTota_L2||' + ('||rMateBobi.CANTCONS||' * '||nPrecio_Mat||')');
						nPrecTota_L2 := nPrecTota_L2 + (rMateBobi.CANTCONS * NVL(nPrecio_Mat,0));

					ELSE
						--dbms_Output.put_line('      --- Encuentra Precio: '||rMaterial.PRECIO_ML);
						--dbms_Output.put_line('         --- Acumula nPrecTota L2: '||nPrecTota_L2||' + ('||rMateBobi.CANTCONS||' * '||rMaterial.PRECIO_ML||')');
						nPrecTota_L2 := nPrecTota_L2 + (rMateBobi.CANTCONS * rMaterial.PRECIO_ML);
						--dbms_Output.put_line('            --- nPrecTota L2: '||nPrecTota_L2);
					END IF;
				END LOOP;
				--
				IF NVL(nCantTota_L2,0) != 0 THEN
					nPrecio_L2 := nPrecTota_L2 / nCantTota_L2; --Se realiza el Precio Medio de la Segunda Lamina
					--dbms_Output.put_line('         --- Precio de Cantidades Utilizadas L2 '||nPrecTota_L2||' / '||nCantTota_L2||' = '||nPrecio_L2);                           
					--Se suma el Precio Medio de la Lamina 2 al Precio Medio de la Lamina 1
					--dbms_Output.put_line('      --- Suma de Precios Medios en L2 '||nPrecio||' + '||nPrecio_L2);                           
					nPrecio := nPrecio + nPrecio_L2;
					--dbms_Output.put_line('      --- Total Precios Medios en L2 '||nPrecio);                           
				END IF;
				--Si es un corte hay que calcular la parte proporcional a su ancho del precio
				IF vTip_Arti = vTiarCosc THEN
					--dbms_Output.put_line('         --- Precio de Corte Total '||nPrecio);                           
					--Se busca la Bobina Utilizada
					rBOBIMAQU_U := F_BOBIMAQU(P_Utilidad.f_ValoCampo(vLote,'EMPRBOBI'), P_Utilidad.f_ValoCampo(vLote,'NUOTBOBI'), P_Utilidad.f_ValoCampo(vLote,'CONTBOBI'), P_Utilidad.f_ValoCampo(vLote,'COBOBOBI'));
					--
					IF NVL(rBOBIMAQU_U.ESTADO,'X') != 'X' THEN
						nPrecio := (rBOBIMAQU_U.Ancho * nPrecio) / rBOBIMAQU_U.Ancho_Total;--Se calcula el precio del Corte
						--dbms_Output.put_line('         --- Precio de Corte '||nPrecio);                           
					ELSE
						--602 No se puede establecer el precio para la MP: @1-@2. [Contador @3]
						P_ERRORES(vEmpresa, nNumeOtre, '602',P_Utilidad.f_ValoCampo(vLote,'EMPRBOBI')||'-'||P_Utilidad.f_ValoCampo(vLote,'NUOTBOBI')||'-'||P_Utilidad.f_ValoCampo(vLote,'CONTBOBI')||'-'||P_Utilidad.f_ValoCampo(vLote,'COBOBOBI')||' |No se encuentra la Bobina Utilizada para calculo de Precios|7','R','E');
						--dbms_output.put_line('Error 602: No se encuentra la Bobina Utilizada para calculo de Precios'||P_Utilidad.f_ValoCampo(vLote,'EMPRBOBI')||'-'||P_Utilidad.f_ValoCampo(vLote,'NUOTBOBI')||'-'||P_Utilidad.f_ValoCampo(vLote,'CONTBOBI')||'-'||P_Utilidad.f_ValoCampo(vLote,'COBOBOBI'));
					END IF;
				END IF;
			END IF;
			--Fin de Actualizacion del Precio de los Materiales de la Bobina
			RETURN '|PRECIO:'||nPrecio||'|TRAZA:'||vLogPreci;
		END;--F_PRECIO
---
   --
   PROCEDURE P_Ancho_Util(vEmpresa PRD_BOBIMAQU.EMPRESA%TYPE, nNumeOtre PRD_BOBIMAQU.NUMEOTRE%TYPE) IS--4278
      nAncho_Utilizado_OT ARTICULO.ANCHO%TYPE;
      nAncho_a_Utilizar_OT ARTICULO.ANCHO%TYPE;
      nAncho_Usado_y_Expedido_OT ARTICULO.ANCHO%TYPE;
      --
      nContador_Busqueda PRD_MAPAMAQU.CONTADOR%TYPE;
      --
      nContador_Busqueda2 PRD_MAPAMAQU.CONTADOR%TYPE;
      nContador_Busqueda3 PRD_MAPAMAQU.CONTADOR%TYPE;
      nContador_Busqueda4 PRD_MAPAMAQU.CONTADOR%TYPE;
      nContador_Busqueda5 PRD_MAPAMAQU.CONTADOR%TYPE;
      nContador_Busqueda6 PRD_MAPAMAQU.CONTADOR%TYPE;
      nContador_Busqueda7 PRD_MAPAMAQU.CONTADOR%TYPE;
      nContador_Busqueda8 PRD_MAPAMAQU.CONTADOR%TYPE;
      nContador_Busqueda9 PRD_MAPAMAQU.CONTADOR%TYPE;
      nContador_Busqueda10 PRD_MAPAMAQU.CONTADOR%TYPE;
      --
      bExisCort BOOLEAN;
      --
      rAncho_Util ST_ANCHO_UTIL;
      --
      CURSOR cAnalisis_Corte_1(nContador_Busqueda PRD_MAPAMAQU.CONTADOR%TYPE) IS--4183
         SELECT SUM(L.ANCHO) ANCHO_DEFINIDO, --Todos los que se utilizan
                SUM(DECODE(L.DESBARBE,'N',L.ANCHO,0)) ANCHO_UTILIZAR_OT, --Utilizar en OT
                SUM(DECODE(L.DESBARBE,'N',1,0)) BOBINAS_UTILIZAR_OT, --Bobinas a Utilizar en OT
                SUM(DECODE(L.DESBARBE,'C',L.ANCHO,0)) ANCHO_EXPEDIR_OT,  --Expedir en OT
                SUM(DECODE(L.DESBARBE,'A',L.ANCHO,'O',L.ANCHO,'E',L.ANCHO,'C',L.ANCHO,0)) ANCHO_TERMINA_FASE, --Termina en la Fase Actual (Almacenar, Utilizar en Otra OT, Expedir en Otra OT, Expedir en la OT)
                --SUM(DECODE(L.DESBARBE,'S',L.ANCHO,0)) DESBARBE_DEFINIDO --Desbarbe Definido para el Corte
                COUNT(*) NUMERO_CORTES
         FROM FIC_LIPCORTR L, 
              (SELECT MR.EMPRESA, MR.NUMEOTRE, MR.FASESEQU, MR.CONTADOR FROM PRD_MAQURUTA MR
               WHERE NOT EXISTS (SELECT 'X' FROM PRD_HCABEOTR OTC WHERE OTC.EMPRESA = MR.EMPRESA AND OTC.NUMEOTRE = MR.NUMEOTRE)
               UNION
               SELECT MR.EMPRESA, MR.NUMEOTRE, MR.FASESEQU, MR.CONTADOR FROM PRD_HMAQURUT MR) M 
            WHERE M.EMPRESA = L.EMPRESA
              AND M.NUMEOTRE = L.NUMERO
              AND SUBSTR(M.NUMEOTRE,1,4) = L.ANNO
              AND M.FASESEQU = (L.FASE * 100) + L.SECUENCI
              AND L.COD_ARES LIKE 'CORTADORA%'
              AND M.EMPRESA = vEmpresa
              AND M.NUMEOTRE = nNumeOtre 
              AND M.CONTADOR = nContador_Busqueda;
      --
      CURSOR cAnalisis_Corte_3 IS--4205
         SELECT TOTAL ANCHO_DEFINIDO, --Todos los que se utilizan
                0 ANCHO_UTILIZAR_OT, --Utilizar en OT
                0 BOBINAS_UTILIZAR_OT, --Bobinas a Utilizar en OT
                TOTAL ANCHO_EXPEDIR_OT,  --Expedir en OT
                TOTAL ANCHO_TERMINA_FASE, --Termina en la Fase Actual (Almacenar, Utilizar en Otra OT, Expedir en Otra OT, Expedir en la OT)
                --0 DESBARBE_DEFINIDO
                N_VECES NUMERO_CORTES
         FROM FIC_INFOPROD 
            WHERE EMPRESA = vEmpresa
              AND NUMERO = nNumeOtre
              AND ANNO = SUBSTR(nNumeOtre,1,4)
              AND TIPOMAQU = 'CORTADORA'
              AND TOTAL IS NOT NULL;
      --
      rAnalisis_Corte cAnalisis_Corte_1%ROWTYPE;
      --
      nAncho_Utilizado_Bobina ARTICULO.ANCHO%TYPE;
      nAncho_a_Utilizar_Bobina ARTICULO.ANCHO%TYPE;
      nAncho_Usado_y_Expedido_Bobina ARTICULO.ANCHO%TYPE;
      --
      nCortAnte NUMBER;
      nCortAnte_Bobina NUMBER;
      --
      nAncho_Utilizado_OT_FSI ARTICULO.ANCHO%TYPE;
      nAncho_Usado_y_Expedido_OT_FSI ARTICULO.ANCHO%TYPE;
      nAncho_Utilizado_Bobina_FSI ARTICULO.ANCHO%TYPE;
      nAncho_Usado_y_Expedido_Bo_FSI ARTICULO.ANCHO%TYPE;
      nCortAnte_FSI NUMBER;
      nCortAnte_Bobina_FSI NUMBER;
      --
      nAncho_Utilizado_OT_FS ARTICULO.ANCHO%TYPE;
      nAncho_a_Utilizar_OT_FS ARTICULO.ANCHO%TYPE;
      nAncho_Usado_y_Expedido_OT_FS ARTICULO.ANCHO%TYPE;
      nAncho_Utilizado_Bobina_FS ARTICULO.ANCHO%TYPE;
      nAncho_a_Utilizar_Bobina_FS ARTICULO.ANCHO%TYPE;
      nAncho_Usado_y_Expedido_Bob_FS ARTICULO.ANCHO%TYPE;
      nCortAnte_FS NUMBER;
      nCortAnte_Bobina_FS NUMBER;
      --
      --nDesbarbe_Definido NUMBER;
      nNumero_Cortes NUMBER;
      nNumero_Cortes_FS NUMBER;
      --
      vMaquActu_FS PRD_MAQURUTA.MAQUCODI%TYPE;
      --
      nContador_Busqueda_Anterior PRD_MAPAMAQU.CONTADOR%TYPE;
   BEGIN--P_Ancho_Util
      FOR rMaquinas IN cMaquinas(vEmpresa,nNumeOtre) LOOP--4253
         nAncho_Utilizado_OT := 0;
         nAncho_a_Utilizar_OT := NULL;
         nAncho_Usado_y_Expedido_OT := 0;
         --
         nContador_Busqueda := rMaquinas.CONTADOR;
         --Existen Cortadoras
         bExisCort := FALSE;
         --
         nAncho_Utilizado_Bobina := 0;
         nAncho_a_Utilizar_Bobina := NULL;
         nAncho_Usado_y_Expedido_Bobina := 0;
         --
         nCortAnte := 1;
         nCortAnte_Bobina := 1;
         --Para Fases Siguientes Multiples
         nContador_Busqueda2 := NULL;
         nContador_Busqueda3 := NULL;
         nContador_Busqueda4 := NULL;
         nContador_Busqueda5 := NULL;
         nContador_Busqueda6 := NULL;
         nContador_Busqueda7 := NULL;
         nContador_Busqueda8 := NULL;
         nContador_Busqueda9 := NULL;
         nContador_Busqueda10 := NULL;
         --
         nAncho_Utilizado_OT_FSI := 0;
         nAncho_Usado_y_Expedido_OT_FSI := 0;
         nAncho_Utilizado_Bobina_FSI := 0;
         nAncho_Usado_y_Expedido_Bo_FSI := 0;
         nCortAnte_FSI := 1;
         nCortAnte_Bobina_FSI := 1;
         --
         --nDesbarbe_Definido := 0;
         nNumero_Cortes := 1;
         nNumero_Cortes_FS := 1;
         --Establece si el material hace parte de un pre-corte
         vPre_Corte := NULL;
         --
         nContador_Busqueda_Anterior := NULL;
         --
         OPEN cPre_Corte(vEmpresa,nNumeOtre,rMaquinas.CONTADOR);--4294
         FETCH cPre_Corte INTO vPre_Corte;
         CLOSE cPre_Corte;
         --
         LOOP
            --Se busca que tipo de Maquina es para verificar si es una Cortadora
            rMaquActu.MaquCodi := NULL;
            --
            OPEN cMaquActu(vEmpresa, nNumeOtre, nContador_Busqueda);--4302
            FETCH cMaquActu INTO rMaquActu;
            CLOSE cMaquActu;
            --
            rContSigu.MAQUCODI := NULL;
            --
            OPEN cContSigu(vEmpresa, nNumeOtre, nContador_Busqueda, 1);
            FETCH cContSigu INTO rContSigu;
            CLOSE cContSigu;
            --
--dbms_output.put_line(vEmpresa||', '||nNumeOtre||', '||nContador_Busqueda||', '||rMaquActu.MAQUCODI||', '||rContSigu.CONTADOR||', '||rContSigu.MAQUCODI_SIGUIENTE);
            IF rMaquActu.MAQUCODI IS NOT NULL THEN
               --Si interviene una cortadora el ancho utilizado lo definira los parametros de los cortes
               IF INSTR(rMaquActu.MaquCodi,'CORTADORA') != 0 THEN --Si es cortadora --4315
                  rAnalisis_Corte.ANCHO_TERMINA_FASE := NULL;
                  rAnalisis_Corte.ANCHO_UTILIZAR_OT := NULL;
                  rAnalisis_Corte.ANCHO_EXPEDIR_OT := NULL;
                  rAnalisis_Corte.NUMERO_CORTES := NULL;
                  --
                  IF NOT (bExisCort) THEN
                     bExisCort := TRUE;
                  END IF;
                  --
                  OPEN cAnalisis_Corte_1(nContador_Busqueda);--4325
                  FETCH cAnalisis_Corte_1 INTO rAnalisis_Corte;
                  CLOSE cAnalisis_Corte_1;
                  --
                  IF rAnalisis_Corte.ANCHO_DEFINIDO IS NULL THEN--4329
                     OPEN cAnalisis_Corte_3;
                     FETCH cAnalisis_Corte_3 INTO rAnalisis_Corte;
                     CLOSE cAnalisis_Corte_3;
                  END IF;
                  --Se acumula lo que ya es en concreto utilizado en esta Fase
--dbms_output.put_line('nAncho_Utilizado_OT := '||nAncho_Utilizado_OT||' + '||(rAnalisis_Corte.ANCHO_TERMINA_FASE * nCortAnte));
                  nAncho_Utilizado_OT := nAncho_Utilizado_OT + (rAnalisis_Corte.ANCHO_TERMINA_FASE * nCortAnte);
                  --Se acumula lo que se ha expedido en la OT en esta Fase
--dbms_output.put_line('nAncho_Usado_y_Expedido_OT := '||nAncho_Usado_y_Expedido_OT||' + '||rAnalisis_Corte.ANCHO_EXPEDIR_OT);
                  nAncho_Usado_y_Expedido_OT := nAncho_Usado_y_Expedido_OT + (rAnalisis_Corte.ANCHO_EXPEDIR_OT * nCortAnte);
                  --Se lleva el registro del material a utilizar en Fases Siguientes, para ir observando cuanto queda del mismo
--dbms_output.put_line('nAncho_a_Utilizar_OT := '||rAnalisis_Corte.ANCHO_UTILIZAR_OT);
                  nAncho_a_Utilizar_OT := rAnalisis_Corte.ANCHO_UTILIZAR_OT;
                  --Si se esta analizando la Maquina Actual
--dbms_output.put_line('ANTES->'||nContador_Busqueda||' = '||rMaquinas.CONTADOR||' AND '||rContSigu.MAQUCODI);
                  IF nContador_Busqueda > rMaquinas.CONTADOR OR (nContador_Busqueda = rMaquinas.CONTADOR AND rContSigu.MAQUCODI IS NULL) THEN
                     --Se acumula lo que ya es en concreto utilizado en esta Fase
--dbms_output.put_line('nAncho_Utilizado_Bobina := '||nAncho_Utilizado_Bobina||' + ('||rAnalisis_Corte.ANCHO_TERMINA_FASE||' * '||nCortAnte_Bobina||')');
                     nAncho_Utilizado_Bobina := nAncho_Utilizado_Bobina + (rAnalisis_Corte.ANCHO_TERMINA_FASE * nCortAnte_Bobina);
                     --Se acumula lo que se ha expedido en la OT en esta Fase
--dbms_output.put_line('nAncho_Usado_y_Expedido_Bobina := '||nAncho_Usado_y_Expedido_Bobina||' + '||(rAnalisis_Corte.ANCHO_EXPEDIR_OT * nCortAnte_Bobina));
                     nAncho_Usado_y_Expedido_Bobina := nAncho_Usado_y_Expedido_Bobina + (rAnalisis_Corte.ANCHO_EXPEDIR_OT * nCortAnte_Bobina);
                     --Se lleva el registro del material a utilizar en Fases Siguientes, para ir observando cuanto queda del mismo
--dbms_output.put_line('nAncho_a_Utilizar_Bobina := '||rAnalisis_Corte.ANCHO_UTILIZAR_OT);
                     nAncho_a_Utilizar_Bobina := rAnalisis_Corte.ANCHO_UTILIZAR_OT;
                  END IF;
                  --
--dbms_output.put_line('nCortAnte := '||nCortAnte||' * '||rAnalisis_Corte.BOBINAS_UTILIZAR_OT);
                  IF NVL(rAnalisis_Corte.BOBINAS_UTILIZAR_OT,0) > 0 THEN
                     nCortAnte := nCortAnte * rAnalisis_Corte.BOBINAS_UTILIZAR_OT;
                     --
                     IF nContador_Busqueda = rMaquinas.CONTADOR THEN
                        nCortAnte_Bobina := 1;
                     ELSE
                        nCortAnte_Bobina := nCortAnte_Bobina * rAnalisis_Corte.BOBINAS_UTILIZAR_OT;
                     END IF;
                  END IF;
                  --Se almacena el Desbarbe definido en la Cortadora si existe
                  --IF nContador_Busqueda = rMaquinas.CONTADOR THEN
                     --nDesbarbe_Definido := rAnalisis_Corte.DESBARBE_DEFINIDO;
                  --END IF;
                  IF rContSigu.MAQUCODI IS NULL THEN
                     nNumero_Cortes := rAnalisis_Corte.NUMERO_CORTES;
                  END IF;
               END IF;
               --Guarda La Maquina 1 de las Fases Siguientes para comprobar que todas son del mismo tipo
               vMaquActu_FS := rMaquActu.MAQUCODI;
-------------------
-->Fase Siguiente 2
-------------------
/*dbms_output.put_line('vMaquActu_FS: '||vMaquActu_FS);
dbms_output.put_line('nContador_Busqueda2: '||nContador_Busqueda2||' nContador_Busqueda3: '||nContador_Busqueda3||' nContador_Busqueda4: '||nContador_Busqueda4||
                    ' nContador_Busqueda5: '||nContador_Busqueda5||' nContador_Busqueda6: '||nContador_Busqueda6||' nContador_Busqueda7: '||nContador_Busqueda7||
                    ' nContador_Busqueda8: '||nContador_Busqueda8||' nContador_Busqueda9: '||nContador_Busqueda9||' nContador_Busqueda10: '||nContador_Busqueda10);*/
               IF nContador_Busqueda2 IS NOT NULL AND rContSigu.MAQUCODI IS NULL THEN
                  --Se guarda la Maquina como una de Fases Siguientes Multiples
                  P_MAQUINA_FASESIMU(vEmpresa, nNumeOtre, nContador_Busqueda_Anterior, nContador_Busqueda);
                  --
                  P_MAQUINA_FASESIMU(vEmpresa, nNumeOtre, nContador_Busqueda_Anterior, nContador_Busqueda2);
                  --Se inicializan los valores para las Fases Siguientes Multiples
                  nAncho_Utilizado_OT_FS := nAncho_Utilizado_OT_FSI;
                  nAncho_a_Utilizar_OT_FS := NULL;
                  nAncho_Usado_y_Expedido_OT_FS := nAncho_Usado_y_Expedido_OT_FSI;
                  nAncho_Utilizado_Bobina_FS := nAncho_Utilizado_Bobina_FSI;
                  nAncho_a_Utilizar_Bobina_FS := NULL;
                  nAncho_Usado_y_Expedido_Bob_FS := nAncho_Usado_y_Expedido_Bo_FSI;
                  nCortAnte_FS := nCortAnte_FSI;
                  nCortAnte_Bobina_FS := nCortAnte_Bobina_FSI;
                  nNumero_Cortes_FS := 1;
                  --Se busca que tipo de Maquina es para verificar si es una Cortadora
                  rMaquActu.MaquCodi := NULL;
                  --
                  OPEN cMaquActu(vEmpresa, nNumeOtre, nContador_Busqueda2);
                  FETCH cMaquActu INTO rMaquActu;
                  CLOSE cMaquActu;
                  --
                  --"NO" se realiza busqueda de cContSigu porque el sistema no esta preparado para Fases siguientes despues de Fases Siguientes Multiples
                  --
                  --Verificación de Maquinas del Mismo tiempo en Fases Siguientes Multiples
                  IF rMaquActu.MAQUCODI IS NOT NULL AND 
                     (
                      (INSTR(rMaquActu.MaquCodi,'CORTADORA') != 0 AND INSTR(vMaquActu_FS,'CORTADORA') != 0) OR
                      (INSTR(rMaquActu.MaquCodi,'IMPRESORA') != 0 AND INSTR(vMaquActu_FS,'IMPRESORA') != 0) OR
                      (INSTR(rMaquActu.MaquCodi,'LAMINADORA') != 0 AND INSTR(vMaquActu_FS,'LAMINADORA') != 0) OR
                      (INSTR(rMaquActu.MaquCodi,'LAQUEADORA') != 0 AND INSTR(vMaquActu_FS,'LAQUEADORA') != 0)
                     )
                  THEN
                     --Si interviene una cortadora el ancho utilizado lo definira los parametros de los cortes
                     IF INSTR(rMaquActu.MaquCodi,'CORTADORA') != 0 THEN --Si es cortadora
                        rAnalisis_Corte.ANCHO_TERMINA_FASE := NULL;
                        rAnalisis_Corte.ANCHO_UTILIZAR_OT := NULL;
                        rAnalisis_Corte.ANCHO_EXPEDIR_OT := NULL;
                        rAnalisis_Corte.NUMERO_CORTES := NULL;
                        --
                        OPEN cAnalisis_Corte_1(nContador_Busqueda2);
                        FETCH cAnalisis_Corte_1 INTO rAnalisis_Corte;
                        CLOSE cAnalisis_Corte_1;
                        --
                        IF rAnalisis_Corte.ANCHO_DEFINIDO IS NULL THEN
                           OPEN cAnalisis_Corte_3;
                           FETCH cAnalisis_Corte_3 INTO rAnalisis_Corte;
                           CLOSE cAnalisis_Corte_3;
                        END IF;
                        --Se acumula lo que ya es en concreto utilizado en esta Fase
                        nAncho_Utilizado_OT_FS := nAncho_Utilizado_OT_FS + (rAnalisis_Corte.ANCHO_TERMINA_FASE * nCortAnte_FS);
                        --Se acumula lo que se ha expedido en la OT en esta Fase
                        nAncho_Usado_y_Expedido_OT_FS := nAncho_Usado_y_Expedido_OT_FS + (rAnalisis_Corte.ANCHO_EXPEDIR_OT * nCortAnte_FS);
                        --Se lleva el registro del material a utilizar en Fases Siguientes, para ir observando cuanto queda del mismo
                        nAncho_a_Utilizar_OT_FS := rAnalisis_Corte.ANCHO_UTILIZAR_OT;
                        --Si se esta analizando la Maquina Actual
                        IF nContador_Busqueda2 > rMaquinas.CONTADOR OR (nContador_Busqueda2 = rMaquinas.CONTADOR AND rContSigu.MAQUCODI IS NULL) THEN
                           --Se acumula lo que ya es en concreto utilizado en esta Fase
                           nAncho_Utilizado_Bobina_FS := nAncho_Utilizado_Bobina_FS + (rAnalisis_Corte.ANCHO_TERMINA_FASE * nCortAnte_Bobina_FS);
                           --Se acumula lo que se ha expedido en la OT en esta Fase
                           nAncho_Usado_y_Expedido_Bob_FS := nAncho_Usado_y_Expedido_Bob_FS + (rAnalisis_Corte.ANCHO_EXPEDIR_OT * nCortAnte_Bobina_FS);
                           --Se lleva el registro del material a utilizar en Fases Siguientes, para ir observando cuanto queda del mismo
                           nAncho_a_Utilizar_Bobina_FS := rAnalisis_Corte.ANCHO_UTILIZAR_OT;
                        END IF;
                        --
                        IF NVL(rAnalisis_Corte.BOBINAS_UTILIZAR_OT,0) > 0 THEN
                           nCortAnte_FS := nCortAnte_FS * rAnalisis_Corte.BOBINAS_UTILIZAR_OT;
                           --
                           IF nContador_Busqueda2 = rMaquinas.CONTADOR THEN
                              nCortAnte_Bobina_FS := 1;
                           ELSE
                              nCortAnte_Bobina_FS := nCortAnte_Bobina_FS * rAnalisis_Corte.BOBINAS_UTILIZAR_OT;
                           END IF;
                        END IF;
                        --
                        nNumero_Cortes_FS := rAnalisis_Corte.NUMERO_CORTES;
                     END IF;
                  ELSE
                     --654 Las Maquinas de Fases Siguientes Multiples deben ser del mismo tipo. Contador @1
                     P_ERRORES(vEmpresa, nNumeOtre, '654','8.3','R','E');
                  END IF;
                  -----------------------------------------------------------------------
                  --Control para deteminar los anchos en que Termina la MP 
                  -----------------------------------------------------------------------
                  rAncho_Util.Empresa := vEmpresa;
                  rAncho_Util.NumeOtre := nNumeOtre;
                  rAncho_Util.Contador := rMaquinas.CONTADOR;
                  rAncho_Util.FaseSigu := 2;
                  --
                  rAncho_Util.CONTFSMU := nContador_Busqueda2;
                  --
                  IF bExisCort THEN --Si se encontraron cortes: el ancho utilizado lo definira los parametros de los cortes
                     --La variable "nAncho_a_Utilizar_OT" Si tiene un valor es sumada a la Utilizacion ya que esto significa que Se uso pero luego no tuvo un proceso de corte
                     rAncho_Util.Ancho_Utilizado_OT := nAncho_Utilizado_OT_FS + (nAncho_a_Utilizar_OT_FS * nCortAnte_FS);
                     rAncho_Util.Ancho_Usado_y_Expedido_OT := nAncho_Usado_y_Expedido_OT_FS + (nAncho_a_Utilizar_OT_FS * nCortAnte_FS);
                     --
                     rAncho_Util.ANCHO_UTILIZADO_UTIL_BOBINA := nAncho_Utilizado_Bobina_FS + (nAncho_a_Utilizar_Bobina_FS * nCortAnte_Bobina_FS);
                     rAncho_Util.NUMECORT := nNumero_Cortes_FS;
                  ELSE --Si no se encontraron cortes: el ancho utilizado lo definira el total del Ancho del Material
                     rAncho_Util.Ancho_Utilizado_OT := NULL;
                     rAncho_Util.Ancho_Usado_y_Expedido_OT := NULL;
                     --
                     rAncho_Util.ANCHO_UTILIZADO_UTIL_BOBINA := NULL;
                  END IF;
                  --
                  T_Ancho_Util(T_Ancho_Util.COUNT + 1) := rAncho_Util;
                  -----------------------------------------------------------------------
                  --Fin Control para deteminar los anchos en que Termina la MP 
                  -----------------------------------------------------------------------
               END IF;
----------------------
--Fin Fase Siguiente 2
----------------------
-------------------
-->Fase Siguiente 3
-------------------
               IF nContador_Busqueda3 IS NOT NULL AND rContSigu.MAQUCODI IS NULL THEN
                  --Se guarda la Maquina como una de Fases Siguientes Multiples
                  P_MAQUINA_FASESIMU(vEmpresa, nNumeOtre, nContador_Busqueda_Anterior, nContador_Busqueda3);
                  --Se inicializan los valores para las Fases Siguientes Multiples
                  nAncho_Utilizado_OT_FS := nAncho_Utilizado_OT_FSI;
                  nAncho_a_Utilizar_OT_FS := NULL;
                  nAncho_Usado_y_Expedido_OT_FS := nAncho_Usado_y_Expedido_OT_FSI;
                  nAncho_Utilizado_Bobina_FS := nAncho_Utilizado_Bobina_FSI;
                  nAncho_a_Utilizar_Bobina_FS := NULL;
                  nAncho_Usado_y_Expedido_Bob_FS := nAncho_Usado_y_Expedido_Bo_FSI;
                  nCortAnte_FS := nCortAnte_FSI;
                  nCortAnte_Bobina_FS := nCortAnte_Bobina_FSI;
                  nNumero_Cortes_FS := 1;
                  --Se busca que tipo de Maquina es para verificar si es una Cortadora
                  rMaquActu.MaquCodi := NULL;
                  --
                  OPEN cMaquActu(vEmpresa, nNumeOtre, nContador_Busqueda3);
                  FETCH cMaquActu INTO rMaquActu;
                  CLOSE cMaquActu;
                  --
                  --"NO" se realiza busqueda de cContSigu porque el sistema no esta preparado para Fases siguientes despues de Fases Siguientes Multiples
                  --
                  --Verificación de Maquinas del Mismo tiempo en Fases Siguientes Multiples
                  IF rMaquActu.MAQUCODI IS NOT NULL AND 
                     (
                      (INSTR(rMaquActu.MaquCodi,'CORTADORA') != 0 AND INSTR(vMaquActu_FS,'CORTADORA') != 0) OR
                      (INSTR(rMaquActu.MaquCodi,'IMPRESORA') != 0 AND INSTR(vMaquActu_FS,'IMPRESORA') != 0) OR
                      (INSTR(rMaquActu.MaquCodi,'LAMINADORA') != 0 AND INSTR(vMaquActu_FS,'LAMINADORA') != 0) OR
                      (INSTR(rMaquActu.MaquCodi,'LAQUEADORA') != 0 AND INSTR(vMaquActu_FS,'LAQUEADORA') != 0)
                     )
                  THEN
                     --Si interviene una cortadora el ancho utilizado lo definira los parametros de los cortes
                     IF INSTR(rMaquActu.MaquCodi,'CORTADORA') != 0 THEN --Si es cortadora
                        rAnalisis_Corte.ANCHO_TERMINA_FASE := NULL;
                        rAnalisis_Corte.ANCHO_UTILIZAR_OT := NULL;
                        rAnalisis_Corte.ANCHO_EXPEDIR_OT := NULL;
                        rAnalisis_Corte.NUMERO_CORTES := NULL;
                        --
                        OPEN cAnalisis_Corte_1(nContador_Busqueda3);
                        FETCH cAnalisis_Corte_1 INTO rAnalisis_Corte;
                        CLOSE cAnalisis_Corte_1;
                        --
                        IF rAnalisis_Corte.ANCHO_DEFINIDO IS NULL THEN
                           OPEN cAnalisis_Corte_3;
                           FETCH cAnalisis_Corte_3 INTO rAnalisis_Corte;
                           CLOSE cAnalisis_Corte_3;
                        END IF;
                        --Se acumula lo que ya es en concreto utilizado en esta Fase
                        nAncho_Utilizado_OT_FS := nAncho_Utilizado_OT_FS + (rAnalisis_Corte.ANCHO_TERMINA_FASE * nCortAnte_FS);
                        --Se acumula lo que se ha expedido en la OT en esta Fase
                        nAncho_Usado_y_Expedido_OT_FS := nAncho_Usado_y_Expedido_OT_FS + (rAnalisis_Corte.ANCHO_EXPEDIR_OT * nCortAnte_FS);
                        --Se lleva el registro del material a utilizar en Fases Siguientes, para ir observando cuanto queda del mismo
                        nAncho_a_Utilizar_OT_FS := rAnalisis_Corte.ANCHO_UTILIZAR_OT;
                        --Si se esta analizando la Maquina Actual
                        IF nContador_Busqueda3 > rMaquinas.CONTADOR OR (nContador_Busqueda3 = rMaquinas.CONTADOR AND rContSigu.MAQUCODI IS NULL) THEN
                           --Se acumula lo que ya es en concreto utilizado en esta Fase
                           nAncho_Utilizado_Bobina_FS := nAncho_Utilizado_Bobina_FS + (rAnalisis_Corte.ANCHO_TERMINA_FASE * nCortAnte_Bobina_FS);
                           --Se acumula lo que se ha expedido en la OT en esta Fase
                           nAncho_Usado_y_Expedido_Bob_FS := nAncho_Usado_y_Expedido_Bob_FS + (rAnalisis_Corte.ANCHO_EXPEDIR_OT * nCortAnte_Bobina_FS);
                           --Se lleva el registro del material a utilizar en Fases Siguientes, para ir observando cuanto queda del mismo
                           nAncho_a_Utilizar_Bobina_FS := rAnalisis_Corte.ANCHO_UTILIZAR_OT;
                        END IF;
                        --
                        IF NVL(rAnalisis_Corte.BOBINAS_UTILIZAR_OT,0) > 0 THEN
                           nCortAnte_FS := nCortAnte_FS * rAnalisis_Corte.BOBINAS_UTILIZAR_OT;
                           --
                           IF nContador_Busqueda3 = rMaquinas.CONTADOR THEN
                              nCortAnte_Bobina_FS := 1;
                           ELSE
                              nCortAnte_Bobina_FS := nCortAnte_Bobina_FS * rAnalisis_Corte.BOBINAS_UTILIZAR_OT;
                           END IF;
                        END IF;
                        --
                        nNumero_Cortes_FS := rAnalisis_Corte.NUMERO_CORTES;
                     END IF;
                  ELSE
                     --654 Las Maquinas de Fases Siguientes Multiples deben ser del mismo tipo. Contador @1
                     P_ERRORES(vEmpresa, nNumeOtre, '654','8.4','R','E');
                  END IF;
                  -----------------------------------------------------------------------
                  --Control para deteminar los anchos en que Termina la MP 
                  -----------------------------------------------------------------------
                  rAncho_Util.Empresa := vEmpresa;
                  rAncho_Util.NumeOtre := nNumeOtre;
                  rAncho_Util.Contador := rMaquinas.CONTADOR;
                  rAncho_Util.FaseSigu := 3;
                  --
                  rAncho_Util.CONTFSMU := nContador_Busqueda3;
                  --
                  IF bExisCort THEN --Si se encontraron cortes: el ancho utilizado lo definira los parametros de los cortes
                     --La variable "nAncho_a_Utilizar_OT" Si tiene un valor es sumada a la Utilizacion ya que esto significa que Se uso pero luego no tuvo un proceso de corte
                     rAncho_Util.Ancho_Utilizado_OT := nAncho_Utilizado_OT_FS + (nAncho_a_Utilizar_OT_FS * nCortAnte_FS);
                     rAncho_Util.Ancho_Usado_y_Expedido_OT := nAncho_Usado_y_Expedido_OT_FS + (nAncho_a_Utilizar_OT_FS * nCortAnte_FS);
                     --
                     rAncho_Util.ANCHO_UTILIZADO_UTIL_BOBINA := nAncho_Utilizado_Bobina_FS + (nAncho_a_Utilizar_Bobina_FS * nCortAnte_Bobina_FS);
                     rAncho_Util.NUMECORT := nNumero_Cortes_FS;
                  ELSE --Si no se encontraron cortes: el ancho utilizado lo definira el total del Ancho del Material
                     rAncho_Util.Ancho_Utilizado_OT := NULL;
                     rAncho_Util.Ancho_Usado_y_Expedido_OT := NULL;
                     --
                     rAncho_Util.ANCHO_UTILIZADO_UTIL_BOBINA := NULL;
                  END IF;
                  --
                  T_Ancho_Util(T_Ancho_Util.COUNT + 1) := rAncho_Util;
                  -----------------------------------------------------------------------
                  --Fin Control para deteminar los anchos en que Termina la MP 
                  -----------------------------------------------------------------------
               END IF;
----------------------
--Fin Fase Siguiente 3
----------------------
-------------------
-->Fase Siguiente 4
-------------------
               IF nContador_Busqueda4 IS NOT NULL AND rContSigu.MAQUCODI IS NULL THEN
                  --Se guarda la Maquina como una de Fases Siguientes Multiples
                  P_MAQUINA_FASESIMU(vEmpresa, nNumeOtre, nContador_Busqueda_Anterior, nContador_Busqueda4);
                  --Se inicializan los valores para las Fases Siguientes Multiples
                  nAncho_Utilizado_OT_FS := nAncho_Utilizado_OT_FSI;
                  nAncho_a_Utilizar_OT_FS := NULL;
                  nAncho_Usado_y_Expedido_OT_FS := nAncho_Usado_y_Expedido_OT_FSI;
                  nAncho_Utilizado_Bobina_FS := nAncho_Utilizado_Bobina_FSI;
                  nAncho_a_Utilizar_Bobina_FS := NULL;
                  nAncho_Usado_y_Expedido_Bob_FS := nAncho_Usado_y_Expedido_Bo_FSI;
                  nCortAnte_FS := nCortAnte_FSI;
                  nCortAnte_Bobina_FS := nCortAnte_Bobina_FSI;
                  nNumero_Cortes_FS := 1;
                  --Se busca que tipo de Maquina es para verificar si es una Cortadora
                  rMaquActu.MaquCodi := NULL;
                  --
                  OPEN cMaquActu(vEmpresa, nNumeOtre, nContador_Busqueda4);
                  FETCH cMaquActu INTO rMaquActu;
                  CLOSE cMaquActu;
                  --
                  --"NO" se realiza busqueda de cContSigu porque el sistema no esta preparado para Fases siguientes despues de Fases Siguientes Multiples
                  --
                  --Verificación de Maquinas del Mismo tiempo en Fases Siguientes Multiples
                  IF rMaquActu.MAQUCODI IS NOT NULL AND 
                     (
                      (INSTR(rMaquActu.MaquCodi,'CORTADORA') != 0 AND INSTR(vMaquActu_FS,'CORTADORA') != 0) OR
                      (INSTR(rMaquActu.MaquCodi,'IMPRESORA') != 0 AND INSTR(vMaquActu_FS,'IMPRESORA') != 0) OR
                      (INSTR(rMaquActu.MaquCodi,'LAMINADORA') != 0 AND INSTR(vMaquActu_FS,'LAMINADORA') != 0) OR
                      (INSTR(rMaquActu.MaquCodi,'LAQUEADORA') != 0 AND INSTR(vMaquActu_FS,'LAQUEADORA') != 0)
                     )
                  THEN
                     --Si interviene una cortadora el ancho utilizado lo definira los parametros de los cortes
                     IF INSTR(rMaquActu.MaquCodi,'CORTADORA') != 0 THEN --Si es cortadora
                        rAnalisis_Corte.ANCHO_TERMINA_FASE := NULL;
                        rAnalisis_Corte.ANCHO_UTILIZAR_OT := NULL;
                        rAnalisis_Corte.ANCHO_EXPEDIR_OT := NULL;
                        rAnalisis_Corte.NUMERO_CORTES := NULL;
                        --
                        OPEN cAnalisis_Corte_1(nContador_Busqueda4);
                        FETCH cAnalisis_Corte_1 INTO rAnalisis_Corte;
                        CLOSE cAnalisis_Corte_1;
                        --
                        IF rAnalisis_Corte.ANCHO_DEFINIDO IS NULL THEN
                           OPEN cAnalisis_Corte_3;
                           FETCH cAnalisis_Corte_3 INTO rAnalisis_Corte;
                           CLOSE cAnalisis_Corte_3;
                        END IF;
                        --Se acumula lo que ya es en concreto utilizado en esta Fase
                        nAncho_Utilizado_OT_FS := nAncho_Utilizado_OT_FS + (rAnalisis_Corte.ANCHO_TERMINA_FASE * nCortAnte_FS);
                        --Se acumula lo que se ha expedido en la OT en esta Fase
                        nAncho_Usado_y_Expedido_OT_FS := nAncho_Usado_y_Expedido_OT_FS + (rAnalisis_Corte.ANCHO_EXPEDIR_OT * nCortAnte_FS);
                        --Se lleva el registro del material a utilizar en Fases Siguientes, para ir observando cuanto queda del mismo
                        nAncho_a_Utilizar_OT_FS := rAnalisis_Corte.ANCHO_UTILIZAR_OT;
                        --Si se esta analizando la Maquina Actual
                        IF nContador_Busqueda4 > rMaquinas.CONTADOR OR (nContador_Busqueda4 = rMaquinas.CONTADOR AND rContSigu.MAQUCODI IS NULL) THEN
                           --Se acumula lo que ya es en concreto utilizado en esta Fase
                           nAncho_Utilizado_Bobina_FS := nAncho_Utilizado_Bobina_FS + (rAnalisis_Corte.ANCHO_TERMINA_FASE * nCortAnte_Bobina_FS);
                           --Se acumula lo que se ha expedido en la OT en esta Fase
                           nAncho_Usado_y_Expedido_Bob_FS := nAncho_Usado_y_Expedido_Bob_FS + (rAnalisis_Corte.ANCHO_EXPEDIR_OT * nCortAnte_Bobina_FS);
                           --Se lleva el registro del material a utilizar en Fases Siguientes, para ir observando cuanto queda del mismo
                           nAncho_a_Utilizar_Bobina_FS := rAnalisis_Corte.ANCHO_UTILIZAR_OT;
                        END IF;
                        --
                        IF NVL(rAnalisis_Corte.BOBINAS_UTILIZAR_OT,0) > 0 THEN
                           nCortAnte_FS := nCortAnte_FS * rAnalisis_Corte.BOBINAS_UTILIZAR_OT;
                           --
                           IF nContador_Busqueda4 = rMaquinas.CONTADOR THEN
                              nCortAnte_Bobina_FS := 1;
                           ELSE
                              nCortAnte_Bobina_FS := nCortAnte_Bobina_FS * rAnalisis_Corte.BOBINAS_UTILIZAR_OT;
                           END IF;
                        END IF;
                        --
                        nNumero_Cortes_FS := rAnalisis_Corte.NUMERO_CORTES;
                     END IF;
                  ELSE
                     --654 Las Maquinas de Fases Siguientes Multiples deben ser del mismo tipo. Contador @1
                     P_ERRORES(vEmpresa, nNumeOtre, '654','8.5','R','E');
                  END IF;
                  -----------------------------------------------------------------------
                  --Control para deteminar los anchos en que Termina la MP 
                  -----------------------------------------------------------------------
                  rAncho_Util.Empresa := vEmpresa;
                  rAncho_Util.NumeOtre := nNumeOtre;
                  rAncho_Util.Contador := rMaquinas.CONTADOR;
                  rAncho_Util.FaseSigu := 4;
                  --
                  rAncho_Util.CONTFSMU := nContador_Busqueda4;
                  --
                  IF bExisCort THEN --Si se encontraron cortes: el ancho utilizado lo definira los parametros de los cortes
                     --La variable "nAncho_a_Utilizar_OT" Si tiene un valor es sumada a la Utilizacion ya que esto significa que Se uso pero luego no tuvo un proceso de corte
                     rAncho_Util.Ancho_Utilizado_OT := nAncho_Utilizado_OT_FS + (nAncho_a_Utilizar_OT_FS * nCortAnte_FS);
                     rAncho_Util.Ancho_Usado_y_Expedido_OT := nAncho_Usado_y_Expedido_OT_FS + (nAncho_a_Utilizar_OT_FS * nCortAnte_FS);
                     --
                     rAncho_Util.ANCHO_UTILIZADO_UTIL_BOBINA := nAncho_Utilizado_Bobina_FS + (nAncho_a_Utilizar_Bobina_FS * nCortAnte_Bobina_FS);
                     rAncho_Util.NUMECORT := nNumero_Cortes_FS;
                  ELSE --Si no se encontraron cortes: el ancho utilizado lo definira el total del Ancho del Material
                     rAncho_Util.Ancho_Utilizado_OT := NULL;
                     rAncho_Util.Ancho_Usado_y_Expedido_OT := NULL;
                     --
                     rAncho_Util.ANCHO_UTILIZADO_UTIL_BOBINA := NULL;
                  END IF;
                  --
                  T_Ancho_Util(T_Ancho_Util.COUNT + 1) := rAncho_Util;
                  -----------------------------------------------------------------------
                  --Fin Control para deteminar los anchos en que Termina la MP 
                  -----------------------------------------------------------------------
               END IF;
----------------------
--Fin Fase Siguiente 4
----------------------
-------------------
-->Fase Siguiente 5
-------------------
               IF nContador_Busqueda5 IS NOT NULL AND rContSigu.MAQUCODI IS NULL THEN
                  --Se guarda la Maquina como una de Fases Siguientes Multiples
                  P_MAQUINA_FASESIMU(vEmpresa, nNumeOtre, nContador_Busqueda_Anterior, nContador_Busqueda5);
                  --Se inicializan los valores para las Fases Siguientes Multiples
                  nAncho_Utilizado_OT_FS := nAncho_Utilizado_OT_FSI;
                  nAncho_a_Utilizar_OT_FS := NULL;
                  nAncho_Usado_y_Expedido_OT_FS := nAncho_Usado_y_Expedido_OT_FSI;
                  nAncho_Utilizado_Bobina_FS := nAncho_Utilizado_Bobina_FSI;
                  nAncho_a_Utilizar_Bobina_FS := NULL;
                  nAncho_Usado_y_Expedido_Bob_FS := nAncho_Usado_y_Expedido_Bo_FSI;
                  nCortAnte_FS := nCortAnte_FSI;
                  nCortAnte_Bobina_FS := nCortAnte_Bobina_FSI;
                  nNumero_Cortes_FS := 1;
                  --Se busca que tipo de Maquina es para verificar si es una Cortadora
                  rMaquActu.MaquCodi := NULL;
                  --
                  OPEN cMaquActu(vEmpresa, nNumeOtre, nContador_Busqueda5);
                  FETCH cMaquActu INTO rMaquActu;
                  CLOSE cMaquActu;
                  --
                  --"NO" se realiza busqueda de cContSigu porque el sistema no esta preparado para Fases siguientes despues de Fases Siguientes Multiples
                  --
                  --Verificación de Maquinas del Mismo tiempo en Fases Siguientes Multiples
                  IF rMaquActu.MAQUCODI IS NOT NULL AND 
                     (
                      (INSTR(rMaquActu.MaquCodi,'CORTADORA') != 0 AND INSTR(vMaquActu_FS,'CORTADORA') != 0) OR
                      (INSTR(rMaquActu.MaquCodi,'IMPRESORA') != 0 AND INSTR(vMaquActu_FS,'IMPRESORA') != 0) OR
                      (INSTR(rMaquActu.MaquCodi,'LAMINADORA') != 0 AND INSTR(vMaquActu_FS,'LAMINADORA') != 0) OR
                      (INSTR(rMaquActu.MaquCodi,'LAQUEADORA') != 0 AND INSTR(vMaquActu_FS,'LAQUEADORA') != 0)
                     )
                  THEN
                     --Si interviene una cortadora el ancho utilizado lo definira los parametros de los cortes
                     IF INSTR(rMaquActu.MaquCodi,'CORTADORA') != 0 THEN --Si es cortadora
                        rAnalisis_Corte.ANCHO_TERMINA_FASE := NULL;
                        rAnalisis_Corte.ANCHO_UTILIZAR_OT := NULL;
                        rAnalisis_Corte.ANCHO_EXPEDIR_OT := NULL;
                        rAnalisis_Corte.NUMERO_CORTES := NULL;
                        --
                        OPEN cAnalisis_Corte_1(nContador_Busqueda5);
                        FETCH cAnalisis_Corte_1 INTO rAnalisis_Corte;
                        CLOSE cAnalisis_Corte_1;
                        --
                        IF rAnalisis_Corte.ANCHO_DEFINIDO IS NULL THEN
                           OPEN cAnalisis_Corte_3;
                           FETCH cAnalisis_Corte_3 INTO rAnalisis_Corte;
                           CLOSE cAnalisis_Corte_3;
                        END IF;
                        --Se acumula lo que ya es en concreto utilizado en esta Fase
                        nAncho_Utilizado_OT_FS := nAncho_Utilizado_OT_FS + (rAnalisis_Corte.ANCHO_TERMINA_FASE * nCortAnte_FS);
                        --Se acumula lo que se ha expedido en la OT en esta Fase
                        nAncho_Usado_y_Expedido_OT_FS := nAncho_Usado_y_Expedido_OT_FS + (rAnalisis_Corte.ANCHO_EXPEDIR_OT * nCortAnte_FS);
                        --Se lleva el registro del material a utilizar en Fases Siguientes, para ir observando cuanto queda del mismo
                        nAncho_a_Utilizar_OT_FS := rAnalisis_Corte.ANCHO_UTILIZAR_OT;
                        --Si se esta analizando la Maquina Actual
                        IF nContador_Busqueda5 > rMaquinas.CONTADOR OR (nContador_Busqueda5 = rMaquinas.CONTADOR AND rContSigu.MAQUCODI IS NULL) THEN
                           --Se acumula lo que ya es en concreto utilizado en esta Fase
                           nAncho_Utilizado_Bobina_FS := nAncho_Utilizado_Bobina_FS + (rAnalisis_Corte.ANCHO_TERMINA_FASE * nCortAnte_Bobina_FS);
                           --Se acumula lo que se ha expedido en la OT en esta Fase
                           nAncho_Usado_y_Expedido_Bob_FS := nAncho_Usado_y_Expedido_Bob_FS + (rAnalisis_Corte.ANCHO_EXPEDIR_OT * nCortAnte_Bobina_FS);
                           --Se lleva el registro del material a utilizar en Fases Siguientes, para ir observando cuanto queda del mismo
                           nAncho_a_Utilizar_Bobina_FS := rAnalisis_Corte.ANCHO_UTILIZAR_OT;
                        END IF;
                        --
                        IF NVL(rAnalisis_Corte.BOBINAS_UTILIZAR_OT,0) > 0 THEN
                           nCortAnte_FS := nCortAnte_FS * rAnalisis_Corte.BOBINAS_UTILIZAR_OT;
                           --
                           IF nContador_Busqueda5 = rMaquinas.CONTADOR THEN
                              nCortAnte_Bobina_FS := 1;
                           ELSE
                              nCortAnte_Bobina_FS := nCortAnte_Bobina_FS * rAnalisis_Corte.BOBINAS_UTILIZAR_OT;
                           END IF;
                        END IF;
                        --
                        nNumero_Cortes_FS := rAnalisis_Corte.NUMERO_CORTES;
                     END IF;
                  ELSE
                     --654 Las Maquinas de Fases Siguientes Multiples deben ser del mismo tipo. Contador @1
                     P_ERRORES(vEmpresa, nNumeOtre, '654','8.6','R','E');
                  END IF;
                  -----------------------------------------------------------------------
                  --Control para deteminar los anchos en que Termina la MP 
                  -----------------------------------------------------------------------
                  rAncho_Util.Empresa := vEmpresa;
                  rAncho_Util.NumeOtre := nNumeOtre;
                  rAncho_Util.Contador := rMaquinas.CONTADOR;
                  rAncho_Util.FaseSigu := 5;
                  --
                  rAncho_Util.CONTFSMU := nContador_Busqueda5;
                  --
                  IF bExisCort THEN --Si se encontraron cortes: el ancho utilizado lo definira los parametros de los cortes
                     --La variable "nAncho_a_Utilizar_OT" Si tiene un valor es sumada a la Utilizacion ya que esto significa que Se uso pero luego no tuvo un proceso de corte
                     rAncho_Util.Ancho_Utilizado_OT := nAncho_Utilizado_OT_FS + (nAncho_a_Utilizar_OT_FS * nCortAnte_FS);
                     rAncho_Util.Ancho_Usado_y_Expedido_OT := nAncho_Usado_y_Expedido_OT_FS + (nAncho_a_Utilizar_OT_FS * nCortAnte_FS);
                     --
                     rAncho_Util.ANCHO_UTILIZADO_UTIL_BOBINA := nAncho_Utilizado_Bobina_FS + (nAncho_a_Utilizar_Bobina_FS * nCortAnte_Bobina_FS);
                     rAncho_Util.NUMECORT := nNumero_Cortes_FS;
                  ELSE --Si no se encontraron cortes: el ancho utilizado lo definira el total del Ancho del Material
                     rAncho_Util.Ancho_Utilizado_OT := NULL;
                     rAncho_Util.Ancho_Usado_y_Expedido_OT := NULL;
                     --
                     rAncho_Util.ANCHO_UTILIZADO_UTIL_BOBINA := NULL;
                  END IF;
                  --
                  T_Ancho_Util(T_Ancho_Util.COUNT + 1) := rAncho_Util;
                  -----------------------------------------------------------------------
                  --Fin Control para deteminar los anchos en que Termina la MP 
                  -----------------------------------------------------------------------
               END IF;
----------------------
--Fin Fase Siguiente 5
----------------------
-------------------
-->Fase Siguiente 6
-------------------
               IF nContador_Busqueda6 IS NOT NULL AND rContSigu.MAQUCODI IS NULL THEN
                  --Se guarda la Maquina como una de Fases Siguientes Multiples
                  P_MAQUINA_FASESIMU(vEmpresa, nNumeOtre, nContador_Busqueda_Anterior, nContador_Busqueda6);
                  --Se inicializan los valores para las Fases Siguientes Multiples
                  nAncho_Utilizado_OT_FS := nAncho_Utilizado_OT_FSI;
                  nAncho_a_Utilizar_OT_FS := NULL;
                  nAncho_Usado_y_Expedido_OT_FS := nAncho_Usado_y_Expedido_OT_FSI;
                  nAncho_Utilizado_Bobina_FS := nAncho_Utilizado_Bobina_FSI;
                  nAncho_a_Utilizar_Bobina_FS := NULL;
                  nAncho_Usado_y_Expedido_Bob_FS := nAncho_Usado_y_Expedido_Bo_FSI;
                  nCortAnte_FS := nCortAnte_FSI;
                  nCortAnte_Bobina_FS := nCortAnte_Bobina_FSI;
                  nNumero_Cortes_FS := 1;
                  --Se busca que tipo de Maquina es para verificar si es una Cortadora
                  rMaquActu.MaquCodi := NULL;
                  --
                  OPEN cMaquActu(vEmpresa, nNumeOtre, nContador_Busqueda6);
                  FETCH cMaquActu INTO rMaquActu;
                  CLOSE cMaquActu;
                  --
                  --"NO" se realiza busqueda de cContSigu porque el sistema no esta preparado para Fases siguientes despues de Fases Siguientes Multiples
                  --
                  --Verificación de Maquinas del Mismo tiempo en Fases Siguientes Multiples
                  IF rMaquActu.MAQUCODI IS NOT NULL AND 
                     (
                      (INSTR(rMaquActu.MaquCodi,'CORTADORA') != 0 AND INSTR(vMaquActu_FS,'CORTADORA') != 0) OR
                      (INSTR(rMaquActu.MaquCodi,'IMPRESORA') != 0 AND INSTR(vMaquActu_FS,'IMPRESORA') != 0) OR
                      (INSTR(rMaquActu.MaquCodi,'LAMINADORA') != 0 AND INSTR(vMaquActu_FS,'LAMINADORA') != 0) OR
                      (INSTR(rMaquActu.MaquCodi,'LAQUEADORA') != 0 AND INSTR(vMaquActu_FS,'LAQUEADORA') != 0)
                     )
                  THEN
                     --Si interviene una cortadora el ancho utilizado lo definira los parametros de los cortes
                     IF INSTR(rMaquActu.MaquCodi,'CORTADORA') != 0 THEN --Si es cortadora
                        rAnalisis_Corte.ANCHO_TERMINA_FASE := NULL;
                        rAnalisis_Corte.ANCHO_UTILIZAR_OT := NULL;
                        rAnalisis_Corte.ANCHO_EXPEDIR_OT := NULL;
                        rAnalisis_Corte.NUMERO_CORTES := NULL;
                        --
                        OPEN cAnalisis_Corte_1(nContador_Busqueda6);
                        FETCH cAnalisis_Corte_1 INTO rAnalisis_Corte;
                        CLOSE cAnalisis_Corte_1;
                        --
                        IF rAnalisis_Corte.ANCHO_DEFINIDO IS NULL THEN
                           OPEN cAnalisis_Corte_3;
                           FETCH cAnalisis_Corte_3 INTO rAnalisis_Corte;
                           CLOSE cAnalisis_Corte_3;
                        END IF;
                        --Se acumula lo que ya es en concreto utilizado en esta Fase
                        nAncho_Utilizado_OT_FS := nAncho_Utilizado_OT_FS + (rAnalisis_Corte.ANCHO_TERMINA_FASE * nCortAnte_FS);
                        --Se acumula lo que se ha expedido en la OT en esta Fase
                        nAncho_Usado_y_Expedido_OT_FS := nAncho_Usado_y_Expedido_OT_FS + (rAnalisis_Corte.ANCHO_EXPEDIR_OT * nCortAnte_FS);
                        --Se lleva el registro del material a utilizar en Fases Siguientes, para ir observando cuanto queda del mismo
                        nAncho_a_Utilizar_OT_FS := rAnalisis_Corte.ANCHO_UTILIZAR_OT;
                        --Si se esta analizando la Maquina Actual
                        IF nContador_Busqueda6 > rMaquinas.CONTADOR OR (nContador_Busqueda6 = rMaquinas.CONTADOR AND rContSigu.MAQUCODI IS NULL) THEN
                           --Se acumula lo que ya es en concreto utilizado en esta Fase
                           nAncho_Utilizado_Bobina_FS := nAncho_Utilizado_Bobina_FS + (rAnalisis_Corte.ANCHO_TERMINA_FASE * nCortAnte_Bobina_FS);
                           --Se acumula lo que se ha expedido en la OT en esta Fase
                           nAncho_Usado_y_Expedido_Bob_FS := nAncho_Usado_y_Expedido_Bob_FS + (rAnalisis_Corte.ANCHO_EXPEDIR_OT * nCortAnte_Bobina_FS);
                           --Se lleva el registro del material a utilizar en Fases Siguientes, para ir observando cuanto queda del mismo
                           nAncho_a_Utilizar_Bobina_FS := rAnalisis_Corte.ANCHO_UTILIZAR_OT;
                        END IF;
                        --
                        IF NVL(rAnalisis_Corte.BOBINAS_UTILIZAR_OT,0) > 0 THEN
                           nCortAnte_FS := nCortAnte_FS * rAnalisis_Corte.BOBINAS_UTILIZAR_OT;
                           --
                           IF nContador_Busqueda6 = rMaquinas.CONTADOR THEN
                              nCortAnte_Bobina_FS := 1;
                           ELSE
                              nCortAnte_Bobina_FS := nCortAnte_Bobina_FS * rAnalisis_Corte.BOBINAS_UTILIZAR_OT;
                           END IF;
                        END IF;
                        --
                        nNumero_Cortes_FS := rAnalisis_Corte.NUMERO_CORTES;
                     END IF;
                  ELSE
                     --654 Las Maquinas de Fases Siguientes Multiples deben ser del mismo tipo. Contador @1
                     P_ERRORES(vEmpresa, nNumeOtre, '654','8.7','R','E');
                  END IF;
                  -----------------------------------------------------------------------
                  --Control para deteminar los anchos en que Termina la MP 
                  -----------------------------------------------------------------------
                  rAncho_Util.Empresa := vEmpresa;
                  rAncho_Util.NumeOtre := nNumeOtre;
                  rAncho_Util.Contador := rMaquinas.CONTADOR;
                  rAncho_Util.FaseSigu := 6;
                  --
                  rAncho_Util.CONTFSMU := nContador_Busqueda6;
                  --
                  IF bExisCort THEN --Si se encontraron cortes: el ancho utilizado lo definira los parametros de los cortes
                     --La variable "nAncho_a_Utilizar_OT" Si tiene un valor es sumada a la Utilizacion ya que esto significa que Se uso pero luego no tuvo un proceso de corte
                     rAncho_Util.Ancho_Utilizado_OT := nAncho_Utilizado_OT_FS + (nAncho_a_Utilizar_OT_FS * nCortAnte_FS);
                     rAncho_Util.Ancho_Usado_y_Expedido_OT := nAncho_Usado_y_Expedido_OT_FS + (nAncho_a_Utilizar_OT_FS * nCortAnte_FS);
                     --
                     rAncho_Util.ANCHO_UTILIZADO_UTIL_BOBINA := nAncho_Utilizado_Bobina_FS + (nAncho_a_Utilizar_Bobina_FS * nCortAnte_Bobina_FS);
                     rAncho_Util.NUMECORT := nNumero_Cortes_FS;
                  ELSE --Si no se encontraron cortes: el ancho utilizado lo definira el total del Ancho del Material
                     rAncho_Util.Ancho_Utilizado_OT := NULL;
                     rAncho_Util.Ancho_Usado_y_Expedido_OT := NULL;
                     --
                     rAncho_Util.ANCHO_UTILIZADO_UTIL_BOBINA := NULL;
                  END IF;
                  --
                  T_Ancho_Util(T_Ancho_Util.COUNT + 1) := rAncho_Util;
                  -----------------------------------------------------------------------
                  --Fin Control para deteminar los anchos en que Termina la MP 
                  -----------------------------------------------------------------------
               END IF;
----------------------
--Fin Fase Siguiente 6
----------------------
-------------------
-->Fase Siguiente 7
-------------------
               IF nContador_Busqueda7 IS NOT NULL AND rContSigu.MAQUCODI IS NULL THEN
                  --Se guarda la Maquina como una de Fases Siguientes Multiples
                  P_MAQUINA_FASESIMU(vEmpresa, nNumeOtre, nContador_Busqueda_Anterior, nContador_Busqueda7);
                  --Se inicializan los valores para las Fases Siguientes Multiples
                  nAncho_Utilizado_OT_FS := nAncho_Utilizado_OT_FSI;
                  nAncho_a_Utilizar_OT_FS := NULL;
                  nAncho_Usado_y_Expedido_OT_FS := nAncho_Usado_y_Expedido_OT_FSI;
                  nAncho_Utilizado_Bobina_FS := nAncho_Utilizado_Bobina_FSI;
                  nAncho_a_Utilizar_Bobina_FS := NULL;
                  nAncho_Usado_y_Expedido_Bob_FS := nAncho_Usado_y_Expedido_Bo_FSI;
                  nCortAnte_FS := nCortAnte_FSI;
                  nCortAnte_Bobina_FS := nCortAnte_Bobina_FSI;
                  nNumero_Cortes_FS := 1;
                  --Se busca que tipo de Maquina es para verificar si es una Cortadora
                  rMaquActu.MaquCodi := NULL;
                  --
                  OPEN cMaquActu(vEmpresa, nNumeOtre, nContador_Busqueda7);
                  FETCH cMaquActu INTO rMaquActu;
                  CLOSE cMaquActu;
                  --
                  --"NO" se realiza busqueda de cContSigu porque el sistema no esta preparado para Fases siguientes despues de Fases Siguientes Multiples
                  --
                  --Verificación de Maquinas del Mismo tiempo en Fases Siguientes Multiples
                  IF rMaquActu.MAQUCODI IS NOT NULL AND 
                     (
                      (INSTR(rMaquActu.MaquCodi,'CORTADORA') != 0 AND INSTR(vMaquActu_FS,'CORTADORA') != 0) OR
                      (INSTR(rMaquActu.MaquCodi,'IMPRESORA') != 0 AND INSTR(vMaquActu_FS,'IMPRESORA') != 0) OR
                      (INSTR(rMaquActu.MaquCodi,'LAMINADORA') != 0 AND INSTR(vMaquActu_FS,'LAMINADORA') != 0) OR
                      (INSTR(rMaquActu.MaquCodi,'LAQUEADORA') != 0 AND INSTR(vMaquActu_FS,'LAQUEADORA') != 0)
                     )
                  THEN
                     --Si interviene una cortadora el ancho utilizado lo definira los parametros de los cortes
                     IF INSTR(rMaquActu.MaquCodi,'CORTADORA') != 0 THEN --Si es cortadora
                        rAnalisis_Corte.ANCHO_TERMINA_FASE := NULL;
                        rAnalisis_Corte.ANCHO_UTILIZAR_OT := NULL;
                        rAnalisis_Corte.ANCHO_EXPEDIR_OT := NULL;
                        rAnalisis_Corte.NUMERO_CORTES := NULL;
                        --
                        OPEN cAnalisis_Corte_1(nContador_Busqueda7);
                        FETCH cAnalisis_Corte_1 INTO rAnalisis_Corte;
                        CLOSE cAnalisis_Corte_1;
                        --
                        IF rAnalisis_Corte.ANCHO_DEFINIDO IS NULL THEN
                           OPEN cAnalisis_Corte_3;
                           FETCH cAnalisis_Corte_3 INTO rAnalisis_Corte;
                           CLOSE cAnalisis_Corte_3;
                        END IF;
                        --Se acumula lo que ya es en concreto utilizado en esta Fase
                        nAncho_Utilizado_OT_FS := nAncho_Utilizado_OT_FS + (rAnalisis_Corte.ANCHO_TERMINA_FASE * nCortAnte_FS);
                        --Se acumula lo que se ha expedido en la OT en esta Fase
                        nAncho_Usado_y_Expedido_OT_FS := nAncho_Usado_y_Expedido_OT_FS + (rAnalisis_Corte.ANCHO_EXPEDIR_OT * nCortAnte_FS);
                        --Se lleva el registro del material a utilizar en Fases Siguientes, para ir observando cuanto queda del mismo
                        nAncho_a_Utilizar_OT_FS := rAnalisis_Corte.ANCHO_UTILIZAR_OT;
                        --Si se esta analizando la Maquina Actual
                        IF nContador_Busqueda7 > rMaquinas.CONTADOR OR (nContador_Busqueda7 = rMaquinas.CONTADOR AND rContSigu.MAQUCODI IS NULL) THEN
                           --Se acumula lo que ya es en concreto utilizado en esta Fase
                           nAncho_Utilizado_Bobina_FS := nAncho_Utilizado_Bobina_FS + (rAnalisis_Corte.ANCHO_TERMINA_FASE * nCortAnte_Bobina_FS);
                           --Se acumula lo que se ha expedido en la OT en esta Fase
                           nAncho_Usado_y_Expedido_Bob_FS := nAncho_Usado_y_Expedido_Bob_FS + (rAnalisis_Corte.ANCHO_EXPEDIR_OT * nCortAnte_Bobina_FS);
                           --Se lleva el registro del material a utilizar en Fases Siguientes, para ir observando cuanto queda del mismo
                           nAncho_a_Utilizar_Bobina_FS := rAnalisis_Corte.ANCHO_UTILIZAR_OT;
                        END IF;
                        --
                        IF NVL(rAnalisis_Corte.BOBINAS_UTILIZAR_OT,0) > 0 THEN
                           nCortAnte_FS := nCortAnte_FS * rAnalisis_Corte.BOBINAS_UTILIZAR_OT;
                           --
                           IF nContador_Busqueda7 = rMaquinas.CONTADOR THEN
                              nCortAnte_Bobina_FS := 1;
                           ELSE
                              nCortAnte_Bobina_FS := nCortAnte_Bobina_FS * rAnalisis_Corte.BOBINAS_UTILIZAR_OT;
                           END IF;
                        END IF;
                        --
                        nNumero_Cortes_FS := rAnalisis_Corte.NUMERO_CORTES;
                     END IF;
                  ELSE
                     --654 Las Maquinas de Fases Siguientes Multiples deben ser del mismo tipo. Contador @1
                     P_ERRORES(vEmpresa, nNumeOtre, '654','8.8','R','E');
                  END IF;
                  -----------------------------------------------------------------------
                  --Control para deteminar los anchos en que Termina la MP 
                  -----------------------------------------------------------------------
                  rAncho_Util.Empresa := vEmpresa;
                  rAncho_Util.NumeOtre := nNumeOtre;
                  rAncho_Util.Contador := rMaquinas.CONTADOR;
                  rAncho_Util.FaseSigu := 7;
                  --
                  rAncho_Util.CONTFSMU := nContador_Busqueda7;
                  --
                  IF bExisCort THEN --Si se encontraron cortes: el ancho utilizado lo definira los parametros de los cortes
                     --La variable "nAncho_a_Utilizar_OT" Si tiene un valor es sumada a la Utilizacion ya que esto significa que Se uso pero luego no tuvo un proceso de corte
                     rAncho_Util.Ancho_Utilizado_OT := nAncho_Utilizado_OT_FS + (nAncho_a_Utilizar_OT_FS * nCortAnte_FS);
                     rAncho_Util.Ancho_Usado_y_Expedido_OT := nAncho_Usado_y_Expedido_OT_FS + (nAncho_a_Utilizar_OT_FS * nCortAnte_FS);
                     --
                     rAncho_Util.ANCHO_UTILIZADO_UTIL_BOBINA := nAncho_Utilizado_Bobina_FS + (nAncho_a_Utilizar_Bobina_FS * nCortAnte_Bobina_FS);
                     rAncho_Util.NUMECORT := nNumero_Cortes_FS;
                  ELSE --Si no se encontraron cortes: el ancho utilizado lo definira el total del Ancho del Material
                     rAncho_Util.Ancho_Utilizado_OT := NULL;
                     rAncho_Util.Ancho_Usado_y_Expedido_OT := NULL;
                     --
                     rAncho_Util.ANCHO_UTILIZADO_UTIL_BOBINA := NULL;
                  END IF;
                  --
                  T_Ancho_Util(T_Ancho_Util.COUNT + 1) := rAncho_Util;
                  -----------------------------------------------------------------------
                  --Fin Control para deteminar los anchos en que Termina la MP 
                  -----------------------------------------------------------------------
               END IF;
----------------------
--Fin Fase Siguiente 7
----------------------
-------------------
-->Fase Siguiente 8
-------------------
               IF nContador_Busqueda8 IS NOT NULL AND rContSigu.MAQUCODI IS NULL THEN
                  --Se guarda la Maquina como una de Fases Siguientes Multiples
                  P_MAQUINA_FASESIMU(vEmpresa, nNumeOtre, nContador_Busqueda_Anterior, nContador_Busqueda8);
                  --Se inicializan los valores para las Fases Siguientes Multiples
                  nAncho_Utilizado_OT_FS := nAncho_Utilizado_OT_FSI;
                  nAncho_a_Utilizar_OT_FS := NULL;
                  nAncho_Usado_y_Expedido_OT_FS := nAncho_Usado_y_Expedido_OT_FSI;
                  nAncho_Utilizado_Bobina_FS := nAncho_Utilizado_Bobina_FSI;
                  nAncho_a_Utilizar_Bobina_FS := NULL;
                  nAncho_Usado_y_Expedido_Bob_FS := nAncho_Usado_y_Expedido_Bo_FSI;
                  nCortAnte_FS := nCortAnte_FSI;
                  nCortAnte_Bobina_FS := nCortAnte_Bobina_FSI;
                  nNumero_Cortes_FS := 1;
                  --Se busca que tipo de Maquina es para verificar si es una Cortadora
                  rMaquActu.MaquCodi := NULL;
                  --
                  OPEN cMaquActu(vEmpresa, nNumeOtre, nContador_Busqueda8);
                  FETCH cMaquActu INTO rMaquActu;
                  CLOSE cMaquActu;
                  --
                  --"NO" se realiza busqueda de cContSigu porque el sistema no esta preparado para Fases siguientes despues de Fases Siguientes Multiples
                  --
                  --Verificación de Maquinas del Mismo tiempo en Fases Siguientes Multiples
                  IF rMaquActu.MAQUCODI IS NOT NULL AND 
                     (
                      (INSTR(rMaquActu.MaquCodi,'CORTADORA') != 0 AND INSTR(vMaquActu_FS,'CORTADORA') != 0) OR
                      (INSTR(rMaquActu.MaquCodi,'IMPRESORA') != 0 AND INSTR(vMaquActu_FS,'IMPRESORA') != 0) OR
                      (INSTR(rMaquActu.MaquCodi,'LAMINADORA') != 0 AND INSTR(vMaquActu_FS,'LAMINADORA') != 0) OR
                      (INSTR(rMaquActu.MaquCodi,'LAQUEADORA') != 0 AND INSTR(vMaquActu_FS,'LAQUEADORA') != 0)
                     )
                  THEN
                     --Si interviene una cortadora el ancho utilizado lo definira los parametros de los cortes
                     IF INSTR(rMaquActu.MaquCodi,'CORTADORA') != 0 THEN --Si es cortadora
                        rAnalisis_Corte.ANCHO_TERMINA_FASE := NULL;
                        rAnalisis_Corte.ANCHO_UTILIZAR_OT := NULL;
                        rAnalisis_Corte.ANCHO_EXPEDIR_OT := NULL;
                        rAnalisis_Corte.NUMERO_CORTES := NULL;
                        --
                        OPEN cAnalisis_Corte_1(nContador_Busqueda8);
                        FETCH cAnalisis_Corte_1 INTO rAnalisis_Corte;
                        CLOSE cAnalisis_Corte_1;
                        --
                        IF rAnalisis_Corte.ANCHO_DEFINIDO IS NULL THEN
                           OPEN cAnalisis_Corte_3;
                           FETCH cAnalisis_Corte_3 INTO rAnalisis_Corte;
                           CLOSE cAnalisis_Corte_3;
                        END IF;
                        --Se acumula lo que ya es en concreto utilizado en esta Fase
                        nAncho_Utilizado_OT_FS := nAncho_Utilizado_OT_FS + (rAnalisis_Corte.ANCHO_TERMINA_FASE * nCortAnte_FS);
                        --Se acumula lo que se ha expedido en la OT en esta Fase
                        nAncho_Usado_y_Expedido_OT_FS := nAncho_Usado_y_Expedido_OT_FS + (rAnalisis_Corte.ANCHO_EXPEDIR_OT * nCortAnte_FS);
                        --Se lleva el registro del material a utilizar en Fases Siguientes, para ir observando cuanto queda del mismo
                        nAncho_a_Utilizar_OT_FS := rAnalisis_Corte.ANCHO_UTILIZAR_OT;
                        --Si se esta analizando la Maquina Actual
                        IF nContador_Busqueda8 > rMaquinas.CONTADOR OR (nContador_Busqueda8 = rMaquinas.CONTADOR AND rContSigu.MAQUCODI IS NULL) THEN
                           --Se acumula lo que ya es en concreto utilizado en esta Fase
                           nAncho_Utilizado_Bobina_FS := nAncho_Utilizado_Bobina_FS + (rAnalisis_Corte.ANCHO_TERMINA_FASE * nCortAnte_Bobina_FS);
                           --Se acumula lo que se ha expedido en la OT en esta Fase
                           nAncho_Usado_y_Expedido_Bob_FS := nAncho_Usado_y_Expedido_Bob_FS + (rAnalisis_Corte.ANCHO_EXPEDIR_OT * nCortAnte_Bobina_FS);
                           --Se lleva el registro del material a utilizar en Fases Siguientes, para ir observando cuanto queda del mismo
                           nAncho_a_Utilizar_Bobina_FS := rAnalisis_Corte.ANCHO_UTILIZAR_OT;
                        END IF;
                        --
                        IF NVL(rAnalisis_Corte.BOBINAS_UTILIZAR_OT,0) > 0 THEN
                           nCortAnte_FS := nCortAnte_FS * rAnalisis_Corte.BOBINAS_UTILIZAR_OT;
                           --
                           IF nContador_Busqueda8 = rMaquinas.CONTADOR THEN
                              nCortAnte_Bobina_FS := 1;
                           ELSE
                              nCortAnte_Bobina_FS := nCortAnte_Bobina_FS * rAnalisis_Corte.BOBINAS_UTILIZAR_OT;
                           END IF;
                        END IF;
                        --
                        nNumero_Cortes_FS := rAnalisis_Corte.NUMERO_CORTES;
                     END IF;
                  ELSE
                     --654 Las Maquinas de Fases Siguientes Multiples deben ser del mismo tipo. Contador @1
                     P_ERRORES(vEmpresa, nNumeOtre, '654','8.9','R','E');
                  END IF;
                  -----------------------------------------------------------------------
                  --Control para deteminar los anchos en que Termina la MP 
                  -----------------------------------------------------------------------
                  rAncho_Util.Empresa := vEmpresa;
                  rAncho_Util.NumeOtre := nNumeOtre;
                  rAncho_Util.Contador := rMaquinas.CONTADOR;
                  rAncho_Util.FaseSigu := 8;
                  --
                  rAncho_Util.CONTFSMU := nContador_Busqueda8;
                  --
                  IF bExisCort THEN --Si se encontraron cortes: el ancho utilizado lo definira los parametros de los cortes
                     --La variable "nAncho_a_Utilizar_OT" Si tiene un valor es sumada a la Utilizacion ya que esto significa que Se uso pero luego no tuvo un proceso de corte
                     rAncho_Util.Ancho_Utilizado_OT := nAncho_Utilizado_OT_FS + (nAncho_a_Utilizar_OT_FS * nCortAnte_FS);
                     rAncho_Util.Ancho_Usado_y_Expedido_OT := nAncho_Usado_y_Expedido_OT_FS + (nAncho_a_Utilizar_OT_FS * nCortAnte_FS);
                     --
                     rAncho_Util.ANCHO_UTILIZADO_UTIL_BOBINA := nAncho_Utilizado_Bobina_FS + (nAncho_a_Utilizar_Bobina_FS * nCortAnte_Bobina_FS);
                     rAncho_Util.NUMECORT := nNumero_Cortes_FS;
                  ELSE --Si no se encontraron cortes: el ancho utilizado lo definira el total del Ancho del Material
                     rAncho_Util.Ancho_Utilizado_OT := NULL;
                     rAncho_Util.Ancho_Usado_y_Expedido_OT := NULL;
                     --
                     rAncho_Util.ANCHO_UTILIZADO_UTIL_BOBINA := NULL;
                  END IF;
                  --
                  T_Ancho_Util(T_Ancho_Util.COUNT + 1) := rAncho_Util;
                  -----------------------------------------------------------------------
                  --Fin Control para deteminar los anchos en que Termina la MP 
                  -----------------------------------------------------------------------
               END IF;
----------------------
--Fin Fase Siguiente 8
----------------------
-------------------
-->Fase Siguiente 9
-------------------
               IF nContador_Busqueda9 IS NOT NULL AND rContSigu.MAQUCODI IS NULL THEN
                  --Se guarda la Maquina como una de Fases Siguientes Multiples
                  P_MAQUINA_FASESIMU(vEmpresa, nNumeOtre, nContador_Busqueda_Anterior, nContador_Busqueda9);
                  --Se inicializan los valores para las Fases Siguientes Multiples
                  nAncho_Utilizado_OT_FS := nAncho_Utilizado_OT_FSI;
                  nAncho_a_Utilizar_OT_FS := NULL;
                  nAncho_Usado_y_Expedido_OT_FS := nAncho_Usado_y_Expedido_OT_FSI;
                  nAncho_Utilizado_Bobina_FS := nAncho_Utilizado_Bobina_FSI;
                  nAncho_a_Utilizar_Bobina_FS := NULL;
                  nAncho_Usado_y_Expedido_Bob_FS := nAncho_Usado_y_Expedido_Bo_FSI;
                  nCortAnte_FS := nCortAnte_FSI;
                  nCortAnte_Bobina_FS := nCortAnte_Bobina_FSI;
                  nNumero_Cortes_FS := 1;
                  --Se busca que tipo de Maquina es para verificar si es una Cortadora
                  rMaquActu.MaquCodi := NULL;
                  --
                  OPEN cMaquActu(vEmpresa, nNumeOtre, nContador_Busqueda9);
                  FETCH cMaquActu INTO rMaquActu;
                  CLOSE cMaquActu;
                  --
                  --"NO" se realiza busqueda de cContSigu porque el sistema no esta preparado para Fases siguientes despues de Fases Siguientes Multiples
                  --
                  --Verificación de Maquinas del Mismo tiempo en Fases Siguientes Multiples
                  IF rMaquActu.MAQUCODI IS NOT NULL AND 
                     (
                      (INSTR(rMaquActu.MaquCodi,'CORTADORA') != 0 AND INSTR(vMaquActu_FS,'CORTADORA') != 0) OR
                      (INSTR(rMaquActu.MaquCodi,'IMPRESORA') != 0 AND INSTR(vMaquActu_FS,'IMPRESORA') != 0) OR
                      (INSTR(rMaquActu.MaquCodi,'LAMINADORA') != 0 AND INSTR(vMaquActu_FS,'LAMINADORA') != 0) OR
                      (INSTR(rMaquActu.MaquCodi,'LAQUEADORA') != 0 AND INSTR(vMaquActu_FS,'LAQUEADORA') != 0)
                     )
                  THEN
                     --Si interviene una cortadora el ancho utilizado lo definira los parametros de los cortes
                     IF INSTR(rMaquActu.MaquCodi,'CORTADORA') != 0 THEN --Si es cortadora
                        rAnalisis_Corte.ANCHO_TERMINA_FASE := NULL;
                        rAnalisis_Corte.ANCHO_UTILIZAR_OT := NULL;
                        rAnalisis_Corte.ANCHO_EXPEDIR_OT := NULL;
                        rAnalisis_Corte.NUMERO_CORTES := NULL;
                        --
                        OPEN cAnalisis_Corte_1(nContador_Busqueda9);
                        FETCH cAnalisis_Corte_1 INTO rAnalisis_Corte;
                        CLOSE cAnalisis_Corte_1;
                        --
                        IF rAnalisis_Corte.ANCHO_DEFINIDO IS NULL THEN
                           OPEN cAnalisis_Corte_3;
                           FETCH cAnalisis_Corte_3 INTO rAnalisis_Corte;
                           CLOSE cAnalisis_Corte_3;
                        END IF;
                        --Se acumula lo que ya es en concreto utilizado en esta Fase
                        nAncho_Utilizado_OT_FS := nAncho_Utilizado_OT_FS + (rAnalisis_Corte.ANCHO_TERMINA_FASE * nCortAnte_FS);
                        --Se acumula lo que se ha expedido en la OT en esta Fase
                        nAncho_Usado_y_Expedido_OT_FS := nAncho_Usado_y_Expedido_OT_FS + (rAnalisis_Corte.ANCHO_EXPEDIR_OT * nCortAnte_FS);
                        --Se lleva el registro del material a utilizar en Fases Siguientes, para ir observando cuanto queda del mismo
                        nAncho_a_Utilizar_OT_FS := rAnalisis_Corte.ANCHO_UTILIZAR_OT;
                        --Si se esta analizando la Maquina Actual
                        IF nContador_Busqueda9 > rMaquinas.CONTADOR OR (nContador_Busqueda9 = rMaquinas.CONTADOR AND rContSigu.MAQUCODI IS NULL) THEN
                           --Se acumula lo que ya es en concreto utilizado en esta Fase
                           nAncho_Utilizado_Bobina_FS := nAncho_Utilizado_Bobina_FS + (rAnalisis_Corte.ANCHO_TERMINA_FASE * nCortAnte_Bobina_FS);
                           --Se acumula lo que se ha expedido en la OT en esta Fase
                           nAncho_Usado_y_Expedido_Bob_FS := nAncho_Usado_y_Expedido_Bob_FS + (rAnalisis_Corte.ANCHO_EXPEDIR_OT * nCortAnte_Bobina_FS);
                           --Se lleva el registro del material a utilizar en Fases Siguientes, para ir observando cuanto queda del mismo
                           nAncho_a_Utilizar_Bobina_FS := rAnalisis_Corte.ANCHO_UTILIZAR_OT;
                        END IF;
                        --
                        IF NVL(rAnalisis_Corte.BOBINAS_UTILIZAR_OT,0) > 0 THEN
                           nCortAnte_FS := nCortAnte_FS * rAnalisis_Corte.BOBINAS_UTILIZAR_OT;
                           --
                           IF nContador_Busqueda9 = rMaquinas.CONTADOR THEN
                              nCortAnte_Bobina_FS := 1;
                           ELSE
                              nCortAnte_Bobina_FS := nCortAnte_Bobina_FS * rAnalisis_Corte.BOBINAS_UTILIZAR_OT;
                           END IF;
                        END IF;
                        --
                        nNumero_Cortes_FS := rAnalisis_Corte.NUMERO_CORTES;
                     END IF;
                  ELSE
                     --654 Las Maquinas de Fases Siguientes Multiples deben ser del mismo tipo. Contador @1
                     P_ERRORES(vEmpresa, nNumeOtre, '654','8.10','R','E');
                  END IF;
                  -----------------------------------------------------------------------
                  --Control para deteminar los anchos en que Termina la MP 
                  -----------------------------------------------------------------------
                  rAncho_Util.Empresa := vEmpresa;
                  rAncho_Util.NumeOtre := nNumeOtre;
                  rAncho_Util.Contador := rMaquinas.CONTADOR;
                  rAncho_Util.FaseSigu := 9;
                  --
                  rAncho_Util.CONTFSMU := nContador_Busqueda9;
                  --
                  IF bExisCort THEN --Si se encontraron cortes: el ancho utilizado lo definira los parametros de los cortes
                     --La variable "nAncho_a_Utilizar_OT" Si tiene un valor es sumada a la Utilizacion ya que esto significa que Se uso pero luego no tuvo un proceso de corte
                     rAncho_Util.Ancho_Utilizado_OT := nAncho_Utilizado_OT_FS + (nAncho_a_Utilizar_OT_FS * nCortAnte_FS);
                     rAncho_Util.Ancho_Usado_y_Expedido_OT := nAncho_Usado_y_Expedido_OT_FS + (nAncho_a_Utilizar_OT_FS * nCortAnte_FS);
                     --
                     rAncho_Util.ANCHO_UTILIZADO_UTIL_BOBINA := nAncho_Utilizado_Bobina_FS + (nAncho_a_Utilizar_Bobina_FS * nCortAnte_Bobina_FS);
                     rAncho_Util.NUMECORT := nNumero_Cortes_FS;
                  ELSE --Si no se encontraron cortes: el ancho utilizado lo definira el total del Ancho del Material
                     rAncho_Util.Ancho_Utilizado_OT := NULL;
                     rAncho_Util.Ancho_Usado_y_Expedido_OT := NULL;
                     --
                     rAncho_Util.ANCHO_UTILIZADO_UTIL_BOBINA := NULL;
                  END IF;
                  --
                  T_Ancho_Util(T_Ancho_Util.COUNT + 1) := rAncho_Util;
                  -----------------------------------------------------------------------
                  --Fin Control para deteminar los anchos en que Termina la MP 
                  -----------------------------------------------------------------------
               END IF;
----------------------
--Fin Fase Siguiente 9
----------------------
-------------------
-->Fase Siguiente 10
-------------------
               IF nContador_Busqueda10 IS NOT NULL AND rContSigu.MAQUCODI IS NULL THEN
                  --Se guarda la Maquina como una de Fases Siguientes Multiples
                  P_MAQUINA_FASESIMU(vEmpresa, nNumeOtre, nContador_Busqueda_Anterior, nContador_Busqueda10);
                  --Se inicializan los valores para las Fases Siguientes Multiples
                  nAncho_Utilizado_OT_FS := nAncho_Utilizado_OT_FSI;
                  nAncho_a_Utilizar_OT_FS := NULL;
                  nAncho_Usado_y_Expedido_OT_FS := nAncho_Usado_y_Expedido_OT_FSI;
                  nAncho_Utilizado_Bobina_FS := nAncho_Utilizado_Bobina_FSI;
                  nAncho_a_Utilizar_Bobina_FS := NULL;
                  nAncho_Usado_y_Expedido_Bob_FS := nAncho_Usado_y_Expedido_Bo_FSI;
                  nCortAnte_FS := nCortAnte_FSI;
                  nCortAnte_Bobina_FS := nCortAnte_Bobina_FSI;
                  nNumero_Cortes_FS := 1;
                  --Se busca que tipo de Maquina es para verificar si es una Cortadora
                  rMaquActu.MaquCodi := NULL;
                  --
                  OPEN cMaquActu(vEmpresa, nNumeOtre, nContador_Busqueda10);
                  FETCH cMaquActu INTO rMaquActu;
                  CLOSE cMaquActu;
                  --
                  --"NO" se realiza busqueda de cContSigu porque el sistema no esta preparado para Fases siguientes despues de Fases Siguientes Multiples
                  --
                  --Verificación de Maquinas del Mismo tiempo en Fases Siguientes Multiples
                  IF rMaquActu.MAQUCODI IS NOT NULL AND 
                     (
                      (INSTR(rMaquActu.MaquCodi,'CORTADORA') != 0 AND INSTR(vMaquActu_FS,'CORTADORA') != 0) OR
                      (INSTR(rMaquActu.MaquCodi,'IMPRESORA') != 0 AND INSTR(vMaquActu_FS,'IMPRESORA') != 0) OR
                      (INSTR(rMaquActu.MaquCodi,'LAMINADORA') != 0 AND INSTR(vMaquActu_FS,'LAMINADORA') != 0) OR
                      (INSTR(rMaquActu.MaquCodi,'LAQUEADORA') != 0 AND INSTR(vMaquActu_FS,'LAQUEADORA') != 0)
                     )
                  THEN
                     --Si interviene una cortadora el ancho utilizado lo definira los parametros de los cortes
                     IF INSTR(rMaquActu.MaquCodi,'CORTADORA') != 0 THEN --Si es cortadora
                        rAnalisis_Corte.ANCHO_TERMINA_FASE := NULL;
                        rAnalisis_Corte.ANCHO_UTILIZAR_OT := NULL;
                        rAnalisis_Corte.ANCHO_EXPEDIR_OT := NULL;
                        rAnalisis_Corte.NUMERO_CORTES := NULL;
                        --
                        OPEN cAnalisis_Corte_1(nContador_Busqueda10);
                        FETCH cAnalisis_Corte_1 INTO rAnalisis_Corte;
                        CLOSE cAnalisis_Corte_1;
                        --
                        IF rAnalisis_Corte.ANCHO_DEFINIDO IS NULL THEN
                           OPEN cAnalisis_Corte_3;
                           FETCH cAnalisis_Corte_3 INTO rAnalisis_Corte;
                           CLOSE cAnalisis_Corte_3;
                        END IF;
                        --Se acumula lo que ya es en concreto utilizado en esta Fase
                        nAncho_Utilizado_OT_FS := nAncho_Utilizado_OT_FS + (rAnalisis_Corte.ANCHO_TERMINA_FASE * nCortAnte_FS);
                        --Se acumula lo que se ha expedido en la OT en esta Fase
                        nAncho_Usado_y_Expedido_OT_FS := nAncho_Usado_y_Expedido_OT_FS + (rAnalisis_Corte.ANCHO_EXPEDIR_OT * nCortAnte_FS);
                        --Se lleva el registro del material a utilizar en Fases Siguientes, para ir observando cuanto queda del mismo
                        nAncho_a_Utilizar_OT_FS := rAnalisis_Corte.ANCHO_UTILIZAR_OT;
                        --Si se esta analizando la Maquina Actual
                        IF nContador_Busqueda10 > rMaquinas.CONTADOR OR (nContador_Busqueda10 = rMaquinas.CONTADOR AND rContSigu.MAQUCODI IS NULL) THEN
                           --Se acumula lo que ya es en concreto utilizado en esta Fase
                           nAncho_Utilizado_Bobina_FS := nAncho_Utilizado_Bobina_FS + (rAnalisis_Corte.ANCHO_TERMINA_FASE * nCortAnte_Bobina_FS);
                           --Se acumula lo que se ha expedido en la OT en esta Fase
                           nAncho_Usado_y_Expedido_Bob_FS := nAncho_Usado_y_Expedido_Bob_FS + (rAnalisis_Corte.ANCHO_EXPEDIR_OT * nCortAnte_Bobina_FS);
                           --Se lleva el registro del material a utilizar en Fases Siguientes, para ir observando cuanto queda del mismo
                           nAncho_a_Utilizar_Bobina_FS := rAnalisis_Corte.ANCHO_UTILIZAR_OT;
                        END IF;
                        --
                        IF NVL(rAnalisis_Corte.BOBINAS_UTILIZAR_OT,0) > 0 THEN
                           nCortAnte_FS := nCortAnte_FS * rAnalisis_Corte.BOBINAS_UTILIZAR_OT;
                           --
                           IF nContador_Busqueda10 = rMaquinas.CONTADOR THEN
                              nCortAnte_Bobina_FS := 1;
                           ELSE
                              nCortAnte_Bobina_FS := nCortAnte_Bobina_FS * rAnalisis_Corte.BOBINAS_UTILIZAR_OT;
                           END IF;
                        END IF;
                        --
                        nNumero_Cortes_FS := rAnalisis_Corte.NUMERO_CORTES;
                     END IF;
                  ELSE
                     --654 Las Maquinas de Fases Siguientes Multiples deben ser del mismo tipo. Contador @1
                     P_ERRORES(vEmpresa, nNumeOtre, '654','8.11','R','E');
                  END IF;
                  -----------------------------------------------------------------------
                  --Control para deteminar los anchos en que Termina la MP 
                  -----------------------------------------------------------------------
                  rAncho_Util.Empresa := vEmpresa;
                  rAncho_Util.NumeOtre := nNumeOtre;
                  rAncho_Util.Contador := rMaquinas.CONTADOR;
                  rAncho_Util.FaseSigu := 10;
                  --
                  rAncho_Util.CONTFSMU := nContador_Busqueda10;
                  --
                  IF bExisCort THEN --Si se encontraron cortes: el ancho utilizado lo definira los parametros de los cortes
                     --La variable "nAncho_a_Utilizar_OT" Si tiene un valor es sumada a la Utilizacion ya que esto significa que Se uso pero luego no tuvo un proceso de corte
                     rAncho_Util.Ancho_Utilizado_OT := nAncho_Utilizado_OT_FS + (nAncho_a_Utilizar_OT_FS * nCortAnte_FS);
                     rAncho_Util.Ancho_Usado_y_Expedido_OT := nAncho_Usado_y_Expedido_OT_FS + (nAncho_a_Utilizar_OT_FS * nCortAnte_FS);
                     --
                     rAncho_Util.ANCHO_UTILIZADO_UTIL_BOBINA := nAncho_Utilizado_Bobina_FS + (nAncho_a_Utilizar_Bobina_FS * nCortAnte_Bobina_FS);
                     rAncho_Util.NUMECORT := nNumero_Cortes_FS;
                  ELSE --Si no se encontraron cortes: el ancho utilizado lo definira el total del Ancho del Material
                     rAncho_Util.Ancho_Utilizado_OT := NULL;
                     rAncho_Util.Ancho_Usado_y_Expedido_OT := NULL;
                     --
                     rAncho_Util.ANCHO_UTILIZADO_UTIL_BOBINA := NULL;
                  END IF;
                  --
                  T_Ancho_Util(T_Ancho_Util.COUNT + 1) := rAncho_Util;
                  -----------------------------------------------------------------------
                  --Fin Control para deteminar los anchos en que Termina la MP 
                  -----------------------------------------------------------------------
               END IF;
----------------------
--Fin Fase Siguiente 10
----------------------
               --
               IF rContSigu.MAQUCODI IS NOT NULL THEN
                  --Se busca por si tiene mas maquinas configuradas como Siguientes
                  rContSiguN.MAQUCODI := NULL;
                  rContSiguN.CONTADOR := NULL;
                  --
                  OPEN cContSigu(vEmpresa, nNumeOtre, nContador_Busqueda, 2);
                  FETCH cContSigu INTO rContSiguN;
                  CLOSE cContSigu;
                  --
                  IF rContSiguN.CONTADOR IS NOT NULL THEN
                     IF nContador_Busqueda2 IS NULL THEN
                        nContador_Busqueda2 := rContSiguN.CONTADOR;
                        --Si se encuentran Fases Siguientes se guarda los calculos realizados (ACUMULATIVOS) hasta el momento para computarlos correctamente en la siguiente iteraccion
                        nAncho_Utilizado_OT_FSI := nAncho_Utilizado_OT;
                        --Se acumula lo que se ha expedido en la OT en esta Fase
                        nAncho_Usado_y_Expedido_OT_FSI := nAncho_Usado_y_Expedido_OT;
                        --Se acumula lo que ya es en concreto utilizado en esta Fase
                        nAncho_Utilizado_Bobina_FSI := nAncho_Utilizado_Bobina;
                        --Se acumula lo que se ha expedido en la OT en esta Fase
                        nAncho_Usado_y_Expedido_Bo_FSI := nAncho_Usado_y_Expedido_Bobina;
                        --
                        nCortAnte_FSI := nCortAnte;
                        --
                        nCortAnte_Bobina_FSI := nCortAnte_Bobina;
                     ELSE
                        --653 Se ha detectado que existen Fases Siguientes despues de Fases Siguientes Multiples. El sistema no esta preparado para este tratamiento. Contador: @1
                        P_ERRORES(vEmpresa, nNumeOtre, '653','8.4','R','E');
                     END IF;
                  END IF;
                  --
                  IF nContador_Busqueda3 IS NULL THEN
                     rContSiguN.MAQUCODI := NULL;
                     rContSiguN.CONTADOR := NULL;
                     --
                     OPEN cContSigu(vEmpresa, nNumeOtre, nContador_Busqueda, 3);
                     FETCH cContSigu INTO rContSiguN;
                     CLOSE cContSigu;
                     --
                     IF rContSiguN.CONTADOR IS NOT NULL THEN 
                        nContador_Busqueda3 := rContSiguN.CONTADOR;
                     END IF;
                  END IF;
                  --
                  IF nContador_Busqueda4 IS NULL THEN
                     rContSiguN.MAQUCODI := NULL;
                     rContSiguN.CONTADOR := NULL;
                     --
                     OPEN cContSigu(vEmpresa, nNumeOtre, nContador_Busqueda, 4);
                     FETCH cContSigu INTO rContSiguN;
                     CLOSE cContSigu;
                     --
                     IF rContSiguN.CONTADOR IS NOT NULL THEN 
--dbms_output.put_line('ASIGNACION DE nContador_Busqueda4: cContSigu('||vEmpresa||', '||nNumeOtre||', '||nContador_Busqueda||', 4 := '||rContSigu.CONTADOR);
                        nContador_Busqueda4 := rContSiguN.CONTADOR;
                     END IF;
                  END IF;
                  --
                  IF nContador_Busqueda5 IS NULL THEN
                     rContSiguN.MAQUCODI := NULL;
                     rContSiguN.CONTADOR := NULL;
                     --
                     OPEN cContSigu(vEmpresa, nNumeOtre, nContador_Busqueda, 5);
                     FETCH cContSigu INTO rContSiguN;
                     CLOSE cContSigu;
                     --
                     IF rContSiguN.CONTADOR IS NOT NULL THEN 
                        nContador_Busqueda5 := rContSiguN.CONTADOR;
                     END IF;
                  END IF;
                  --
                  IF nContador_Busqueda6 IS NULL THEN
                     rContSiguN.MAQUCODI := NULL;
                     rContSiguN.CONTADOR := NULL;
                     --
                     OPEN cContSigu(vEmpresa, nNumeOtre, nContador_Busqueda, 6);
                     FETCH cContSigu INTO rContSiguN;
                     CLOSE cContSigu;
                     --
                     IF rContSiguN.CONTADOR IS NOT NULL THEN 
                        nContador_Busqueda6 := rContSiguN.CONTADOR;
                     END IF;
                  END IF;
                  --
                  IF nContador_Busqueda7 IS NULL THEN
                     rContSiguN.MAQUCODI := NULL;
                     rContSiguN.CONTADOR := NULL;
                     --
                     OPEN cContSigu(vEmpresa, nNumeOtre, nContador_Busqueda, 7);
                     FETCH cContSigu INTO rContSiguN;
                     CLOSE cContSigu;
                     --
                     IF rContSiguN.CONTADOR IS NOT NULL THEN 
                        nContador_Busqueda7 := rContSiguN.CONTADOR;
                     END IF;
                  END IF;
                  --
                  IF nContador_Busqueda8 IS NULL THEN
                     rContSiguN.MAQUCODI := NULL;
                     rContSiguN.CONTADOR := NULL;
                     --
                     OPEN cContSigu(vEmpresa, nNumeOtre, nContador_Busqueda, 8);
                     FETCH cContSigu INTO rContSiguN;
                     CLOSE cContSigu;
                     --
                     IF rContSiguN.CONTADOR IS NOT NULL THEN 
                        nContador_Busqueda8 := rContSiguN.CONTADOR;
                     END IF;
                  END IF;
                  --
                  IF nContador_Busqueda9 IS NULL THEN
                     rContSiguN.MAQUCODI := NULL;
                     rContSiguN.CONTADOR := NULL;
                     --
                     OPEN cContSigu(vEmpresa, nNumeOtre, nContador_Busqueda, 9);
                     FETCH cContSigu INTO rContSiguN;
                     CLOSE cContSigu;
                     --
                     IF rContSiguN.CONTADOR IS NOT NULL THEN 
                        nContador_Busqueda9 := rContSiguN.CONTADOR;
                     END IF;
                  END IF;
                  --
                  IF nContador_Busqueda10 IS NULL THEN
                     rContSiguN.MAQUCODI := NULL;
                     rContSiguN.CONTADOR := NULL;
                     --
                     OPEN cContSigu(vEmpresa, nNumeOtre, nContador_Busqueda, 10);
                     FETCH cContSigu INTO rContSiguN;
                     CLOSE cContSigu;
                     --
                     IF rContSiguN.CONTADOR IS NOT NULL THEN 
                        nContador_Busqueda10 := rContSiguN.CONTADOR;
                     END IF;
                  END IF;
                  --Se asigna el anteriror (Se utiliza para establecer maquinas que estan Configuradas como Fases Siguientes Multiples
                  nContador_Busqueda_Anterior := nContador_Busqueda;
                  --
                  nContador_Busqueda := rContSigu.CONTADOR;
               ELSE
                  EXIT WHEN TRUE;
               END IF;
            ELSE
               --Error
               EXIT WHEN TRUE;
            END IF;
         END LOOP;
         -----------------------------------------------------------------------
         --Control para deteminar los anchos en que Termina la MP 
         -----------------------------------------------------------------------
         rAncho_Util.Empresa := vEmpresa;
         rAncho_Util.NumeOtre := nNumeOtre;
         rAncho_Util.Contador := rMaquinas.CONTADOR;
         rAncho_Util.FaseSigu := 1;
         rAncho_Util.PRE_CORTE := vPre_Corte;
         --
         rAncho_Util.CONTFSMU := nContador_Busqueda;
         --
--dbms_output.put_line(vEmpresa||'-'||nNumeOtre||'-'||rMaquinas.CONTADOR);
         IF bExisCort THEN --Si se encontraron cortes: el ancho utilizado lo definira los parametros de los cortes
            --La variable "nAncho_a_Utilizar_OT" Si tiene un valor es sumada a la Utilizacion ya que esto significa que Se uso pero luego no tuvo un proceso de corte
--dbms_output.put_line('rAncho_Util.Ancho_Utilizado_OT := '||nAncho_Utilizado_OT||' + ('||nAncho_a_Utilizar_OT||' * '||nCortAnte||')');
            rAncho_Util.Ancho_Utilizado_OT := nAncho_Utilizado_OT + (nAncho_a_Utilizar_OT * nCortAnte);
--dbms_output.put_line('rAncho_Util.Ancho_Usado_y_Expedido_OT := '||nAncho_Usado_y_Expedido_OT||' + '||nAncho_a_Utilizar_OT);
            rAncho_Util.Ancho_Usado_y_Expedido_OT := nAncho_Usado_y_Expedido_OT + (nAncho_a_Utilizar_OT * nCortAnte);
            --
--dbms_output.put_line('rAncho_Util.ANCHO_UTILIZADO_UTIL_BOBINA := '||nAncho_Utilizado_Bobina||' + ('||nAncho_a_Utilizar_Bobina||' * '||nCortAnte_Bobina||')');
            rAncho_Util.ANCHO_UTILIZADO_UTIL_BOBINA := nAncho_Utilizado_Bobina + (nAncho_a_Utilizar_Bobina * nCortAnte_Bobina);
            --
            --rAncho_Util.MM_MERMA_DEFINIDA_CORTADORA := nDesbarbe_Definido;
--dbms_output.put_line('rAncho_Util.nNumero_Cortes-> '||rAncho_Util.Contador||': '||nNumero_Cortes);
            rAncho_Util.NUMECORT := nNumero_Cortes;
         ELSE --Si no se encontraron cortes: el ancho utilizado lo definira el total del Ancho del Material
            rAncho_Util.Ancho_Utilizado_OT := NULL;
            rAncho_Util.Ancho_Usado_y_Expedido_OT := NULL;
            --
            rAncho_Util.ANCHO_UTILIZADO_UTIL_BOBINA := NULL;
         END IF;
--dbms_output.put_line('rAncho_Util := '||rAncho_Util.Contador||' - '||rAncho_Util.Ancho_Utilizado_OT||' - '||rAncho_Util.Ancho_Usado_y_Expedido_OT||' - Bobina: '||rAncho_Util.ANCHO_UTILIZADO_UTIL_BOBINA);
         --
         T_Ancho_Util(T_Ancho_Util.COUNT + 1) := rAncho_Util;--5589
         -----------------------------------------------------------------------
         --Fin Control para deteminar los anchos en que Termina la MP 
         -----------------------------------------------------------------------
      END LOOP;
   END;--P_Ancho_Util
   --
   PROCEDURE P_CONSUMO_MATERIALES(vEmpresa PRD_BOBIMAQU.EMPRESA%TYPE, nNumeOtre PRD_BOBIMAQU.NUMEOTRE%TYPE) IS
      --Establece cuantas Maquinas se utilizaron en esa Fase Secuencia, para el tema de Mermas en Pasadas
      CURSOR cMaquinas_Utilizadas(nContador PRD_PASAMAQU.CONTADOR%TYPE) IS
         SELECT DISTINCT MAQUCODI FROM PRD_PASAMAQU
            WHERE EMPRESA = vEmpresa
              AND NUMEOTRE = nNumeOtre
              AND CONTADOR = nContador;
      --Establece cuantas Maquinas se utilizaron en esa Fase Secuencia, para el tema de Mermas en Eventos
      CURSOR cMaquinas_Utilizadas_EvenMerm(nContador PRD_PASAMAQU.CONTADOR%TYPE, vEvenCodi PRD_PRMAEVEN.EVENCODI%TYPE) IS
         SELECT DISTINCT MAQUCODI FROM PRD_MEFAEVEN
            WHERE EMPRESA = vEmpresa
              AND NUMEOTRE = nNumeOtre
              AND CAMPNU01 = nContador
              AND EVENCODI = vEvenCodi;
      --Establece cuantas Maquinas se utilizaron en esa Fase Secuencia, para el tema de Eventos
      CURSOR cMaquinas_Utilizadas_Eventos(vEvenCodi PRD_PRMAEVCO.EVENCODI%TYPE, nContMaqu PRD_PRMAEVCO.CONTMAQU%TYPE) IS
         SELECT DISTINCT MAQUCODI FROM PRD_PRMAEVCO
            WHERE EMPRESA = vEmpresa
              AND NUMEOTRE = nNumeOtre
              AND EVENCODI = vEvenCodi
              AND CONTMAQU = nContMaqu;
      --Cuenta los eventos de esa Maquina
      CURSOR cCuenta_Eventos(vMaquTipo PRD_PRMAEVCO.MAQUTIPO%TYPE, vMaquCodi PRD_PRMAEVCO.MAQUCODI%TYPE, vEvenCodi PRD_PRMAEVCO.EVENCODI%TYPE, nContMaqu PRD_PRMAEVCO.CONTMAQU%TYPE) IS
         SELECT COUNT(*) NUMERO FROM PRD_PRMAEVCO
            WHERE EMPRESA = vEmpresa
              AND MAQUTIPO = vMaquTipo
              AND MAQUCODI = vMaquCodi
              AND NUMEOTRE = nNumeOtre
              AND EVENCODI = vEvenCodi
              AND CONTMAQU = nContMaqu;
      --
      CURSOR cCaracteristica_Maquina(vMerma VARCHAR2,vMaquCodi PRD_MAQURUTA.MAQUCODI%TYPE, vLinea GNR_LINEAS.LINEA%TYPE, nPasada NUMBER) IS
         SELECT P_UTILIDAD.F_ValoCampo (VALOR,'CARACTERISTICA') CARACTERISTICA, 
                P_UTILIDAD.F_ValoCampo (VALOR,'CARACTERISTICA2') CARACTERISTICA2, 
                P_UTILIDAD.F_ValoCampo (VALOR,'EVENCODI') EVENCODI, 
                P_UTILIDAD.F_ValoCampo (VALOR,'LINEA') LINEA, 
                P_UTILIDAD.F_ValoCampo (VALOR,'PASADA') PASADA, 
                P_UTILIDAD.F_ValoCampo (VALOR,'MATERIAL') MATERIAL, 
                P_UTILIDAD.F_ValoCampo (VALOR,'CAPTACION') CAPTACION 
                FROM VALORES_LISTA
            WHERE CODIGO = 'PRD_EQCAMERM'
              AND P_UTILIDAD.F_ValoCampo (VALOR,'MERMA') = vMerma
              AND P_UTILIDAD.F_ValoCampo (VALOR,'MAQUINA') = SUBSTR(vMaquCodi,1,INSTR(vMaquCodi,' ')-1)
              AND (vLinea IS NULL OR (vLinea IS NOT NULL AND P_UTILIDAD.F_ValoCampo (VALOR,'LINEA') = vLinea))
              AND (nPasada IS NULL OR (nPasada IS NOT NULL AND P_UTILIDAD.F_ValoCampo (VALOR,'PASADA') = nPasada));
      --
      rCaracteristica_Maquina_CoefCo cCaracteristica_Maquina%ROWTYPE;
      rCaracteristica_Maquina_CoefAj cCaracteristica_Maquina%ROWTYPE;
      --
      nCoefCorr NUMBER;
      nMermMacu NUMBER;
      nColoMaxi NUMBER;
      nMermInse NUMBER;
      nMLMuestra NUMBER;
      nNuMuestra NUMBER;
      nMTMuestra NUMBER;
      nTintForm NUMBER;
      nAjuPres NUMBER;
      nAjuRegi NUMBER;
      nCoefAjus NUMBER;
      --
      CURSOR cPRD_MAQUCARA(vMaquTipo PRD_MAQURUTA.MAQUTIPO%TYPE, vMaquCodi PRD_MAQURUTA.MAQUCODI%TYPE, vCaracter PRD_MAQUCARA.CARACTER%TYPE) IS
         SELECT VALOR FROM PRD_MAQUCARA
         WHERE EMPRESA = vEmpresa
           AND MAQUTIPO = vMaquTipo
           AND MAQUCODI = vMaquCodi
           AND CARACTER = vCaracter;
      --Contador de Tintas Formuladas
      CURSOR cTintForm(nContador PRD_PASAMAQU.CONTADOR%TYPE) IS
         SELECT SUM(NUMERO) NUMERO FROM
         (
            SELECT COUNT(*) NUMERO
            FROM (SELECT MR.EMPRESA, MR.NUMEOTRE, MR.CONTADOR, MR.RECUCODI, MR.MATECODE, MR.RECUTIPO FROM PRD_RECUOTRF MR
                  WHERE NOT EXISTS (SELECT 'X' FROM PRD_HCABEOTR OTC WHERE OTC.EMPRESA = MR.EMPRESA AND OTC.NUMEOTRE = MR.NUMEOTRE)
                  UNION
                  SELECT MR.EMPRESA, MR.NUMEOTRE, MR.CONTADOR, MR.RECUCODI, MR.MATECODE, MR.RECUTIPO FROM PRD_HIREOTRF MR) RU,
                 (SELECT MR.EMPRESA, MR.NUMEOTRE, MR.POSICION, MR.COLOR FROM PRD_HICOOTRE MR
                  WHERE NOT EXISTS (SELECT 'X' FROM PRD_HCABEOTR OTC WHERE OTC.EMPRESA = MR.EMPRESA AND OTC.NUMEOTRE = MR.NUMEOTRE)
                  UNION
                  SELECT MR.EMPRESA, MR.NUMEOTRE, MR.POSICION, MR.COLOR FROM PRD_HICOHOTR MR) HC,
                 PRI_FORMTINT FT
            WHERE RU.EMPRESA = HC.EMPRESA
              AND RU.NUMEOTRE = HC.NUMEOTRE
              AND RU.RECUCODI = HC.POSICION||'-'||HC.COLOR
              AND FT.EMPRESA = RU.EMPRESA 
              AND FT.IM_IDENT = RU.MATECODE
              AND RU.EMPRESA = vEmpresa
              AND RU.NUMEOTRE = nNumeOtre
              AND RU.CONTADOR = nContador
              AND RU.RECUTIPO = 'J'
              AND FT.FORMULADA = 'S'
         );
      --
      nMaquCara_M1 NUMBER;
      nMaquCara_M2 NUMBER;
      nMerma_Ajuste_M1 NUMBER;
      nMerma_Ajuste_M2 NUMBER;
      nMerma_Ajuste_M1_E NUMBER;
      nMerma_Ajuste_M2_E NUMBER;
      nMerma_CambBobi_M1 NUMBER;
      nMerma_CambBobi_M2 NUMBER;
      nMerma_CambBobi_M1_E NUMBER;
      nMerma_CambBobi_M2_E NUMBER;
      nMerma_Picos_M1 NUMBER;
      nMerma_Picos_M2 NUMBER;
      nMerma_Picos_M1_E NUMBER;
      nMerma_Picos_M2_E NUMBER;
      nMerma_Enhebrado_M1 NUMBER;
      nMerma_Enhebrado_M2 NUMBER;
      nMerma_Enhebrado_M1_E NUMBER;
      nMerma_Enhebrado_M2_E NUMBER;
      nMerma_Ajuste_Enhebrado_M1 NUMBER;
      nMerma_Ajuste_Enhebrado_M2 NUMBER;
      bCaAuEnhe BOOLEAN; --Establece si la Máquina tiene captación automática de Enhebrado
		bEjecAjEh BOOLEAN; --Establece si la Máquina tiene captación automática de Enhebrado y si se procesa
      nContEven NUMBER;
      --
      CURSOR cPRD_MAQUEVEN(vMaquTipo PRD_MAQURUTA.MAQUTIPO%TYPE, vMaquCodi PRD_MAQURUTA.MAQUCODI%TYPE, vEvenCodi PRD_MAQUEVEN.EVENCODI%TYPE) IS
         SELECT P_UTILIDAD.F_VALOCAMPO(L.VALOR,'VALOR') VALOR, ME.ORVAREAL  FROM PRD_MAQUEVEN ME, VALORES_LISTA L
	      WHERE L.CODIGO = 'PRD_ORVARECM'
	      AND P_UTILIDAD.F_VALOCAMPO(L.VALOR,'TIPO') = ME.ORVAREAL
           AND ME.EMPRESA = vEmpresa
           AND ME.MAQUTIPO = vMaquTipo
           AND ME.MAQUCODI = vMaquCodi
           AND ME.EVENTIPO = vTievMaqu
           AND ME.EVENCODI = vEvenCodi
           AND ME.INTRMANU = 'S';
      --
      rPRD_MAQUEVEN cPRD_MAQUEVEN%ROWTYPE;
      --
      CURSOR cMERMA(nContador PRD_PASAMAQU.CONTADOR%TYPE, vMaquTipo PRD_MAQURUTA.MAQUTIPO%TYPE, vMaquCodi PRD_MAQURUTA.MAQUCODI%TYPE, vEvenCodi PRD_MAQUEVEN.EVENCODI%TYPE, vOrvaReal PRD_MEFAEVEN.ORVAREAL%TYPE) IS
         SELECT CAMPVA02 TIP_ARTI, CAMPVA03 COD_ARTI, CAMPVA04 LOTE,
                CAMPVA05 EMPRBOBI, CAMPVA06 CONTBOBI, CAMPVA07 COBOBOBI, CAMPVA08 NUOTBOBI,
                CAM2VA02 TIP_ARTI2, CAM2VA03 COD_ARTI2, CAM2VA04 LOTE2,
                CAM2VA05 EMPRBOBI2, CAM2VA06 CONTBOBI2, CAM2VA07 COBOBOBI2, CAM2VA08 NUOTBOBI2,
                SUM(NVL(M.CAMPNU09,0)) MERMA_M1, SUM(NVL(M.CAM2NU09,0)) MERMA_M2 FROM PRD_MEFAEVEN M
         WHERE M.EMPRESA = vEmpresa
           AND M.MAQUTIPO = vMaquTipo
           AND M.NUMEOTRE = nNumeOtre
           AND M.MAQUCODI = vMaquCodi
           AND M.EVENCODI = vEvenCodi
           AND M.CAMPNU01 = nContador
           AND M.ORVAREAL = vOrvaReal
         GROUP BY CAMPVA02, CAMPVA03, CAMPVA04,
                  CAMPVA05, CAMPVA06, CAMPVA07, CAMPVA08,
                  CAM2VA02, CAM2VA03, CAM2VA04,
                  CAM2VA05, CAM2VA06, CAM2VA07, CAM2VA08;
      --Busca la Maquina Anterior 
      CURSOR cVeriMaan(nContador PRD_MAQURUTA.CONTADOR%TYPE) IS
         SELECT LO.FASE, LO.SECUENCI, LO.COD_ARES, MRAC.CONTADOR, MRAC.MAQUCODI
         FROM FIC_LINEOTRE LO, PRD_MAQURUTA MRAN, PRD_MAQURUTA MRAC
         WHERE LO.EMPRESA = MRAN.EMPRESA
           AND LO.NUMERO = MRAN.NUMEOTRE
           AND LO.EMPRESA = MRAC.EMPRESA
           AND LO.NUMERO = MRAC.NUMEOTRE
           AND MRAC.FASESEQU = (LO.FASE * 100) + LO.SECUENCI
           AND LO.TIP_ARES = vTipoRecu
           AND LO.COD_ARES NOT LIKE 'MONTADOR%'
           AND MRAN.EMPRESA = vEmpresa
           AND MRAN.NUMEOTRE = nNumeOtre
           AND MRAN.CONTADOR = nContador
           AND (
                (MRAN.FASESEQU BETWEEN LO.FASESI01 * 100 AND ((LO.FASESI01 + 1) * 100) - 1 AND LO.FASE != LO.FASESI01) OR
                (MRAN.FASESEQU BETWEEN LO.FASESI02 * 100 AND ((LO.FASESI02 + 1) * 100) - 1 AND LO.FASE != LO.FASESI02) OR
                (MRAN.FASESEQU BETWEEN LO.FASESI03 * 100 AND ((LO.FASESI03 + 1) * 100) - 1 AND LO.FASE != LO.FASESI03) OR
                (MRAN.FASESEQU BETWEEN LO.FASESI04 * 100 AND ((LO.FASESI04 + 1) * 100) - 1 AND LO.FASE != LO.FASESI04) OR
                (MRAN.FASESEQU BETWEEN LO.FASESI05 * 100 AND ((LO.FASESI05 + 1) * 100) - 1 AND LO.FASE != LO.FASESI05) OR
                (MRAN.FASESEQU BETWEEN LO.FASESI06 * 100 AND ((LO.FASESI06 + 1) * 100) - 1 AND LO.FASE != LO.FASESI06) OR
                (MRAN.FASESEQU BETWEEN LO.FASESI07 * 100 AND ((LO.FASESI07 + 1) * 100) - 1 AND LO.FASE != LO.FASESI07) OR
                (MRAN.FASESEQU BETWEEN LO.FASESI08 * 100 AND ((LO.FASESI08 + 1) * 100) - 1 AND LO.FASE != LO.FASESI08) OR
                (MRAN.FASESEQU BETWEEN LO.FASESI09 * 100 AND ((LO.FASESI09 + 1) * 100) - 1 AND LO.FASE != LO.FASESI09) OR
                (MRAN.FASESEQU BETWEEN LO.FASESI10 * 100 AND ((LO.FASESI10 + 1) * 100) - 1 AND LO.FASE != LO.FASESI10)
               )
         ORDER BY CONTADOR;
      --
      rVeriMaAN cVeriMaAN%ROWTYPE;
      --
      nNumePasa NUMBER;
      vLinea GNR_LINEAS.LINEA%TYPE;
      --
      CURSOR cNumeMate(nContador PRD_MAQURUTA.CONTADOR%TYPE) IS--3021
         SELECT MAX(CONTMATE) NUMEMATE FROM PRD_MAPAMAQU
            WHERE EMPRESA = vEmpresa
              AND NUMEOTRE = nNumeOtre
              AND CONTADOR = nContador;
      --
      nNumeMate PRD_MAPAMAQU.CONTMATE%TYPE;
      nContMate PRD_MAPAMAQU.CONTMATE%TYPE;
      --
      CURSOR cConsumos(nContador PRD_MAQURUTA.CONTADOR%TYPE) IS--3030
         SELECT CONTPASA, CONTMATE, CANTPROD, CANTCONS, CANTAJUS, MARCPASA, MAQUCODI, TIP_ARTI, COD_ARTI, LOTE, EMPRBOBI, NUOTBOBI, CONTBOBI, COBOBOBI, COBOGENE 
         FROM PRD_MAPAMAQU
            WHERE EMPRESA = vEmpresa
              AND NUMEOTRE = nNumeOtre
              AND CONTADOR = nContador
              AND MARCPASA = 'N' --Se establece esto por que solo vamos a tratar consumos, lo producido se realizará con las Bobinas
         ORDER BY CONTPASA, CONTMATE;
      --
      rConsumos cConsumos%ROWTYPE;
		--COPI 04-02-2013
		--Maquinas lanzadas a OTRF
		CURSOR cMaquinas(vEmpresa FIC_CABEOTRE.EMPRESA%TYPE, nNumeOtre FIC_CABEOTRE.NUMERO%TYPE) IS
			SELECT M.CONTADOR, M.MAQUTIPO, M.MAQUCODI, M.FASESEQU FROM PRD_MAQURUTA M
			  WHERE NOT EXISTS (SELECT 'X' FROM PRD_HCABEOTR OTC WHERE OTC.EMPRESA = M.EMPRESA AND OTC.NUMEOTRE = M.NUMEOTRE)
				AND M.EMPRESA = vEmpresa
				AND M.NUMEOTRE = nNumeOtre
			UNION
			SELECT M.CONTADOR, M.MAQUTIPO, M.MAQUCODI, FASESEQU FROM PRD_HMAQURUT M
			  WHERE M.EMPRESA = vEmpresa
				AND M.NUMEOTRE = nNumeOtre
			ORDER BY CONTADOR;
		--MOVI 04-02-2013
		--Cortes
		CURSOR cCortes(nContador PRD_MAQURUTA.CONTADOR%TYPE, nCoboPadr PRD_LIBOCORT.COBOPADR%TYPE) IS
			SELECT CONTBOBI, NUMECORT FROM PRD_LIBOCORT
			 WHERE EMPRESA = vEmpresa
				AND NUMEOTRE = nNumeOtre
				AND CONTADOR = nContador
				AND COBOPADR = nCoboPadr;
		--
		CURSOR cANE_MER_MATERIAL_OT_SP IS
			SELECT EMPRESA,NUMEOTRE,CONTADOR,CONTMATE,CONTMAEV,IDENTIFICADOR,TIP_ARTI,COD_ARTI,LOTE,CANTCONS,CANTCONS_BOBINAS,CANTPROD,CANTAJUS,MERMENHE,MERMAJUS,MERMCABO,MERMPICO,MERMTIRA,MERMSANE,
					CONTFSMU_01,CONTFSMU_02,CONTFSMU_03,CONTFSMU_04,CONTFSMU_05,CONTFSMU_06,CONTFSMU_07,CONTFSMU_08,CONTFSMU_09,CONTFSMU_10,
					CANTFSMU_01,CANTFSMU_02,CANTFSMU_03,CANTFSMU_04,CANTFSMU_05,CANTFSMU_06,CANTFSMU_07,CANTFSMU_08,CANTFSMU_09,CANTFSMU_10,
					CATOFSMU,MM_MERMPLAN_01,MM_MERMPLAN_02,MM_MERMPLAN_03,MM_MERMPLAN_04,MM_MERMPLAN_05,MM_MERMPLAN_06,MM_MERMPLAN_07,MM_MERMPLAN_08,MM_MERMPLAN_09,MM_MERMPLAN_10,
					MM_MERMPLAN,MERMPLAN,
					MM_MERMPLAN_EXESO_01,MM_MERMPLAN_EXESO_02,MM_MERMPLAN_EXESO_03,MM_MERMPLAN_EXESO_04,MM_MERMPLAN_EXESO_05,MM_MERMPLAN_EXESO_06,MM_MERMPLAN_EXESO_07,MM_MERMPLAN_EXESO_08,MM_MERMPLAN_EXESO_09,MM_MERMPLAN_EXESO_10,
					MM_MERMPLAN_EXESO,MERMPLAN_EXESO,
					PRE_CORTE,
					NUMECORT_01,NUMECORT_02,NUMECORT_03,NUMECORT_04,NUMECORT_05,NUMECORT_06,NUMECORT_07,NUMECORT_08,NUMECORT_09,NUMECORT_10,
					NUMECORT,
					MM_MERMPRCO_01,MM_MERMPRCO_02,MM_MERMPRCO_03,MM_MERMPRCO_04,MM_MERMPRCO_05,MM_MERMPRCO_06,MM_MERMPRCO_07,MM_MERMPRCO_08,MM_MERMPRCO_09,MM_MERMPRCO_10,
					MM_MERMPRCO,MERMPRCO,
					CANTCONS_E,MERMENHE_E,MERMAJUS_E,MERMCABO_E,MERMPICO_E,MERMTIRA_E,MERMSANE_E,MM_MERMPLAN_E,MERMPLAN_E,
					ANCHO,
					ANCHO_BUENO_OT_01,ANCHO_BUENO_TOTAL_01,ANCHO_BUENO_OT_02,ANCHO_BUENO_TOTAL_02,ANCHO_BUENO_OT_03,ANCHO_BUENO_TOTAL_03,ANCHO_BUENO_OT_04,ANCHO_BUENO_TOTAL_04,ANCHO_BUENO_OT_05,ANCHO_BUENO_TOTAL_05,
					ANCHO_BUENO_OT_06,ANCHO_BUENO_TOTAL_06,ANCHO_BUENO_OT_07,ANCHO_BUENO_TOTAL_07,ANCHO_BUENO_OT_08,ANCHO_BUENO_TOTAL_08,ANCHO_BUENO_OT_09,ANCHO_BUENO_TOTAL_09,ANCHO_BUENO_OT_10,ANCHO_BUENO_TOTAL_10,
					ANCHO_BUENO_TOTAL,ANCHO_BUENO_OT,
					CANTIDAD_CONSUMIDA_FINAL_01,CANTIDAD_CONSUMIDA_FINAL_02,CANTIDAD_CONSUMIDA_FINAL_03,CANTIDAD_CONSUMIDA_FINAL_04,CANTIDAD_CONSUMIDA_FINAL_05,CANTIDAD_CONSUMIDA_FINAL_06,CANTIDAD_CONSUMIDA_FINAL_07,CANTIDAD_CONSUMIDA_FINAL_08,CANTIDAD_CONSUMIDA_FINAL_09,CANTIDAD_CONSUMIDA_FINAL_10,
					CANTIDAD_CONSUMIDA_FINAL_TOTAL,
					PRECIO_ML,PRECIO_ML_E,FACTOR_CONVERSION_M2_KG
			FROM ANALESTA.ANE_MER_MATERIAL_OT
				WHERE EMPRESA = vEmpresa
              AND NUMEOTRE = nNumeOtre
              AND TIP_ARTI != 'RE' 
              AND (PRECIO_ML IS NULL OR ANCHO IS NULL OR FACTOR_CONVERSION_M2_KG IS NULL);
		--
--*****FUNCIONES
--
   BEGIN--P_CONSUMO_MATERIALES
--dbms_output.put_line('OT: '||vEmpresa||'-'||nNumeOtre);
      FOR rMaquinas IN cMaquinas(vEmpresa,nNumeOtre) LOOP --Se recorren las Maquinas de la OTRF desde PRD_MAQURUTA O PRD_HMAQURUT --3062
         -->BOBINAS DE PASADAS DE MAQUINA (PRIMERO SE REALIZA ESTO YA QUE HAY QUE IDENTIFICAR MATERIALES
         nNumeMate := NULL; 
         --
         OPEN cNumeMate(rMaquinas.Contador);--Calculo del Numero de Materiales utilizados en esta Maquina--3066
         FETCH cNumeMate INTO nNumeMate;
         CLOSE cNumeMate;
         --
         nContMaev := 0; --Controla el orden de uso de los Materiales, basicamente establece cual fue el primero para tenerlo en cuenta para lo de Enhebrado y Ajuste
         --
         FOR rConsumos IN cConsumos(rMaquinas.Contador) LOOP --Se recorren las Pasadas--3072
            IF rConsumos.CONTMATE = 1 THEN
               nContMaev := nContMaev + 1;--Se van contando los Materiales
               --Se busca la Bobina Generada
               rBOBIMAQU := F_BOBIMAQU(vEmpresa, nNumeOtre, rMaquinas.Contador, rConsumos.CoboGene);--3076
            END IF;
            --La función F_MATERIAL busca los valores asigna estos a las características de la tabla de T_MATERIAL, en cuando a anchos, numero de cortes y contadores de Fases siguientes
            IF rConsumos.CoboBobi > 0 THEN --Se trata de una Bobina Generada --3079
--dbms_output.put_line('CoboBobi > 0 -> '||vEmpresa||', '||nNumeOtre||', '||rMaquinas.Contador||', '||
--                                       rConsumos.Tip_Arti||', '||rConsumos.Cod_Arti||', '||'|EMPRBOBI:'||rConsumos.EmprBobi||'|NUOTBOBI:'||rConsumos.NuotBobi||'|CONTBOBI:'||rConsumos.ContBobi||'|COBOBOBI:'||rConsumos.CoboBobi||'|LOTE:'||rConsumos.Lote||', '||
--                                       rConsumos.CONTMATE||', '|| nContMaev);
               rMaterial := F_MATERIAL(vEmpresa, nNumeOtre, rMaquinas.Contador, --3083
                                       rConsumos.Tip_Arti, rConsumos.Cod_Arti, '|EMPRBOBI:'||rConsumos.EmprBobi||'|NUOTBOBI:'||rConsumos.NuotBobi||'|CONTBOBI:'||rConsumos.ContBobi||'|COBOBOBI:'||rConsumos.CoboBobi||'|LOTE:'||rConsumos.Lote,
                                       rConsumos.CONTMATE, nContMaev);
            ELSE --Es un material de Almacen
--dbms_output.put_line('CoboBobi < 0 -> '||vEmpresa||', '||nNumeOtre||', '||rMaquinas.Contador||', '||
--                                       rConsumos.Tip_Arti||', '||rConsumos.Cod_Arti||', '||'|EMPRBOBI:'||rConsumos.EmprBobi||'|NUOTBOBI:'||rConsumos.NuotBobi||'|LOTE:'||rConsumos.Lote||', '||
--                                       rConsumos.CONTMATE||', '|| nContMaev);            
               rMaterial := F_MATERIAL(vEmpresa, nNumeOtre, rMaquinas.Contador, 
                                       rConsumos.Tip_Arti, rConsumos.Cod_Arti, '|EMPRBOBI:'||rConsumos.EmprBobi||'|NUOTBOBI:'||rConsumos.NuotBobi||'|LOTE:'||rConsumos.Lote||--3090
												   '|COBOMATE:'||rConsumos.ContBobi||'|BOBIMATE:'||rConsumos.CoboBobi, -- 11-11-2016 Solo para materiales tipo M,
                                       rConsumos.CONTMATE, nContMaev);
            END IF;
--dbms_output.put_line('t_MATERIAL(rMaterial.IDENTIFICADOR) -> '||rMaterial.IDENTIFICADOR);
				P_MATERIAL(rMaterial,'U',
							  rConsumos.CantProd,--nCantProd
							  NULL,--nCantCons_E
							  NULL,--nCantCons
							  NULL,--nCantAjus
							  NULL,--nAncho
							  NULL,--nFACTOR_CONVERSION_M2_KG
							  NULL,--nPrecio_ML_E
							  NULL,--vLog_Precio
							  NULL,--nMermEnhe_E
							  NULL,--nMermEnhe
							  NULL,--nMermAjus_E
							  NULL,--nMermAjus
							  NULL,--nMermCabo_E
							  NULL,--nMermCabo
							  NULL,--nMermPico_E
                       NULL,--nMermPico
                       NULL,--nMermTita
                       NULL,--nMermSane
                       NULL,--nCantCons_Bobinas
                       --
                        NULL, --nCONTFSMU_01 
                        NULL, --nCANTFSMU_01 
                        NULL, --nCATOFSMU 
                        NULL, --nCONTFSMU_02 
                        NULL, --nCANTFSMU_02 
                        NULL, --nCONTFSMU_03 
                        NULL, --nCANTFSMU_03 
                        NULL, --nCONTFSMU_04 
                        NULL, --nCANTFSMU_04 
                        NULL, --nCONTFSMU_05 
                        NULL, --nCANTFSMU_05 
                        NULL, --nCONTFSMU_06 
                        NULL, --nCANTFSMU_06 
                        NULL, --nCONTFSMU_07 
                        NULL, --nCANTFSMU_07 
                        NULL, --nCONTFSMU_08 
                        NULL, --nCANTFSMU_08 
                        NULL, --nCONTFSMU_09 
                        NULL, --nCANTFSMU_09 
                        NULL, --nCONTFSMU_10 
                        NULL, --nCANTFSMU_10 
                        NULL, --nANCHO_BUENO_TOTAL_01 
                        NULL, --nANCHO_BUENO_OT_01 
                        NULL, --nANCHO_BUENO_TOTAL_02 
                        NULL, --nANCHO_BUENO_OT_02 
                        NULL, --nANCHO_BUENO_TOTAL_03 
                        NULL, --nANCHO_BUENO_OT_03 
                        NULL, --nANCHO_BUENO_TOTAL_04 
                        NULL, --nANCHO_BUENO_OT_04 
                        NULL, --nANCHO_BUENO_TOTAL_05 
                        NULL, --nANCHO_BUENO_OT_05 
                        NULL, --nANCHO_BUENO_TOTAL_06 
                        NULL, --nANCHO_BUENO_OT_06 
                        NULL, --nANCHO_BUENO_TOTAL_07 
                        NULL, --nANCHO_BUENO_OT_07 
                        NULL, --nANCHO_BUENO_TOTAL_08 
                        NULL, --nANCHO_BUENO_OT_08 
                        NULL, --nANCHO_BUENO_TOTAL_09 
                        NULL, --nANCHO_BUENO_OT_09 
                        NULL, --nANCHO_BUENO_TOTAL_10 
                        NULL, --nANCHO_BUENO_OT_10 
                        NULL, --nANCHO_BUENO_TOTAL 
                        NULL, --nANCHO_BUENO_OT 
                        NULL, --nNUMECORT 
                        NULL, --nMM_MERMPRCO_01 
                        NULL, --nMM_MERMPLAN_EXESO_01 
                        NULL, --nMM_MERMPLAN_01 
                        NULL, --nMM_MERMPRCO_02 
                        NULL, --nMM_MERMPLAN_EXESO_02 
                        NULL, --nMM_MERMPLAN_02 
                        NULL, --nMM_MERMPRCO_03 
                        NULL, --nMM_MERMPLAN_EXESO_03 
                        NULL, --nMM_MERMPLAN_03 
                        NULL, --nMM_MERMPRCO_04 
                        NULL, --nMM_MERMPLAN_EXESO_04 
                        NULL, --nMM_MERMPLAN_04 
                        NULL, --nMM_MERMPRCO_05 
                        NULL, --nMM_MERMPLAN_EXESO_05 
                        NULL, --nMM_MERMPLAN_05 
                        NULL, --nMM_MERMPRCO_06 
                        NULL, --nMM_MERMPLAN_EXESO_06 
                        NULL, --nMM_MERMPLAN_06 
                        NULL, --nMM_MERMPRCO_07 
                        NULL, --nMM_MERMPLAN_EXESO_07 
                        NULL, --nMM_MERMPLAN_07 
                        NULL, --nMM_MERMPRCO_08 
                        NULL, --nMM_MERMPLAN_EXESO_08 
                        NULL, --nMM_MERMPLAN_08 
                        NULL, --nMM_MERMPRCO_09 
                        NULL, --nMM_MERMPLAN_EXESO_09 
                        NULL, --nMM_MERMPLAN_09 
                        NULL, --nMM_MERMPRCO_10 
                        NULL, --nMM_MERMPLAN_EXESO_10 
                        NULL, --nMM_MERMPLAN_10 
                        NULL, --nMM_MERMPRCO 
                        NULL, --nMM_MERMPLAN_EXESO 
                        NULL); --nMM_MERMPLAN
	--dbms_output.put_line('TRAZA 1 nCantCons:'||rMaterial.IDENTIFICADOR||'-'||rConsumos.CantCons);
				P_MATERIAL(rMaterial,'U',
							  NULL,--nCantProd
							  NULL,--nCantCons_E
							  rConsumos.CantCons,--nCantCons
							  NULL,--nCantAjus
							  NULL,--nAncho
							  NULL,--nFACTOR_CONVERSION_M2_KG
							  NULL,--nPrecio_ML_E
							  NULL,--vLog_Precio
							  NULL,--nMermEnhe_E
							  NULL,--nMermEnhe
							  NULL,--nMermAjus_E
							  NULL,--nMermAjus
							  NULL,--nMermCabo_E
							  NULL,--nMermCabo
							  NULL,--nMermPico_E
							  NULL,--nMermPico
                       NULL,--nMermTita
                       NULL,--nMermSane
                       NULL,--nCantCons_Bobinas
                       --
                        NULL, --nCONTFSMU_01 
                        NULL, --nCANTFSMU_01 
                        NULL, --nCATOFSMU 
                        NULL, --nCONTFSMU_02 
                        NULL, --nCANTFSMU_02 
                        NULL, --nCONTFSMU_03 
                        NULL, --nCANTFSMU_03 
                        NULL, --nCONTFSMU_04 
                        NULL, --nCANTFSMU_04 
                        NULL, --nCONTFSMU_05 
                        NULL, --nCANTFSMU_05 
                        NULL, --nCONTFSMU_06 
                        NULL, --nCANTFSMU_06 
                        NULL, --nCONTFSMU_07 
                        NULL, --nCANTFSMU_07 
                        NULL, --nCONTFSMU_08 
                        NULL, --nCANTFSMU_08 
                        NULL, --nCONTFSMU_09 
                        NULL, --nCANTFSMU_09 
                        NULL, --nCONTFSMU_10 
                        NULL, --nCANTFSMU_10 
                        NULL, --nANCHO_BUENO_TOTAL_01 
                        NULL, --nANCHO_BUENO_OT_01 
                        NULL, --nANCHO_BUENO_TOTAL_02 
                        NULL, --nANCHO_BUENO_OT_02 
                        NULL, --nANCHO_BUENO_TOTAL_03 
                        NULL, --nANCHO_BUENO_OT_03 
                        NULL, --nANCHO_BUENO_TOTAL_04 
                        NULL, --nANCHO_BUENO_OT_04 
                        NULL, --nANCHO_BUENO_TOTAL_05 
                        NULL, --nANCHO_BUENO_OT_05 
                        NULL, --nANCHO_BUENO_TOTAL_06 
                        NULL, --nANCHO_BUENO_OT_06 
                        NULL, --nANCHO_BUENO_TOTAL_07 
                        NULL, --nANCHO_BUENO_OT_07 
                        NULL, --nANCHO_BUENO_TOTAL_08 
                        NULL, --nANCHO_BUENO_OT_08 
                        NULL, --nANCHO_BUENO_TOTAL_09 
                        NULL, --nANCHO_BUENO_OT_09 
                        NULL, --nANCHO_BUENO_TOTAL_10 
                        NULL, --nANCHO_BUENO_OT_10 
                        NULL, --nANCHO_BUENO_TOTAL 
                        NULL, --nANCHO_BUENO_OT 
                        NULL, --nNUMECORT 
                        NULL, --nMM_MERMPRCO_01 
                        NULL, --nMM_MERMPLAN_EXESO_01 
                        NULL, --nMM_MERMPLAN_01 
                        NULL, --nMM_MERMPRCO_02 
                        NULL, --nMM_MERMPLAN_EXESO_02 
                        NULL, --nMM_MERMPLAN_02 
                        NULL, --nMM_MERMPRCO_03 
                        NULL, --nMM_MERMPLAN_EXESO_03 
                        NULL, --nMM_MERMPLAN_03 
                        NULL, --nMM_MERMPRCO_04 
                        NULL, --nMM_MERMPLAN_EXESO_04 
                        NULL, --nMM_MERMPLAN_04 
                        NULL, --nMM_MERMPRCO_05 
                        NULL, --nMM_MERMPLAN_EXESO_05 
                        NULL, --nMM_MERMPLAN_05 
                        NULL, --nMM_MERMPRCO_06 
                        NULL, --nMM_MERMPLAN_EXESO_06 
                        NULL, --nMM_MERMPLAN_06 
                        NULL, --nMM_MERMPRCO_07 
                        NULL, --nMM_MERMPLAN_EXESO_07 
                        NULL, --nMM_MERMPLAN_07 
                        NULL, --nMM_MERMPRCO_08 
                        NULL, --nMM_MERMPLAN_EXESO_08 
                        NULL, --nMM_MERMPLAN_08 
                        NULL, --nMM_MERMPRCO_09 
                        NULL, --nMM_MERMPLAN_EXESO_09 
                        NULL, --nMM_MERMPLAN_09 
                        NULL, --nMM_MERMPRCO_10 
                        NULL, --nMM_MERMPLAN_EXESO_10 
                        NULL, --nMM_MERMPLAN_10 
                        NULL, --nMM_MERMPRCO 
                        NULL, --nMM_MERMPLAN_EXESO 
                        NULL); --nMM_MERMPLAN
				P_MATERIAL(rMaterial,'U',
							  NULL,--nCantProd
							  NULL,--nCantCons_E
							  NULL,--nCantCons
							  rConsumos.CantAjus,--nCantAjus
							  NULL,--nAncho
							  NULL,--nFACTOR_CONVERSION_M2_KG
							  NULL,--nPrecio_ML_E
							  NULL,--vLog_Precio
							  NULL,--nMermEnhe_E
							  NULL,--nMermEnhe
							  NULL,--nMermAjus_E
							  NULL,--nMermAjus
							  NULL,--nMermCabo_E
							  NULL,--nMermCabo
							  NULL,--nMermPico_E
							  NULL,--nMermPico
                       NULL,--nMermTita
                       NULL,--nMermSane
                       NULL,--nCantCons_Bobinas
                       --
                        NULL, --nCONTFSMU_01 
                        NULL, --nCANTFSMU_01 
                        NULL, --nCATOFSMU 
                        NULL, --nCONTFSMU_02 
                        NULL, --nCANTFSMU_02 
                        NULL, --nCONTFSMU_03 
                        NULL, --nCANTFSMU_03 
                        NULL, --nCONTFSMU_04 
                        NULL, --nCANTFSMU_04 
                        NULL, --nCONTFSMU_05 
                        NULL, --nCANTFSMU_05 
                        NULL, --nCONTFSMU_06 
                        NULL, --nCANTFSMU_06 
                        NULL, --nCONTFSMU_07 
                        NULL, --nCANTFSMU_07 
                        NULL, --nCONTFSMU_08 
                        NULL, --nCANTFSMU_08 
                        NULL, --nCONTFSMU_09 
                        NULL, --nCANTFSMU_09 
                        NULL, --nCONTFSMU_10 
                        NULL, --nCANTFSMU_10 
                        NULL, --nANCHO_BUENO_TOTAL_01 
                        NULL, --nANCHO_BUENO_OT_01 
                        NULL, --nANCHO_BUENO_TOTAL_02 
                        NULL, --nANCHO_BUENO_OT_02 
                        NULL, --nANCHO_BUENO_TOTAL_03 
                        NULL, --nANCHO_BUENO_OT_03 
                        NULL, --nANCHO_BUENO_TOTAL_04 
                        NULL, --nANCHO_BUENO_OT_04 
                        NULL, --nANCHO_BUENO_TOTAL_05 
                        NULL, --nANCHO_BUENO_OT_05 
                        NULL, --nANCHO_BUENO_TOTAL_06 
                        NULL, --nANCHO_BUENO_OT_06 
                        NULL, --nANCHO_BUENO_TOTAL_07 
                        NULL, --nANCHO_BUENO_OT_07 
                        NULL, --nANCHO_BUENO_TOTAL_08 
                        NULL, --nANCHO_BUENO_OT_08 
                        NULL, --nANCHO_BUENO_TOTAL_09 
                        NULL, --nANCHO_BUENO_OT_09 
                        NULL, --nANCHO_BUENO_TOTAL_10 
                        NULL, --nANCHO_BUENO_OT_10 
                        NULL, --nANCHO_BUENO_TOTAL 
                        NULL, --nANCHO_BUENO_OT 
                        NULL, --nNUMECORT 
                        NULL, --nMM_MERMPRCO_01 
                        NULL, --nMM_MERMPLAN_EXESO_01 
                        NULL, --nMM_MERMPLAN_01 
                        NULL, --nMM_MERMPRCO_02 
                        NULL, --nMM_MERMPLAN_EXESO_02 
                        NULL, --nMM_MERMPLAN_02 
                        NULL, --nMM_MERMPRCO_03 
                        NULL, --nMM_MERMPLAN_EXESO_03 
                        NULL, --nMM_MERMPLAN_03 
                        NULL, --nMM_MERMPRCO_04 
                        NULL, --nMM_MERMPLAN_EXESO_04 
                        NULL, --nMM_MERMPLAN_04 
                        NULL, --nMM_MERMPRCO_05 
                        NULL, --nMM_MERMPLAN_EXESO_05 
                        NULL, --nMM_MERMPLAN_05 
                        NULL, --nMM_MERMPRCO_06 
                        NULL, --nMM_MERMPLAN_EXESO_06 
                        NULL, --nMM_MERMPLAN_06 
                        NULL, --nMM_MERMPRCO_07 
                        NULL, --nMM_MERMPLAN_EXESO_07 
                        NULL, --nMM_MERMPLAN_07 
                        NULL, --nMM_MERMPRCO_08 
                        NULL, --nMM_MERMPLAN_EXESO_08 
                        NULL, --nMM_MERMPLAN_08 
                        NULL, --nMM_MERMPRCO_09 
                        NULL, --nMM_MERMPLAN_EXESO_09 
                        NULL, --nMM_MERMPLAN_09 
                        NULL, --nMM_MERMPRCO_10 
                        NULL, --nMM_MERMPLAN_EXESO_10 
                        NULL, --nMM_MERMPLAN_10 
                        NULL, --nMM_MERMPRCO 
                        NULL, --nMM_MERMPLAN_EXESO 
                        NULL); --nMM_MERMPLAN
            --Actualización de Consumos
            -->OK t_MATERIAL(rMaterial.IDENTIFICADOR).CantProd := NVL(rMaterial.CANTPROD,0) + rConsumos.CantProd;--3096
            -->OK t_MATERIAL(rMaterial.IDENTIFICADOR).CantCons := NVL(rMaterial.CANTCONS,0) + rConsumos.CantCons;
            -->OK t_MATERIAL(rMaterial.IDENTIFICADOR).CantAjus := NVL(rMaterial.CANTAJUS,0) + rConsumos.CantAjus;
            --Acumulados de Consumos para Calculos de Merma de Tirada y Saneamiento Estandar
            IF rConsumos.CONTMATE = 1 THEN--3100
               IF rMaterial_B1.CONTADOR IS NULL OR (rMaterial_B1.CONTADOR IS NOT NULL AND rMaterial_B1.CONTADOR != rMaterial.CONTADOR) THEN
                  --Se busca el 1er Material para acumular las Cantidades Consumidas para Calculos de Merma de Tirada y Saneamiento Estandar
                  rMaterial_B1 := F_MATERIAL(vEmpresa, nNumeOtre, rMaterial.Contador, 
                                             NULL, NULL, NULL,
                                             1, 1);
               END IF;
               --
               IF rMATERIAL_B1.IDENTIFICADOR IS NOT NULL THEN
						P_MATERIAL(rMATERIAL_B1,'U',
									  NULL,--nCantProd
									  NVL(rConsumos.CANTCONS,0),--nCantCons_E
									  NULL,--nCantCons
									  NULL,--nCantAjus
									  NULL,--nAncho
									  NULL,--nFACTOR_CONVERSION_M2_KG
									  NULL,--nPrecio_ML_E
									  NULL,--vLog_Precio
									  NULL,--nMermEnhe_E
									  NULL,--nMermEnhe
									  NULL,--nMermAjus_E
									  NULL,--nMermAjus
									  NULL,--nMermCabo_E
									  NULL,--nMermCabo
									  NULL,--nMermPico_E
									  NULL,--nMermPico
                             NULL,--nMermTita
                             NULL,--nMermSane
                             NULL,--nCantCons_Bobinas
                             --
                           NULL, --nCONTFSMU_01 
                           NULL, --nCANTFSMU_01 
                           NULL, --nCATOFSMU 
                           NULL, --nCONTFSMU_02 
                           NULL, --nCANTFSMU_02 
                           NULL, --nCONTFSMU_03 
                           NULL, --nCANTFSMU_03 
                           NULL, --nCONTFSMU_04 
                           NULL, --nCANTFSMU_04 
                           NULL, --nCONTFSMU_05 
                           NULL, --nCANTFSMU_05 
                           NULL, --nCONTFSMU_06 
                           NULL, --nCANTFSMU_06 
                           NULL, --nCONTFSMU_07 
                           NULL, --nCANTFSMU_07 
                           NULL, --nCONTFSMU_08 
                           NULL, --nCANTFSMU_08 
                           NULL, --nCONTFSMU_09 
                           NULL, --nCANTFSMU_09 
                           NULL, --nCONTFSMU_10 
                           NULL, --nCANTFSMU_10 
                           NULL, --nANCHO_BUENO_TOTAL_01 
                           NULL, --nANCHO_BUENO_OT_01 
                           NULL, --nANCHO_BUENO_TOTAL_02 
                           NULL, --nANCHO_BUENO_OT_02 
                           NULL, --nANCHO_BUENO_TOTAL_03 
                           NULL, --nANCHO_BUENO_OT_03 
                           NULL, --nANCHO_BUENO_TOTAL_04 
                           NULL, --nANCHO_BUENO_OT_04 
                           NULL, --nANCHO_BUENO_TOTAL_05 
                           NULL, --nANCHO_BUENO_OT_05 
                           NULL, --nANCHO_BUENO_TOTAL_06 
                           NULL, --nANCHO_BUENO_OT_06 
                           NULL, --nANCHO_BUENO_TOTAL_07 
                           NULL, --nANCHO_BUENO_OT_07 
                           NULL, --nANCHO_BUENO_TOTAL_08 
                           NULL, --nANCHO_BUENO_OT_08 
                           NULL, --nANCHO_BUENO_TOTAL_09 
                           NULL, --nANCHO_BUENO_OT_09 
                           NULL, --nANCHO_BUENO_TOTAL_10 
                           NULL, --nANCHO_BUENO_OT_10 
                           NULL, --nANCHO_BUENO_TOTAL 
                           NULL, --nANCHO_BUENO_OT 
                           NULL, --nNUMECORT 
                           NULL, --nMM_MERMPRCO_01 
                           NULL, --nMM_MERMPLAN_EXESO_01 
                           NULL, --nMM_MERMPLAN_01 
                           NULL, --nMM_MERMPRCO_02 
                           NULL, --nMM_MERMPLAN_EXESO_02 
                           NULL, --nMM_MERMPLAN_02 
                           NULL, --nMM_MERMPRCO_03 
                           NULL, --nMM_MERMPLAN_EXESO_03 
                           NULL, --nMM_MERMPLAN_03 
                           NULL, --nMM_MERMPRCO_04 
                           NULL, --nMM_MERMPLAN_EXESO_04 
                           NULL, --nMM_MERMPLAN_04 
                           NULL, --nMM_MERMPRCO_05 
                           NULL, --nMM_MERMPLAN_EXESO_05 
                           NULL, --nMM_MERMPLAN_05 
                           NULL, --nMM_MERMPRCO_06 
                           NULL, --nMM_MERMPLAN_EXESO_06 
                           NULL, --nMM_MERMPLAN_06 
                           NULL, --nMM_MERMPRCO_07 
                           NULL, --nMM_MERMPLAN_EXESO_07 
                           NULL, --nMM_MERMPLAN_07 
                           NULL, --nMM_MERMPRCO_08 
                           NULL, --nMM_MERMPLAN_EXESO_08 
                           NULL, --nMM_MERMPLAN_08 
                           NULL, --nMM_MERMPRCO_09 
                           NULL, --nMM_MERMPLAN_EXESO_09 
                           NULL, --nMM_MERMPLAN_09 
                           NULL, --nMM_MERMPRCO_10 
                           NULL, --nMM_MERMPLAN_EXESO_10 
                           NULL, --nMM_MERMPLAN_10 
                           NULL, --nMM_MERMPRCO 
                           NULL, --nMM_MERMPLAN_EXESO 
                           NULL); --nMM_MERMPLAN
                  --Cantidad Consumida para Calculos Estandar
                  -->OK t_MATERIAL(rMATERIAL_B1.IDENTIFICADOR).CantCons_E := NVL(t_MATERIAL(rMATERIAL_B1.IDENTIFICADOR).CantCons_E,0) + NVL(rConsumos.CANTCONS,0);--3110
--ELSE dbms_output.put_line('1 IDENTIFICADOR IS NULL '||vEmpresa||', '||nNumeOtre||', '||rMaterial.Contador||', ||NULL, NULL, NULL, 1, 1');
               END IF;
            ELSIF rConsumos.CONTMATE = 2 THEN--3112
               IF rMaterial_B2.CONTADOR IS NULL OR (rMaterial_B2.CONTADOR IS NOT NULL AND rMaterial_B2.CONTADOR != rMaterial.CONTADOR) THEN
                  rMaterial_B2 := F_MATERIAL(vEmpresa, nNumeOtre, rMaterial.Contador, 
                                             NULL, NULL, NULL,
                                             2, 1);
               END IF;
               --
               IF rMATERIAL_B2.IDENTIFICADOR IS NOT NULL THEN
						P_MATERIAL(rMATERIAL_B2,'U',
									  NULL,--nCantProd
									  NVL(rConsumos.CANTCONS,0),--nCantCons_E
									  NULL,--nCantCons
									  NULL,--nCantAjus
									  NULL,--nAncho
									  NULL,--nFACTOR_CONVERSION_M2_KG
									  NULL,--nPrecio_ML_E
									  NULL,--vLog_Precio
									  NULL,--nMermEnhe_E
									  NULL,--nMermEnhe
									  NULL,--nMermAjus_E
									  NULL,--nMermAjus
									  NULL,--nMermCabo_E
									  NULL,--nMermCabo
									  NULL,--nMermPico_E
									  NULL,--nMermPico
                             NULL,--nMermTita
                             NULL,--nMermSane
                             NULL,--nCantCons_Bobinas
                             --
                           NULL, --nCONTFSMU_01 
                           NULL, --nCANTFSMU_01 
                           NULL, --nCATOFSMU 
                           NULL, --nCONTFSMU_02 
                           NULL, --nCANTFSMU_02 
                           NULL, --nCONTFSMU_03 
                           NULL, --nCANTFSMU_03 
                           NULL, --nCONTFSMU_04 
                           NULL, --nCANTFSMU_04 
                           NULL, --nCONTFSMU_05 
                           NULL, --nCANTFSMU_05 
                           NULL, --nCONTFSMU_06 
                           NULL, --nCANTFSMU_06 
                           NULL, --nCONTFSMU_07 
                           NULL, --nCANTFSMU_07 
                           NULL, --nCONTFSMU_08 
                           NULL, --nCANTFSMU_08 
                           NULL, --nCONTFSMU_09 
                           NULL, --nCANTFSMU_09 
                           NULL, --nCONTFSMU_10 
                           NULL, --nCANTFSMU_10 
                           NULL, --nANCHO_BUENO_TOTAL_01 
                           NULL, --nANCHO_BUENO_OT_01 
                           NULL, --nANCHO_BUENO_TOTAL_02 
                           NULL, --nANCHO_BUENO_OT_02 
                           NULL, --nANCHO_BUENO_TOTAL_03 
                           NULL, --nANCHO_BUENO_OT_03 
                           NULL, --nANCHO_BUENO_TOTAL_04 
                           NULL, --nANCHO_BUENO_OT_04 
                           NULL, --nANCHO_BUENO_TOTAL_05 
                           NULL, --nANCHO_BUENO_OT_05 
                           NULL, --nANCHO_BUENO_TOTAL_06 
                           NULL, --nANCHO_BUENO_OT_06 
                           NULL, --nANCHO_BUENO_TOTAL_07 
                           NULL, --nANCHO_BUENO_OT_07 
                           NULL, --nANCHO_BUENO_TOTAL_08 
                           NULL, --nANCHO_BUENO_OT_08 
                           NULL, --nANCHO_BUENO_TOTAL_09 
                           NULL, --nANCHO_BUENO_OT_09 
                           NULL, --nANCHO_BUENO_TOTAL_10 
                           NULL, --nANCHO_BUENO_OT_10 
                           NULL, --nANCHO_BUENO_TOTAL 
                           NULL, --nANCHO_BUENO_OT 
                           NULL, --nNUMECORT 
                           NULL, --nMM_MERMPRCO_01 
                           NULL, --nMM_MERMPLAN_EXESO_01 
                           NULL, --nMM_MERMPLAN_01 
                           NULL, --nMM_MERMPRCO_02 
                           NULL, --nMM_MERMPLAN_EXESO_02 
                           NULL, --nMM_MERMPLAN_02 
                           NULL, --nMM_MERMPRCO_03 
                           NULL, --nMM_MERMPLAN_EXESO_03 
                           NULL, --nMM_MERMPLAN_03 
                           NULL, --nMM_MERMPRCO_04 
                           NULL, --nMM_MERMPLAN_EXESO_04 
                           NULL, --nMM_MERMPLAN_04 
                           NULL, --nMM_MERMPRCO_05 
                           NULL, --nMM_MERMPLAN_EXESO_05 
                           NULL, --nMM_MERMPLAN_05 
                           NULL, --nMM_MERMPRCO_06 
                           NULL, --nMM_MERMPLAN_EXESO_06 
                           NULL, --nMM_MERMPLAN_06 
                           NULL, --nMM_MERMPRCO_07 
                           NULL, --nMM_MERMPLAN_EXESO_07 
                           NULL, --nMM_MERMPLAN_07 
                           NULL, --nMM_MERMPRCO_08 
                           NULL, --nMM_MERMPLAN_EXESO_08 
                           NULL, --nMM_MERMPLAN_08 
                           NULL, --nMM_MERMPRCO_09 
                           NULL, --nMM_MERMPLAN_EXESO_09 
                           NULL, --nMM_MERMPLAN_09 
                           NULL, --nMM_MERMPRCO_10 
                           NULL, --nMM_MERMPLAN_EXESO_10 
                           NULL, --nMM_MERMPLAN_10 
                           NULL, --nMM_MERMPRCO 
                           NULL, --nMM_MERMPLAN_EXESO 
                           NULL); --nMM_MERMPLAN
                  --Cantidad Consumida para Calculos Estandar
                  -->OK t_MATERIAL(rMATERIAL_B2.IDENTIFICADOR).CantCons_E := NVL(t_MATERIAL(rMATERIAL_B2.IDENTIFICADOR).CantCons_E,0) + NVL(rConsumos.CANTCONS,0);--3121
--ELSE dbms_output.put_line('2 IDENTIFICADOR IS NULL(2) '||vEmpresa||', '||nNumeOtre||', '||rMaterial.Contador||', ||NULL, NULL, NULL, 2, 1');
               END IF;
            END IF;
            --
            IF NVL(rBOBIMAQU.ESTADO,'X') != 'X' THEN
               IF rConsumos.Tip_Arti IN (vTiarMpF4,vTiarSeF4,vP_TiarFiF4) THEN --Si es Materia Prima se Busca el Ancho en Maestro de Articulos--3125
                  rArticulo.ANCHO := NULL;
                  rArticulo.COD_LFS := NULL;
                  rArticulo.UNIDSTOC := NULL;
                  rArticulo.FCKG := NULL;
                  --
                  OPEN cArticulo(rConsumos.EmprBobi, rConsumos.Tip_Arti, rConsumos.Cod_Arti, rConsumos.LOTE);--3132
                  FETCH cArticulo INTO rArticulo;
                  CLOSE cArticulo;
--dbms_output.put_line('BUS ANCH:'||rConsumos.EmprBobi||', '||rConsumos.Tip_Arti||', '||rConsumos.Cod_Arti||' ANCHO->'||rArticulo.ANCHO);                                 
                  --
                  IF rConsumos.ContMate = 1 THEN
                     nAncho1 := rArticulo.ANCHO;
                     nFCKG1 := rArticulo.FCKG;
                  ELSE
                     nAncho2 := rArticulo.ANCHO;
                     nFCKG2 := rArticulo.FCKG;
                  END IF;
--dbms_Output.put_line('FACTOR M2KG MATERIAL: '||rArticulo.FCKG);
                  --
                  IF NVL(rArticulo.FCKG,0) = 0 THEN
                     IF vMaprPrCl = 'N' THEN
                        --647 No se encuentra @1. [Contador @1]
                        P_ERRORES(vEmpresa, nNumeOtre, '647','el Factor de Conversion del Material '||rConsumos.EmprBobi||'-'||rConsumos.Tip_Arti||'-'||rConsumos.Cod_Arti||'|8.1','R','E');
                     ELSE
                        --647 No se encuentra @1. [Contador @1]
                        P_ERRORES(vEmpresa, nNumeOtre, '647','el Factor de Conversion del Material (Material Propiedad del Cliente) '||rConsumos.EmprBobi||'-'||rConsumos.Tip_Arti||'-'||rConsumos.Cod_Arti||'|8.2','R','A');
                    END IF;
                  END IF;
               ELSE
                  --Se busca la Bobina Utilizada
                  rBOBIMAQU_U := F_BOBIMAQU(rConsumos.EmprBobi, rConsumos.NuotBobi, rConsumos.ContBobi, rConsumos.CoboBobi);
                  --
                  IF NVL(rBOBIMAQU_U.ESTADO,'X') != 'X' THEN
                     IF rBOBIMAQU_U.Ancho IS NULL AND vEmpresa||'-'||nNumeOtre != rConsumos.EmprBobi||'-'||rConsumos.NuotBobi THEN --Se calcula todo de la OT de la Bobina Utilizada, si no es de la misma Ot por que se entiende que si es de la misma Ot se calculara en Orden
                        P_CONSUMO_MATERIALES(rConsumos.EmprBobi, rConsumos.NuotBobi);
                        --Se busca la Bobina Utilizada con los Datos Actualizados
                        rBOBIMAQU_U := F_BOBIMAQU(rConsumos.EmprBobi, rConsumos.NuotBobi, rConsumos.ContBobi, rConsumos.CoboBobi);
                     END IF;
                  ELSE
                     --647 No se encuentra @1. [Contador @1]
                     P_ERRORES(vEmpresa, nNumeOtre, '647','la Bobina Utilizada '||rConsumos.EmprBobi||'-'||rConsumos.NuotBobi||'-'||rConsumos.ContBobi||'-'||rConsumos.CoboBobi||'|9','R','E');
--dbms_output.put_line('Error 647: No se encuentra la Bobina Utilizada '||rConsumos.EmprBobi||'-'||rConsumos.NuotBobi||'-'||rConsumos.ContBobi||'-'||rConsumos.CoboBobi);
                  END IF;
                  --
                  IF rConsumos.ContMate = 1 THEN
                     nAncho1 := rBOBIMAQU_U.ANCHO;
                     nFCKG1 := rBOBIMAQU_U.FACTOR_CONVERSION_M2_KG;
                  ELSE
                     nAncho2 := rBOBIMAQU_U.ANCHO;
                     nFCKG2 := rBOBIMAQU_U.FACTOR_CONVERSION_M2_KG;
                  END IF;
--dbms_Output.put_line('FACTOR M2KG BOBINA: '||rConsumos.EmprBobi||'-'||rConsumos.NuotBobi||'-'||rConsumos.ContBobi||'-'||rConsumos.CoboBobi||'->'||rBOBIMAQU_U.FACTOR_CONVERSION_M2_KG);                  
                  --
                  IF NVL(rBOBIMAQU_U.FACTOR_CONVERSION_M2_KG,0) = 0 THEN
                     --647 No se encuentra @1. [Contador @1]
                     P_ERRORES(vEmpresa, nNumeOtre, '647','el Factor de Conversion de la Bobina Utilizada '||rConsumos.EmprBobi||'-'||rConsumos.NuotBobi||'-'||rConsumos.ContBobi||'-'||rConsumos.CoboBobi||'|9.1','R','E');
                  END IF;
               END IF;
            ELSE
               --647 No se encuentra @1. [Contador @1]
               P_ERRORES(vEmpresa, nNumeOtre, '647','la Bobina Utilizada '||rConsumos.EmprBobi||'-'||rConsumos.NuotBobi||'-'||rConsumos.ContBobi||'-'||rConsumos.CoboGene||'|10','R','E');
               --dbms_output.put_line('Error 647: No se encuentra la Bobina Generada '||rConsumos.EmprBobi||'-'||rConsumos.NuotBobi||'-'||rConsumos.ContBobi||'-'||rConsumos.CoboGene);
            END IF;
            --Actualizacion de Ancho de la Bobina
            IF rConsumos.ContMate = 1 THEN
               IF rBOBIMAQU.Ancho IS NULL OR (rBOBIMAQU.Ancho IS NOT NULL AND nAncho1 < rBOBIMAQU.Ancho) THEN --Se actualiza el ancho de la Bobina
--dbms_Output.put_line('ANCHO0:'||nAncho1);               
						P_BOBIMAQU(rBOBIMAQU.IDENTIFICADOR,--nIdentificador
									  nAncho1,--nAncho 
									  NULL,--nAncho_Total 
									  NULL,--vDesbarbe 
									  NULL,--nNumero_Bobinas_Corte 
									  NULL,--nFACTOR_CONVERSION_M2_KG
                             NULL,--nPRECIO_ML
                             NULL);--nAncho_Bueno
						--
						rBOBIMAQU.Ancho := nAncho1;
						--t_BOBIMAQU(rBOBIMAQU.IDENTIFICADOR).Ancho := nAncho1;
               END IF;
					--
					P_MATERIAL(rMaterial,'U',
					           NULL,--nCantProd
								  NULL,--nCantCons_E
								  NULL,--nCantCons
								  NULL,--nCantAjus
								  nAncho1,--nAncho
								  NULL,--nFACTOR_CONVERSION_M2_KG
								  NULL,--nPrecio_ML_E
								  NULL,--vLog_Precio
								  NULL,--nMermEnhe_E
								  NULL,--nMermEnhe
								  NULL,--nMermAjus_E
								  NULL,--nMermAjus
								  NULL,--nMermCabo_E
								  NULL,--nMermCabo
								  NULL,--nMermPico_E
								  NULL,--nMermPico
                          NULL,--nMermTita
                          NULL,--nMermSane
                          NULL,--nCantCons_Bobinas
                          --
                        NULL, --nCONTFSMU_01 
                        NULL, --nCANTFSMU_01 
                        NULL, --nCATOFSMU 
                        NULL, --nCONTFSMU_02 
                        NULL, --nCANTFSMU_02 
                        NULL, --nCONTFSMU_03 
                        NULL, --nCANTFSMU_03 
                        NULL, --nCONTFSMU_04 
                        NULL, --nCANTFSMU_04 
                        NULL, --nCONTFSMU_05 
                        NULL, --nCANTFSMU_05 
                        NULL, --nCONTFSMU_06 
                        NULL, --nCANTFSMU_06 
                        NULL, --nCONTFSMU_07 
                        NULL, --nCANTFSMU_07 
                        NULL, --nCONTFSMU_08 
                        NULL, --nCANTFSMU_08 
                        NULL, --nCONTFSMU_09 
                        NULL, --nCANTFSMU_09 
                        NULL, --nCONTFSMU_10 
                        NULL, --nCANTFSMU_10 
                        NULL, --nANCHO_BUENO_TOTAL_01 
                        NULL, --nANCHO_BUENO_OT_01 
                        NULL, --nANCHO_BUENO_TOTAL_02 
                        NULL, --nANCHO_BUENO_OT_02 
                        NULL, --nANCHO_BUENO_TOTAL_03 
                        NULL, --nANCHO_BUENO_OT_03 
                        NULL, --nANCHO_BUENO_TOTAL_04 
                        NULL, --nANCHO_BUENO_OT_04 
                        NULL, --nANCHO_BUENO_TOTAL_05 
                        NULL, --nANCHO_BUENO_OT_05 
                        NULL, --nANCHO_BUENO_TOTAL_06 
                        NULL, --nANCHO_BUENO_OT_06 
                        NULL, --nANCHO_BUENO_TOTAL_07 
                        NULL, --nANCHO_BUENO_OT_07 
                        NULL, --nANCHO_BUENO_TOTAL_08 
                        NULL, --nANCHO_BUENO_OT_08 
                        NULL, --nANCHO_BUENO_TOTAL_09 
                        NULL, --nANCHO_BUENO_OT_09 
                        NULL, --nANCHO_BUENO_TOTAL_10 
                        NULL, --nANCHO_BUENO_OT_10 
                        NULL, --nANCHO_BUENO_TOTAL 
                        NULL, --nANCHO_BUENO_OT 
                        NULL, --nNUMECORT 
                        NULL, --nMM_MERMPRCO_01 
                        NULL, --nMM_MERMPLAN_EXESO_01 
                        NULL, --nMM_MERMPLAN_01 
                        NULL, --nMM_MERMPRCO_02 
                        NULL, --nMM_MERMPLAN_EXESO_02 
                        NULL, --nMM_MERMPLAN_02 
                        NULL, --nMM_MERMPRCO_03 
                        NULL, --nMM_MERMPLAN_EXESO_03 
                        NULL, --nMM_MERMPLAN_03 
                        NULL, --nMM_MERMPRCO_04 
                        NULL, --nMM_MERMPLAN_EXESO_04 
                        NULL, --nMM_MERMPLAN_04 
                        NULL, --nMM_MERMPRCO_05 
                        NULL, --nMM_MERMPLAN_EXESO_05 
                        NULL, --nMM_MERMPLAN_05 
                        NULL, --nMM_MERMPRCO_06 
                        NULL, --nMM_MERMPLAN_EXESO_06 
                        NULL, --nMM_MERMPLAN_06 
                        NULL, --nMM_MERMPRCO_07 
                        NULL, --nMM_MERMPLAN_EXESO_07 
                        NULL, --nMM_MERMPLAN_07 
                        NULL, --nMM_MERMPRCO_08 
                        NULL, --nMM_MERMPLAN_EXESO_08 
                        NULL, --nMM_MERMPLAN_08 
                        NULL, --nMM_MERMPRCO_09 
                        NULL, --nMM_MERMPLAN_EXESO_09 
                        NULL, --nMM_MERMPLAN_09 
                        NULL, --nMM_MERMPRCO_10 
                        NULL, --nMM_MERMPLAN_EXESO_10 
                        NULL, --nMM_MERMPLAN_10 
                        NULL, --nMM_MERMPRCO 
                        NULL, --nMM_MERMPLAN_EXESO 
                        NULL); --nMM_MERMPLAN
               --Se actualiza el ancho del Material en caso de no existir
               --IF t_MATERIAL(rMaterial.IDENTIFICADOR).Ancho IS NULL THEN
--dbms_Output.put_line('ANCHO1:'||nAncho1);               
                  --t_MATERIAL(rMaterial.IDENTIFICADOR).Ancho := nAncho1;
               --END IF;
               --Se actualiza el FCKG de la Bobina en caso de no existir
               IF rBOBIMAQU.FACTOR_CONVERSION_M2_KG IS NULL THEN
--dbms_Output.put_line('FACTORXXX01 BOBINA EN 1: '||rBOBIMAQU.IDENTIFICADOR||'-'||rBOBIMAQU.COD_ARTI||'LOTE:'||rBOBIMAQU.LOTE||'-> nFCKG1:'||nFCKG1);  
                  P_BOBIMAQU(rBOBIMAQU.IDENTIFICADOR,--nIdentificador
									  NULL,--nAncho 
									  NULL,--nAncho_Total 
									  NULL,--vDesbarbe 
									  NULL,--nNumero_Bobinas_Corte 
									  nFCKG1,--nFACTOR_CONVERSION_M2_KG
                             NULL,--nPRECIO_ML
                             NULL);--nAncho_Bueno
						--
						rBOBIMAQU.FACTOR_CONVERSION_M2_KG := nFCKG1;
						--t_BOBIMAQU(rBOBIMAQU.IDENTIFICADOR).FACTOR_CONVERSION_M2_KG := nFCKG1;
               END IF;
					--
--dbms_Output.put_line('FACTORXXX02 BOBINA EN 2: '||rMaterial.IDENTIFICADOR||'-'||rMaterial.COD_ARTI||'LOTE:'||rMaterial.LOTE||'-> nFCKG1:'||nFCKG1); 
					P_MATERIAL(rMaterial,'U',
					           NULL,--nCantProd
								  NULL,--nCantCons_E
								  NULL,--nCantCons
								  NULL,--nCantAjus
								  NULL,--nAncho
								  nFCKG1,--nFACTOR_CONVERSION_M2_KG
								  NULL,--nPrecio_ML_E
								  NULL,--vLog_Precio
								  NULL,--nMermEnhe_E
								  NULL,--nMermEnhe
								  NULL,--nMermAjus_E
								  NULL,--nMermAjus
								  NULL,--nMermCabo_E
								  NULL,--nMermCabo
								  NULL,--nMermPico_E
								  NULL,--nMermPico
                          NULL,--nMermTita
                          NULL,--nMermSane
                          NULL,--nCantCons_Bobinas
                          --
                        NULL, --nCONTFSMU_01 
                        NULL, --nCANTFSMU_01 
                        NULL, --nCATOFSMU 
                        NULL, --nCONTFSMU_02 
                        NULL, --nCANTFSMU_02 
                        NULL, --nCONTFSMU_03 
                        NULL, --nCANTFSMU_03 
                        NULL, --nCONTFSMU_04 
                        NULL, --nCANTFSMU_04 
                        NULL, --nCONTFSMU_05 
                        NULL, --nCANTFSMU_05 
                        NULL, --nCONTFSMU_06 
                        NULL, --nCANTFSMU_06 
                        NULL, --nCONTFSMU_07 
                        NULL, --nCANTFSMU_07 
                        NULL, --nCONTFSMU_08 
                        NULL, --nCANTFSMU_08 
                        NULL, --nCONTFSMU_09 
                        NULL, --nCANTFSMU_09 
                        NULL, --nCONTFSMU_10 
                        NULL, --nCANTFSMU_10 
                        NULL, --nANCHO_BUENO_TOTAL_01 
                        NULL, --nANCHO_BUENO_OT_01 
                        NULL, --nANCHO_BUENO_TOTAL_02 
                        NULL, --nANCHO_BUENO_OT_02 
                        NULL, --nANCHO_BUENO_TOTAL_03 
                        NULL, --nANCHO_BUENO_OT_03 
                        NULL, --nANCHO_BUENO_TOTAL_04 
                        NULL, --nANCHO_BUENO_OT_04 
                        NULL, --nANCHO_BUENO_TOTAL_05 
                        NULL, --nANCHO_BUENO_OT_05 
                        NULL, --nANCHO_BUENO_TOTAL_06 
                        NULL, --nANCHO_BUENO_OT_06 
                        NULL, --nANCHO_BUENO_TOTAL_07 
                        NULL, --nANCHO_BUENO_OT_07 
                        NULL, --nANCHO_BUENO_TOTAL_08 
                        NULL, --nANCHO_BUENO_OT_08 
                        NULL, --nANCHO_BUENO_TOTAL_09 
                        NULL, --nANCHO_BUENO_OT_09 
                        NULL, --nANCHO_BUENO_TOTAL_10 
                        NULL, --nANCHO_BUENO_OT_10 
                        NULL, --nANCHO_BUENO_TOTAL 
                        NULL, --nANCHO_BUENO_OT 
                        NULL, --nNUMECORT 
                        NULL, --nMM_MERMPRCO_01 
                        NULL, --nMM_MERMPLAN_EXESO_01 
                        NULL, --nMM_MERMPLAN_01 
                        NULL, --nMM_MERMPRCO_02 
                        NULL, --nMM_MERMPLAN_EXESO_02 
                        NULL, --nMM_MERMPLAN_02 
                        NULL, --nMM_MERMPRCO_03 
                        NULL, --nMM_MERMPLAN_EXESO_03 
                        NULL, --nMM_MERMPLAN_03 
                        NULL, --nMM_MERMPRCO_04 
                        NULL, --nMM_MERMPLAN_EXESO_04 
                        NULL, --nMM_MERMPLAN_04 
                        NULL, --nMM_MERMPRCO_05 
                        NULL, --nMM_MERMPLAN_EXESO_05 
                        NULL, --nMM_MERMPLAN_05 
                        NULL, --nMM_MERMPRCO_06 
                        NULL, --nMM_MERMPLAN_EXESO_06 
                        NULL, --nMM_MERMPLAN_06 
                        NULL, --nMM_MERMPRCO_07 
                        NULL, --nMM_MERMPLAN_EXESO_07 
                        NULL, --nMM_MERMPLAN_07 
                        NULL, --nMM_MERMPRCO_08 
                        NULL, --nMM_MERMPLAN_EXESO_08 
                        NULL, --nMM_MERMPLAN_08 
                        NULL, --nMM_MERMPRCO_09 
                        NULL, --nMM_MERMPLAN_EXESO_09 
                        NULL, --nMM_MERMPLAN_09 
                        NULL, --nMM_MERMPRCO_10 
                        NULL, --nMM_MERMPLAN_EXESO_10 
                        NULL, --nMM_MERMPLAN_10 
                        NULL, --nMM_MERMPRCO 
                        NULL, --nMM_MERMPLAN_EXESO 
                        NULL); --nMM_MERMPLAN
               --Se actualiza el FCKG del Material en caso de no existir
               --IF t_MATERIAL(rMaterial.IDENTIFICADOR).FACTOR_CONVERSION_M2_KG IS NULL THEN
--dbms_Output.put_line('MATERIAL 1 LFS: '||rArticulo.COD_LFS||' COD_ARTI: '||t_MATERIAL(rMaterial.IDENTIFICADOR).COD_ARTI||'-> nFCKG1:'||nFCKG1);               
                  --t_MATERIAL(rMaterial.IDENTIFICADOR).FACTOR_CONVERSION_M2_KG := nFCKG1;
               --END IF;
               --ANTES ESTO SE REALIZABA AL PRINCIPIO
               --Se busca las Bobinas Generadas en Caso de Ser un Corte
               IF rBOBIMAQU.TIP_ARTI = vTiarCose THEN
                  FOR rCortes IN cCortes(rMaquinas.Contador, rConsumos.CoboGene) LOOP
--dbms_Output.put_line('cCortes:'||vEmpresa||', '||nNumeOtre||', '||rMaquinas.Contador||', '||rConsumos.CoboGene||', '||rCortes.ContBobi);                  
                     rBOBIMAQU_C := F_BOBIMAQU(vEmpresa, nNumeOtre, rMaquinas.Contador, rCortes.ContBobi);
                     --
                     IF NVL(rBOBIMAQU_C.ESTADO,'X') != 'X' THEN
                        rAncho_Corte.Ancho := NULL;
                        rAncho_Corte.Ancho_Total := NULL;
                        rAncho_Corte.Desbarbe := NULL;
                        rAncho_Corte.Numero_Bobinas_Corte := NULL;
                        --
                        OPEN cAncho_Corte(vEmpresa, nNumeOtre, rMaquinas.Contador, rCortes.NUMECORT);
                        FETCH cAncho_Corte INTO rAncho_Corte;
                        CLOSE cAncho_Corte;
                        --
								P_BOBIMAQU(rBOBIMAQU_C.IDENTIFICADOR,--nIdentificador
									  rAncho_Corte.Ancho,--nAncho 
									  NULL,--nAncho_Total 
									  NULL,--vDesbarbe 
									  NULL,--nNumero_Bobinas_Corte 
									  NULL,--nFACTOR_CONVERSION_M2_KG
                             NULL,--nPRECIO_ML
                             NULL);--nAncho_Bueno
                        --
								rBOBIMAQU_C.Ancho := rAncho_Corte.Ancho;
								--t_BOBIMAQU(rBOBIMAQU_C.IDENTIFICADOR).Ancho := rAncho_Corte.Ancho;
								P_BOBIMAQU(rBOBIMAQU_C.IDENTIFICADOR,--nIdentificador
									  NULL,--nAncho 
									  rAncho_Corte.Ancho_Total,--nAncho_Total 
									  NULL,--vDesbarbe 
									  NULL,--nNumero_Bobinas_Corte 
									  NULL,--nFACTOR_CONVERSION_M2_KG
                             NULL,--nPRECIO_ML
                             NULL);--nAncho_Bueno
                        --
								rBOBIMAQU_C.Ancho_Total := rAncho_Corte.Ancho_Total;
								--t_BOBIMAQU(rBOBIMAQU_C.IDENTIFICADOR).Ancho_Total := rAncho_Corte.Ancho_Total;
--dbms_Output.put_line('BOBINA PADRE: '||vEmpresa||'-'||nNumeOtre||'-'||rMaquinas.Contador||'-'||rConsumos.CoboGene||' CONTBOBI: '||rCortes.ContBobi||' ANCHO:' ||rAncho_Corte.Ancho||' Ancho_Total:'||rAncho_Corte.Ancho_Total);                                                                  
--dbms_Output.put_line('->'|| rBOBIMAQU_C.IDENTIFICADOR||'-'  ||rAncho_Corte.Desbarbe);                    
                        P_BOBIMAQU(rBOBIMAQU_C.IDENTIFICADOR,--nIdentificador
									  NULL,--nAncho 
									  NULL,--nAncho_Total 
									  rAncho_Corte.Desbarbe,--vDesbarbe 
									  NULL,--nNumero_Bobinas_Corte 
									  NULL,--nFACTOR_CONVERSION_M2_KG
                             NULL,--nPRECIO_ML
                             NULL);--nAncho_Bueno
								--
								rBOBIMAQU_C.Desbarbe := rAncho_Corte.Desbarbe;
								--t_BOBIMAQU(rBOBIMAQU_C.IDENTIFICADOR).Desbarbe := rAncho_Corte.Desbarbe;
                        P_BOBIMAQU(rBOBIMAQU_C.IDENTIFICADOR,--nIdentificador
									  NULL,--nAncho 
									  NULL,--nAncho_Total 
									  NULL,--vDesbarbe 
									  rAncho_Corte.Numero_Bobinas_Corte,--nNumero_Bobinas_Corte 
									  NULL,--nFACTOR_CONVERSION_M2_KG
                             NULL,--nPRECIO_ML
                             NULL);--nAncho_Bueno
								--
								rBOBIMAQU_C.Numero_Bobinas_Corte := rAncho_Corte.Numero_Bobinas_Corte;
								--t_BOBIMAQU(rBOBIMAQU_C.IDENTIFICADOR).Numero_Bobinas_Corte := rAncho_Corte.Numero_Bobinas_Corte;
                        --Hereda el factor del Material
--dbms_Output.put_line('FACTORXXX03 BOBINA PADRE: '||rBOBIMAQU.IDENTIFICADOR||'-'||vEmpresa||'-'||nNumeOtre||'-'||rMaquinas.Contador||'-'||rConsumos.CoboGene||' FACTOR HEREDA BOBINA: '||vEmpresa||'-'||nNumeOtre||'-'||rMaquinas.Contador||'-'||rCortes.ContBobi||'->'||rBOBIMAQU.FACTOR_CONVERSION_M2_KG);                                          
                        P_BOBIMAQU(rBOBIMAQU_C.IDENTIFICADOR,--nIdentificador
									  NULL,--nAncho 
									  NULL,--nAncho_Total 
									  NULL,--vDesbarbe 
									  NULL,--nNumero_Bobinas_Corte 
									  rBOBIMAQU.FACTOR_CONVERSION_M2_KG,--nFACTOR_CONVERSION_M2_KG
                             NULL,--nPRECIO_ML
                             NULL);--nAncho_Bueno
								--
								rBOBIMAQU_C.FACTOR_CONVERSION_M2_KG := rBOBIMAQU.FACTOR_CONVERSION_M2_KG;
								--t_BOBIMAQU(rBOBIMAQU_C.IDENTIFICADOR).FACTOR_CONVERSION_M2_KG := t_BOBIMAQU(rBOBIMAQU.IDENTIFICADOR).FACTOR_CONVERSION_M2_KG;
                     ELSE
                        --647 No se encuentra @1. [Contador @1]
                        P_ERRORES(vEmpresa, nNumeOtre, '647','la Bobina de Corte '||vEmpresa||'-'||nNumeOtre||'-'||rMaquinas.Contador||'-'||rCortes.ContBobi||'|8.1','R','E');
                        --dbms_output.put_line('Error 647: No se encuentra la Bobina de Corte '||vEmpresa||'-'||nNumeOtre||'-'||rMaquinas.Contador||'-'||rCortes.ContBobi);
                     END IF;
                  END LOOP;
--dbms_Output.put_line('FIN cCortes:'||vEmpresa||', '||nNumeOtre||', '||rMaquinas.Contador||', '||rConsumos.CoboGene);                  
               END IF;
               --ANTES ESTO SE REALIZABA AL PRINCIPIO
            ELSE --IF rConsumos.ContMate = 1 THEN
               IF (rBOBIMAQU.Ancho IS NULL AND nAncho1 < nAncho2) OR (rBOBIMAQU.Ancho IS NOT NULL AND nAncho1 < rBOBIMAQU.Ancho AND nAncho1 < nAncho2) THEN --Se actualiza el ancho de la Bobina
--dbms_Output.put_line('ANCHO2:'||nAncho1);               
                  P_BOBIMAQU(rBOBIMAQU.IDENTIFICADOR,--nIdentificador
									  nAncho1,--nAncho 
									  NULL,--nAncho_Total 
									  NULL,--vDesbarbe 
									  NULL,--nNumero_Bobinas_Corte 
									  NULL,--nFACTOR_CONVERSION_M2_KG
                             NULL,--nPRECIO_ML
                             NULL);--nAncho_Bueno
                  --
						rBOBIMAQU.Ancho := nAncho1;
						--t_BOBIMAQU(rBOBIMAQU.IDENTIFICADOR).Ancho := nAncho1;
               ELSIF (rBOBIMAQU.Ancho IS NULL AND nAncho2 < nAncho1) OR (rBOBIMAQU.Ancho IS NOT NULL AND nAncho2 < rBOBIMAQU.Ancho AND nAncho2 < nAncho1) THEN --Se actualiza el ancho de la Bobina
--dbms_Output.put_line('ANCHO3:'||nAncho2);               
                  P_BOBIMAQU(rBOBIMAQU.IDENTIFICADOR,--nIdentificador
									  nAncho2,--nAncho 
									  NULL,--nAncho_Total 
									  NULL,--vDesbarbe 
									  NULL,--nNumero_Bobinas_Corte 
									  NULL,--nFACTOR_CONVERSION_M2_KG
                             NULL,--nPRECIO_ML
                             NULL);--nAncho_Bueno
                  --
						rBOBIMAQU.Ancho := nAncho2;
						--t_BOBIMAQU(rBOBIMAQU.IDENTIFICADOR).Ancho := nAncho2;
               END IF;
					--
					P_MATERIAL(rMaterial,'U',
					           NULL,--nCantProd
								  NULL,--nCantCons_E
								  NULL,--nCantCons
								  NULL,--nCantAjus
								  nAncho2,--nAncho
								  NULL,--nFACTOR_CONVERSION_M2_KG
								  NULL,--nPrecio_ML_E
								  NULL,--vLog_Precio
								  NULL,--nMermEnhe_E
								  NULL,--nMermEnhe
								  NULL,--nMermAjus_E
								  NULL,--nMermAjus
								  NULL,--nMermCabo_E
								  NULL,--nMermCabo
								  NULL,--nMermPico_E
								  NULL,--nMermPico
                          NULL,--nMermTita
                          NULL,--nMermSane
                          NULL,--nCantCons_Bobinas
                          --
                        NULL, --nCONTFSMU_01 
                        NULL, --nCANTFSMU_01 
                        NULL, --nCATOFSMU 
                        NULL, --nCONTFSMU_02 
                        NULL, --nCANTFSMU_02 
                        NULL, --nCONTFSMU_03 
                        NULL, --nCANTFSMU_03 
                        NULL, --nCONTFSMU_04 
                        NULL, --nCANTFSMU_04 
                        NULL, --nCONTFSMU_05 
                        NULL, --nCANTFSMU_05 
                        NULL, --nCONTFSMU_06 
                        NULL, --nCANTFSMU_06 
                        NULL, --nCONTFSMU_07 
                        NULL, --nCANTFSMU_07 
                        NULL, --nCONTFSMU_08 
                        NULL, --nCANTFSMU_08 
                        NULL, --nCONTFSMU_09 
                        NULL, --nCANTFSMU_09 
                        NULL, --nCONTFSMU_10 
                        NULL, --nCANTFSMU_10 
                        NULL, --nANCHO_BUENO_TOTAL_01 
                        NULL, --nANCHO_BUENO_OT_01 
                        NULL, --nANCHO_BUENO_TOTAL_02 
                        NULL, --nANCHO_BUENO_OT_02 
                        NULL, --nANCHO_BUENO_TOTAL_03 
                        NULL, --nANCHO_BUENO_OT_03 
                        NULL, --nANCHO_BUENO_TOTAL_04 
                        NULL, --nANCHO_BUENO_OT_04 
                        NULL, --nANCHO_BUENO_TOTAL_05 
                        NULL, --nANCHO_BUENO_OT_05 
                        NULL, --nANCHO_BUENO_TOTAL_06 
                        NULL, --nANCHO_BUENO_OT_06 
                        NULL, --nANCHO_BUENO_TOTAL_07 
                        NULL, --nANCHO_BUENO_OT_07 
                        NULL, --nANCHO_BUENO_TOTAL_08 
                        NULL, --nANCHO_BUENO_OT_08 
                        NULL, --nANCHO_BUENO_TOTAL_09 
                        NULL, --nANCHO_BUENO_OT_09 
                        NULL, --nANCHO_BUENO_TOTAL_10 
                        NULL, --nANCHO_BUENO_OT_10 
                        NULL, --nANCHO_BUENO_TOTAL 
                        NULL, --nANCHO_BUENO_OT 
                        NULL, --nNUMECORT 
                        NULL, --nMM_MERMPRCO_01 
                        NULL, --nMM_MERMPLAN_EXESO_01 
                        NULL, --nMM_MERMPLAN_01 
                        NULL, --nMM_MERMPRCO_02 
                        NULL, --nMM_MERMPLAN_EXESO_02 
                        NULL, --nMM_MERMPLAN_02 
                        NULL, --nMM_MERMPRCO_03 
                        NULL, --nMM_MERMPLAN_EXESO_03 
                        NULL, --nMM_MERMPLAN_03 
                        NULL, --nMM_MERMPRCO_04 
                        NULL, --nMM_MERMPLAN_EXESO_04 
                        NULL, --nMM_MERMPLAN_04 
                        NULL, --nMM_MERMPRCO_05 
                        NULL, --nMM_MERMPLAN_EXESO_05 
                        NULL, --nMM_MERMPLAN_05 
                        NULL, --nMM_MERMPRCO_06 
                        NULL, --nMM_MERMPLAN_EXESO_06 
                        NULL, --nMM_MERMPLAN_06 
                        NULL, --nMM_MERMPRCO_07 
                        NULL, --nMM_MERMPLAN_EXESO_07 
                        NULL, --nMM_MERMPLAN_07 
                        NULL, --nMM_MERMPRCO_08 
                        NULL, --nMM_MERMPLAN_EXESO_08 
                        NULL, --nMM_MERMPLAN_08 
                        NULL, --nMM_MERMPRCO_09 
                        NULL, --nMM_MERMPLAN_EXESO_09 
                        NULL, --nMM_MERMPLAN_09 
                        NULL, --nMM_MERMPRCO_10 
                        NULL, --nMM_MERMPLAN_EXESO_10 
                        NULL, --nMM_MERMPLAN_10 
                        NULL, --nMM_MERMPRCO 
                        NULL, --nMM_MERMPLAN_EXESO 
                        NULL); --nMM_MERMPLAN
               --Se actualiza el ancho del Material en caso de no existir
               --IF t_MATERIAL(rMaterial.IDENTIFICADOR).Ancho IS NULL THEN
--dbms_Output.put_line('ANCHO4:'||nAncho2);               
                  --t_MATERIAL(rMaterial.IDENTIFICADOR).Ancho := nAncho2;
               --END IF;
               --Calculo de FCKG compuesto por los 2 Materiales
               IF NVL(nFCKG1,0) * NVL(nFCKG2,0) != 0 THEN
                  nFCKG := (nFCKG1 + nFCKG2) / (nFCKG1 * nFCKG2);
                  --Se invierte el valor para ser almacenado
                  IF NVL(nFCKG,0) != 0 THEN
                     nFCKG := 1 / nFCKG;
                  ELSE
                     nFCKG := 0;
                  END IF;
               ELSE
                  nFCKG := 0;
               END IF;
               --Se actualiza el FCKG de la Bobina en caso de no existir
               --IF t_BOBIMAQU(rBOBIMAQU.IDENTIFICADOR).FACTOR_CONVERSION_M2_KG IS NULL OR t_BOBIMAQU(rBOBIMAQU.IDENTIFICADOR).FACTOR_CONVERSION_M2_KG != nFCKG THEN
--dbms_Output.put_line('FACTORXXX04 BOBINA EN 2: '||rBOBIMAQU.IDENTIFICADOR||'-'||rBOBIMAQU.COD_ARTI||'LOTE:'||rBOBIMAQU.LOTE||'-> nFCKG:'||nFCKG);  
                  P_BOBIMAQU(rBOBIMAQU.IDENTIFICADOR,--nIdentificador
									  NULL,--nAncho 
									  NULL,--nAncho_Total 
									  NULL,--vDesbarbe 
									  NULL,--nNumero_Bobinas_Corte 
									  nFCKG,--nFACTOR_CONVERSION_M2_KG
                             NULL,--nPRECIO_ML
                             NULL);--nAncho_Bueno
						--
						rBOBIMAQU.FACTOR_CONVERSION_M2_KG := nFCKG;
						--t_BOBIMAQU(rBOBIMAQU.IDENTIFICADOR).FACTOR_CONVERSION_M2_KG := nFCKG;
                  --ANTES ESTO SE REALIZABA AL PRINCIPIO
                  --Se busca las Bobinas Generadas en Caso de Ser un Corte
                  IF rBOBIMAQU.TIP_ARTI = vTiarCose THEN
                     FOR rCortes IN cCortes(rMaquinas.Contador, rConsumos.CoboGene) LOOP
                        rBOBIMAQU_C := F_BOBIMAQU(vEmpresa, nNumeOtre, rMaquinas.Contador, rCortes.ContBobi);
                        --
                        IF NVL(rBOBIMAQU_C.ESTADO,'X') != 'X' THEN
                           --Se actualiza el FCKG de la Bobina en caso de no existir
                           --IF t_BOBIMAQU(rBOBIMAQU_C.IDENTIFICADOR).FACTOR_CONVERSION_M2_KG IS NULL OR t_BOBIMAQU(rBOBIMAQU_C.IDENTIFICADOR).FACTOR_CONVERSION_M2_KG != nFCKG THEN
--dbms_Output.put_line('FACTORXXX05 BOBINA PADRE: '||rBOBIMAQU.IDENTIFICADOR||'-'||vEmpresa||'-'||nNumeOtre||'-'||rMaquinas.Contador||'-'||rConsumos.CoboGene||' FACTOR ASIGNA BOBINA 2 MAT: '||vEmpresa||'-'||nNumeOtre||'-'||rMaquinas.Contador||'-'||rCortes.ContBobi||'->'||nFCKG);                                          
                              P_BOBIMAQU(rBOBIMAQU_C.IDENTIFICADOR,--nIdentificador
													  NULL,--nAncho 
													  NULL,--nAncho_Total 
													  NULL,--vDesbarbe 
													  NULL,--nNumero_Bobinas_Corte 
													  nFCKG,--nFACTOR_CONVERSION_M2_KG
                                         NULL,--nPRECIO_ML
                                         NULL);--nAncho_Bueno
										--
										rBOBIMAQU_C.FACTOR_CONVERSION_M2_KG := nFCKG;
										--t_BOBIMAQU(rBOBIMAQU_C.IDENTIFICADOR).FACTOR_CONVERSION_M2_KG := nFCKG;
                           --END IF;
                        ELSE
                           --647 No se encuentra @1. [Contador @1]
                           P_ERRORES(vEmpresa, nNumeOtre, '647','la Bobina de Corte '||vEmpresa||'-'||nNumeOtre||'-'||rMaquinas.Contador||'-'||rCortes.ContBobi||'|8.2','R','E');
                           --dbms_output.put_line('Error 647: No se encuentra la Bobina de Corte '||vEmpresa||'-'||nNumeOtre||'-'||rMaquinas.Contador||'-'||rCortes.ContBobi);
                        END IF;
                     END LOOP;
                  END IF;
               --ANTES ESTO SE REALIZABA AL PRINCIPIO
               --END IF;
               --Se actualiza el FCKG del Material en caso de no existir
					--
--dbms_Output.put_line('FACTORXXX06+ BOBINA EN 2: '||rMaterial.IDENTIFICADOR||'-'||rMaterial.COD_ARTI||'LOTE:'||rMaterial.LOTE||'-> nFCKG1:'||nFCKG2); 
					P_MATERIAL(rMaterial,'U',
					           NULL,--nCantProd
								  NULL,--nCantCons_E
								  NULL,--nCantCons
								  NULL,--nCantAjus
								  NULL,--nAncho
								  nFCKG2,--nFACTOR_CONVERSION_M2_KG
								  NULL,--nPrecio_ML_E
								  NULL,--vLog_Precio
								  NULL,--nMermEnhe_E
								  NULL,--nMermEnhe
								  NULL,--nMermAjus_E
								  NULL,--nMermAjus
								  NULL,--nMermCabo_E
								  NULL,--nMermCabo
								  NULL,--nMermPico_E
								  NULL,--nMermPico
                          NULL,--nMermTita
                          NULL,--nMermSane
                          NULL,--nCantCons_Bobinas
                          --
                        NULL, --nCONTFSMU_01 
                        NULL, --nCANTFSMU_01 
                        NULL, --nCATOFSMU 
                        NULL, --nCONTFSMU_02 
                        NULL, --nCANTFSMU_02 
                        NULL, --nCONTFSMU_03 
                        NULL, --nCANTFSMU_03 
                        NULL, --nCONTFSMU_04 
                        NULL, --nCANTFSMU_04 
                        NULL, --nCONTFSMU_05 
                        NULL, --nCANTFSMU_05 
                        NULL, --nCONTFSMU_06 
                        NULL, --nCANTFSMU_06 
                        NULL, --nCONTFSMU_07 
                        NULL, --nCANTFSMU_07 
                        NULL, --nCONTFSMU_08 
                        NULL, --nCANTFSMU_08 
                        NULL, --nCONTFSMU_09 
                        NULL, --nCANTFSMU_09 
                        NULL, --nCONTFSMU_10 
                        NULL, --nCANTFSMU_10 
                        NULL, --nANCHO_BUENO_TOTAL_01 
                        NULL, --nANCHO_BUENO_OT_01 
                        NULL, --nANCHO_BUENO_TOTAL_02 
                        NULL, --nANCHO_BUENO_OT_02 
                        NULL, --nANCHO_BUENO_TOTAL_03 
                        NULL, --nANCHO_BUENO_OT_03 
                        NULL, --nANCHO_BUENO_TOTAL_04 
                        NULL, --nANCHO_BUENO_OT_04 
                        NULL, --nANCHO_BUENO_TOTAL_05 
                        NULL, --nANCHO_BUENO_OT_05 
                        NULL, --nANCHO_BUENO_TOTAL_06 
                        NULL, --nANCHO_BUENO_OT_06 
                        NULL, --nANCHO_BUENO_TOTAL_07 
                        NULL, --nANCHO_BUENO_OT_07 
                        NULL, --nANCHO_BUENO_TOTAL_08 
                        NULL, --nANCHO_BUENO_OT_08 
                        NULL, --nANCHO_BUENO_TOTAL_09 
                        NULL, --nANCHO_BUENO_OT_09 
                        NULL, --nANCHO_BUENO_TOTAL_10 
                        NULL, --nANCHO_BUENO_OT_10 
                        NULL, --nANCHO_BUENO_TOTAL 
                        NULL, --nANCHO_BUENO_OT 
                        NULL, --nNUMECORT 
                        NULL, --nMM_MERMPRCO_01 
                        NULL, --nMM_MERMPLAN_EXESO_01 
                        NULL, --nMM_MERMPLAN_01 
                        NULL, --nMM_MERMPRCO_02 
                        NULL, --nMM_MERMPLAN_EXESO_02 
                        NULL, --nMM_MERMPLAN_02 
                        NULL, --nMM_MERMPRCO_03 
                        NULL, --nMM_MERMPLAN_EXESO_03 
                        NULL, --nMM_MERMPLAN_03 
                        NULL, --nMM_MERMPRCO_04 
                        NULL, --nMM_MERMPLAN_EXESO_04 
                        NULL, --nMM_MERMPLAN_04 
                        NULL, --nMM_MERMPRCO_05 
                        NULL, --nMM_MERMPLAN_EXESO_05 
                        NULL, --nMM_MERMPLAN_05 
                        NULL, --nMM_MERMPRCO_06 
                        NULL, --nMM_MERMPLAN_EXESO_06 
                        NULL, --nMM_MERMPLAN_06 
                        NULL, --nMM_MERMPRCO_07 
                        NULL, --nMM_MERMPLAN_EXESO_07 
                        NULL, --nMM_MERMPLAN_07 
                        NULL, --nMM_MERMPRCO_08 
                        NULL, --nMM_MERMPLAN_EXESO_08 
                        NULL, --nMM_MERMPLAN_08 
                        NULL, --nMM_MERMPRCO_09 
                        NULL, --nMM_MERMPLAN_EXESO_09 
                        NULL, --nMM_MERMPLAN_09 
                        NULL, --nMM_MERMPRCO_10 
                        NULL, --nMM_MERMPLAN_EXESO_10 
                        NULL, --nMM_MERMPLAN_10 
                        NULL, --nMM_MERMPRCO 
                        NULL, --nMM_MERMPLAN_EXESO 
                        NULL); --nMM_MERMPLAN
               --IF t_MATERIAL(rMaterial.IDENTIFICADOR).FACTOR_CONVERSION_M2_KG IS NULL OR t_MATERIAL(rMaterial.IDENTIFICADOR).FACTOR_CONVERSION_M2_KG != nFCKG THEN
               --IF t_MATERIAL(rMaterial.IDENTIFICADOR).FACTOR_CONVERSION_M2_KG IS NULL THEN
--dbms_Output.put_line('MATERIAL 2 LFS: '||rArticulo.COD_LFS||' COD_ARTI: '||t_MATERIAL(rMaterial.IDENTIFICADOR).COD_ARTI||'-> nFCKG2:'||nFCKG2);               
                  --t_MATERIAL(rMaterial.IDENTIFICADOR).FACTOR_CONVERSION_M2_KG := nFCKG2;
               --END IF;
            END IF;
            --
            IF nNumeMate = rConsumos.ContMate THEN
               nAncho1 := NULL;
               nAncho2 := NULL;
            END IF;
            --Actualización de Precio de MP
            --IF t_MATERIAL(rMaterial.IDENTIFICADOR).Precio_ML IS NULL THEN --Si es Materia Prima
               IF rConsumos.CoboBobi > 0 THEN --Se trata de una Bobina Generada
						vLogPreci := NULL;
                  vPrecio := F_PRECIO(vEmpresa, nNumeOtre, 
												  rConsumos.Tip_Arti, rConsumos.Cod_Arti, '|EMPRBOBI:'||rConsumos.EmprBobi||'|NUOTBOBI:'||rConsumos.NuotBobi||'|CONTBOBI:'||rConsumos.ContBobi||'|COBOBOBI:'||rConsumos.CoboBobi||'|LOTE:'||rConsumos.Lote,
												  NULL, NULL, NULL, NULL); 
						--
						P_MATERIAL(rMaterial,'U',
									  NULL,--nCantProd
									  NULL,--nCantCons_E
									  NULL,--nCantCons
									  NULL,--nCantAjus
									  NULL,--nAncho
									  NULL,--nFACTOR_CONVERSION_M2_KG
									  NULL,--nPrecio_ML_E
									  vPrecio,--vLog_Precio
									  NULL,--nMermEnhe_E
									  NULL,--nMermEnhe
									  NULL,--nMermAjus_E
									  NULL,--nMermAjus
									  NULL,--nMermCabo_E
									  NULL,--nMermCabo
									  NULL,--nMermPico_E
									  NULL,--nMermPico
                             NULL,--nMermTita
                             NULL,--nMermSane
                             NULL,--nCantCons_Bobinas
                             --
                        NULL, --nCONTFSMU_01 
                        NULL, --nCANTFSMU_01 
                        NULL, --nCATOFSMU 
                        NULL, --nCONTFSMU_02 
                        NULL, --nCANTFSMU_02 
                        NULL, --nCONTFSMU_03 
                        NULL, --nCANTFSMU_03 
                        NULL, --nCONTFSMU_04 
                        NULL, --nCANTFSMU_04 
                        NULL, --nCONTFSMU_05 
                        NULL, --nCANTFSMU_05 
                        NULL, --nCONTFSMU_06 
                        NULL, --nCANTFSMU_06 
                        NULL, --nCONTFSMU_07 
                        NULL, --nCANTFSMU_07 
                        NULL, --nCONTFSMU_08 
                        NULL, --nCANTFSMU_08 
                        NULL, --nCONTFSMU_09 
                        NULL, --nCANTFSMU_09 
                        NULL, --nCONTFSMU_10 
                        NULL, --nCANTFSMU_10 
                        NULL, --nANCHO_BUENO_TOTAL_01 
                        NULL, --nANCHO_BUENO_OT_01 
                        NULL, --nANCHO_BUENO_TOTAL_02 
                        NULL, --nANCHO_BUENO_OT_02 
                        NULL, --nANCHO_BUENO_TOTAL_03 
                        NULL, --nANCHO_BUENO_OT_03 
                        NULL, --nANCHO_BUENO_TOTAL_04 
                        NULL, --nANCHO_BUENO_OT_04 
                        NULL, --nANCHO_BUENO_TOTAL_05 
                        NULL, --nANCHO_BUENO_OT_05 
                        NULL, --nANCHO_BUENO_TOTAL_06 
                        NULL, --nANCHO_BUENO_OT_06 
                        NULL, --nANCHO_BUENO_TOTAL_07 
                        NULL, --nANCHO_BUENO_OT_07 
                        NULL, --nANCHO_BUENO_TOTAL_08 
                        NULL, --nANCHO_BUENO_OT_08 
                        NULL, --nANCHO_BUENO_TOTAL_09 
                        NULL, --nANCHO_BUENO_OT_09 
                        NULL, --nANCHO_BUENO_TOTAL_10 
                        NULL, --nANCHO_BUENO_OT_10 
                        NULL, --nANCHO_BUENO_TOTAL 
                        NULL, --nANCHO_BUENO_OT 
                        NULL, --nNUMECORT 
                        NULL, --nMM_MERMPRCO_01 
                        NULL, --nMM_MERMPLAN_EXESO_01 
                        NULL, --nMM_MERMPLAN_01 
                        NULL, --nMM_MERMPRCO_02 
                        NULL, --nMM_MERMPLAN_EXESO_02 
                        NULL, --nMM_MERMPLAN_02 
                        NULL, --nMM_MERMPRCO_03 
                        NULL, --nMM_MERMPLAN_EXESO_03 
                        NULL, --nMM_MERMPLAN_03 
                        NULL, --nMM_MERMPRCO_04 
                        NULL, --nMM_MERMPLAN_EXESO_04 
                        NULL, --nMM_MERMPLAN_04 
                        NULL, --nMM_MERMPRCO_05 
                        NULL, --nMM_MERMPLAN_EXESO_05 
                        NULL, --nMM_MERMPLAN_05 
                        NULL, --nMM_MERMPRCO_06 
                        NULL, --nMM_MERMPLAN_EXESO_06 
                        NULL, --nMM_MERMPLAN_06 
                        NULL, --nMM_MERMPRCO_07 
                        NULL, --nMM_MERMPLAN_EXESO_07 
                        NULL, --nMM_MERMPLAN_07 
                        NULL, --nMM_MERMPRCO_08 
                        NULL, --nMM_MERMPLAN_EXESO_08 
                        NULL, --nMM_MERMPLAN_08 
                        NULL, --nMM_MERMPRCO_09 
                        NULL, --nMM_MERMPLAN_EXESO_09 
                        NULL, --nMM_MERMPLAN_09 
                        NULL, --nMM_MERMPRCO_10 
                        NULL, --nMM_MERMPLAN_EXESO_10 
                        NULL, --nMM_MERMPLAN_10 
                        NULL, --nMM_MERMPRCO 
                        NULL, --nMM_MERMPLAN_EXESO 
                        NULL); --nMM_MERMPLAN
                  --t_MATERIAL(rMaterial.IDENTIFICADOR).Precio_ML := F_PRECIO(vEmpresa, nNumeOtre, 
                  --                                                          rConsumos.Tip_Arti, rConsumos.Cod_Arti, '|EMPRBOBI:'||rConsumos.EmprBobi||'|NUOTBOBI:'||rConsumos.NuotBobi||'|CONTBOBI:'||rConsumos.ContBobi||'|COBOBOBI:'||rConsumos.CoboBobi||'|LOTE:'||rConsumos.Lote,
                  --                                                          NULL, NULL, NULL, NULL);
                  --t_MATERIAL(rMaterial.IDENTIFICADOR).Precio_ML_E := F_PRECIO_E(vEmpresa, nNumeOtre, 
                  --                                                              rConsumos.Tip_Arti, rConsumos.Cod_Arti, '|EMPRBOBI:'||rConsumos.EmprBobi||'|NUOTBOBI:'||rConsumos.NuotBobi||'|CONTBOBI:'||rConsumos.ContBobi||'|COBOBOBI:'||rConsumos.CoboBobi||'|LOTE:'||rConsumos.Lote,
                  --                                                              NULL, NULL, NULL, NULL);
               ELSE
						vLogPreci := NULL;
                  vPrecio := F_PRECIO(vEmpresa, nNumeOtre, 
												  rConsumos.Tip_Arti, rConsumos.Cod_Arti, rConsumos.Lote,
												  rArticulo.Cod_LFS, rArticulo.Ancho, rArticulo.UnidStoc, rArticulo.FCKG);
						--
						P_MATERIAL(rMaterial,'U',
									  NULL,--nCantProd
									  NULL,--nCantCons_E
									  NULL,--nCantCons
									  NULL,--nCantAjus
									  NULL,--nAncho
									  NULL,--nFACTOR_CONVERSION_M2_KG
									  NULL,--nPrecio_ML_E
									  vPrecio,--vLog_Precio
									  NULL,--nMermEnhe_E
									  NULL,--nMermEnhe
									  NULL,--nMermAjus_E
									  NULL,--nMermAjus
									  NULL,--nMermCabo_E
									  NULL,--nMermCabo
									  NULL,--nMermPico_E
									  NULL,--nMermPico
                             NULL,--nMermTita
                             NULL,--nMermSane
                             NULL,--nCantCons_Bobinas
                             --
                        NULL, --nCONTFSMU_01 
                        NULL, --nCANTFSMU_01 
                        NULL, --nCATOFSMU 
                        NULL, --nCONTFSMU_02 
                        NULL, --nCANTFSMU_02 
                        NULL, --nCONTFSMU_03 
                        NULL, --nCANTFSMU_03 
                        NULL, --nCONTFSMU_04 
                        NULL, --nCANTFSMU_04 
                        NULL, --nCONTFSMU_05 
                        NULL, --nCANTFSMU_05 
                        NULL, --nCONTFSMU_06 
                        NULL, --nCANTFSMU_06 
                        NULL, --nCONTFSMU_07 
                        NULL, --nCANTFSMU_07 
                        NULL, --nCONTFSMU_08 
                        NULL, --nCANTFSMU_08 
                        NULL, --nCONTFSMU_09 
                        NULL, --nCANTFSMU_09 
                        NULL, --nCONTFSMU_10 
                        NULL, --nCANTFSMU_10 
                        NULL, --nANCHO_BUENO_TOTAL_01 
                        NULL, --nANCHO_BUENO_OT_01 
                        NULL, --nANCHO_BUENO_TOTAL_02 
                        NULL, --nANCHO_BUENO_OT_02 
                        NULL, --nANCHO_BUENO_TOTAL_03 
                        NULL, --nANCHO_BUENO_OT_03 
                        NULL, --nANCHO_BUENO_TOTAL_04 
                        NULL, --nANCHO_BUENO_OT_04 
                        NULL, --nANCHO_BUENO_TOTAL_05 
                        NULL, --nANCHO_BUENO_OT_05 
                        NULL, --nANCHO_BUENO_TOTAL_06 
                        NULL, --nANCHO_BUENO_OT_06 
                        NULL, --nANCHO_BUENO_TOTAL_07 
                        NULL, --nANCHO_BUENO_OT_07 
                        NULL, --nANCHO_BUENO_TOTAL_08 
                        NULL, --nANCHO_BUENO_OT_08 
                        NULL, --nANCHO_BUENO_TOTAL_09 
                        NULL, --nANCHO_BUENO_OT_09 
                        NULL, --nANCHO_BUENO_TOTAL_10 
                        NULL, --nANCHO_BUENO_OT_10 
                        NULL, --nANCHO_BUENO_TOTAL 
                        NULL, --nANCHO_BUENO_OT 
                        NULL, --nNUMECORT 
                        NULL, --nMM_MERMPRCO_01 
                        NULL, --nMM_MERMPLAN_EXESO_01 
                        NULL, --nMM_MERMPLAN_01 
                        NULL, --nMM_MERMPRCO_02 
                        NULL, --nMM_MERMPLAN_EXESO_02 
                        NULL, --nMM_MERMPLAN_02 
                        NULL, --nMM_MERMPRCO_03 
                        NULL, --nMM_MERMPLAN_EXESO_03 
                        NULL, --nMM_MERMPLAN_03 
                        NULL, --nMM_MERMPRCO_04 
                        NULL, --nMM_MERMPLAN_EXESO_04 
                        NULL, --nMM_MERMPLAN_04 
                        NULL, --nMM_MERMPRCO_05 
                        NULL, --nMM_MERMPLAN_EXESO_05 
                        NULL, --nMM_MERMPLAN_05 
                        NULL, --nMM_MERMPRCO_06 
                        NULL, --nMM_MERMPLAN_EXESO_06 
                        NULL, --nMM_MERMPLAN_06 
                        NULL, --nMM_MERMPRCO_07 
                        NULL, --nMM_MERMPLAN_EXESO_07 
                        NULL, --nMM_MERMPLAN_07 
                        NULL, --nMM_MERMPRCO_08 
                        NULL, --nMM_MERMPLAN_EXESO_08 
                        NULL, --nMM_MERMPLAN_08 
                        NULL, --nMM_MERMPRCO_09 
                        NULL, --nMM_MERMPLAN_EXESO_09 
                        NULL, --nMM_MERMPLAN_09 
                        NULL, --nMM_MERMPRCO_10 
                        NULL, --nMM_MERMPLAN_EXESO_10 
                        NULL, --nMM_MERMPLAN_10 
                        NULL, --nMM_MERMPRCO 
                        NULL, --nMM_MERMPLAN_EXESO 
                        NULL); --nMM_MERMPLAN
                  --t_MATERIAL(rMaterial.IDENTIFICADOR).Precio_ML := F_PRECIO(vEmpresa, nNumeOtre, 
                  --                                                          rConsumos.Tip_Arti, rConsumos.Cod_Arti, rConsumos.Lote,
                  --                                                          rArticulo.Cod_LFS, rArticulo.Ancho, rArticulo.UnidStoc, rArticulo.FCKG);
                  --t_MATERIAL(rMaterial.IDENTIFICADOR).Precio_ML_E := F_PRECIO_E(vEmpresa, nNumeOtre, 
                  --                                                              rConsumos.Tip_Arti, rConsumos.Cod_Arti, rConsumos.Lote,
                  --                                                              rArticulo.Cod_LFS, rArticulo.Ancho, rArticulo.UnidStoc, rArticulo.FCKG);
               END IF;
            --END IF;
         END LOOP;
         -->FIN DE BOBINAS DE PASADAS DE MAQUINA
--dbms_output.put_line('Maquina Planificada: '||rMaquinas.Contador||'-'||rMaquinas.MaquCodi||', Numero de Materiales Consumido: '||nNumeMate);
         --
         nMerma_Ajuste_M1 := NULL;
         nMerma_Ajuste_M2 := NULL;
         nMerma_Ajuste_M1_E := NULL;
         nMerma_Ajuste_M2_E := NULL;
         nMerma_CambBobi_M1 := NULL;
         nMerma_CambBobi_M2 := NULL;
         nMerma_CambBobi_M1_E := NULL;
         nMerma_CambBobi_M2_E := NULL;
         nMerma_Picos_M1 := NULL;
         nMerma_Picos_M2 := NULL;
         nMerma_Picos_M1_E := NULL;
         nMerma_Picos_M2_E := NULL;
         nMerma_Enhebrado_M1 := NULL;
         nMerma_Enhebrado_M2 := NULL;
         nMerma_Enhebrado_M1_E := NULL;
         nMerma_Enhebrado_M2_E := NULL;
         --Si es una maquina que ha tenido Pasadas se realiza esto, puede ser que sea por Ejemplo una maquina Cortadora lanzada solamente para etiquetar o que todavia no se ha hecho nada en la maquina
         IF NVL(nNumeMate,0) > 0 THEN
            --TRATAMIENTO DE MERMAS
            --Se busca el 1er Material Consumido en las Pasadas para asignarle valores estandar al tratamiento real donde este específicado de esta forma
            rMaterial_B1 := F_MATERIAL(vEmpresa, nNumeOtre, rMaquinas.Contador, 
                                      NULL, NULL, NULL,
                                      1, 1);
            --
            rMaterial_B2 := F_MATERIAL(vEmpresa, nNumeOtre, rMaquinas.Contador, 
                                      NULL, NULL, NULL,
                                      2, 1);
            --Solo Aplica para Laqueadora y Laminadora para Buscar las Pasadas --SE PONE EN ESTE NIVEL PARA CUANDO SE TRATE EL TEMA ESTANDAR
            IF SUBSTR(rMaquinas.MaquCodi,1,INSTR(rMaquinas.MaquCodi,' ')-1) IN ('LAQUEADORA','LAMINADORA') THEN
               --Las Laqueadoras y Laminadoras dependen de las Pasadas que tengan, para esto hay que verificar cuantas pasadas hay hasta este punto
               nNumePasa := 1;--Equivalente a la pasada actual
               --
               IF t_PASADAS.Count > 0 THEN
                  t_PASADAS.DELETE;
               END IF;
               --
               rPASADAS.CONTADOR := rMaquinas.Contador;
               --
               t_PASADAS(t_PASADAS.Count + 1) := rPASADAS;
               --Se realiza este Loop por que hay que verificar todo hacia atras
               LOOP
                  IF t_PASADAS_C.Count > 0 THEN
                     t_PASADAS_C.DELETE;
                  END IF;
                  --
                  FOR nI In 1..T_PASADAS.COUNT LOOP
                     biIndice   := nI;
                     rPASADAS_B := T_PASADAS(biIndice);
                     --
                     FOR rVeriMaan IN cVeriMaan(rPASADAS_B.Contador) LOOP
                        IF SUBSTR(rVeriMaan.MaquCodi,1,INSTR(rVeriMaan.MaquCodi,' ')-1) = 'LAQUEADORA' THEN
                           nNumePasa := nNumePasa + 1;
                        END IF;
                        --Guarda el Contador encontrado de Pasadas Anteriores para Verificar si existen Maquinas antes de Este
                        rPASADAS.CONTADOR := rVeriMaan.Contador;
                        --
                        t_PASADAS_C(t_PASADAS_C.Count + 1) := rPASADAS;
                     END LOOP;
                  END LOOP;
                  --
                  IF NVL(t_PASADAS_C.Count,0) = 0 THEN
                     EXIT WHEN TRUE;
                  END IF;
                  --
                  IF t_PASADAS.Count > 0 THEN
                     t_PASADAS.DELETE;
                  END IF;
                  --
                  t_PASADAS := t_PASADAS_C;
               END LOOP;
               --La linea solo aplica para Caracteristicas de Laqueadora
               IF SUBSTR(rMaquinas.MaquCodi,1,INSTR(rMaquinas.MaquCodi,' ')-1)= ('LAQUEADORA') THEN
                  vLinea := SUBSTR(vMatBase,1,2);
                  --
                  IF vLinea IS NULL THEN 
                     vLinea := '**';--Debe ser asi porque sino el cursor de Caracteristicas tratara por NULL
                  END IF;
               ELSE
                  vLinea := NULL;
               END IF;
               --
--dbms_output.put_line('   PASADAS: '||nNumePasa||' LINEA: '||vLinea);
            ELSE
               --En este caso el cursor de Caracteristicas no tendrá en cuenta estos valores
               nNumePasa := NULL;
               vLinea := NULL;
            END IF;            
            --ENHEBRADO
            --Parte REAL
            bCaAuEnhe := FALSE; --Controla si la Máquina tiene tratamiento Automatico o Real para el tratamiento REAL
--dbms_output.put_line('ENHEBRAD1: '||rMaquinas.MaquCodi||','||rMaquinas.Contador||','||vLinea||','||nNumePasa);
            --Se busca si la Maquina tiene valor de Ajuste Automatico o Real para el tratamiento REAL
            FOR rCaracteristica_Maquina IN cCaracteristica_Maquina('ENHEBRAD',rMaquinas.MaquCodi,vLinea,nNumePasa) LOOP --Pueden ser varios Eventos, tambien podria aplicar a varias Caracteristicas
--dbms_output.put_line('ENHEBRAD2: '||rCaracteristica_Maquina.Caracteristica);
               --Si se encuentra caracteristica es una Merma Automatica (Captación Estandar)
               IF rCaracteristica_Maquina.Caracteristica IS NOT NULL THEN
                  --Parte ESTANDAR
                  --Se realizan las busquedas de Mermas en las Maquinas Utilizadas en las Pasadas
                  FOR rMaquinas_Utilizadas IN cMaquinas_Utilizadas(rMaquinas.Contador) LOOP
                     nMaquCara_M1 := NULL;
                     nMaquCara_M2 := NULL;
                     --
--dbms_output.put_line('ENHEBRAD3: '||rMaquinas_Utilizadas.MaquCodi||','||rCaracteristica_Maquina.Caracteristica||','||rCaracteristica_Maquina.Caracteristica2);
                     OPEN cPRD_MAQUCARA(rMaquinas.MaquTipo,rMaquinas_Utilizadas.MaquCodi,rCaracteristica_Maquina.Caracteristica);
                     FETCH cPRD_MAQUCARA INTO nMaquCara_M1;
                     CLOSE cPRD_MAQUCARA;
                     --Se verifica si existe la Caracteristica 2 En caso de Laminadoras Material 2
                     IF rCaracteristica_Maquina.Caracteristica2 IS NOT NULL THEN
                        OPEN cPRD_MAQUCARA(rMaquinas.MaquTipo,rMaquinas_Utilizadas.MaquCodi,rCaracteristica_Maquina.Caracteristica2);
                        FETCH cPRD_MAQUCARA INTO nMaquCara_M2;
                        CLOSE cPRD_MAQUCARA;
                     END IF;
                     --
--dbms_output.put_line('ENHEBRAD3: '||NVL(nMerma_Enhebrado_M1_E,0)||' + '||NVL(nMaquCara_M1,0));
                     nMerma_Enhebrado_M1_E := NVL(nMerma_Enhebrado_M1_E,0) + NVL(nMaquCara_M1,0);
--dbms_output.put_line('ENHEBRAD4: '||NVL(nMerma_Enhebrado_M2_E,0)||' + '||NVL(nMaquCara_M2,0));
                     nMerma_Enhebrado_M2_E := NVL(nMerma_Enhebrado_M2_E,0) + NVL(nMaquCara_M2,0);
                  END LOOP;
                  --Enhebrado Estandar
                  IF rMATERIAL_B1.IDENTIFICADOR IS NOT NULL THEN
                     P_MATERIAL(rMATERIAL_B1,'U',
										  NULL,--nCantProd
										  NULL,--nCantCons_E
										  NULL,--nCantCons
										  NULL,--nCantAjus
										  NULL,--nAncho
										  NULL,--nFACTOR_CONVERSION_M2_KG
										  NULL,--nPrecio_ML_E
										  NULL,--vLog_Precio
										  nMerma_Enhebrado_M1_E,--nMermEnhe_E
										  NULL,--nMermEnhe
										  NULL,--nMermAjus_E
										  NULL,--nMermAjus
										  NULL,--nMermCabo_E
										  NULL,--nMermCabo
										  NULL,--nMermPico_E
										  NULL,--nMermPico
                                NULL,--nMermTita
                                NULL,--nMermSane
                                NULL,--nCantCons_Bobinas
                                --
                              NULL, --nCONTFSMU_01 
                              NULL, --nCANTFSMU_01 
                              NULL, --nCATOFSMU 
                              NULL, --nCONTFSMU_02 
                              NULL, --nCANTFSMU_02 
                              NULL, --nCONTFSMU_03 
                              NULL, --nCANTFSMU_03 
                              NULL, --nCONTFSMU_04 
                              NULL, --nCANTFSMU_04 
                              NULL, --nCONTFSMU_05 
                              NULL, --nCANTFSMU_05 
                              NULL, --nCONTFSMU_06 
                              NULL, --nCANTFSMU_06 
                              NULL, --nCONTFSMU_07 
                              NULL, --nCANTFSMU_07 
                              NULL, --nCONTFSMU_08 
                              NULL, --nCANTFSMU_08 
                              NULL, --nCONTFSMU_09 
                              NULL, --nCANTFSMU_09 
                              NULL, --nCONTFSMU_10 
                              NULL, --nCANTFSMU_10 
                              NULL, --nANCHO_BUENO_TOTAL_01 
                              NULL, --nANCHO_BUENO_OT_01 
                              NULL, --nANCHO_BUENO_TOTAL_02 
                              NULL, --nANCHO_BUENO_OT_02 
                              NULL, --nANCHO_BUENO_TOTAL_03 
                              NULL, --nANCHO_BUENO_OT_03 
                              NULL, --nANCHO_BUENO_TOTAL_04 
                              NULL, --nANCHO_BUENO_OT_04 
                              NULL, --nANCHO_BUENO_TOTAL_05 
                              NULL, --nANCHO_BUENO_OT_05 
                              NULL, --nANCHO_BUENO_TOTAL_06 
                              NULL, --nANCHO_BUENO_OT_06 
                              NULL, --nANCHO_BUENO_TOTAL_07 
                              NULL, --nANCHO_BUENO_OT_07 
                              NULL, --nANCHO_BUENO_TOTAL_08 
                              NULL, --nANCHO_BUENO_OT_08 
                              NULL, --nANCHO_BUENO_TOTAL_09 
                              NULL, --nANCHO_BUENO_OT_09 
                              NULL, --nANCHO_BUENO_TOTAL_10 
                              NULL, --nANCHO_BUENO_OT_10 
                              NULL, --nANCHO_BUENO_TOTAL 
                              NULL, --nANCHO_BUENO_OT 
                              NULL, --nNUMECORT 
                              NULL, --nMM_MERMPRCO_01 
                              NULL, --nMM_MERMPLAN_EXESO_01 
                              NULL, --nMM_MERMPLAN_01 
                              NULL, --nMM_MERMPRCO_02 
                              NULL, --nMM_MERMPLAN_EXESO_02 
                              NULL, --nMM_MERMPLAN_02 
                              NULL, --nMM_MERMPRCO_03 
                              NULL, --nMM_MERMPLAN_EXESO_03 
                              NULL, --nMM_MERMPLAN_03 
                              NULL, --nMM_MERMPRCO_04 
                              NULL, --nMM_MERMPLAN_EXESO_04 
                              NULL, --nMM_MERMPLAN_04 
                              NULL, --nMM_MERMPRCO_05 
                              NULL, --nMM_MERMPLAN_EXESO_05 
                              NULL, --nMM_MERMPLAN_05 
                              NULL, --nMM_MERMPRCO_06 
                              NULL, --nMM_MERMPLAN_EXESO_06 
                              NULL, --nMM_MERMPLAN_06 
                              NULL, --nMM_MERMPRCO_07 
                              NULL, --nMM_MERMPLAN_EXESO_07 
                              NULL, --nMM_MERMPLAN_07 
                              NULL, --nMM_MERMPRCO_08 
                              NULL, --nMM_MERMPLAN_EXESO_08 
                              NULL, --nMM_MERMPLAN_08 
                              NULL, --nMM_MERMPRCO_09 
                              NULL, --nMM_MERMPLAN_EXESO_09 
                              NULL, --nMM_MERMPLAN_09 
                              NULL, --nMM_MERMPRCO_10 
                              NULL, --nMM_MERMPLAN_EXESO_10 
                              NULL, --nMM_MERMPLAN_10 
                              NULL, --nMM_MERMPRCO 
                              NULL, --nMM_MERMPLAN_EXESO 
                              NULL); --nMM_MERMPLAN
							--t_MATERIAL(rMATERIAL_B1.IDENTIFICADOR).MermEnhe_E := NVL(t_MATERIAL(rMATERIAL_B1.IDENTIFICADOR).MermEnhe_E,0) + nMerma_Enhebrado_M1_E;
--ELSE dbms_output.put_line('3 IDENTIFICADOR IS NULL '||rMATERIAL_B1.Empresa||', '||rMATERIAL_B1.NumeOtre||', '||rMATERIAL_B1.Contador);
                  END IF;
                  --
                  IF rMATERIAL_B2.IDENTIFICADOR IS NOT NULL THEN
                     P_MATERIAL(rMATERIAL_B2,'U',
										  NULL,--nCantProd
										  NULL,--nCantCons_E
										  NULL,--nCantCons
										  NULL,--nCantAjus
										  NULL,--nAncho
										  NULL,--nFACTOR_CONVERSION_M2_KG
										  NULL,--nPrecio_ML_E
										  NULL,--vLog_Precio
										  nMerma_Enhebrado_M2_E,--nMermEnhe_E
										  NULL,--nMermEnhe
										  NULL,--nMermAjus_E
										  NULL,--nMermAjus
										  NULL,--nMermCabo_E
										  NULL,--nMermCabo
										  NULL,--nMermPico_E
										  NULL,--nMermPico
                                NULL,--nMermTita
                                NULL,--nMermSane
                                NULL,--nCantCons_Bobinas
                                --
                              NULL, --nCONTFSMU_01 
                              NULL, --nCANTFSMU_01 
                              NULL, --nCATOFSMU 
                              NULL, --nCONTFSMU_02 
                              NULL, --nCANTFSMU_02 
                              NULL, --nCONTFSMU_03 
                              NULL, --nCANTFSMU_03 
                              NULL, --nCONTFSMU_04 
                              NULL, --nCANTFSMU_04 
                              NULL, --nCONTFSMU_05 
                              NULL, --nCANTFSMU_05 
                              NULL, --nCONTFSMU_06 
                              NULL, --nCANTFSMU_06 
                              NULL, --nCONTFSMU_07 
                              NULL, --nCANTFSMU_07 
                              NULL, --nCONTFSMU_08 
                              NULL, --nCANTFSMU_08 
                              NULL, --nCONTFSMU_09 
                              NULL, --nCANTFSMU_09 
                              NULL, --nCONTFSMU_10 
                              NULL, --nCANTFSMU_10 
                              NULL, --nANCHO_BUENO_TOTAL_01 
                              NULL, --nANCHO_BUENO_OT_01 
                              NULL, --nANCHO_BUENO_TOTAL_02 
                              NULL, --nANCHO_BUENO_OT_02 
                              NULL, --nANCHO_BUENO_TOTAL_03 
                              NULL, --nANCHO_BUENO_OT_03 
                              NULL, --nANCHO_BUENO_TOTAL_04 
                              NULL, --nANCHO_BUENO_OT_04 
                              NULL, --nANCHO_BUENO_TOTAL_05 
                              NULL, --nANCHO_BUENO_OT_05 
                              NULL, --nANCHO_BUENO_TOTAL_06 
                              NULL, --nANCHO_BUENO_OT_06 
                              NULL, --nANCHO_BUENO_TOTAL_07 
                              NULL, --nANCHO_BUENO_OT_07 
                              NULL, --nANCHO_BUENO_TOTAL_08 
                              NULL, --nANCHO_BUENO_OT_08 
                              NULL, --nANCHO_BUENO_TOTAL_09 
                              NULL, --nANCHO_BUENO_OT_09 
                              NULL, --nANCHO_BUENO_TOTAL_10 
                              NULL, --nANCHO_BUENO_OT_10 
                              NULL, --nANCHO_BUENO_TOTAL 
                              NULL, --nANCHO_BUENO_OT 
                              NULL, --nNUMECORT 
                              NULL, --nMM_MERMPRCO_01 
                              NULL, --nMM_MERMPLAN_EXESO_01 
                              NULL, --nMM_MERMPLAN_01 
                              NULL, --nMM_MERMPRCO_02 
                              NULL, --nMM_MERMPLAN_EXESO_02 
                              NULL, --nMM_MERMPLAN_02 
                              NULL, --nMM_MERMPRCO_03 
                              NULL, --nMM_MERMPLAN_EXESO_03 
                              NULL, --nMM_MERMPLAN_03 
                              NULL, --nMM_MERMPRCO_04 
                              NULL, --nMM_MERMPLAN_EXESO_04 
                              NULL, --nMM_MERMPLAN_04 
                              NULL, --nMM_MERMPRCO_05 
                              NULL, --nMM_MERMPLAN_EXESO_05 
                              NULL, --nMM_MERMPLAN_05 
                              NULL, --nMM_MERMPRCO_06 
                              NULL, --nMM_MERMPLAN_EXESO_06 
                              NULL, --nMM_MERMPLAN_06 
                              NULL, --nMM_MERMPRCO_07 
                              NULL, --nMM_MERMPLAN_EXESO_07 
                              NULL, --nMM_MERMPLAN_07 
                              NULL, --nMM_MERMPRCO_08 
                              NULL, --nMM_MERMPLAN_EXESO_08 
                              NULL, --nMM_MERMPLAN_08 
                              NULL, --nMM_MERMPRCO_09 
                              NULL, --nMM_MERMPLAN_EXESO_09 
                              NULL, --nMM_MERMPLAN_09 
                              NULL, --nMM_MERMPRCO_10 
                              NULL, --nMM_MERMPLAN_EXESO_10 
                              NULL, --nMM_MERMPLAN_10 
                              NULL, --nMM_MERMPRCO 
                              NULL, --nMM_MERMPLAN_EXESO 
                              NULL); --nMM_MERMPLAN
							--t_MATERIAL(rMATERIAL_B2.IDENTIFICADOR).MermEnhe_E := NVL(t_MATERIAL(rMATERIAL_B2.IDENTIFICADOR).MermEnhe_E,0) + nMerma_Enhebrado_M2_E;
--ELSE dbms_output.put_line('4 IDENTIFICADOR IS NULL(2) '||rMATERIAL_B2.Empresa||', '||rMATERIAL_B2.NumeOtre||', '||rMATERIAL_B2.Contador);
                  END IF;
                  --Fin Parte ESTANDAR
               END IF;
               --
               IF rCaracteristica_Maquina.Caracteristica IS NOT NULL AND rCaracteristica_Maquina.Captacion = 'ESTANDAR' THEN
--dbms_output.put_line('ENHEBRAD5: NO IMPUTA ENHEBARADO');
                  bCaAuEnhe := TRUE;
                  --Se toman los valores del Estandar
                  nMerma_Enhebrado_M1 := NVL(nMerma_Enhebrado_M1_E,0);
                  nMerma_Enhebrado_M2 := NVL(nMerma_Enhebrado_M2_E,0);
                  --18-04-2012 NO SE REALIZA AQUI POR QUE COMO ES AUTOMATICO SE REALIZA AL DESCONTAR EL AJUSTE
                  /*IF rMATERIAL_B1.IDENTIFICADOR IS NOT NULL THEN
                     t_MATERIAL(rMATERIAL_B1.IDENTIFICADOR).MermEnhe := NVL(t_MATERIAL(rMATERIAL_B1.IDENTIFICADOR).MermEnhe,0) + nMerma_Enhebrado_M1;
                  END IF;
                  --
                  IF rMATERIAL_B2.IDENTIFICADOR IS NOT NULL THEN
                     t_MATERIAL(rMATERIAL_B2.IDENTIFICADOR).MermEnhe := NVL(t_MATERIAL(rMATERIAL_B2.IDENTIFICADOR).MermEnhe,0) + nMerma_Enhebrado_M2;
                  END IF;*/
               --Si encuentra un Evento es una Merma asociada a un Evento (Captación Real)
               ELSIF rCaracteristica_Maquina.EvenCodi IS NOT NULL THEN
--dbms_output.put_line('ENHEBRAD6: IMPUTA ENHEBARADO CON EVENTO');
                 --Se realizan las busquedas de Mermas en las Maquinas Utilizadas en las Pasadas
                  FOR rMaquinas_Utilizadas_EvenMerm IN cMaquinas_Utilizadas_EvenMerm(rMaquinas.Contador,rCaracteristica_Maquina.EvenCodi) LOOP
                     rPRD_MAQUEVEN.Valor := NULL;
                     rPRD_MAQUEVEN.OrvaReal := NULL;
                     --
                     OPEN cPRD_MAQUEVEN(rMaquinas.MaquTipo,rMaquinas_Utilizadas_EvenMerm.MaquCodi, rCaracteristica_Maquina.EvenCodi);
                     FETCH cPRD_MAQUEVEN INTO rPRD_MAQUEVEN;
                     CLOSE cPRD_MAQUEVEN;
                     --
                     IF rPRD_MAQUEVEN.VALOR = 'PRD_MEEVFA' THEN
                        FOR rMERMA IN cMERMA(rMaquinas.Contador, rMaquinas.MaquTipo, rMaquinas_Utilizadas_EvenMerm.MaquCodi, rCaracteristica_Maquina.EvenCodi, rPRD_MAQUEVEN.ORVAREAL) LOOP
                           nMerma_Enhebrado_M1 := NVL(nMerma_Enhebrado_M1,0) + NVL(rMERMA.Merma_M1,0);
                           nMerma_Enhebrado_M2 := NVL(nMerma_Enhebrado_M2,0) + NVL(rMERMA.Merma_M2,0);
                           --
                           rMaterial_B1R.IDENTIFICADOR := NULL;
                           rMaterial_B2R.IDENTIFICADOR := NULL;
                           --
                           IF NVL(rMERMA.CoboBobi,0) > 0 THEN --Se trata de una Bobina Generada
                              rMaterial_B1R := F_MATERIAL(vEmpresa, nNumeOtre, rMaquinas.Contador, 
                                                          rMERMA.Tip_Arti, rMERMA.Cod_Arti, '|EMPRBOBI:'||rMERMA.EmprBobi||'|NUOTBOBI:'||rMERMA.NuotBobi||'|CONTBOBI:'||rMERMA.ContBobi||'|COBOBOBI:'||rMERMA.CoboBobi||'|LOTE:'||rMERMA.Lote,
                                                          1, NULL);
                           ELSE --Es un material de Almacen
                              rMaterial_B1R := F_MATERIAL(vEmpresa, nNumeOtre, rMaquinas.Contador, 
                                                          rMERMA.Tip_Arti, rMERMA.Cod_Arti, '|EMPRBOBI:'||NVL(rMERMA.EmprBobi,vEmpresa)||'|NUOTBOBI:'||NVL(rMERMA.NuotBobi,nNumeOtre)||'|LOTE:'||rMERMA.Lote||--3090
												                      '|COBOMATE:'||rMERMA.ContBobi||'|BOBIMATE:'||rMERMA.CoboBobi, -- 11-11-2016 Solo para materiales tipo M
                                                          1, NULL);
                           END IF;
                           --
                           IF rMERMA.Tip_Arti2 IS NOT NULL THEN
                              IF NVL(rMERMA.CoboBobi2,0) > 0 THEN --Se trata de una Bobina Generada
                                 rMaterial_B2R := F_MATERIAL(vEmpresa, nNumeOtre, rMaquinas.Contador, 
                                                             rMERMA.Tip_Arti2, rMERMA.Cod_Arti2, '|EMPRBOBI:'||rMERMA.EmprBobi2||'|NUOTBOBI:'||rMERMA.NuotBobi2||'|CONTBOBI:'||rMERMA.ContBobi2||'|COBOBOBI:'||rMERMA.CoboBobi2||'|LOTE:'||rMERMA.Lote2,
                                                             2, NULL);
                              ELSE --Es un material de Almacen
                                 rMaterial_B2R := F_MATERIAL(vEmpresa, nNumeOtre, rMaquinas.Contador, 
                                                             rMERMA.Tip_Arti2, rMERMA.Cod_Arti2, '|EMPRBOBI:'||NVL(rMERMA.EmprBobi2,vEmpresa)||'|NUOTBOBI:'||NVL(rMERMA.NuotBobi2,nNumeOtre)||'|LOTE:'||rMERMA.Lote2||
												                         '|COBOMATE:'||rMERMA.ContBobi2||'|BOBIMATE:'||rMERMA.CoboBobi2, -- 11-11-2016 Solo para materiales tipo M
                                                             2, NULL);
                              END IF;
                           END IF;
                           --
                           IF rMATERIAL_B1R.IDENTIFICADOR IS NOT NULL THEN
                              P_MATERIAL(rMATERIAL_B1R,'U',
													  NULL,--nCantProd
													  NULL,--nCantCons_E
													  NULL,--nCantCons
													  NULL,--nCantAjus
													  NULL,--nAncho
													  NULL,--nFACTOR_CONVERSION_M2_KG
													  NULL,--nPrecio_ML_E
													  NULL,--vLog_Precio
													  NULL,--nMermEnhe_E
													  NVL(rMERMA.Merma_M1,0),--nMermEnhe
													  NULL,--nMermAjus_E
													  NULL,--nMermAjus
													  NULL,--nMermCabo_E
													  NULL,--nMermCabo
													  NULL,--nMermPico_E
													  NULL,--nMermPico
                                         NULL,--nMermTita
                                         NULL,--nMermSane
                                         NULL,--nCantCons_Bobinas
                                         --
                                       NULL, --nCONTFSMU_01 
                                       NULL, --nCANTFSMU_01 
                                       NULL, --nCATOFSMU 
                                       NULL, --nCONTFSMU_02 
                                       NULL, --nCANTFSMU_02 
                                       NULL, --nCONTFSMU_03 
                                       NULL, --nCANTFSMU_03 
                                       NULL, --nCONTFSMU_04 
                                       NULL, --nCANTFSMU_04 
                                       NULL, --nCONTFSMU_05 
                                       NULL, --nCANTFSMU_05 
                                       NULL, --nCONTFSMU_06 
                                       NULL, --nCANTFSMU_06 
                                       NULL, --nCONTFSMU_07 
                                       NULL, --nCANTFSMU_07 
                                       NULL, --nCONTFSMU_08 
                                       NULL, --nCANTFSMU_08 
                                       NULL, --nCONTFSMU_09 
                                       NULL, --nCANTFSMU_09 
                                       NULL, --nCONTFSMU_10 
                                       NULL, --nCANTFSMU_10 
                                       NULL, --nANCHO_BUENO_TOTAL_01 
                                       NULL, --nANCHO_BUENO_OT_01 
                                       NULL, --nANCHO_BUENO_TOTAL_02 
                                       NULL, --nANCHO_BUENO_OT_02 
                                       NULL, --nANCHO_BUENO_TOTAL_03 
                                       NULL, --nANCHO_BUENO_OT_03 
                                       NULL, --nANCHO_BUENO_TOTAL_04 
                                       NULL, --nANCHO_BUENO_OT_04 
                                       NULL, --nANCHO_BUENO_TOTAL_05 
                                       NULL, --nANCHO_BUENO_OT_05 
                                       NULL, --nANCHO_BUENO_TOTAL_06 
                                       NULL, --nANCHO_BUENO_OT_06 
                                       NULL, --nANCHO_BUENO_TOTAL_07 
                                       NULL, --nANCHO_BUENO_OT_07 
                                       NULL, --nANCHO_BUENO_TOTAL_08 
                                       NULL, --nANCHO_BUENO_OT_08 
                                       NULL, --nANCHO_BUENO_TOTAL_09 
                                       NULL, --nANCHO_BUENO_OT_09 
                                       NULL, --nANCHO_BUENO_TOTAL_10 
                                       NULL, --nANCHO_BUENO_OT_10 
                                       NULL, --nANCHO_BUENO_TOTAL 
                                       NULL, --nANCHO_BUENO_OT 
                                       NULL, --nNUMECORT 
                                       NULL, --nMM_MERMPRCO_01 
                                       NULL, --nMM_MERMPLAN_EXESO_01 
                                       NULL, --nMM_MERMPLAN_01 
                                       NULL, --nMM_MERMPRCO_02 
                                       NULL, --nMM_MERMPLAN_EXESO_02 
                                       NULL, --nMM_MERMPLAN_02 
                                       NULL, --nMM_MERMPRCO_03 
                                       NULL, --nMM_MERMPLAN_EXESO_03 
                                       NULL, --nMM_MERMPLAN_03 
                                       NULL, --nMM_MERMPRCO_04 
                                       NULL, --nMM_MERMPLAN_EXESO_04 
                                       NULL, --nMM_MERMPLAN_04 
                                       NULL, --nMM_MERMPRCO_05 
                                       NULL, --nMM_MERMPLAN_EXESO_05 
                                       NULL, --nMM_MERMPLAN_05 
                                       NULL, --nMM_MERMPRCO_06 
                                       NULL, --nMM_MERMPLAN_EXESO_06 
                                       NULL, --nMM_MERMPLAN_06 
                                       NULL, --nMM_MERMPRCO_07 
                                       NULL, --nMM_MERMPLAN_EXESO_07 
                                       NULL, --nMM_MERMPLAN_07 
                                       NULL, --nMM_MERMPRCO_08 
                                       NULL, --nMM_MERMPLAN_EXESO_08 
                                       NULL, --nMM_MERMPLAN_08 
                                       NULL, --nMM_MERMPRCO_09 
                                       NULL, --nMM_MERMPLAN_EXESO_09 
                                       NULL, --nMM_MERMPLAN_09 
                                       NULL, --nMM_MERMPRCO_10 
                                       NULL, --nMM_MERMPLAN_EXESO_10 
                                       NULL, --nMM_MERMPLAN_10 
                                       NULL, --nMM_MERMPRCO 
                                       NULL, --nMM_MERMPLAN_EXESO 
                                       NULL); --nMM_MERMPLAN
										--t_MATERIAL(rMATERIAL_B1R.IDENTIFICADOR).MermEnhe := NVL(t_MATERIAL(rMATERIAL_B1R.IDENTIFICADOR).MermEnhe,0) + NVL(rMERMA.Merma_M1,0);
                              --Actualización de Precio de MP
                              IF rMERMA.Tip_Arti IN (vTiarMpF4,vTiarSeF4,vP_TiarFiF4) THEN-- t_MATERIAL(rMATERIAL_B1R.IDENTIFICADOR).Precio_ML IS NULL THEN --Si es Materia Prima
                                 vLogPreci := NULL;
                                 vPrecio := F_PRECIO(vEmpresa, nNumeOtre, 
																	  rMERMA.Tip_Arti, rMERMA.Cod_Arti, rMERMA.Lote,
																	  NULL, NULL, NULL, NULL);
											--
											P_MATERIAL(rMATERIAL_B1R,'U',
														  NULL,--nCantProd
														  NULL,--nCantCons_E
														  NULL,--nCantCons
														  NULL,--nCantAjus
														  NULL,--nAncho
														  NULL,--nFACTOR_CONVERSION_M2_KG
														  NULL,--nPrecio_ML_E
														  vPrecio,--vLog_Precio
														  NULL,--nMermEnhe_E
														  NULL,--nMermEnhe
														  NULL,--nMermAjus_E
														  NULL,--nMermAjus
														  NULL,--nMermCabo_E
														  NULL,--nMermCabo
														  NULL,--nMermPico_E
														  NULL,--nMermPico
                                            NULL,--nMermTita
                                            NULL,--nMermSane
                                            NULL,--nCantCons_Bobinas
                                            --
                                          NULL, --nCONTFSMU_01 
                                          NULL, --nCANTFSMU_01 
                                          NULL, --nCATOFSMU 
                                          NULL, --nCONTFSMU_02 
                                          NULL, --nCANTFSMU_02 
                                          NULL, --nCONTFSMU_03 
                                          NULL, --nCANTFSMU_03 
                                          NULL, --nCONTFSMU_04 
                                          NULL, --nCANTFSMU_04 
                                          NULL, --nCONTFSMU_05 
                                          NULL, --nCANTFSMU_05 
                                          NULL, --nCONTFSMU_06 
                                          NULL, --nCANTFSMU_06 
                                          NULL, --nCONTFSMU_07 
                                          NULL, --nCANTFSMU_07 
                                          NULL, --nCONTFSMU_08 
                                          NULL, --nCANTFSMU_08 
                                          NULL, --nCONTFSMU_09 
                                          NULL, --nCANTFSMU_09 
                                          NULL, --nCONTFSMU_10 
                                          NULL, --nCANTFSMU_10 
                                          NULL, --nANCHO_BUENO_TOTAL_01 
                                          NULL, --nANCHO_BUENO_OT_01 
                                          NULL, --nANCHO_BUENO_TOTAL_02 
                                          NULL, --nANCHO_BUENO_OT_02 
                                          NULL, --nANCHO_BUENO_TOTAL_03 
                                          NULL, --nANCHO_BUENO_OT_03 
                                          NULL, --nANCHO_BUENO_TOTAL_04 
                                          NULL, --nANCHO_BUENO_OT_04 
                                          NULL, --nANCHO_BUENO_TOTAL_05 
                                          NULL, --nANCHO_BUENO_OT_05 
                                          NULL, --nANCHO_BUENO_TOTAL_06 
                                          NULL, --nANCHO_BUENO_OT_06 
                                          NULL, --nANCHO_BUENO_TOTAL_07 
                                          NULL, --nANCHO_BUENO_OT_07 
                                          NULL, --nANCHO_BUENO_TOTAL_08 
                                          NULL, --nANCHO_BUENO_OT_08 
                                          NULL, --nANCHO_BUENO_TOTAL_09 
                                          NULL, --nANCHO_BUENO_OT_09 
                                          NULL, --nANCHO_BUENO_TOTAL_10 
                                          NULL, --nANCHO_BUENO_OT_10 
                                          NULL, --nANCHO_BUENO_TOTAL 
                                          NULL, --nANCHO_BUENO_OT 
                                          NULL, --nNUMECORT 
                                          NULL, --nMM_MERMPRCO_01 
                                          NULL, --nMM_MERMPLAN_EXESO_01 
                                          NULL, --nMM_MERMPLAN_01 
                                          NULL, --nMM_MERMPRCO_02 
                                          NULL, --nMM_MERMPLAN_EXESO_02 
                                          NULL, --nMM_MERMPLAN_02 
                                          NULL, --nMM_MERMPRCO_03 
                                          NULL, --nMM_MERMPLAN_EXESO_03 
                                          NULL, --nMM_MERMPLAN_03 
                                          NULL, --nMM_MERMPRCO_04 
                                          NULL, --nMM_MERMPLAN_EXESO_04 
                                          NULL, --nMM_MERMPLAN_04 
                                          NULL, --nMM_MERMPRCO_05 
                                          NULL, --nMM_MERMPLAN_EXESO_05 
                                          NULL, --nMM_MERMPLAN_05 
                                          NULL, --nMM_MERMPRCO_06 
                                          NULL, --nMM_MERMPLAN_EXESO_06 
                                          NULL, --nMM_MERMPLAN_06 
                                          NULL, --nMM_MERMPRCO_07 
                                          NULL, --nMM_MERMPLAN_EXESO_07 
                                          NULL, --nMM_MERMPLAN_07 
                                          NULL, --nMM_MERMPRCO_08 
                                          NULL, --nMM_MERMPLAN_EXESO_08 
                                          NULL, --nMM_MERMPLAN_08 
                                          NULL, --nMM_MERMPRCO_09 
                                          NULL, --nMM_MERMPLAN_EXESO_09 
                                          NULL, --nMM_MERMPLAN_09 
                                          NULL, --nMM_MERMPRCO_10 
                                          NULL, --nMM_MERMPLAN_EXESO_10 
                                          NULL, --nMM_MERMPLAN_10 
                                          NULL, --nMM_MERMPRCO 
                                          NULL, --nMM_MERMPLAN_EXESO 
                                          NULL); --nMM_MERMPLAN
											--t_MATERIAL(rMATERIAL_B1R.IDENTIFICADOR).Precio_ML := F_PRECIO(vEmpresa, nNumeOtre, 
                                 --                                                              rMERMA.Tip_Arti, rMERMA.Cod_Arti, rMERMA.Lote,
                                 --                                                              NULL, NULL, NULL, NULL);
                                 --t_MATERIAL(rMATERIAL_B1R.IDENTIFICADOR).Precio_ML_E := F_PRECIO_E(vEmpresa, nNumeOtre, 
                                 --                                                                  rMERMA.Tip_Arti, rMERMA.Cod_Arti, rMERMA.Lote,
                                 --                                                                  NULL, NULL, NULL, NULL);
--ELSE dbms_output.put_line('6 IDENTIFICADOR IS NULL ');
                              END IF;
                           END IF;
                           --
                           IF rMATERIAL_B2R.IDENTIFICADOR IS NOT NULL THEN
--dbms_output.put_line('ENHEBRADX1:'||rMERMA.Merma_M2);
                              P_MATERIAL(rMATERIAL_B2R,'U',
													  NULL,--nCantProd
													  NULL,--nCantCons_E
													  NULL,--nCantCons
													  NULL,--nCantAjus
													  NULL,--nAncho
													  NULL,--nFACTOR_CONVERSION_M2_KG
													  NULL,--nPrecio_ML_E
													  NULL,--vLog_Precio
													  NULL,--nMermEnhe_E
													  NVL(rMERMA.Merma_M2,0),--nMermEnhe
													  NULL,--nMermAjus_E
													  NULL,--nMermAjus
													  NULL,--nMermCabo_E
													  NULL,--nMermCabo
													  NULL,--nMermPico_E
													  NULL,--nMermPico
                                         NULL,--nMermTita
                                         NULL,--nMermSane
                                         NULL,--nCantCons_Bobinas
                                         --
                                          NULL, --nCONTFSMU_01 
                                          NULL, --nCANTFSMU_01 
                                          NULL, --nCATOFSMU 
                                          NULL, --nCONTFSMU_02 
                                          NULL, --nCANTFSMU_02 
                                          NULL, --nCONTFSMU_03 
                                          NULL, --nCANTFSMU_03 
                                          NULL, --nCONTFSMU_04 
                                          NULL, --nCANTFSMU_04 
                                          NULL, --nCONTFSMU_05 
                                          NULL, --nCANTFSMU_05 
                                          NULL, --nCONTFSMU_06 
                                          NULL, --nCANTFSMU_06 
                                          NULL, --nCONTFSMU_07 
                                          NULL, --nCANTFSMU_07 
                                          NULL, --nCONTFSMU_08 
                                          NULL, --nCANTFSMU_08 
                                          NULL, --nCONTFSMU_09 
                                          NULL, --nCANTFSMU_09 
                                          NULL, --nCONTFSMU_10 
                                          NULL, --nCANTFSMU_10 
                                          NULL, --nANCHO_BUENO_TOTAL_01 
                                          NULL, --nANCHO_BUENO_OT_01 
                                          NULL, --nANCHO_BUENO_TOTAL_02 
                                          NULL, --nANCHO_BUENO_OT_02 
                                          NULL, --nANCHO_BUENO_TOTAL_03 
                                          NULL, --nANCHO_BUENO_OT_03 
                                          NULL, --nANCHO_BUENO_TOTAL_04 
                                          NULL, --nANCHO_BUENO_OT_04 
                                          NULL, --nANCHO_BUENO_TOTAL_05 
                                          NULL, --nANCHO_BUENO_OT_05 
                                          NULL, --nANCHO_BUENO_TOTAL_06 
                                          NULL, --nANCHO_BUENO_OT_06 
                                          NULL, --nANCHO_BUENO_TOTAL_07 
                                          NULL, --nANCHO_BUENO_OT_07 
                                          NULL, --nANCHO_BUENO_TOTAL_08 
                                          NULL, --nANCHO_BUENO_OT_08 
                                          NULL, --nANCHO_BUENO_TOTAL_09 
                                          NULL, --nANCHO_BUENO_OT_09 
                                          NULL, --nANCHO_BUENO_TOTAL_10 
                                          NULL, --nANCHO_BUENO_OT_10 
                                          NULL, --nANCHO_BUENO_TOTAL 
                                          NULL, --nANCHO_BUENO_OT 
                                          NULL, --nNUMECORT 
                                          NULL, --nMM_MERMPRCO_01 
                                          NULL, --nMM_MERMPLAN_EXESO_01 
                                          NULL, --nMM_MERMPLAN_01 
                                          NULL, --nMM_MERMPRCO_02 
                                          NULL, --nMM_MERMPLAN_EXESO_02 
                                          NULL, --nMM_MERMPLAN_02 
                                          NULL, --nMM_MERMPRCO_03 
                                          NULL, --nMM_MERMPLAN_EXESO_03 
                                          NULL, --nMM_MERMPLAN_03 
                                          NULL, --nMM_MERMPRCO_04 
                                          NULL, --nMM_MERMPLAN_EXESO_04 
                                          NULL, --nMM_MERMPLAN_04 
                                          NULL, --nMM_MERMPRCO_05 
                                          NULL, --nMM_MERMPLAN_EXESO_05 
                                          NULL, --nMM_MERMPLAN_05 
                                          NULL, --nMM_MERMPRCO_06 
                                          NULL, --nMM_MERMPLAN_EXESO_06 
                                          NULL, --nMM_MERMPLAN_06 
                                          NULL, --nMM_MERMPRCO_07 
                                          NULL, --nMM_MERMPLAN_EXESO_07 
                                          NULL, --nMM_MERMPLAN_07 
                                          NULL, --nMM_MERMPRCO_08 
                                          NULL, --nMM_MERMPLAN_EXESO_08 
                                          NULL, --nMM_MERMPLAN_08 
                                          NULL, --nMM_MERMPRCO_09 
                                          NULL, --nMM_MERMPLAN_EXESO_09 
                                          NULL, --nMM_MERMPLAN_09 
                                          NULL, --nMM_MERMPRCO_10 
                                          NULL, --nMM_MERMPLAN_EXESO_10 
                                          NULL, --nMM_MERMPLAN_10 
                                          NULL, --nMM_MERMPRCO 
                                          NULL, --nMM_MERMPLAN_EXESO 
                                          NULL); --nMM_MERMPLAN
										--t_MATERIAL(rMATERIAL_B2R.IDENTIFICADOR).MermEnhe := NVL(t_MATERIAL(rMATERIAL_B2R.IDENTIFICADOR).MermEnhe,0) + NVL(rMERMA.Merma_M2,0);
                              --Actualización de Precio de MP
                              IF rMERMA.Tip_Arti2 IN (vTiarMpF4,vTiarSeF4,vP_TiarFiF4) THEN--AND t_MATERIAL(rMATERIAL_B2R.IDENTIFICADOR).Precio_ML IS NULL THEN --Si es Materia Prima
                                 vLogPreci := NULL;
                                 vPrecio := F_PRECIO(vEmpresa, nNumeOtre, 
																	  rMERMA.Tip_Arti2, rMERMA.Cod_Arti2, rMERMA.Lote2,
																	  NULL, NULL, NULL, NULL);
											--
											P_MATERIAL(rMATERIAL_B2R,'U',
														  NULL,--nCantProd
														  NULL,--nCantCons_E
														  NULL,--nCantCons
														  NULL,--nCantAjus
														  NULL,--nAncho
														  NULL,--nFACTOR_CONVERSION_M2_KG
														  NULL,--nPrecio_ML_E
														  vPrecio,--vLog_Precio
														  NULL,--nMermEnhe_E
														  NULL,--nMermEnhe
														  NULL,--nMermAjus_E
														  NULL,--nMermAjus
														  NULL,--nMermCabo_E
														  NULL,--nMermCabo
														  NULL,--nMermPico_E
														  NULL,--nMermPico
                                            NULL,--nMermTita
                                            NULL,--nMermSane
                                            NULL,--nCantCons_Bobinas
                                            --
                                          NULL, --nCONTFSMU_01 
                                          NULL, --nCANTFSMU_01 
                                          NULL, --nCATOFSMU 
                                          NULL, --nCONTFSMU_02 
                                          NULL, --nCANTFSMU_02 
                                          NULL, --nCONTFSMU_03 
                                          NULL, --nCANTFSMU_03 
                                          NULL, --nCONTFSMU_04 
                                          NULL, --nCANTFSMU_04 
                                          NULL, --nCONTFSMU_05 
                                          NULL, --nCANTFSMU_05 
                                          NULL, --nCONTFSMU_06 
                                          NULL, --nCANTFSMU_06 
                                          NULL, --nCONTFSMU_07 
                                          NULL, --nCANTFSMU_07 
                                          NULL, --nCONTFSMU_08 
                                          NULL, --nCANTFSMU_08 
                                          NULL, --nCONTFSMU_09 
                                          NULL, --nCANTFSMU_09 
                                          NULL, --nCONTFSMU_10 
                                          NULL, --nCANTFSMU_10 
                                          NULL, --nANCHO_BUENO_TOTAL_01 
                                          NULL, --nANCHO_BUENO_OT_01 
                                          NULL, --nANCHO_BUENO_TOTAL_02 
                                          NULL, --nANCHO_BUENO_OT_02 
                                          NULL, --nANCHO_BUENO_TOTAL_03 
                                          NULL, --nANCHO_BUENO_OT_03 
                                          NULL, --nANCHO_BUENO_TOTAL_04 
                                          NULL, --nANCHO_BUENO_OT_04 
                                          NULL, --nANCHO_BUENO_TOTAL_05 
                                          NULL, --nANCHO_BUENO_OT_05 
                                          NULL, --nANCHO_BUENO_TOTAL_06 
                                          NULL, --nANCHO_BUENO_OT_06 
                                          NULL, --nANCHO_BUENO_TOTAL_07 
                                          NULL, --nANCHO_BUENO_OT_07 
                                          NULL, --nANCHO_BUENO_TOTAL_08 
                                          NULL, --nANCHO_BUENO_OT_08 
                                          NULL, --nANCHO_BUENO_TOTAL_09 
                                          NULL, --nANCHO_BUENO_OT_09 
                                          NULL, --nANCHO_BUENO_TOTAL_10 
                                          NULL, --nANCHO_BUENO_OT_10 
                                          NULL, --nANCHO_BUENO_TOTAL 
                                          NULL, --nANCHO_BUENO_OT 
                                          NULL, --nNUMECORT 
                                          NULL, --nMM_MERMPRCO_01 
                                          NULL, --nMM_MERMPLAN_EXESO_01 
                                          NULL, --nMM_MERMPLAN_01 
                                          NULL, --nMM_MERMPRCO_02 
                                          NULL, --nMM_MERMPLAN_EXESO_02 
                                          NULL, --nMM_MERMPLAN_02 
                                          NULL, --nMM_MERMPRCO_03 
                                          NULL, --nMM_MERMPLAN_EXESO_03 
                                          NULL, --nMM_MERMPLAN_03 
                                          NULL, --nMM_MERMPRCO_04 
                                          NULL, --nMM_MERMPLAN_EXESO_04 
                                          NULL, --nMM_MERMPLAN_04 
                                          NULL, --nMM_MERMPRCO_05 
                                          NULL, --nMM_MERMPLAN_EXESO_05 
                                          NULL, --nMM_MERMPLAN_05 
                                          NULL, --nMM_MERMPRCO_06 
                                          NULL, --nMM_MERMPLAN_EXESO_06 
                                          NULL, --nMM_MERMPLAN_06 
                                          NULL, --nMM_MERMPRCO_07 
                                          NULL, --nMM_MERMPLAN_EXESO_07 
                                          NULL, --nMM_MERMPLAN_07 
                                          NULL, --nMM_MERMPRCO_08 
                                          NULL, --nMM_MERMPLAN_EXESO_08 
                                          NULL, --nMM_MERMPLAN_08 
                                          NULL, --nMM_MERMPRCO_09 
                                          NULL, --nMM_MERMPLAN_EXESO_09 
                                          NULL, --nMM_MERMPLAN_09 
                                          NULL, --nMM_MERMPRCO_10 
                                          NULL, --nMM_MERMPLAN_EXESO_10 
                                          NULL, --nMM_MERMPLAN_10 
                                          NULL, --nMM_MERMPRCO 
                                          NULL, --nMM_MERMPLAN_EXESO 
                                          NULL); --nMM_MERMPLAN
											--t_MATERIAL(rMATERIAL_B2R.IDENTIFICADOR).Precio_ML := F_PRECIO(vEmpresa, nNumeOtre, 
                                 --                                                              rMERMA.Tip_Arti2, rMERMA.Cod_Arti2, rMERMA.Lote2,
                                 --                                                              NULL, NULL, NULL, NULL);
                                 --t_MATERIAL(rMATERIAL_B2R.IDENTIFICADOR).Precio_ML_E := F_PRECIO_E(vEmpresa, nNumeOtre, 
                                 --                                                                  rMERMA.Tip_Arti2, rMERMA.Cod_Arti2, rMERMA.Lote2,
                                 --                                                                  NULL, NULL, NULL, NULL);
                              END IF;
--ELSE dbms_output.put_line('7 IDENTIFICADOR IS NULL(2) ');
                           END IF;
                        END LOOP;
                     END IF;
                  END LOOP;
               END IF;
            END LOOP;
            --AJUSTE
            IF SUBSTR(rMaquinas.MaquCodi,1,INSTR(rMaquinas.MaquCodi,' ')-1) = 'IMPRESORA' THEN
               IF vPos_Macula IS NOT NULL THEN
                  --Se busca la Merma por Macula en Caso de Existir
                  nMermMacu := NULL;
                  --
                  OPEN cPRD_MAQUCARA(rMaquinas.MaquTipo,rMaquinas.MaquCodi,'MACULA');
                  FETCH cPRD_MAQUCARA INTO nMermMacu;
                  CLOSE cPRD_MAQUCARA;
               END IF;
               --
--dbms_output.put_line('vPos_Macula:'||vPos_Macula||' nMermMacu:'||nMermMacu);              
               nMermMacu := NVL(nMermMacu,0);
               --Se busca el Numero Máximo de Colores de la Maquina
               nColoMaxi := NULL;
               --
               OPEN cPRD_MAQUCARA(rMaquinas.MaquTipo,rMaquinas.MaquCodi,'COLOMAXI');
               FETCH cPRD_MAQUCARA INTO nColoMaxi;
               CLOSE cPRD_MAQUCARA;
               --
               nColoMaxi := NVL(nColoMaxi,0);
--dbms_output.put_line('nColoMaxi:'||nColoMaxi||' nNumeColo:'||nNumeColo);
               --Se superan el numero de Colores Máximo que puede imprimir la Impresora se aplica ajuste de Inserter
               IF NVL(nNumeColo,0) > NVL(nColoMaxi,0) THEN
                  --Se busca el Inserter de la Maquina
                  nMermInse := NULL;
                  --
                  OPEN cPRD_MAQUCARA(rMaquinas.MaquTipo,rMaquinas.MaquCodi,'INSERTER');
                  FETCH cPRD_MAQUCARA INTO nMermInse;
                  CLOSE cPRD_MAQUCARA;
                  --
                  nMermInse := NVL(nMermInse,0);
--dbms_output.put_line('nMermInse:'||nMermInse);
               END IF;
               --Se busca los ML de Muestra de la Maquina
               nMLMuestra := NULL;
               --
               OPEN cPRD_MAQUCARA(rMaquinas.MaquTipo,rMaquinas.MaquCodi,'MLMUESTRA');
               FETCH cPRD_MAQUCARA INTO nMLMuestra;
               CLOSE cPRD_MAQUCARA;
               --
               nMLMuestra := NVL(nMLMuestra,0);
--dbms_output.put_line('nMLMuestra:'||nMLMuestra);
               --Se busca el numero de Muestras según el Numero de Colores para la Maquina
               nNuMuestra := NULL;
               --
               OPEN cPRD_MAQUCARA(rMaquinas.MaquTipo,rMaquinas.MaquCodi,'MLMUESTRA'||TO_CHAR(NVL(nNumeColo,0)));
               FETCH cPRD_MAQUCARA INTO nNuMuestra;
               CLOSE cPRD_MAQUCARA;
               --
               nNuMuestra := NVL(nNuMuestra,0);
--dbms_output.put_line('nNuMuestra:'||nNuMuestra);
               --Metros Totales de la Muestra
               nMTMuestra := NVL(nNuMuestra,0) * NVL(nMLMuestra,0);
--dbms_output.put_line('nMTMuestra:'||nMTMuestra);
               --Se buscan las tintas que estan formuladas 
               nTintForm := NULL;
               --
               OPEN cTintForm(rMaquinas.Contador);
               FETCH cTintForm INTO nTintForm;
               CLOSE cTintForm;
--dbms_output.put_line('nTintForm:'||nTintForm||' vCoefCoCf:'||vCoefCoCf);
               --
               nTintForm := NVL(nTintForm,0);
               --Se aplica el coheficiente corrector por cada color Formulado
               IF NVL(nTintForm,0) > 0 AND NVL(TO_NUMBER(vCoefCoCf),0) > 0 THEN
                  nMTMuestra := NVL(nMTMuestra,0) * nTintForm * TO_NUMBER(vCoefCoCf);
--dbms_output.put_line('nMTMuestra:'||nMTMuestra);
               END IF;
               --Se busca el Ajuste de Presiones para la Maquina
               nAjuPres := NULL;
               --
               OPEN cPRD_MAQUCARA(rMaquinas.MaquTipo,rMaquinas.MaquCodi,'AJUPRES'||TO_CHAR(NVL(nNumeColo,0)));
               FETCH cPRD_MAQUCARA INTO nAjuPres;
               CLOSE cPRD_MAQUCARA;
--dbms_output.put_line('nAjuPres:'||nAjuPres);
               --
               nAjuPres := NVL(nAjuPres,0);
               --Se busca el Ajuste de Registro para la Maquina
               nAjuRegi := NULL;
               --
               OPEN cPRD_MAQUCARA(rMaquinas.MaquTipo,rMaquinas.MaquCodi,'AJUREGI'||TO_CHAR(NVL(nNumeColo,0)));
               FETCH cPRD_MAQUCARA INTO nAjuRegi;
               CLOSE cPRD_MAQUCARA;
--dbms_output.put_line('nAjuRegi:'||nAjuRegi);
               --
               nAjuRegi := NVL(nAjuRegi,0);
               --Se busca el Coeficiente Corrector de Ajuste
               rCaracteristica_Maquina_CoefAj.Caracteristica := NULL;
               --
               OPEN cCaracteristica_Maquina('COEFAJUS',rMaquinas.MaquCodi,SUBSTR(vMatBase,1,2),NULL);
               FETCH cCaracteristica_Maquina INTO rCaracteristica_Maquina_CoefAj;
               CLOSE cCaracteristica_Maquina;
               --
--dbms_output.put_line('rCaracteristica_Maquina_CoefAj.Caracteristica:'||rCaracteristica_Maquina_CoefAj.Caracteristica);
               IF rCaracteristica_Maquina_CoefAj.Caracteristica IS NOT NULL THEN
                  nCoefAjus := NULL;
                  --
                  OPEN cPRD_MAQUCARA(rMaquinas.MaquTipo,rMaquinas.MaquCodi,'COEFAJUS');
                  FETCH cPRD_MAQUCARA INTO nCoefAjus;
                  CLOSE cPRD_MAQUCARA;
--dbms_output.put_line('nCoefAjus:'||nCoefAjus);
               END IF;
               --
               IF nCoefAjus IS NULL THEN
                  nCoefAjus := 1;
               END IF;
               --
               nMaquCara_M1 := NVL(nMermMacu,0) + NVL(nMermInse,0) + ((NVL(nMTMuestra,0) + NVL(nAjuPres,0) + NVL(nAjuRegi,0)) * nCoefAjus);
--dbms_output.put_line('nMaquCara_M1:'||nMaquCara_M1);
               nMaquCara_M2 := NULL;
            END IF;
            --Control de Ajuste de Enhebrado; si no se ejecuta se debe realizar manualmente por fuera de la caracteristica para que se ejecute una vez
            bEjecAjEh := FALSE;
--dbms_output.put_line('AJUSTE 1,'||rMaquinas.MaquCodi||','||vLinea||','||nNumePasa);
            --Se busca si la Maquina tiene valor de Ajuste Automatico o Real
            FOR rCaracteristica_Maquina IN cCaracteristica_Maquina('AJUSTE',rMaquinas.MaquCodi,vLinea,nNumePasa) LOOP --Pueden ser varios Eventos, tambien podria aplicar a varias Caracteristicas
               --Si se encuentra caracteristica es una Merma Automatica (Captación Estandar)
--dbms_output.put_line('AJUSTE 2 rCaracteristica_Maquina.Caracteristica:'||rCaracteristica_Maquina.Caracteristica);
               IF rCaracteristica_Maquina.Caracteristica IS NOT NULL THEN
                  --Parte ESTANDAR
                  --Se realizan las busquedas de Mermas en las Maquinas Utilizadas en las Pasadas
                  FOR rMaquinas_Utilizadas IN cMaquinas_Utilizadas(rMaquinas.Contador) LOOP
                     IF SUBSTR(rMaquinas.MaquCodi,1,INSTR(rMaquinas.MaquCodi,' ')-1) != 'IMPRESORA' THEN --Si no es impresora se calcula con la forma tradicional de buscar la Característica, de lo contrario el calculo esta realizado en el anterior tratamiento
                        nMaquCara_M1 := NULL;
                        nMaquCara_M2 := NULL;
                        --
                        OPEN cPRD_MAQUCARA(rMaquinas.MaquTipo,rMaquinas_Utilizadas.MaquCodi,rCaracteristica_Maquina.Caracteristica);
                        FETCH cPRD_MAQUCARA INTO nMaquCara_M1;
                        CLOSE cPRD_MAQUCARA;
                        --Se verifica si existe la Caracteristica 2 En caso de Laminadoras Material 2
                        IF rCaracteristica_Maquina.Caracteristica2 IS NOT NULL THEN
                           OPEN cPRD_MAQUCARA(rMaquinas.MaquTipo,rMaquinas_Utilizadas.MaquCodi,rCaracteristica_Maquina.Caracteristica2);
                           FETCH cPRD_MAQUCARA INTO nMaquCara_M2;
                           CLOSE cPRD_MAQUCARA;
                        END IF;
                     END IF;
                     --
--dbms_output.put_line('AJUSTE 3 '||nMerma_Ajuste_M1_E||'+'||NVL(nMaquCara_M1,0)||'->'||rMaquinas_Utilizadas.MaquCodi);
                     nMerma_Ajuste_M1_E := NVL(nMerma_Ajuste_M1_E,0) + NVL(nMaquCara_M1,0);
                     nMerma_Ajuste_M2_E := NVL(nMerma_Ajuste_M2_E,0) + NVL(nMaquCara_M2,0);
                  END LOOP;
                  --A el Ajuste se le resta el Enhebrado si este es Automático
                  IF bCaAuEnhe THEN
--dbms_output.put_line('AJUSTE 4 nMerma_Ajuste_M1_E:'||nMerma_Ajuste_M1_E||'-'||NVL(nMerma_Enhebrado_M1_E,0));
                     nMerma_Ajuste_M1_E := NVL(nMerma_Ajuste_M1_E,0) - NVL(nMerma_Enhebrado_M1_E,0);
                     nMerma_Ajuste_M2_E := NVL(nMerma_Ajuste_M2_E,0) - NVL(nMerma_Enhebrado_M2_E,0);
                  END IF;
                  --
                  IF NVL(nMerma_Ajuste_M1_E,0) < 0 THEN
                     nMerma_Ajuste_M1_E := 0;
                  END IF;
                  --
                  IF NVL(nMerma_Ajuste_M2_E,0) < 0 THEN
                     nMerma_Ajuste_M2_E := 0;
                  END IF;
                  --Ajuste Estandar
                  IF rMATERIAL_B1.IDENTIFICADOR IS NOT NULL THEN
                     P_MATERIAL(rMATERIAL_B1,'U',
										  NULL,--nCantProd
										  NULL,--nCantCons_E
										  NULL,--nCantCons
										  NULL,--nCantAjus
										  NULL,--nAncho
										  NULL,--nFACTOR_CONVERSION_M2_KG
										  NULL,--nPrecio_ML_E
										  NULL,--vLog_Precio
										  NULL,--nMermEnhe_E
										  NULL,--nMermEnhe
										  nMerma_Ajuste_M1_E,--nMermAjus_E
										  NULL,--nMermAjus
										  NULL,--nMermCabo_E
										  NULL,--nMermCabo
										  NULL,--nMermPico_E
										  NULL,--nMermPico
                                NULL,--nMermTita
                                NULL,--nMermSane
                                NULL,--nCantCons_Bobinas
                                --
                              NULL, --nCONTFSMU_01 
                              NULL, --nCANTFSMU_01 
                              NULL, --nCATOFSMU 
                              NULL, --nCONTFSMU_02 
                              NULL, --nCANTFSMU_02 
                              NULL, --nCONTFSMU_03 
                              NULL, --nCANTFSMU_03 
                              NULL, --nCONTFSMU_04 
                              NULL, --nCANTFSMU_04 
                              NULL, --nCONTFSMU_05 
                              NULL, --nCANTFSMU_05 
                              NULL, --nCONTFSMU_06 
                              NULL, --nCANTFSMU_06 
                              NULL, --nCONTFSMU_07 
                              NULL, --nCANTFSMU_07 
                              NULL, --nCONTFSMU_08 
                              NULL, --nCANTFSMU_08 
                              NULL, --nCONTFSMU_09 
                              NULL, --nCANTFSMU_09 
                              NULL, --nCONTFSMU_10 
                              NULL, --nCANTFSMU_10 
                              NULL, --nANCHO_BUENO_TOTAL_01 
                              NULL, --nANCHO_BUENO_OT_01 
                              NULL, --nANCHO_BUENO_TOTAL_02 
                              NULL, --nANCHO_BUENO_OT_02 
                              NULL, --nANCHO_BUENO_TOTAL_03 
                              NULL, --nANCHO_BUENO_OT_03 
                              NULL, --nANCHO_BUENO_TOTAL_04 
                              NULL, --nANCHO_BUENO_OT_04 
                              NULL, --nANCHO_BUENO_TOTAL_05 
                              NULL, --nANCHO_BUENO_OT_05 
                              NULL, --nANCHO_BUENO_TOTAL_06 
                              NULL, --nANCHO_BUENO_OT_06 
                              NULL, --nANCHO_BUENO_TOTAL_07 
                              NULL, --nANCHO_BUENO_OT_07 
                              NULL, --nANCHO_BUENO_TOTAL_08 
                              NULL, --nANCHO_BUENO_OT_08 
                              NULL, --nANCHO_BUENO_TOTAL_09 
                              NULL, --nANCHO_BUENO_OT_09 
                              NULL, --nANCHO_BUENO_TOTAL_10 
                              NULL, --nANCHO_BUENO_OT_10 
                              NULL, --nANCHO_BUENO_TOTAL 
                              NULL, --nANCHO_BUENO_OT 
                              NULL, --nNUMECORT 
                              NULL, --nMM_MERMPRCO_01 
                              NULL, --nMM_MERMPLAN_EXESO_01 
                              NULL, --nMM_MERMPLAN_01 
                              NULL, --nMM_MERMPRCO_02 
                              NULL, --nMM_MERMPLAN_EXESO_02 
                              NULL, --nMM_MERMPLAN_02 
                              NULL, --nMM_MERMPRCO_03 
                              NULL, --nMM_MERMPLAN_EXESO_03 
                              NULL, --nMM_MERMPLAN_03 
                              NULL, --nMM_MERMPRCO_04 
                              NULL, --nMM_MERMPLAN_EXESO_04 
                              NULL, --nMM_MERMPLAN_04 
                              NULL, --nMM_MERMPRCO_05 
                              NULL, --nMM_MERMPLAN_EXESO_05 
                              NULL, --nMM_MERMPLAN_05 
                              NULL, --nMM_MERMPRCO_06 
                              NULL, --nMM_MERMPLAN_EXESO_06 
                              NULL, --nMM_MERMPLAN_06 
                              NULL, --nMM_MERMPRCO_07 
                              NULL, --nMM_MERMPLAN_EXESO_07 
                              NULL, --nMM_MERMPLAN_07 
                              NULL, --nMM_MERMPRCO_08 
                              NULL, --nMM_MERMPLAN_EXESO_08 
                              NULL, --nMM_MERMPLAN_08 
                              NULL, --nMM_MERMPRCO_09 
                              NULL, --nMM_MERMPLAN_EXESO_09 
                              NULL, --nMM_MERMPLAN_09 
                              NULL, --nMM_MERMPRCO_10 
                              NULL, --nMM_MERMPLAN_EXESO_10 
                              NULL, --nMM_MERMPLAN_10 
                              NULL, --nMM_MERMPRCO 
                              NULL, --nMM_MERMPLAN_EXESO 
                              NULL); --nMM_MERMPLAN
							--t_MATERIAL(rMATERIAL_B1.IDENTIFICADOR).MermAjus_E := NVL(t_MATERIAL(rMATERIAL_B1.IDENTIFICADOR).MermAjus_E,0) + nMerma_Ajuste_M1_E;
--ELSE dbms_output.put_line('8 IDENTIFICADOR IS NULL ');
                  END IF;
                  --
                  IF rMATERIAL_B2.IDENTIFICADOR IS NOT NULL THEN
                     P_MATERIAL(rMATERIAL_B2,'U',
										  NULL,--nCantProd
										  NULL,--nCantCons_E
										  NULL,--nCantCons
										  NULL,--nCantAjus
										  NULL,--nAncho
										  NULL,--nFACTOR_CONVERSION_M2_KG
										  NULL,--nPrecio_ML_E
										  NULL,--vLog_Precio
										  NULL,--nMermEnhe_E
										  NULL,--nMermEnhe
										  nMerma_Ajuste_M2_E,--nMermAjus_E
										  NULL,--nMermAjus
										  NULL,--nMermCabo_E
										  NULL,--nMermCabo
										  NULL,--nMermPico_E
										  NULL,--nMermPico
                                NULL,--nMermTita
                                NULL,--nMermSane
                                NULL,--nCantCons_Bobinas
                                --
                              NULL, --nCONTFSMU_01 
                              NULL, --nCANTFSMU_01 
                              NULL, --nCATOFSMU 
                              NULL, --nCONTFSMU_02 
                              NULL, --nCANTFSMU_02 
                              NULL, --nCONTFSMU_03 
                              NULL, --nCANTFSMU_03 
                              NULL, --nCONTFSMU_04 
                              NULL, --nCANTFSMU_04 
                              NULL, --nCONTFSMU_05 
                              NULL, --nCANTFSMU_05 
                              NULL, --nCONTFSMU_06 
                              NULL, --nCANTFSMU_06 
                              NULL, --nCONTFSMU_07 
                              NULL, --nCANTFSMU_07 
                              NULL, --nCONTFSMU_08 
                              NULL, --nCANTFSMU_08 
                              NULL, --nCONTFSMU_09 
                              NULL, --nCANTFSMU_09 
                              NULL, --nCONTFSMU_10 
                              NULL, --nCANTFSMU_10 
                              NULL, --nANCHO_BUENO_TOTAL_01 
                              NULL, --nANCHO_BUENO_OT_01 
                              NULL, --nANCHO_BUENO_TOTAL_02 
                              NULL, --nANCHO_BUENO_OT_02 
                              NULL, --nANCHO_BUENO_TOTAL_03 
                              NULL, --nANCHO_BUENO_OT_03 
                              NULL, --nANCHO_BUENO_TOTAL_04 
                              NULL, --nANCHO_BUENO_OT_04 
                              NULL, --nANCHO_BUENO_TOTAL_05 
                              NULL, --nANCHO_BUENO_OT_05 
                              NULL, --nANCHO_BUENO_TOTAL_06 
                              NULL, --nANCHO_BUENO_OT_06 
                              NULL, --nANCHO_BUENO_TOTAL_07 
                              NULL, --nANCHO_BUENO_OT_07 
                              NULL, --nANCHO_BUENO_TOTAL_08 
                              NULL, --nANCHO_BUENO_OT_08 
                              NULL, --nANCHO_BUENO_TOTAL_09 
                              NULL, --nANCHO_BUENO_OT_09 
                              NULL, --nANCHO_BUENO_TOTAL_10 
                              NULL, --nANCHO_BUENO_OT_10 
                              NULL, --nANCHO_BUENO_TOTAL 
                              NULL, --nANCHO_BUENO_OT 
                              NULL, --nNUMECORT 
                              NULL, --nMM_MERMPRCO_01 
                              NULL, --nMM_MERMPLAN_EXESO_01 
                              NULL, --nMM_MERMPLAN_01 
                              NULL, --nMM_MERMPRCO_02 
                              NULL, --nMM_MERMPLAN_EXESO_02 
                              NULL, --nMM_MERMPLAN_02 
                              NULL, --nMM_MERMPRCO_03 
                              NULL, --nMM_MERMPLAN_EXESO_03 
                              NULL, --nMM_MERMPLAN_03 
                              NULL, --nMM_MERMPRCO_04 
                              NULL, --nMM_MERMPLAN_EXESO_04 
                              NULL, --nMM_MERMPLAN_04 
                              NULL, --nMM_MERMPRCO_05 
                              NULL, --nMM_MERMPLAN_EXESO_05 
                              NULL, --nMM_MERMPLAN_05 
                              NULL, --nMM_MERMPRCO_06 
                              NULL, --nMM_MERMPLAN_EXESO_06 
                              NULL, --nMM_MERMPLAN_06 
                              NULL, --nMM_MERMPRCO_07 
                              NULL, --nMM_MERMPLAN_EXESO_07 
                              NULL, --nMM_MERMPLAN_07 
                              NULL, --nMM_MERMPRCO_08 
                              NULL, --nMM_MERMPLAN_EXESO_08 
                              NULL, --nMM_MERMPLAN_08 
                              NULL, --nMM_MERMPRCO_09 
                              NULL, --nMM_MERMPLAN_EXESO_09 
                              NULL, --nMM_MERMPLAN_09 
                              NULL, --nMM_MERMPRCO_10 
                              NULL, --nMM_MERMPLAN_EXESO_10 
                              NULL, --nMM_MERMPLAN_10 
                              NULL, --nMM_MERMPRCO 
                              NULL, --nMM_MERMPLAN_EXESO 
                              NULL); --nMM_MERMPLAN
							--t_MATERIAL(rMATERIAL_B2.IDENTIFICADOR).MermAjus_E := NVL(t_MATERIAL(rMATERIAL_B2.IDENTIFICADOR).MermAjus_E,0) + nMerma_Ajuste_M2_E;
--ELSE dbms_output.put_line('9 IDENTIFICADOR IS NULL(2) ');
                  END IF;
                  --Fin Parte ESTANDAR
               END IF;
               --
               IF rCaracteristica_Maquina.Caracteristica IS NOT NULL AND rCaracteristica_Maquina.Captacion = 'ESTANDAR' THEN
                  nMerma_Ajuste_M1 := NVL(nMerma_Ajuste_M1_E,0);
                  nMerma_Ajuste_M2 := NVL(nMerma_Ajuste_M2_E,0);
                  --
                  IF rMATERIAL_B1.IDENTIFICADOR IS NOT NULL THEN
                     P_MATERIAL(rMATERIAL_B1,'U',
										  NULL,--nCantProd
										  NULL,--nCantCons_E
										  NULL,--nCantCons
										  NULL,--nCantAjus
										  NULL,--nAncho
										  NULL,--nFACTOR_CONVERSION_M2_KG
										  NULL,--nPrecio_ML_E
										  NULL,--vLog_Precio
										  NULL,--nMermEnhe_E
										  NULL,--nMermEnhe
										  NULL,--nMermAjus_E
										  nMerma_Ajuste_M1,--nMermAjus
										  NULL,--nMermCabo_E
										  NULL,--nMermCabo
										  NULL,--nMermPico_E
										  NULL,--nMermPico
                                NULL,--nMermTita
                                NULL,--nMermSane
                                NULL,--nCantCons_Bobinas
                                --
                              NULL, --nCONTFSMU_01 
                              NULL, --nCANTFSMU_01 
                              NULL, --nCATOFSMU 
                              NULL, --nCONTFSMU_02 
                              NULL, --nCANTFSMU_02 
                              NULL, --nCONTFSMU_03 
                              NULL, --nCANTFSMU_03 
                              NULL, --nCONTFSMU_04 
                              NULL, --nCANTFSMU_04 
                              NULL, --nCONTFSMU_05 
                              NULL, --nCANTFSMU_05 
                              NULL, --nCONTFSMU_06 
                              NULL, --nCANTFSMU_06 
                              NULL, --nCONTFSMU_07 
                              NULL, --nCANTFSMU_07 
                              NULL, --nCONTFSMU_08 
                              NULL, --nCANTFSMU_08 
                              NULL, --nCONTFSMU_09 
                              NULL, --nCANTFSMU_09 
                              NULL, --nCONTFSMU_10 
                              NULL, --nCANTFSMU_10 
                              NULL, --nANCHO_BUENO_TOTAL_01 
                              NULL, --nANCHO_BUENO_OT_01 
                              NULL, --nANCHO_BUENO_TOTAL_02 
                              NULL, --nANCHO_BUENO_OT_02 
                              NULL, --nANCHO_BUENO_TOTAL_03 
                              NULL, --nANCHO_BUENO_OT_03 
                              NULL, --nANCHO_BUENO_TOTAL_04 
                              NULL, --nANCHO_BUENO_OT_04 
                              NULL, --nANCHO_BUENO_TOTAL_05 
                              NULL, --nANCHO_BUENO_OT_05 
                              NULL, --nANCHO_BUENO_TOTAL_06 
                              NULL, --nANCHO_BUENO_OT_06 
                              NULL, --nANCHO_BUENO_TOTAL_07 
                              NULL, --nANCHO_BUENO_OT_07 
                              NULL, --nANCHO_BUENO_TOTAL_08 
                              NULL, --nANCHO_BUENO_OT_08 
                              NULL, --nANCHO_BUENO_TOTAL_09 
                              NULL, --nANCHO_BUENO_OT_09 
                              NULL, --nANCHO_BUENO_TOTAL_10 
                              NULL, --nANCHO_BUENO_OT_10 
                              NULL, --nANCHO_BUENO_TOTAL 
                              NULL, --nANCHO_BUENO_OT 
                              NULL, --nNUMECORT 
                              NULL, --nMM_MERMPRCO_01 
                              NULL, --nMM_MERMPLAN_EXESO_01 
                              NULL, --nMM_MERMPLAN_01 
                              NULL, --nMM_MERMPRCO_02 
                              NULL, --nMM_MERMPLAN_EXESO_02 
                              NULL, --nMM_MERMPLAN_02 
                              NULL, --nMM_MERMPRCO_03 
                              NULL, --nMM_MERMPLAN_EXESO_03 
                              NULL, --nMM_MERMPLAN_03 
                              NULL, --nMM_MERMPRCO_04 
                              NULL, --nMM_MERMPLAN_EXESO_04 
                              NULL, --nMM_MERMPLAN_04 
                              NULL, --nMM_MERMPRCO_05 
                              NULL, --nMM_MERMPLAN_EXESO_05 
                              NULL, --nMM_MERMPLAN_05 
                              NULL, --nMM_MERMPRCO_06 
                              NULL, --nMM_MERMPLAN_EXESO_06 
                              NULL, --nMM_MERMPLAN_06 
                              NULL, --nMM_MERMPRCO_07 
                              NULL, --nMM_MERMPLAN_EXESO_07 
                              NULL, --nMM_MERMPLAN_07 
                              NULL, --nMM_MERMPRCO_08 
                              NULL, --nMM_MERMPLAN_EXESO_08 
                              NULL, --nMM_MERMPLAN_08 
                              NULL, --nMM_MERMPRCO_09 
                              NULL, --nMM_MERMPLAN_EXESO_09 
                              NULL, --nMM_MERMPLAN_09 
                              NULL, --nMM_MERMPRCO_10 
                              NULL, --nMM_MERMPLAN_EXESO_10 
                              NULL, --nMM_MERMPLAN_10 
                              NULL, --nMM_MERMPRCO 
                              NULL, --nMM_MERMPLAN_EXESO 
                              NULL); --nMM_MERMPLAN
							--t_MATERIAL(rMATERIAL_B1.IDENTIFICADOR).MermAjus := NVL(t_MATERIAL(rMATERIAL_B1.IDENTIFICADOR).MermAjus,0) + nMerma_Ajuste_M1;
--ELSE dbms_output.put_line('10 IDENTIFICADOR IS NULL ');
                  END IF;
                  --
                  IF rMATERIAL_B2.IDENTIFICADOR IS NOT NULL THEN
                     P_MATERIAL(rMATERIAL_B2,'U',
										  NULL,--nCantProd
										  NULL,--nCantCons_E
										  NULL,--nCantCons
										  NULL,--nCantAjus
										  NULL,--nAncho
										  NULL,--nFACTOR_CONVERSION_M2_KG
										  NULL,--nPrecio_ML_E
										  NULL,--vLog_Precio
										  NULL,--nMermEnhe_E
										  NULL,--nMermEnhe
										  NULL,--nMermAjus_E
										  nMerma_Ajuste_M2,--nMermAjus
										  NULL,--nMermCabo_E
										  NULL,--nMermCabo
										  NULL,--nMermPico_E
										  NULL,--nMermPico
                                NULL,--nMermTita
                                NULL,--nMermSane
                                NULL,--nCantCons_Bobinas
                                --
                              NULL, --nCONTFSMU_01 
                              NULL, --nCANTFSMU_01 
                              NULL, --nCATOFSMU 
                              NULL, --nCONTFSMU_02 
                              NULL, --nCANTFSMU_02 
                              NULL, --nCONTFSMU_03 
                              NULL, --nCANTFSMU_03 
                              NULL, --nCONTFSMU_04 
                              NULL, --nCANTFSMU_04 
                              NULL, --nCONTFSMU_05 
                              NULL, --nCANTFSMU_05 
                              NULL, --nCONTFSMU_06 
                              NULL, --nCANTFSMU_06 
                              NULL, --nCONTFSMU_07 
                              NULL, --nCANTFSMU_07 
                              NULL, --nCONTFSMU_08 
                              NULL, --nCANTFSMU_08 
                              NULL, --nCONTFSMU_09 
                              NULL, --nCANTFSMU_09 
                              NULL, --nCONTFSMU_10 
                              NULL, --nCANTFSMU_10 
                              NULL, --nANCHO_BUENO_TOTAL_01 
                              NULL, --nANCHO_BUENO_OT_01 
                              NULL, --nANCHO_BUENO_TOTAL_02 
                              NULL, --nANCHO_BUENO_OT_02 
                              NULL, --nANCHO_BUENO_TOTAL_03 
                              NULL, --nANCHO_BUENO_OT_03 
                              NULL, --nANCHO_BUENO_TOTAL_04 
                              NULL, --nANCHO_BUENO_OT_04 
                              NULL, --nANCHO_BUENO_TOTAL_05 
                              NULL, --nANCHO_BUENO_OT_05 
                              NULL, --nANCHO_BUENO_TOTAL_06 
                              NULL, --nANCHO_BUENO_OT_06 
                              NULL, --nANCHO_BUENO_TOTAL_07 
                              NULL, --nANCHO_BUENO_OT_07 
                              NULL, --nANCHO_BUENO_TOTAL_08 
                              NULL, --nANCHO_BUENO_OT_08 
                              NULL, --nANCHO_BUENO_TOTAL_09 
                              NULL, --nANCHO_BUENO_OT_09 
                              NULL, --nANCHO_BUENO_TOTAL_10 
                              NULL, --nANCHO_BUENO_OT_10 
                              NULL, --nANCHO_BUENO_TOTAL 
                              NULL, --nANCHO_BUENO_OT 
                              NULL, --nNUMECORT 
                              NULL, --nMM_MERMPRCO_01 
                              NULL, --nMM_MERMPLAN_EXESO_01 
                              NULL, --nMM_MERMPLAN_01 
                              NULL, --nMM_MERMPRCO_02 
                              NULL, --nMM_MERMPLAN_EXESO_02 
                              NULL, --nMM_MERMPLAN_02 
                              NULL, --nMM_MERMPRCO_03 
                              NULL, --nMM_MERMPLAN_EXESO_03 
                              NULL, --nMM_MERMPLAN_03 
                              NULL, --nMM_MERMPRCO_04 
                              NULL, --nMM_MERMPLAN_EXESO_04 
                              NULL, --nMM_MERMPLAN_04 
                              NULL, --nMM_MERMPRCO_05 
                              NULL, --nMM_MERMPLAN_EXESO_05 
                              NULL, --nMM_MERMPLAN_05 
                              NULL, --nMM_MERMPRCO_06 
                              NULL, --nMM_MERMPLAN_EXESO_06 
                              NULL, --nMM_MERMPLAN_06 
                              NULL, --nMM_MERMPRCO_07 
                              NULL, --nMM_MERMPLAN_EXESO_07 
                              NULL, --nMM_MERMPLAN_07 
                              NULL, --nMM_MERMPRCO_08 
                              NULL, --nMM_MERMPLAN_EXESO_08 
                              NULL, --nMM_MERMPLAN_08 
                              NULL, --nMM_MERMPRCO_09 
                              NULL, --nMM_MERMPLAN_EXESO_09 
                              NULL, --nMM_MERMPLAN_09 
                              NULL, --nMM_MERMPRCO_10 
                              NULL, --nMM_MERMPLAN_EXESO_10 
                              NULL, --nMM_MERMPLAN_10 
                              NULL, --nMM_MERMPRCO 
                              NULL, --nMM_MERMPLAN_EXESO 
                              NULL); --nMM_MERMPLAN
							--t_MATERIAL(rMATERIAL_B2.IDENTIFICADOR).MermAjus := NVL(t_MATERIAL(rMATERIAL_B2.IDENTIFICADOR).MermAjus,0) + nMerma_Ajuste_M2;
--ELSE dbms_output.put_line('11 IDENTIFICADOR IS NULL(2) ');
                  END IF;
               --Si encuentra un Evento es una Merma asociada a un Evento (Captación Real)
               ELSIF rCaracteristica_Maquina.EvenCodi IS NOT NULL THEN
--dbms_output.put_line('ENHEBRADX2.0.1 '|| rCaracteristica_Maquina.EvenCodi);
                  --Se realizan las busquedas de Mermas en las Maquinas Utilizadas en las Pasadas
                  FOR rMaquinas_Utilizadas_EvenMerm IN cMaquinas_Utilizadas_EvenMerm(rMaquinas.Contador,rCaracteristica_Maquina.EvenCodi) LOOP
--dbms_output.put_line('ENHEBRADX2.0.2 '|| rMaquinas_Utilizadas_EvenMerm.MaquCodi);
                     rPRD_MAQUEVEN.Valor := NULL;
                     rPRD_MAQUEVEN.OrvaReal := NULL;
                     --
                     OPEN cPRD_MAQUEVEN(rMaquinas.MaquTipo,rMaquinas_Utilizadas_EvenMerm.MaquCodi, rCaracteristica_Maquina.EvenCodi);
                     FETCH cPRD_MAQUEVEN INTO rPRD_MAQUEVEN;
                     CLOSE cPRD_MAQUEVEN;
                     --
                     IF rPRD_MAQUEVEN.VALOR = 'PRD_MEEVFA' THEN
--IF INSTR(rMaquinas_Utilizadas_EvenMerm.MaquCodi,'IMPRESORA')!= 0 OR INSTR(rMaquinas_Utilizadas_EvenMerm.MaquCodi,'LAMINADORA')!= 0 THEN
--dbms_output.put_line('ENHEBRADX2.0 nMaquCara_M1 := '||NVL(nMerma_Enhebrado_M1,0)||'->'||rMaquinas_Utilizadas_EvenMerm.MaquCodi);
--END IF;
                        --Se utilizan para ir restando la Merma de Enhebrado
                        IF bEjecAjEh THEN--24-10-2015 Se adiciona este control para que se realice solo una vez
                           nMaquCara_M1 := 0;
                           nMaquCara_M2 := 0;
                        ELSE
                           nMaquCara_M1 := NVL(nMerma_Enhebrado_M1,0);
                           nMaquCara_M2 := NVL(nMerma_Enhebrado_M2,0);
                        END IF;
                        --
                        FOR rMERMA IN cMERMA(rMaquinas.Contador, rMaquinas.MaquTipo, rMaquinas_Utilizadas_EvenMerm.MaquCodi, rCaracteristica_Maquina.EvenCodi, rPRD_MAQUEVEN.ORVAREAL) LOOP
                           --Se restan los valores de Enhebrado si este es Automático
                           nMerma_Ajuste_Enhebrado_M1 := NULL;
                           nMerma_Ajuste_Enhebrado_M2 := NULL;
                           --
                           IF bCaAuEnhe THEN
									   bEjecAjEh := TRUE;
										--
                              IF NVL(rMERMA.Merma_M1,0) >= NVL(nMaquCara_M1,0) AND NVL(nMaquCara_M1,0) > 0 THEN
--IF INSTR(rMaquinas_Utilizadas_EvenMerm.MaquCodi,'IMPRESORA')!= 0 OR INSTR(rMaquinas_Utilizadas_EvenMerm.MaquCodi,'LAMINADORA')!= 0 THEN
--dbms_output.put_line('ENHEBRADX2.1 nMerma_Ajuste_Enhebrado_M1 := '||nMaquCara_M1||'->'||rMaquinas_Utilizadas_EvenMerm.MaquCodi);
--END IF;                    
                                 nMerma_Ajuste_Enhebrado_M1 := nMaquCara_M1;
                                 --
                                 rMERMA.Merma_M1 := rMERMA.Merma_M1 - nMaquCara_M1;
                                 --
                                 nMaquCara_M1 := 0;
                              ELSIF NVL(rMERMA.Merma_M1,0) < NVL(nMaquCara_M1,0) AND NVL(nMaquCara_M1,0) > 0 AND NVL(rMERMA.Merma_M1,0) > 0 THEN
--IF INSTR(rMaquinas_Utilizadas_EvenMerm.MaquCodi,'IMPRESORA')!= 0 OR INSTR(rMaquinas_Utilizadas_EvenMerm.MaquCodi,'LAMINADORA')!= 0 THEN
--dbms_output.put_line('ENHEBRADX2.2 nMerma_Ajuste_Enhebrado_M1 := '||rMERMA.Merma_M1||'->'||rMaquinas_Utilizadas_EvenMerm.MaquCodi);
--END IF;
                                 nMerma_Ajuste_Enhebrado_M1 := rMERMA.Merma_M1;
                                 --18-06-2012 Error detectado Se pasa despues de que se reste
                                 --rMERMA.Merma_M1 := 0;
                                 --
                                 nMaquCara_M1 := nMaquCara_M1 - rMERMA.Merma_M1;
                                 --
                                 rMERMA.Merma_M1 := 0;
                              END IF;
                              --
                              IF NVL(rMERMA.Merma_M2,0) >= NVL(nMaquCara_M2,0) AND NVL(nMaquCara_M2,0) > 0 THEN
                                 nMerma_Ajuste_Enhebrado_M2 := nMaquCara_M2;
                                 --
                                 rMERMA.Merma_M2 := rMERMA.Merma_M2 - nMaquCara_M2;
                                 --
                                 nMaquCara_M2 := 0;
                              ELSIF NVL(rMERMA.Merma_M2,0) < NVL(nMaquCara_M2,0) AND NVL(nMaquCara_M2,0) > 0 AND NVL(rMERMA.Merma_M2,0) > 0 THEN
                                 nMerma_Ajuste_Enhebrado_M1 := rMERMA.Merma_M2;
                                 --
                                 rMERMA.Merma_M2 := 0;
                                 --
                                 nMaquCara_M2 := nMaquCara_M2 - rMERMA.Merma_M2;
                              END IF;
                           END IF;
                           --
--IF INSTR(rMaquinas_Utilizadas_EvenMerm.MaquCodi,'IMPRESORA')!= 0 OR INSTR(rMaquinas_Utilizadas_EvenMerm.MaquCodi,'LAMINADORA')!= 0 THEN
--dbms_output.put_line('ENHEBRADX2.3 nMerma_Ajuste_M1 := '||NVL(nMerma_Ajuste_M1,0)||' + '||NVL(rMERMA.Merma_M1,0)||'->'||rMaquinas_Utilizadas_EvenMerm.MaquCodi);
--END IF;
                           nMerma_Ajuste_M1 := NVL(nMerma_Ajuste_M1,0) + NVL(rMERMA.Merma_M1,0);
                           nMerma_Ajuste_M2 := NVL(nMerma_Ajuste_M2,0) + NVL(rMERMA.Merma_M2,0);
                           --
                           rMaterial_B1R.IDENTIFICADOR := NULL;
                           rMaterial_B2R.IDENTIFICADOR := NULL;
                           --
                           IF NVL(rMERMA.CoboBobi,0) > 0 THEN --Se trata de una Bobina Generada
                              rMaterial_B1R := F_MATERIAL(vEmpresa, nNumeOtre, rMaquinas.Contador, 
                                                          rMERMA.Tip_Arti, rMERMA.Cod_Arti, '|EMPRBOBI:'||rMERMA.EmprBobi||'|NUOTBOBI:'||rMERMA.NuotBobi||'|CONTBOBI:'||rMERMA.ContBobi||'|COBOBOBI:'||rMERMA.CoboBobi||'|LOTE:'||rMERMA.Lote,
                                                          1, NULL);
                           ELSE --Es un material de Almacen
                              rMaterial_B1R := F_MATERIAL(vEmpresa, nNumeOtre, rMaquinas.Contador, 
                                                          rMERMA.Tip_Arti, rMERMA.Cod_Arti, '|EMPRBOBI:'||NVL(rMERMA.EmprBobi,vEmpresa)||'|NUOTBOBI:'||NVL(rMERMA.NuotBobi,nNumeOtre)||'|LOTE:'||rMERMA.Lote||
																			 '|COBOMATE:'||rMERMA.ContBobi||'|BOBIMATE:'||rMERMA.CoboBobi, -- 11-11-2016 Solo para materiales tipo M
                                                          1, NULL);
                           END IF;
                           --
                           IF rMERMA.Tip_Arti2 IS NOT NULL THEN
                              IF NVL(rMERMA.CoboBobi2,0) > 0 THEN --Se trata de una Bobina Generada
                                 rMaterial_B2R := F_MATERIAL(vEmpresa, nNumeOtre, rMaquinas.Contador, 
                                                             rMERMA.Tip_Arti2, rMERMA.Cod_Arti2, '|EMPRBOBI:'||rMERMA.EmprBobi2||'|NUOTBOBI:'||rMERMA.NuotBobi2||'|CONTBOBI:'||rMERMA.ContBobi2||'|COBOBOBI:'||rMERMA.CoboBobi2||'|LOTE:'||rMERMA.Lote2,
                                                             2, NULL);
                              ELSE --Es un material de Almacen
                                 rMaterial_B2R := F_MATERIAL(vEmpresa, nNumeOtre, rMaquinas.Contador, 
                                                             rMERMA.Tip_Arti2, rMERMA.Cod_Arti2, '|EMPRBOBI:'||NVL(rMERMA.EmprBobi2,vEmpresa)||'|NUOTBOBI:'||NVL(rMERMA.NuotBobi2,nNumeOtre)||'|LOTE:'||rMERMA.Lote2||
												                         '|COBOMATE:'||rMERMA.ContBobi2||'|BOBIMATE:'||rMERMA.CoboBobi2, -- 11-11-2016 Solo para materiales tipo M
                                                             2, NULL);
                              END IF;
                           END IF;
                           --
                           IF rMATERIAL_B1R.IDENTIFICADOR IS NOT NULL THEN
/*IF INSTR(rMaquinas_Utilizadas_EvenMerm.MaquCodi,'IMPRESORA')!= 0 OR INSTR(rMaquinas_Utilizadas_EvenMerm.MaquCodi,'LAMINADORA')!= 0 THEN
dbms_output.put_line('t_MATERIAL(rMATERIAL_B1R.IDENTIFICADOR).MermAjus := '||NVL(t_MATERIAL(rMATERIAL_B1R.IDENTIFICADOR).MermAjus,0)||' + '||NVL(rMERMA.Merma_M1,0)||'->'||rMaquinas_Utilizadas_EvenMerm.MaquCodi);
END IF;*/
                              P_MATERIAL(rMATERIAL_B1R,'U',
													  NULL,--nCantProd
													  NULL,--nCantCons_E
													  NULL,--nCantCons
													  NULL,--nCantAjus
													  NULL,--nAncho
													  NULL,--nFACTOR_CONVERSION_M2_KG
													  NULL,--nPrecio_ML_E
													  NULL,--vLog_Precio
													  NULL,--nMermEnhe_E
													  NULL,--nMermEnhe
													  NULL,--nMermAjus_E
													  NVL(rMERMA.Merma_M1,0),--nMermAjus
													  NULL,--nMermCabo_E
													  NULL,--nMermCabo
													  NULL,--nMermPico_E
													  NULL,--nMermPico
                                         NULL,--nMermTita
                                         NULL,--nMermSane
                                         NULL,--nCantCons_Bobinas
                                         --
                                       NULL, --nCONTFSMU_01 
                                       NULL, --nCANTFSMU_01 
                                       NULL, --nCATOFSMU 
                                       NULL, --nCONTFSMU_02 
                                       NULL, --nCANTFSMU_02 
                                       NULL, --nCONTFSMU_03 
                                       NULL, --nCANTFSMU_03 
                                       NULL, --nCONTFSMU_04 
                                       NULL, --nCANTFSMU_04 
                                       NULL, --nCONTFSMU_05 
                                       NULL, --nCANTFSMU_05 
                                       NULL, --nCONTFSMU_06 
                                       NULL, --nCANTFSMU_06 
                                       NULL, --nCONTFSMU_07 
                                       NULL, --nCANTFSMU_07 
                                       NULL, --nCONTFSMU_08 
                                       NULL, --nCANTFSMU_08 
                                       NULL, --nCONTFSMU_09 
                                       NULL, --nCANTFSMU_09 
                                       NULL, --nCONTFSMU_10 
                                       NULL, --nCANTFSMU_10 
                                       NULL, --nANCHO_BUENO_TOTAL_01 
                                       NULL, --nANCHO_BUENO_OT_01 
                                       NULL, --nANCHO_BUENO_TOTAL_02 
                                       NULL, --nANCHO_BUENO_OT_02 
                                       NULL, --nANCHO_BUENO_TOTAL_03 
                                       NULL, --nANCHO_BUENO_OT_03 
                                       NULL, --nANCHO_BUENO_TOTAL_04 
                                       NULL, --nANCHO_BUENO_OT_04 
                                       NULL, --nANCHO_BUENO_TOTAL_05 
                                       NULL, --nANCHO_BUENO_OT_05 
                                       NULL, --nANCHO_BUENO_TOTAL_06 
                                       NULL, --nANCHO_BUENO_OT_06 
                                       NULL, --nANCHO_BUENO_TOTAL_07 
                                       NULL, --nANCHO_BUENO_OT_07 
                                       NULL, --nANCHO_BUENO_TOTAL_08 
                                       NULL, --nANCHO_BUENO_OT_08 
                                       NULL, --nANCHO_BUENO_TOTAL_09 
                                       NULL, --nANCHO_BUENO_OT_09 
                                       NULL, --nANCHO_BUENO_TOTAL_10 
                                       NULL, --nANCHO_BUENO_OT_10 
                                       NULL, --nANCHO_BUENO_TOTAL 
                                       NULL, --nANCHO_BUENO_OT 
                                       NULL, --nNUMECORT 
                                       NULL, --nMM_MERMPRCO_01 
                                       NULL, --nMM_MERMPLAN_EXESO_01 
                                       NULL, --nMM_MERMPLAN_01 
                                       NULL, --nMM_MERMPRCO_02 
                                       NULL, --nMM_MERMPLAN_EXESO_02 
                                       NULL, --nMM_MERMPLAN_02 
                                       NULL, --nMM_MERMPRCO_03 
                                       NULL, --nMM_MERMPLAN_EXESO_03 
                                       NULL, --nMM_MERMPLAN_03 
                                       NULL, --nMM_MERMPRCO_04 
                                       NULL, --nMM_MERMPLAN_EXESO_04 
                                       NULL, --nMM_MERMPLAN_04 
                                       NULL, --nMM_MERMPRCO_05 
                                       NULL, --nMM_MERMPLAN_EXESO_05 
                                       NULL, --nMM_MERMPLAN_05 
                                       NULL, --nMM_MERMPRCO_06 
                                       NULL, --nMM_MERMPLAN_EXESO_06 
                                       NULL, --nMM_MERMPLAN_06 
                                       NULL, --nMM_MERMPRCO_07 
                                       NULL, --nMM_MERMPLAN_EXESO_07 
                                       NULL, --nMM_MERMPLAN_07 
                                       NULL, --nMM_MERMPRCO_08 
                                       NULL, --nMM_MERMPLAN_EXESO_08 
                                       NULL, --nMM_MERMPLAN_08 
                                       NULL, --nMM_MERMPRCO_09 
                                       NULL, --nMM_MERMPLAN_EXESO_09 
                                       NULL, --nMM_MERMPLAN_09 
                                       NULL, --nMM_MERMPRCO_10 
                                       NULL, --nMM_MERMPLAN_EXESO_10 
                                       NULL, --nMM_MERMPLAN_10 
                                       NULL, --nMM_MERMPRCO 
                                       NULL, --nMM_MERMPLAN_EXESO 
                                       NULL); --nMM_MERMPLAN
										--t_MATERIAL(rMATERIAL_B1R.IDENTIFICADOR).MermAjus := NVL(t_MATERIAL(rMATERIAL_B1R.IDENTIFICADOR).MermAjus,0) + NVL(rMERMA.Merma_M1,0);
                              --18-04-2012 Si queda algo por asignar del Enhebrado se asigna al primer material
--dbms_output.put_line('ENHEBRADX2.6');
                              IF bCaAuEnhe THEN
/*IF INSTR(rMaquinas_Utilizadas_EvenMerm.MaquCodi,'IMPRESORA')!= 0 OR INSTR(rMaquinas_Utilizadas_EvenMerm.MaquCodi,'LAMINADORA')!= 0 THEN
dbms_output.put_line('t_MATERIAL(rMATERIAL_B1R.IDENTIFICADOR).MermEnhe := '||NVL(t_MATERIAL(rMATERIAL_B1R.IDENTIFICADOR).MermEnhe,0)||' + '||NVL(nMerma_Ajuste_Enhebrado_M1,0)||'->'||rMaquinas_Utilizadas_EvenMerm.MaquCodi);
END IF;*/
--dbms_output.put_line('ENHEBRADX2:'||nMerma_Ajuste_Enhebrado_M1);
                                 P_MATERIAL(rMATERIAL_B1R,'U',
														  NULL,--nCantProd
														  NULL,--nCantCons_E
														  NULL,--nCantCons
														  NULL,--nCantAjus
														  NULL,--nAncho
														  NULL,--nFACTOR_CONVERSION_M2_KG
														  NULL,--nPrecio_ML_E
														  NULL,--vLog_Precio
														  NULL,--nMermEnhe_E
														  NVL(nMerma_Ajuste_Enhebrado_M1,0),--nMermEnhe
														  NULL,--nMermAjus_E
														  NULL,--nMermAjus
														  NULL,--nMermCabo_E
														  NULL,--nMermCabo
														  NULL,--nMermPico_E
														  NULL,--nMermPico
                                            NULL,--nMermTita
                                            NULL,--nMermSane
                                            NULL,--nCantCons_Bobinas
                                            --
                                          NULL, --nCONTFSMU_01 
                                          NULL, --nCANTFSMU_01 
                                          NULL, --nCATOFSMU 
                                          NULL, --nCONTFSMU_02 
                                          NULL, --nCANTFSMU_02 
                                          NULL, --nCONTFSMU_03 
                                          NULL, --nCANTFSMU_03 
                                          NULL, --nCONTFSMU_04 
                                          NULL, --nCANTFSMU_04 
                                          NULL, --nCONTFSMU_05 
                                          NULL, --nCANTFSMU_05 
                                          NULL, --nCONTFSMU_06 
                                          NULL, --nCANTFSMU_06 
                                          NULL, --nCONTFSMU_07 
                                          NULL, --nCANTFSMU_07 
                                          NULL, --nCONTFSMU_08 
                                          NULL, --nCANTFSMU_08 
                                          NULL, --nCONTFSMU_09 
                                          NULL, --nCANTFSMU_09 
                                          NULL, --nCONTFSMU_10 
                                          NULL, --nCANTFSMU_10 
                                          NULL, --nANCHO_BUENO_TOTAL_01 
                                          NULL, --nANCHO_BUENO_OT_01 
                                          NULL, --nANCHO_BUENO_TOTAL_02 
                                          NULL, --nANCHO_BUENO_OT_02 
                                          NULL, --nANCHO_BUENO_TOTAL_03 
                                          NULL, --nANCHO_BUENO_OT_03 
                                          NULL, --nANCHO_BUENO_TOTAL_04 
                                          NULL, --nANCHO_BUENO_OT_04 
                                          NULL, --nANCHO_BUENO_TOTAL_05 
                                          NULL, --nANCHO_BUENO_OT_05 
                                          NULL, --nANCHO_BUENO_TOTAL_06 
                                          NULL, --nANCHO_BUENO_OT_06 
                                          NULL, --nANCHO_BUENO_TOTAL_07 
                                          NULL, --nANCHO_BUENO_OT_07 
                                          NULL, --nANCHO_BUENO_TOTAL_08 
                                          NULL, --nANCHO_BUENO_OT_08 
                                          NULL, --nANCHO_BUENO_TOTAL_09 
                                          NULL, --nANCHO_BUENO_OT_09 
                                          NULL, --nANCHO_BUENO_TOTAL_10 
                                          NULL, --nANCHO_BUENO_OT_10 
                                          NULL, --nANCHO_BUENO_TOTAL 
                                          NULL, --nANCHO_BUENO_OT 
                                          NULL, --nNUMECORT 
                                          NULL, --nMM_MERMPRCO_01 
                                          NULL, --nMM_MERMPLAN_EXESO_01 
                                          NULL, --nMM_MERMPLAN_01 
                                          NULL, --nMM_MERMPRCO_02 
                                          NULL, --nMM_MERMPLAN_EXESO_02 
                                          NULL, --nMM_MERMPLAN_02 
                                          NULL, --nMM_MERMPRCO_03 
                                          NULL, --nMM_MERMPLAN_EXESO_03 
                                          NULL, --nMM_MERMPLAN_03 
                                          NULL, --nMM_MERMPRCO_04 
                                          NULL, --nMM_MERMPLAN_EXESO_04 
                                          NULL, --nMM_MERMPLAN_04 
                                          NULL, --nMM_MERMPRCO_05 
                                          NULL, --nMM_MERMPLAN_EXESO_05 
                                          NULL, --nMM_MERMPLAN_05 
                                          NULL, --nMM_MERMPRCO_06 
                                          NULL, --nMM_MERMPLAN_EXESO_06 
                                          NULL, --nMM_MERMPLAN_06 
                                          NULL, --nMM_MERMPRCO_07 
                                          NULL, --nMM_MERMPLAN_EXESO_07 
                                          NULL, --nMM_MERMPLAN_07 
                                          NULL, --nMM_MERMPRCO_08 
                                          NULL, --nMM_MERMPLAN_EXESO_08 
                                          NULL, --nMM_MERMPLAN_08 
                                          NULL, --nMM_MERMPRCO_09 
                                          NULL, --nMM_MERMPLAN_EXESO_09 
                                          NULL, --nMM_MERMPLAN_09 
                                          NULL, --nMM_MERMPRCO_10 
                                          NULL, --nMM_MERMPLAN_EXESO_10 
                                          NULL, --nMM_MERMPLAN_10 
                                          NULL, --nMM_MERMPRCO 
                                          NULL, --nMM_MERMPLAN_EXESO 
                                          NULL); --nMM_MERMPLAN
											--t_MATERIAL(rMATERIAL_B1R.IDENTIFICADOR).MermEnhe := NVL(t_MATERIAL(rMATERIAL_B1R.IDENTIFICADOR).MermEnhe,0) + NVL(nMerma_Ajuste_Enhebrado_M1,0);
                              END IF;
                              --Actualización de Precio de MP
                              IF rMERMA.Tip_Arti IN (vTiarMpF4,vTiarSeF4,vP_TiarFiF4) THEN--AND t_MATERIAL(rMATERIAL_B1R.IDENTIFICADOR).Precio_ML IS NULL THEN --Si es Materia Prima
                                 vLogPreci := NULL;
                                 vPrecio := F_PRECIO(vEmpresa, nNumeOtre, 
																	  rMERMA.Tip_Arti, rMERMA.Cod_Arti, rMERMA.Lote,
																	  NULL, NULL, NULL, NULL);
											--
											P_MATERIAL(rMATERIAL_B1R,'U',
														  NULL,--nCantProd
														  NULL,--nCantCons_E
														  NULL,--nCantCons
														  NULL,--nCantAjus
														  NULL,--nAncho
														  NULL,--nFACTOR_CONVERSION_M2_KG
														  NULL,--nPrecio_ML_E
														  vPrecio,--vLog_Precio
														  NULL,--nMermEnhe_E
														  NULL,--nMermEnhe
														  NULL,--nMermAjus_E
														  NULL,--nMermAjus
														  NULL,--nMermCabo_E
														  NULL,--nMermCabo
														  NULL,--nMermPico_E
														  NULL,--nMermPico
                                            NULL,--nMermTita
                                            NULL,--nMermSane
                                            NULL,--nCantCons_Bobinas
                                            --
                                          NULL, --nCONTFSMU_01 
                                          NULL, --nCANTFSMU_01 
                                          NULL, --nCATOFSMU 
                                          NULL, --nCONTFSMU_02 
                                          NULL, --nCANTFSMU_02 
                                          NULL, --nCONTFSMU_03 
                                          NULL, --nCANTFSMU_03 
                                          NULL, --nCONTFSMU_04 
                                          NULL, --nCANTFSMU_04 
                                          NULL, --nCONTFSMU_05 
                                          NULL, --nCANTFSMU_05 
                                          NULL, --nCONTFSMU_06 
                                          NULL, --nCANTFSMU_06 
                                          NULL, --nCONTFSMU_07 
                                          NULL, --nCANTFSMU_07 
                                          NULL, --nCONTFSMU_08 
                                          NULL, --nCANTFSMU_08 
                                          NULL, --nCONTFSMU_09 
                                          NULL, --nCANTFSMU_09 
                                          NULL, --nCONTFSMU_10 
                                          NULL, --nCANTFSMU_10 
                                          NULL, --nANCHO_BUENO_TOTAL_01 
                                          NULL, --nANCHO_BUENO_OT_01 
                                          NULL, --nANCHO_BUENO_TOTAL_02 
                                          NULL, --nANCHO_BUENO_OT_02 
                                          NULL, --nANCHO_BUENO_TOTAL_03 
                                          NULL, --nANCHO_BUENO_OT_03 
                                          NULL, --nANCHO_BUENO_TOTAL_04 
                                          NULL, --nANCHO_BUENO_OT_04 
                                          NULL, --nANCHO_BUENO_TOTAL_05 
                                          NULL, --nANCHO_BUENO_OT_05 
                                          NULL, --nANCHO_BUENO_TOTAL_06 
                                          NULL, --nANCHO_BUENO_OT_06 
                                          NULL, --nANCHO_BUENO_TOTAL_07 
                                          NULL, --nANCHO_BUENO_OT_07 
                                          NULL, --nANCHO_BUENO_TOTAL_08 
                                          NULL, --nANCHO_BUENO_OT_08 
                                          NULL, --nANCHO_BUENO_TOTAL_09 
                                          NULL, --nANCHO_BUENO_OT_09 
                                          NULL, --nANCHO_BUENO_TOTAL_10 
                                          NULL, --nANCHO_BUENO_OT_10 
                                          NULL, --nANCHO_BUENO_TOTAL 
                                          NULL, --nANCHO_BUENO_OT 
                                          NULL, --nNUMECORT 
                                          NULL, --nMM_MERMPRCO_01 
                                          NULL, --nMM_MERMPLAN_EXESO_01 
                                          NULL, --nMM_MERMPLAN_01 
                                          NULL, --nMM_MERMPRCO_02 
                                          NULL, --nMM_MERMPLAN_EXESO_02 
                                          NULL, --nMM_MERMPLAN_02 
                                          NULL, --nMM_MERMPRCO_03 
                                          NULL, --nMM_MERMPLAN_EXESO_03 
                                          NULL, --nMM_MERMPLAN_03 
                                          NULL, --nMM_MERMPRCO_04 
                                          NULL, --nMM_MERMPLAN_EXESO_04 
                                          NULL, --nMM_MERMPLAN_04 
                                          NULL, --nMM_MERMPRCO_05 
                                          NULL, --nMM_MERMPLAN_EXESO_05 
                                          NULL, --nMM_MERMPLAN_05 
                                          NULL, --nMM_MERMPRCO_06 
                                          NULL, --nMM_MERMPLAN_EXESO_06 
                                          NULL, --nMM_MERMPLAN_06 
                                          NULL, --nMM_MERMPRCO_07 
                                          NULL, --nMM_MERMPLAN_EXESO_07 
                                          NULL, --nMM_MERMPLAN_07 
                                          NULL, --nMM_MERMPRCO_08 
                                          NULL, --nMM_MERMPLAN_EXESO_08 
                                          NULL, --nMM_MERMPLAN_08 
                                          NULL, --nMM_MERMPRCO_09 
                                          NULL, --nMM_MERMPLAN_EXESO_09 
                                          NULL, --nMM_MERMPLAN_09 
                                          NULL, --nMM_MERMPRCO_10 
                                          NULL, --nMM_MERMPLAN_EXESO_10 
                                          NULL, --nMM_MERMPLAN_10 
                                          NULL, --nMM_MERMPRCO 
                                          NULL, --nMM_MERMPLAN_EXESO 
                                          NULL); --nMM_MERMPLAN
											--t_MATERIAL(rMATERIAL_B1R.IDENTIFICADOR).Precio_ML := F_PRECIO(vEmpresa, nNumeOtre, 
                                 --                                                              rMERMA.Tip_Arti, rMERMA.Cod_Arti, rMERMA.Lote,
                                 --                                                              NULL, NULL, NULL, NULL);
                                 --t_MATERIAL(rMATERIAL_B1R.IDENTIFICADOR).Precio_ML_E := F_PRECIO_E(vEmpresa, nNumeOtre, 
                                 --                                                                  rMERMA.Tip_Arti, rMERMA.Cod_Arti, rMERMA.Lote,
                                 --                                                                  NULL, NULL, NULL, NULL);
                              END IF;
--ELSE dbms_output.put_line('12 IDENTIFICADOR IS NULL ');
									END IF;
                           --
                           IF rMATERIAL_B2R.IDENTIFICADOR IS NOT NULL THEN
                              P_MATERIAL(rMATERIAL_B2R,'U',
                                         NULL,--nCantProd
                                         NULL,--nCantCons_E
                                         NULL,--nCantCons
                                         NULL,--nCantAjus
                                         NULL,--nAncho
                                         NULL,--nFACTOR_CONVERSION_M2_KG
                                         NULL,--nPrecio_ML_E
                                         NULL,--vLog_Precio
                                         NULL,--nMermEnhe_E
                                         NULL,--nMermEnhe
                                         NULL,--nMermAjus_E
                                         NVL(rMERMA.Merma_M2,0),--nMermAjus
                                         NULL,--nMermCabo_E
                                         NULL,--nMermCabo
                                         NULL,--nMermPico_E
                                         NULL,--nMermPico
                                         NULL,--nMermTita
                                         NULL,--nMermSane
                                         NULL,--nCantCons_Bobinas
                                         --
                                       NULL, --nCONTFSMU_01 
                                       NULL, --nCANTFSMU_01 
                                       NULL, --nCATOFSMU 
                                       NULL, --nCONTFSMU_02 
                                       NULL, --nCANTFSMU_02 
                                       NULL, --nCONTFSMU_03 
                                       NULL, --nCANTFSMU_03 
                                       NULL, --nCONTFSMU_04 
                                       NULL, --nCANTFSMU_04 
                                       NULL, --nCONTFSMU_05 
                                       NULL, --nCANTFSMU_05 
                                       NULL, --nCONTFSMU_06 
                                       NULL, --nCANTFSMU_06 
                                       NULL, --nCONTFSMU_07 
                                       NULL, --nCANTFSMU_07 
                                       NULL, --nCONTFSMU_08 
                                       NULL, --nCANTFSMU_08 
                                       NULL, --nCONTFSMU_09 
                                       NULL, --nCANTFSMU_09 
                                       NULL, --nCONTFSMU_10 
                                       NULL, --nCANTFSMU_10 
                                       NULL, --nANCHO_BUENO_TOTAL_01 
                                       NULL, --nANCHO_BUENO_OT_01 
                                       NULL, --nANCHO_BUENO_TOTAL_02 
                                       NULL, --nANCHO_BUENO_OT_02 
                                       NULL, --nANCHO_BUENO_TOTAL_03 
                                       NULL, --nANCHO_BUENO_OT_03 
                                       NULL, --nANCHO_BUENO_TOTAL_04 
                                       NULL, --nANCHO_BUENO_OT_04 
                                       NULL, --nANCHO_BUENO_TOTAL_05 
                                       NULL, --nANCHO_BUENO_OT_05 
                                       NULL, --nANCHO_BUENO_TOTAL_06 
                                       NULL, --nANCHO_BUENO_OT_06 
                                       NULL, --nANCHO_BUENO_TOTAL_07 
                                       NULL, --nANCHO_BUENO_OT_07 
                                       NULL, --nANCHO_BUENO_TOTAL_08 
                                       NULL, --nANCHO_BUENO_OT_08 
                                       NULL, --nANCHO_BUENO_TOTAL_09 
                                       NULL, --nANCHO_BUENO_OT_09 
                                       NULL, --nANCHO_BUENO_TOTAL_10 
                                       NULL, --nANCHO_BUENO_OT_10 
                                       NULL, --nANCHO_BUENO_TOTAL 
                                       NULL, --nANCHO_BUENO_OT 
                                       NULL, --nNUMECORT 
                                       NULL, --nMM_MERMPRCO_01 
                                       NULL, --nMM_MERMPLAN_EXESO_01 
                                       NULL, --nMM_MERMPLAN_01 
                                       NULL, --nMM_MERMPRCO_02 
                                       NULL, --nMM_MERMPLAN_EXESO_02 
                                       NULL, --nMM_MERMPLAN_02 
                                       NULL, --nMM_MERMPRCO_03 
                                       NULL, --nMM_MERMPLAN_EXESO_03 
                                       NULL, --nMM_MERMPLAN_03 
                                       NULL, --nMM_MERMPRCO_04 
                                       NULL, --nMM_MERMPLAN_EXESO_04 
                                       NULL, --nMM_MERMPLAN_04 
                                       NULL, --nMM_MERMPRCO_05 
                                       NULL, --nMM_MERMPLAN_EXESO_05 
                                       NULL, --nMM_MERMPLAN_05 
                                       NULL, --nMM_MERMPRCO_06 
                                       NULL, --nMM_MERMPLAN_EXESO_06 
                                       NULL, --nMM_MERMPLAN_06 
                                       NULL, --nMM_MERMPRCO_07 
                                       NULL, --nMM_MERMPLAN_EXESO_07 
                                       NULL, --nMM_MERMPLAN_07 
                                       NULL, --nMM_MERMPRCO_08 
                                       NULL, --nMM_MERMPLAN_EXESO_08 
                                       NULL, --nMM_MERMPLAN_08 
                                       NULL, --nMM_MERMPRCO_09 
                                       NULL, --nMM_MERMPLAN_EXESO_09 
                                       NULL, --nMM_MERMPLAN_09 
                                       NULL, --nMM_MERMPRCO_10 
                                       NULL, --nMM_MERMPLAN_EXESO_10 
                                       NULL, --nMM_MERMPLAN_10 
                                       NULL, --nMM_MERMPRCO 
                                       NULL, --nMM_MERMPLAN_EXESO 
                                       NULL); --nMM_MERMPLAN
                              --t_MATERIAL(rMATERIAL_B2R.IDENTIFICADOR).MermAjus := NVL(t_MATERIAL(rMATERIAL_B2R.IDENTIFICADOR).MermAjus,0) + NVL(rMERMA.Merma_M2,0);
                              --18-04-2012 Si queda algo por asignar del Enhebrado se asigna al primer material
                              IF bCaAuEnhe THEN
--dbms_output.put_line('ENHEBRADX3:'||nMerma_Ajuste_Enhebrado_M2);
                                 P_MATERIAL(rMATERIAL_B2R,'U',
														  NULL,--nCantProd
														  NULL,--nCantCons_E
														  NULL,--nCantCons
														  NULL,--nCantAjus
														  NULL,--nAncho
														  NULL,--nFACTOR_CONVERSION_M2_KG
														  NULL,--nPrecio_ML_E
														  NULL,--vLog_Precio
														  NULL,--nMermEnhe_E
														  NVL(nMerma_Ajuste_Enhebrado_M2,0),--nMermEnhe
														  NULL,--nMermAjus_E
														  NULL,--nMermAjus
														  NULL,--nMermCabo_E
														  NULL,--nMermCabo
														  NULL,--nMermPico_E
														  NULL,--nMermPico
                                            NULL,--nMermTita
                                            NULL,--nMermSane
                                            NULL,--nCantCons_Bobinas
                                            --
                                          NULL, --nCONTFSMU_01 
                                          NULL, --nCANTFSMU_01 
                                          NULL, --nCATOFSMU 
                                          NULL, --nCONTFSMU_02 
                                          NULL, --nCANTFSMU_02 
                                          NULL, --nCONTFSMU_03 
                                          NULL, --nCANTFSMU_03 
                                          NULL, --nCONTFSMU_04 
                                          NULL, --nCANTFSMU_04 
                                          NULL, --nCONTFSMU_05 
                                          NULL, --nCANTFSMU_05 
                                          NULL, --nCONTFSMU_06 
                                          NULL, --nCANTFSMU_06 
                                          NULL, --nCONTFSMU_07 
                                          NULL, --nCANTFSMU_07 
                                          NULL, --nCONTFSMU_08 
                                          NULL, --nCANTFSMU_08 
                                          NULL, --nCONTFSMU_09 
                                          NULL, --nCANTFSMU_09 
                                          NULL, --nCONTFSMU_10 
                                          NULL, --nCANTFSMU_10 
                                          NULL, --nANCHO_BUENO_TOTAL_01 
                                          NULL, --nANCHO_BUENO_OT_01 
                                          NULL, --nANCHO_BUENO_TOTAL_02 
                                          NULL, --nANCHO_BUENO_OT_02 
                                          NULL, --nANCHO_BUENO_TOTAL_03 
                                          NULL, --nANCHO_BUENO_OT_03 
                                          NULL, --nANCHO_BUENO_TOTAL_04 
                                          NULL, --nANCHO_BUENO_OT_04 
                                          NULL, --nANCHO_BUENO_TOTAL_05 
                                          NULL, --nANCHO_BUENO_OT_05 
                                          NULL, --nANCHO_BUENO_TOTAL_06 
                                          NULL, --nANCHO_BUENO_OT_06 
                                          NULL, --nANCHO_BUENO_TOTAL_07 
                                          NULL, --nANCHO_BUENO_OT_07 
                                          NULL, --nANCHO_BUENO_TOTAL_08 
                                          NULL, --nANCHO_BUENO_OT_08 
                                          NULL, --nANCHO_BUENO_TOTAL_09 
                                          NULL, --nANCHO_BUENO_OT_09 
                                          NULL, --nANCHO_BUENO_TOTAL_10 
                                          NULL, --nANCHO_BUENO_OT_10 
                                          NULL, --nANCHO_BUENO_TOTAL 
                                          NULL, --nANCHO_BUENO_OT 
                                          NULL, --nNUMECORT 
                                          NULL, --nMM_MERMPRCO_01 
                                          NULL, --nMM_MERMPLAN_EXESO_01 
                                          NULL, --nMM_MERMPLAN_01 
                                          NULL, --nMM_MERMPRCO_02 
                                          NULL, --nMM_MERMPLAN_EXESO_02 
                                          NULL, --nMM_MERMPLAN_02 
                                          NULL, --nMM_MERMPRCO_03 
                                          NULL, --nMM_MERMPLAN_EXESO_03 
                                          NULL, --nMM_MERMPLAN_03 
                                          NULL, --nMM_MERMPRCO_04 
                                          NULL, --nMM_MERMPLAN_EXESO_04 
                                          NULL, --nMM_MERMPLAN_04 
                                          NULL, --nMM_MERMPRCO_05 
                                          NULL, --nMM_MERMPLAN_EXESO_05 
                                          NULL, --nMM_MERMPLAN_05 
                                          NULL, --nMM_MERMPRCO_06 
                                          NULL, --nMM_MERMPLAN_EXESO_06 
                                          NULL, --nMM_MERMPLAN_06 
                                          NULL, --nMM_MERMPRCO_07 
                                          NULL, --nMM_MERMPLAN_EXESO_07 
                                          NULL, --nMM_MERMPLAN_07 
                                          NULL, --nMM_MERMPRCO_08 
                                          NULL, --nMM_MERMPLAN_EXESO_08 
                                          NULL, --nMM_MERMPLAN_08 
                                          NULL, --nMM_MERMPRCO_09 
                                          NULL, --nMM_MERMPLAN_EXESO_09 
                                          NULL, --nMM_MERMPLAN_09 
                                          NULL, --nMM_MERMPRCO_10 
                                          NULL, --nMM_MERMPLAN_EXESO_10 
                                          NULL, --nMM_MERMPLAN_10 
                                          NULL, --nMM_MERMPRCO 
                                          NULL, --nMM_MERMPLAN_EXESO 
                                          NULL); --nMM_MERMPLAN
											--t_MATERIAL(rMATERIAL_B2R.IDENTIFICADOR).MermEnhe := NVL(t_MATERIAL(rMATERIAL_B2R.IDENTIFICADOR).MermEnhe,0) + NVL(nMerma_Ajuste_Enhebrado_M2,0);
                              END IF;
                              --Actualización de Precio de MP
                              IF rMERMA.Tip_Arti2 IN (vTiarMpF4,vTiarSeF4,vP_TiarFiF4) THEN--AND t_MATERIAL(rMATERIAL_B2R.IDENTIFICADOR).Precio_ML IS NULL THEN --Si es Materia Prima
                                 vLogPreci := NULL;
                                 vPrecio := F_PRECIO(vEmpresa, nNumeOtre, 
																	  rMERMA.Tip_Arti2, rMERMA.Cod_Arti2, rMERMA.Lote2,
																	  NULL, NULL, NULL, NULL);
											--
											P_MATERIAL(rMATERIAL_B2R,'U',
														  NULL,--nCantProd
														  NULL,--nCantCons_E
														  NULL,--nCantCons
														  NULL,--nCantAjus
														  NULL,--nAncho
														  NULL,--nFACTOR_CONVERSION_M2_KG
														  NULL,--nPrecio_ML_E
														  vPrecio,--vLog_Precio
														  NULL,--nMermEnhe_E
														  NULL,--nMermEnhe
														  NULL,--nMermAjus_E
														  NULL,--nMermAjus
														  NULL,--nMermCabo_E
														  NULL,--nMermCabo
														  NULL,--nMermPico_E
														  NULL,--nMermPico
                                            NULL,--nMermTita
                                            NULL,--nMermSane
                                            NULL,--nCantCons_Bobinas
                                            --
                                          NULL, --nCONTFSMU_01 
                                          NULL, --nCANTFSMU_01 
                                          NULL, --nCATOFSMU 
                                          NULL, --nCONTFSMU_02 
                                          NULL, --nCANTFSMU_02 
                                          NULL, --nCONTFSMU_03 
                                          NULL, --nCANTFSMU_03 
                                          NULL, --nCONTFSMU_04 
                                          NULL, --nCANTFSMU_04 
                                          NULL, --nCONTFSMU_05 
                                          NULL, --nCANTFSMU_05 
                                          NULL, --nCONTFSMU_06 
                                          NULL, --nCANTFSMU_06 
                                          NULL, --nCONTFSMU_07 
                                          NULL, --nCANTFSMU_07 
                                          NULL, --nCONTFSMU_08 
                                          NULL, --nCANTFSMU_08 
                                          NULL, --nCONTFSMU_09 
                                          NULL, --nCANTFSMU_09 
                                          NULL, --nCONTFSMU_10 
                                          NULL, --nCANTFSMU_10 
                                          NULL, --nANCHO_BUENO_TOTAL_01 
                                          NULL, --nANCHO_BUENO_OT_01 
                                          NULL, --nANCHO_BUENO_TOTAL_02 
                                          NULL, --nANCHO_BUENO_OT_02 
                                          NULL, --nANCHO_BUENO_TOTAL_03 
                                          NULL, --nANCHO_BUENO_OT_03 
                                          NULL, --nANCHO_BUENO_TOTAL_04 
                                          NULL, --nANCHO_BUENO_OT_04 
                                          NULL, --nANCHO_BUENO_TOTAL_05 
                                          NULL, --nANCHO_BUENO_OT_05 
                                          NULL, --nANCHO_BUENO_TOTAL_06 
                                          NULL, --nANCHO_BUENO_OT_06 
                                          NULL, --nANCHO_BUENO_TOTAL_07 
                                          NULL, --nANCHO_BUENO_OT_07 
                                          NULL, --nANCHO_BUENO_TOTAL_08 
                                          NULL, --nANCHO_BUENO_OT_08 
                                          NULL, --nANCHO_BUENO_TOTAL_09 
                                          NULL, --nANCHO_BUENO_OT_09 
                                          NULL, --nANCHO_BUENO_TOTAL_10 
                                          NULL, --nANCHO_BUENO_OT_10 
                                          NULL, --nANCHO_BUENO_TOTAL 
                                          NULL, --nANCHO_BUENO_OT 
                                          NULL, --nNUMECORT 
                                          NULL, --nMM_MERMPRCO_01 
                                          NULL, --nMM_MERMPLAN_EXESO_01 
                                          NULL, --nMM_MERMPLAN_01 
                                          NULL, --nMM_MERMPRCO_02 
                                          NULL, --nMM_MERMPLAN_EXESO_02 
                                          NULL, --nMM_MERMPLAN_02 
                                          NULL, --nMM_MERMPRCO_03 
                                          NULL, --nMM_MERMPLAN_EXESO_03 
                                          NULL, --nMM_MERMPLAN_03 
                                          NULL, --nMM_MERMPRCO_04 
                                          NULL, --nMM_MERMPLAN_EXESO_04 
                                          NULL, --nMM_MERMPLAN_04 
                                          NULL, --nMM_MERMPRCO_05 
                                          NULL, --nMM_MERMPLAN_EXESO_05 
                                          NULL, --nMM_MERMPLAN_05 
                                          NULL, --nMM_MERMPRCO_06 
                                          NULL, --nMM_MERMPLAN_EXESO_06 
                                          NULL, --nMM_MERMPLAN_06 
                                          NULL, --nMM_MERMPRCO_07 
                                          NULL, --nMM_MERMPLAN_EXESO_07 
                                          NULL, --nMM_MERMPLAN_07 
                                          NULL, --nMM_MERMPRCO_08 
                                          NULL, --nMM_MERMPLAN_EXESO_08 
                                          NULL, --nMM_MERMPLAN_08 
                                          NULL, --nMM_MERMPRCO_09 
                                          NULL, --nMM_MERMPLAN_EXESO_09 
                                          NULL, --nMM_MERMPLAN_09 
                                          NULL, --nMM_MERMPRCO_10 
                                          NULL, --nMM_MERMPLAN_EXESO_10 
                                          NULL, --nMM_MERMPLAN_10 
                                          NULL, --nMM_MERMPRCO 
                                          NULL, --nMM_MERMPLAN_EXESO 
                                          NULL); --nMM_MERMPLAN
											--t_MATERIAL(rMATERIAL_B2R.IDENTIFICADOR).Precio_ML := F_PRECIO(vEmpresa, nNumeOtre, 
                                 --                                                              rMERMA.Tip_Arti2, rMERMA.Cod_Arti2, rMERMA.Lote2,
                                 --                                                              NULL, NULL, NULL, NULL);
                                 --t_MATERIAL(rMATERIAL_B2R.IDENTIFICADOR).Precio_ML_E := F_PRECIO_E(vEmpresa, nNumeOtre, 
                                 --                                                                  rMERMA.Tip_Arti2, rMERMA.Cod_Arti2, rMERMA.Lote2,
                                 --                                                                  NULL, NULL, NULL, NULL);
                              END IF;
--ELSE dbms_output.put_line('13 IDENTIFICADOR IS NULL(2) ');
									END IF;
                        END LOOP;
                        --18-04-2012 Si queda algo por asignar del Enhebrado se asigna al primer material
                        IF bCaAuEnhe THEN
                           IF nMaquCara_M1 > 0 THEN
                              IF rMATERIAL_B1.IDENTIFICADOR IS NOT NULL THEN
/*IF INSTR(rMaquinas_Utilizadas_EvenMerm.MaquCodi,'IMPRESORA')!= 0 OR INSTR(rMaquinas_Utilizadas_EvenMerm.MaquCodi,'LAMINADORA')!= 0 THEN
dbms_output.put_line('QUEDA t_MATERIAL(rMATERIAL_B1.IDENTIFICADOR).MermEnhe := '||NVL(t_MATERIAL(rMATERIAL_B1.IDENTIFICADOR).MermEnhe,0)||' + '||nMaquCara_M1||'->'||rMaquinas_Utilizadas_EvenMerm.MaquCodi);
END IF;*/
--dbms_output.put_line('ENHEBRADX4:'||nMaquCara_M1);
                                 P_MATERIAL(rMATERIAL_B1,'U',
														  NULL,--nCantProd
														  NULL,--nCantCons_E
														  NULL,--nCantCons
														  NULL,--nCantAjus
														  NULL,--nAncho
														  NULL,--nFACTOR_CONVERSION_M2_KG
														  NULL,--nPrecio_ML_E
														  NULL,--vLog_Precio
														  NULL,--nMermEnhe_E
														  nMaquCara_M1,--nMermEnhe
														  NULL,--nMermAjus_E
														  NULL,--nMermAjus
														  NULL,--nMermCabo_E
														  NULL,--nMermCabo
														  NULL,--nMermPico_E
														  NULL,--nMermPico
                                            NULL,--nMermTita
                                            NULL,--nMermSane
                                            NULL,--nCantCons_Bobinas
                                            --
                                             NULL, --nCONTFSMU_01 
                                             NULL, --nCANTFSMU_01 
                                             NULL, --nCATOFSMU 
                                             NULL, --nCONTFSMU_02 
                                             NULL, --nCANTFSMU_02 
                                             NULL, --nCONTFSMU_03 
                                             NULL, --nCANTFSMU_03 
                                             NULL, --nCONTFSMU_04 
                                             NULL, --nCANTFSMU_04 
                                             NULL, --nCONTFSMU_05 
                                             NULL, --nCANTFSMU_05 
                                             NULL, --nCONTFSMU_06 
                                             NULL, --nCANTFSMU_06 
                                             NULL, --nCONTFSMU_07 
                                             NULL, --nCANTFSMU_07 
                                             NULL, --nCONTFSMU_08 
                                             NULL, --nCANTFSMU_08 
                                             NULL, --nCONTFSMU_09 
                                             NULL, --nCANTFSMU_09 
                                             NULL, --nCONTFSMU_10 
                                             NULL, --nCANTFSMU_10 
                                             NULL, --nANCHO_BUENO_TOTAL_01 
                                             NULL, --nANCHO_BUENO_OT_01 
                                             NULL, --nANCHO_BUENO_TOTAL_02 
                                             NULL, --nANCHO_BUENO_OT_02 
                                             NULL, --nANCHO_BUENO_TOTAL_03 
                                             NULL, --nANCHO_BUENO_OT_03 
                                             NULL, --nANCHO_BUENO_TOTAL_04 
                                             NULL, --nANCHO_BUENO_OT_04 
                                             NULL, --nANCHO_BUENO_TOTAL_05 
                                             NULL, --nANCHO_BUENO_OT_05 
                                             NULL, --nANCHO_BUENO_TOTAL_06 
                                             NULL, --nANCHO_BUENO_OT_06 
                                             NULL, --nANCHO_BUENO_TOTAL_07 
                                             NULL, --nANCHO_BUENO_OT_07 
                                             NULL, --nANCHO_BUENO_TOTAL_08 
                                             NULL, --nANCHO_BUENO_OT_08 
                                             NULL, --nANCHO_BUENO_TOTAL_09 
                                             NULL, --nANCHO_BUENO_OT_09 
                                             NULL, --nANCHO_BUENO_TOTAL_10 
                                             NULL, --nANCHO_BUENO_OT_10 
                                             NULL, --nANCHO_BUENO_TOTAL 
                                             NULL, --nANCHO_BUENO_OT 
                                             NULL, --nNUMECORT 
                                             NULL, --nMM_MERMPRCO_01 
                                             NULL, --nMM_MERMPLAN_EXESO_01 
                                             NULL, --nMM_MERMPLAN_01 
                                             NULL, --nMM_MERMPRCO_02 
                                             NULL, --nMM_MERMPLAN_EXESO_02 
                                             NULL, --nMM_MERMPLAN_02 
                                             NULL, --nMM_MERMPRCO_03 
                                             NULL, --nMM_MERMPLAN_EXESO_03 
                                             NULL, --nMM_MERMPLAN_03 
                                             NULL, --nMM_MERMPRCO_04 
                                             NULL, --nMM_MERMPLAN_EXESO_04 
                                             NULL, --nMM_MERMPLAN_04 
                                             NULL, --nMM_MERMPRCO_05 
                                             NULL, --nMM_MERMPLAN_EXESO_05 
                                             NULL, --nMM_MERMPLAN_05 
                                             NULL, --nMM_MERMPRCO_06 
                                             NULL, --nMM_MERMPLAN_EXESO_06 
                                             NULL, --nMM_MERMPLAN_06 
                                             NULL, --nMM_MERMPRCO_07 
                                             NULL, --nMM_MERMPLAN_EXESO_07 
                                             NULL, --nMM_MERMPLAN_07 
                                             NULL, --nMM_MERMPRCO_08 
                                             NULL, --nMM_MERMPLAN_EXESO_08 
                                             NULL, --nMM_MERMPLAN_08 
                                             NULL, --nMM_MERMPRCO_09 
                                             NULL, --nMM_MERMPLAN_EXESO_09 
                                             NULL, --nMM_MERMPLAN_09 
                                             NULL, --nMM_MERMPRCO_10 
                                             NULL, --nMM_MERMPLAN_EXESO_10 
                                             NULL, --nMM_MERMPLAN_10 
                                             NULL, --nMM_MERMPRCO 
                                             NULL, --nMM_MERMPLAN_EXESO 
                                             NULL); --nMM_MERMPLAN
											--t_MATERIAL(rMATERIAL_B1.IDENTIFICADOR).MermEnhe := NVL(t_MATERIAL(rMATERIAL_B1.IDENTIFICADOR).MermEnhe,0) + nMaquCara_M1;
--ELSE dbms_output.put_line('14 IDENTIFICADOR IS NULL ');
										END IF;
                           END IF;
                           --
                           IF nMaquCara_M2 > 0 THEN
                              IF rMATERIAL_B2.IDENTIFICADOR IS NOT NULL THEN
--dbms_output.put_line('ENHEBRADX5:'||nMaquCara_M2);
                                 P_MATERIAL(rMATERIAL_B2,'U',
														  NULL,--nCantProd
														  NULL,--nCantCons_E
														  NULL,--nCantCons
														  NULL,--nCantAjus
														  NULL,--nAncho
														  NULL,--nFACTOR_CONVERSION_M2_KG
														  NULL,--nPrecio_ML_E
														  NULL,--vLog_Precio
														  NULL,--nMermEnhe_E
														  nMaquCara_M2,--nMermEnhe
														  NULL,--nMermAjus_E
														  NULL,--nMermAjus
														  NULL,--nMermCabo_E
														  NULL,--nMermCabo
														  NULL,--nMermPico_E
														  NULL,--nMermPico
                                            NULL,--nMermTita
                                            NULL,--nMermSane
                                            NULL,--nCantCons_Bobinas
                                            --
                                          NULL, --nCONTFSMU_01 
                                          NULL, --nCANTFSMU_01 
                                          NULL, --nCATOFSMU 
                                          NULL, --nCONTFSMU_02 
                                          NULL, --nCANTFSMU_02 
                                          NULL, --nCONTFSMU_03 
                                          NULL, --nCANTFSMU_03 
                                          NULL, --nCONTFSMU_04 
                                          NULL, --nCANTFSMU_04 
                                          NULL, --nCONTFSMU_05 
                                          NULL, --nCANTFSMU_05 
                                          NULL, --nCONTFSMU_06 
                                          NULL, --nCANTFSMU_06 
                                          NULL, --nCONTFSMU_07 
                                          NULL, --nCANTFSMU_07 
                                          NULL, --nCONTFSMU_08 
                                          NULL, --nCANTFSMU_08 
                                          NULL, --nCONTFSMU_09 
                                          NULL, --nCANTFSMU_09 
                                          NULL, --nCONTFSMU_10 
                                          NULL, --nCANTFSMU_10 
                                          NULL, --nANCHO_BUENO_TOTAL_01 
                                          NULL, --nANCHO_BUENO_OT_01 
                                          NULL, --nANCHO_BUENO_TOTAL_02 
                                          NULL, --nANCHO_BUENO_OT_02 
                                          NULL, --nANCHO_BUENO_TOTAL_03 
                                          NULL, --nANCHO_BUENO_OT_03 
                                          NULL, --nANCHO_BUENO_TOTAL_04 
                                          NULL, --nANCHO_BUENO_OT_04 
                                          NULL, --nANCHO_BUENO_TOTAL_05 
                                          NULL, --nANCHO_BUENO_OT_05 
                                          NULL, --nANCHO_BUENO_TOTAL_06 
                                          NULL, --nANCHO_BUENO_OT_06 
                                          NULL, --nANCHO_BUENO_TOTAL_07 
                                          NULL, --nANCHO_BUENO_OT_07 
                                          NULL, --nANCHO_BUENO_TOTAL_08 
                                          NULL, --nANCHO_BUENO_OT_08 
                                          NULL, --nANCHO_BUENO_TOTAL_09 
                                          NULL, --nANCHO_BUENO_OT_09 
                                          NULL, --nANCHO_BUENO_TOTAL_10 
                                          NULL, --nANCHO_BUENO_OT_10 
                                          NULL, --nANCHO_BUENO_TOTAL 
                                          NULL, --nANCHO_BUENO_OT 
                                          NULL, --nNUMECORT 
                                          NULL, --nMM_MERMPRCO_01 
                                          NULL, --nMM_MERMPLAN_EXESO_01 
                                          NULL, --nMM_MERMPLAN_01 
                                          NULL, --nMM_MERMPRCO_02 
                                          NULL, --nMM_MERMPLAN_EXESO_02 
                                          NULL, --nMM_MERMPLAN_02 
                                          NULL, --nMM_MERMPRCO_03 
                                          NULL, --nMM_MERMPLAN_EXESO_03 
                                          NULL, --nMM_MERMPLAN_03 
                                          NULL, --nMM_MERMPRCO_04 
                                          NULL, --nMM_MERMPLAN_EXESO_04 
                                          NULL, --nMM_MERMPLAN_04 
                                          NULL, --nMM_MERMPRCO_05 
                                          NULL, --nMM_MERMPLAN_EXESO_05 
                                          NULL, --nMM_MERMPLAN_05 
                                          NULL, --nMM_MERMPRCO_06 
                                          NULL, --nMM_MERMPLAN_EXESO_06 
                                          NULL, --nMM_MERMPLAN_06 
                                          NULL, --nMM_MERMPRCO_07 
                                          NULL, --nMM_MERMPLAN_EXESO_07 
                                          NULL, --nMM_MERMPLAN_07 
                                          NULL, --nMM_MERMPRCO_08 
                                          NULL, --nMM_MERMPLAN_EXESO_08 
                                          NULL, --nMM_MERMPLAN_08 
                                          NULL, --nMM_MERMPRCO_09 
                                          NULL, --nMM_MERMPLAN_EXESO_09 
                                          NULL, --nMM_MERMPLAN_09 
                                          NULL, --nMM_MERMPRCO_10 
                                          NULL, --nMM_MERMPLAN_EXESO_10 
                                          NULL, --nMM_MERMPLAN_10 
                                          NULL, --nMM_MERMPRCO 
                                          NULL, --nMM_MERMPLAN_EXESO 
                                          NULL); --nMM_MERMPLAN
											--t_MATERIAL(rMATERIAL_B2.IDENTIFICADOR).MermEnhe := NVL(t_MATERIAL(rMATERIAL_B2.IDENTIFICADOR).MermEnhe,0) + nMaquCara_M2;
--ELSE dbms_output.put_line('15 IDENTIFICADOR IS NULL(2) ');
										END IF;
                           END IF;
                        END IF;
							END IF;
                  END LOOP;
						--22-10-2015 Se adiciona esto ya que si no se ajusta con lo anterior se debe hacer de forma normal
						IF bCaAuEnhe AND NOT(bEjecAjEh) THEN
							IF rMATERIAL_B1.IDENTIFICADOR IS NOT NULL THEN
--dbms_output.put_line('ENHEBRADX6:'||nMerma_Enhebrado_M1);
								P_MATERIAL(rMATERIAL_B1,'U',
											  NULL,--nCantProd
											  NULL,--nCantCons_E
											  NULL,--nCantCons
											  NULL,--nCantAjus
											  NULL,--nAncho
											  NULL,--nFACTOR_CONVERSION_M2_KG
											  NULL,--nPrecio_ML_E
											  NULL,--vLog_Precio
											  NULL,--nMermEnhe_E
											  NVL(nMerma_Enhebrado_M1,0),--nMermEnhe
											  NULL,--nMermAjus_E
											  NULL,--nMermAjus
											  NULL,--nMermCabo_E
											  NULL,--nMermCabo
											  NULL,--nMermPico_E
											  NULL,--nMermPico
                                   NULL,--nMermTita
                                   NULL,--nMermSane
                                   NULL,--nCantCons_Bobinas
                                   --
                                    NULL, --nCONTFSMU_01 
                                    NULL, --nCANTFSMU_01 
                                    NULL, --nCATOFSMU 
                                    NULL, --nCONTFSMU_02 
                                    NULL, --nCANTFSMU_02 
                                    NULL, --nCONTFSMU_03 
                                    NULL, --nCANTFSMU_03 
                                    NULL, --nCONTFSMU_04 
                                    NULL, --nCANTFSMU_04 
                                    NULL, --nCONTFSMU_05 
                                    NULL, --nCANTFSMU_05 
                                    NULL, --nCONTFSMU_06 
                                    NULL, --nCANTFSMU_06 
                                    NULL, --nCONTFSMU_07 
                                    NULL, --nCANTFSMU_07 
                                    NULL, --nCONTFSMU_08 
                                    NULL, --nCANTFSMU_08 
                                    NULL, --nCONTFSMU_09 
                                    NULL, --nCANTFSMU_09 
                                    NULL, --nCONTFSMU_10 
                                    NULL, --nCANTFSMU_10 
                                    NULL, --nANCHO_BUENO_TOTAL_01 
                                    NULL, --nANCHO_BUENO_OT_01 
                                    NULL, --nANCHO_BUENO_TOTAL_02 
                                    NULL, --nANCHO_BUENO_OT_02 
                                    NULL, --nANCHO_BUENO_TOTAL_03 
                                    NULL, --nANCHO_BUENO_OT_03 
                                    NULL, --nANCHO_BUENO_TOTAL_04 
                                    NULL, --nANCHO_BUENO_OT_04 
                                    NULL, --nANCHO_BUENO_TOTAL_05 
                                    NULL, --nANCHO_BUENO_OT_05 
                                    NULL, --nANCHO_BUENO_TOTAL_06 
                                    NULL, --nANCHO_BUENO_OT_06 
                                    NULL, --nANCHO_BUENO_TOTAL_07 
                                    NULL, --nANCHO_BUENO_OT_07 
                                    NULL, --nANCHO_BUENO_TOTAL_08 
                                    NULL, --nANCHO_BUENO_OT_08 
                                    NULL, --nANCHO_BUENO_TOTAL_09 
                                    NULL, --nANCHO_BUENO_OT_09 
                                    NULL, --nANCHO_BUENO_TOTAL_10 
                                    NULL, --nANCHO_BUENO_OT_10 
                                    NULL, --nANCHO_BUENO_TOTAL 
                                    NULL, --nANCHO_BUENO_OT 
                                    NULL, --nNUMECORT 
                                    NULL, --nMM_MERMPRCO_01 
                                    NULL, --nMM_MERMPLAN_EXESO_01 
                                    NULL, --nMM_MERMPLAN_01 
                                    NULL, --nMM_MERMPRCO_02 
                                    NULL, --nMM_MERMPLAN_EXESO_02 
                                    NULL, --nMM_MERMPLAN_02 
                                    NULL, --nMM_MERMPRCO_03 
                                    NULL, --nMM_MERMPLAN_EXESO_03 
                                    NULL, --nMM_MERMPLAN_03 
                                    NULL, --nMM_MERMPRCO_04 
                                    NULL, --nMM_MERMPLAN_EXESO_04 
                                    NULL, --nMM_MERMPLAN_04 
                                    NULL, --nMM_MERMPRCO_05 
                                    NULL, --nMM_MERMPLAN_EXESO_05 
                                    NULL, --nMM_MERMPLAN_05 
                                    NULL, --nMM_MERMPRCO_06 
                                    NULL, --nMM_MERMPLAN_EXESO_06 
                                    NULL, --nMM_MERMPLAN_06 
                                    NULL, --nMM_MERMPRCO_07 
                                    NULL, --nMM_MERMPLAN_EXESO_07 
                                    NULL, --nMM_MERMPLAN_07 
                                    NULL, --nMM_MERMPRCO_08 
                                    NULL, --nMM_MERMPLAN_EXESO_08 
                                    NULL, --nMM_MERMPLAN_08 
                                    NULL, --nMM_MERMPRCO_09 
                                    NULL, --nMM_MERMPLAN_EXESO_09 
                                    NULL, --nMM_MERMPLAN_09 
                                    NULL, --nMM_MERMPRCO_10 
                                    NULL, --nMM_MERMPLAN_EXESO_10 
                                    NULL, --nMM_MERMPLAN_10 
                                    NULL, --nMM_MERMPRCO 
                                    NULL, --nMM_MERMPLAN_EXESO 
                                    NULL); --nMM_MERMPLAN
								--t_MATERIAL(rMATERIAL_B1.IDENTIFICADOR).MermEnhe := NVL(t_MATERIAL(rMATERIAL_B1.IDENTIFICADOR).MermEnhe,0) + nMaquCara_M1;
--ELSE dbms_output.put_line('16 IDENTIFICADOR IS NULL ');
							END IF;
							--
							IF rMATERIAL_B2.IDENTIFICADOR IS NOT NULL THEN
--dbms_output.put_line('ENHEBRADX7:'||nMerma_Enhebrado_M2);
								P_MATERIAL(rMATERIAL_B2,'U',
											  NULL,--nCantProd
											  NULL,--nCantCons_E
											  NULL,--nCantCons
											  NULL,--nCantAjus
											  NULL,--nAncho
											  NULL,--nFACTOR_CONVERSION_M2_KG
											  NULL,--nPrecio_ML_E
											  NULL,--vLog_Precio
											  NULL,--nMermEnhe_E
											  NVL(nMerma_Enhebrado_M2,0),--nMermEnhe
											  NULL,--nMermAjus_E
											  NULL,--nMermAjus
											  NULL,--nMermCabo_E
											  NULL,--nMermCabo
											  NULL,--nMermPico_E
											  NULL,--nMermPico
                                   NULL,--nMermTita
                                   NULL,--nMermSane
                                   NULL,--nCantCons_Bobinas
                                   --
                                    NULL, --nCONTFSMU_01 
                                    NULL, --nCANTFSMU_01 
                                    NULL, --nCATOFSMU 
                                    NULL, --nCONTFSMU_02 
                                    NULL, --nCANTFSMU_02 
                                    NULL, --nCONTFSMU_03 
                                    NULL, --nCANTFSMU_03 
                                    NULL, --nCONTFSMU_04 
                                    NULL, --nCANTFSMU_04 
                                    NULL, --nCONTFSMU_05 
                                    NULL, --nCANTFSMU_05 
                                    NULL, --nCONTFSMU_06 
                                    NULL, --nCANTFSMU_06 
                                    NULL, --nCONTFSMU_07 
                                    NULL, --nCANTFSMU_07 
                                    NULL, --nCONTFSMU_08 
                                    NULL, --nCANTFSMU_08 
                                    NULL, --nCONTFSMU_09 
                                    NULL, --nCANTFSMU_09 
                                    NULL, --nCONTFSMU_10 
                                    NULL, --nCANTFSMU_10 
                                    NULL, --nANCHO_BUENO_TOTAL_01 
                                    NULL, --nANCHO_BUENO_OT_01 
                                    NULL, --nANCHO_BUENO_TOTAL_02 
                                    NULL, --nANCHO_BUENO_OT_02 
                                    NULL, --nANCHO_BUENO_TOTAL_03 
                                    NULL, --nANCHO_BUENO_OT_03 
                                    NULL, --nANCHO_BUENO_TOTAL_04 
                                    NULL, --nANCHO_BUENO_OT_04 
                                    NULL, --nANCHO_BUENO_TOTAL_05 
                                    NULL, --nANCHO_BUENO_OT_05 
                                    NULL, --nANCHO_BUENO_TOTAL_06 
                                    NULL, --nANCHO_BUENO_OT_06 
                                    NULL, --nANCHO_BUENO_TOTAL_07 
                                    NULL, --nANCHO_BUENO_OT_07 
                                    NULL, --nANCHO_BUENO_TOTAL_08 
                                    NULL, --nANCHO_BUENO_OT_08 
                                    NULL, --nANCHO_BUENO_TOTAL_09 
                                    NULL, --nANCHO_BUENO_OT_09 
                                    NULL, --nANCHO_BUENO_TOTAL_10 
                                    NULL, --nANCHO_BUENO_OT_10 
                                    NULL, --nANCHO_BUENO_TOTAL 
                                    NULL, --nANCHO_BUENO_OT 
                                    NULL, --nNUMECORT 
                                    NULL, --nMM_MERMPRCO_01 
                                    NULL, --nMM_MERMPLAN_EXESO_01 
                                    NULL, --nMM_MERMPLAN_01 
                                    NULL, --nMM_MERMPRCO_02 
                                    NULL, --nMM_MERMPLAN_EXESO_02 
                                    NULL, --nMM_MERMPLAN_02 
                                    NULL, --nMM_MERMPRCO_03 
                                    NULL, --nMM_MERMPLAN_EXESO_03 
                                    NULL, --nMM_MERMPLAN_03 
                                    NULL, --nMM_MERMPRCO_04 
                                    NULL, --nMM_MERMPLAN_EXESO_04 
                                    NULL, --nMM_MERMPLAN_04 
                                    NULL, --nMM_MERMPRCO_05 
                                    NULL, --nMM_MERMPLAN_EXESO_05 
                                    NULL, --nMM_MERMPLAN_05 
                                    NULL, --nMM_MERMPRCO_06 
                                    NULL, --nMM_MERMPLAN_EXESO_06 
                                    NULL, --nMM_MERMPLAN_06 
                                    NULL, --nMM_MERMPRCO_07 
                                    NULL, --nMM_MERMPLAN_EXESO_07 
                                    NULL, --nMM_MERMPLAN_07 
                                    NULL, --nMM_MERMPRCO_08 
                                    NULL, --nMM_MERMPLAN_EXESO_08 
                                    NULL, --nMM_MERMPLAN_08 
                                    NULL, --nMM_MERMPRCO_09 
                                    NULL, --nMM_MERMPLAN_EXESO_09 
                                    NULL, --nMM_MERMPLAN_09 
                                    NULL, --nMM_MERMPRCO_10 
                                    NULL, --nMM_MERMPLAN_EXESO_10 
                                    NULL, --nMM_MERMPLAN_10 
                                    NULL, --nMM_MERMPRCO 
                                    NULL, --nMM_MERMPLAN_EXESO 
                                    NULL); --nMM_MERMPLAN
								--t_MATERIAL(rMATERIAL_B2.IDENTIFICADOR).MermEnhe := NVL(t_MATERIAL(rMATERIAL_B2.IDENTIFICADOR).MermEnhe,0) + nMaquCara_M2;
--ELSE dbms_output.put_line('17 IDENTIFICADOR IS NULL(2) ');
							END IF;
						END IF;
						--
               END IF;
            END LOOP;
            --CAMBIO DE BOBINA
            --Se busca el Coeficiente Corrector de Cambio de Bobina
            rCaracteristica_Maquina_CoefCo.Caracteristica := NULL;
            --
            OPEN cCaracteristica_Maquina('COEFCORR',rMaquinas.MaquCodi,SUBSTR(vMatBase,1,2),NULL);
            FETCH cCaracteristica_Maquina INTO rCaracteristica_Maquina_CoefCo;
            CLOSE cCaracteristica_Maquina;
            --
            IF rCaracteristica_Maquina_CoefCo.Caracteristica IS NOT NULL THEN
               nCoefCorr := NULL;
               --
               OPEN cPRD_MAQUCARA(rMaquinas.MaquTipo,rMaquinas.MaquCodi,rCaracteristica_Maquina_CoefCo.Caracteristica);
               FETCH cPRD_MAQUCARA INTO nCoefCorr;
               CLOSE cPRD_MAQUCARA;
            END IF;
            --
            IF nCoefCorr IS NULL THEN
               nCoefCorr := 1;
            END IF;
				--
				nMerma_CambBobi_M1_E := 0;
				nMerma_CambBobi_M2_E := 0;
            --Se busca si la Maquina tiene valor de Ajuste Automatico o Real
            FOR rCaracteristica_Maquina IN cCaracteristica_Maquina('CAMBBOBI',rMaquinas.MaquCodi,vLinea,nNumePasa) LOOP --Pueden ser varios Eventos, tambien podria aplicar a varias Caracteristicas
               --Si se encuentra caracteristica es una Merma Automatica (Captación Estandar)
               IF rCaracteristica_Maquina.Caracteristica IS NOT NULL AND rCaracteristica_Maquina.EvenCodi IS NOT NULL THEN
                  --Parte ESTANDAR
                  --Se realizan las busquedas de Mermas en las Maquinas Utilizadas en las Pasadas
                  FOR rMaquinas_Utilizadas_Eventos IN cMaquinas_Utilizadas_Eventos(rCaracteristica_Maquina.EvenCodi,rMaquinas.Contador) LOOP
                     nMaquCara_M1 := NULL;
                     nMaquCara_M2 := NULL;
                     --
                     OPEN cPRD_MAQUCARA(rMaquinas.MaquTipo,rMaquinas_Utilizadas_Eventos.MaquCodi,rCaracteristica_Maquina.Caracteristica);
                     FETCH cPRD_MAQUCARA INTO nMaquCara_M1;
                     CLOSE cPRD_MAQUCARA;
                     --Se verifica si existe la Caracteristica 2 En caso de Laminadoras Material 2
                     IF rCaracteristica_Maquina.Caracteristica2 IS NOT NULL THEN
                        OPEN cPRD_MAQUCARA(rMaquinas.MaquTipo,rMaquinas_Utilizadas_Eventos.MaquCodi,rCaracteristica_Maquina.Caracteristica2);
                        FETCH cPRD_MAQUCARA INTO nMaquCara_M2;
                        CLOSE cPRD_MAQUCARA;
                     END IF;
                     --Contador de Eventos
                     nContEven := NULL;
                     --
                     OPEN cCuenta_Eventos(rMaquinas.MaquTipo,rMaquinas_Utilizadas_Eventos.MaquCodi, rCaracteristica_Maquina.EvenCodi, rMaquinas.Contador);
                     FETCH cCuenta_Eventos INTO nContEven;
                     CLOSE cCuenta_Eventos;
                     --
--dbms_output.put_line('nMerma_CambBobi_M1_E := '||NVL(nMerma_CambBobi_M1_E,0)||' + (('||NVL(nMaquCara_M1,0)||' * '||NVL(nContEven,0)||') * '||nCoefCorr||')');
                     nMerma_CambBobi_M1_E := NVL(nMerma_CambBobi_M1_E,0) + ((NVL(nMaquCara_M1,0) * NVL(nContEven,0)) * nCoefCorr);
                     nMerma_CambBobi_M2_E := NVL(nMerma_CambBobi_M2_E,0) + ((NVL(nMaquCara_M2,0) * NVL(nContEven,0)) * nCoefCorr);
                  END LOOP;
                  --
                  IF rMATERIAL_B1.IDENTIFICADOR IS NOT NULL THEN
                     P_MATERIAL(rMATERIAL_B1,'U',
										  NULL,--nCantProd
										  NULL,--nCantCons_E
										  NULL,--nCantCons
										  NULL,--nCantAjus
										  NULL,--nAncho
										  NULL,--nFACTOR_CONVERSION_M2_KG
										  NULL,--nPrecio_ML_E
										  NULL,--vLog_Precio
										  NULL,--nMermEnhe_E
										  NULL,--nMermEnhe
										  NULL,--nMermAjus_E
										  NULL,--nMermAjus
										  nMerma_CambBobi_M1_E,--nMermCabo_E
										  NULL,--nMermCabo
										  NULL,--nMermPico_E
										  NULL,--nMermPico
                                NULL,--nMermTita
                                NULL,--nMermSane
                                NULL,--nCantCons_Bobinas
                                --
                                 NULL, --nCONTFSMU_01 
                                 NULL, --nCANTFSMU_01 
                                 NULL, --nCATOFSMU 
                                 NULL, --nCONTFSMU_02 
                                 NULL, --nCANTFSMU_02 
                                 NULL, --nCONTFSMU_03 
                                 NULL, --nCANTFSMU_03 
                                 NULL, --nCONTFSMU_04 
                                 NULL, --nCANTFSMU_04 
                                 NULL, --nCONTFSMU_05 
                                 NULL, --nCANTFSMU_05 
                                 NULL, --nCONTFSMU_06 
                                 NULL, --nCANTFSMU_06 
                                 NULL, --nCONTFSMU_07 
                                 NULL, --nCANTFSMU_07 
                                 NULL, --nCONTFSMU_08 
                                 NULL, --nCANTFSMU_08 
                                 NULL, --nCONTFSMU_09 
                                 NULL, --nCANTFSMU_09 
                                 NULL, --nCONTFSMU_10 
                                 NULL, --nCANTFSMU_10 
                                 NULL, --nANCHO_BUENO_TOTAL_01 
                                 NULL, --nANCHO_BUENO_OT_01 
                                 NULL, --nANCHO_BUENO_TOTAL_02 
                                 NULL, --nANCHO_BUENO_OT_02 
                                 NULL, --nANCHO_BUENO_TOTAL_03 
                                 NULL, --nANCHO_BUENO_OT_03 
                                 NULL, --nANCHO_BUENO_TOTAL_04 
                                 NULL, --nANCHO_BUENO_OT_04 
                                 NULL, --nANCHO_BUENO_TOTAL_05 
                                 NULL, --nANCHO_BUENO_OT_05 
                                 NULL, --nANCHO_BUENO_TOTAL_06 
                                 NULL, --nANCHO_BUENO_OT_06 
                                 NULL, --nANCHO_BUENO_TOTAL_07 
                                 NULL, --nANCHO_BUENO_OT_07 
                                 NULL, --nANCHO_BUENO_TOTAL_08 
                                 NULL, --nANCHO_BUENO_OT_08 
                                 NULL, --nANCHO_BUENO_TOTAL_09 
                                 NULL, --nANCHO_BUENO_OT_09 
                                 NULL, --nANCHO_BUENO_TOTAL_10 
                                 NULL, --nANCHO_BUENO_OT_10 
                                 NULL, --nANCHO_BUENO_TOTAL 
                                 NULL, --nANCHO_BUENO_OT 
                                 NULL, --nNUMECORT 
                                 NULL, --nMM_MERMPRCO_01 
                                 NULL, --nMM_MERMPLAN_EXESO_01 
                                 NULL, --nMM_MERMPLAN_01 
                                 NULL, --nMM_MERMPRCO_02 
                                 NULL, --nMM_MERMPLAN_EXESO_02 
                                 NULL, --nMM_MERMPLAN_02 
                                 NULL, --nMM_MERMPRCO_03 
                                 NULL, --nMM_MERMPLAN_EXESO_03 
                                 NULL, --nMM_MERMPLAN_03 
                                 NULL, --nMM_MERMPRCO_04 
                                 NULL, --nMM_MERMPLAN_EXESO_04 
                                 NULL, --nMM_MERMPLAN_04 
                                 NULL, --nMM_MERMPRCO_05 
                                 NULL, --nMM_MERMPLAN_EXESO_05 
                                 NULL, --nMM_MERMPLAN_05 
                                 NULL, --nMM_MERMPRCO_06 
                                 NULL, --nMM_MERMPLAN_EXESO_06 
                                 NULL, --nMM_MERMPLAN_06 
                                 NULL, --nMM_MERMPRCO_07 
                                 NULL, --nMM_MERMPLAN_EXESO_07 
                                 NULL, --nMM_MERMPLAN_07 
                                 NULL, --nMM_MERMPRCO_08 
                                 NULL, --nMM_MERMPLAN_EXESO_08 
                                 NULL, --nMM_MERMPLAN_08 
                                 NULL, --nMM_MERMPRCO_09 
                                 NULL, --nMM_MERMPLAN_EXESO_09 
                                 NULL, --nMM_MERMPLAN_09 
                                 NULL, --nMM_MERMPRCO_10 
                                 NULL, --nMM_MERMPLAN_EXESO_10 
                                 NULL, --nMM_MERMPLAN_10 
                                 NULL, --nMM_MERMPRCO 
                                 NULL, --nMM_MERMPLAN_EXESO 
                                 NULL); --nMM_MERMPLAN
							--t_MATERIAL(rMATERIAL_B1.IDENTIFICADOR).MermCabo_E := NVL(t_MATERIAL(rMATERIAL_B1.IDENTIFICADOR).MermCabo_E,0) + nMerma_CambBobi_M1_E;
--ELSE dbms_output.put_line('16 IDENTIFICADOR IS NULL ');
                  END IF;
                  --
                  IF rMATERIAL_B2.IDENTIFICADOR IS NOT NULL THEN
                     P_MATERIAL(rMATERIAL_B2,'U',
										  NULL,--nCantProd
										  NULL,--nCantCons_E
										  NULL,--nCantCons
										  NULL,--nCantAjus
										  NULL,--nAncho
										  NULL,--nFACTOR_CONVERSION_M2_KG
										  NULL,--nPrecio_ML_E
										  NULL,--vLog_Precio
										  NULL,--nMermEnhe_E
										  NULL,--nMermEnhe
										  NULL,--nMermAjus_E
										  NULL,--nMermAjus
										  nMerma_CambBobi_M2_E,--nMermCabo_E
										  NULL,--nMermCabo
										  NULL,--nMermPico_E
										  NULL,--nMermPico
                                NULL,--nMermTita
                                NULL,--nMermSane
                                NULL,--nCantCons_Bobinas
                                --
                              NULL, --nCONTFSMU_01 
                              NULL, --nCANTFSMU_01 
                              NULL, --nCATOFSMU 
                              NULL, --nCONTFSMU_02 
                              NULL, --nCANTFSMU_02 
                              NULL, --nCONTFSMU_03 
                              NULL, --nCANTFSMU_03 
                              NULL, --nCONTFSMU_04 
                              NULL, --nCANTFSMU_04 
                              NULL, --nCONTFSMU_05 
                              NULL, --nCANTFSMU_05 
                              NULL, --nCONTFSMU_06 
                              NULL, --nCANTFSMU_06 
                              NULL, --nCONTFSMU_07 
                              NULL, --nCANTFSMU_07 
                              NULL, --nCONTFSMU_08 
                              NULL, --nCANTFSMU_08 
                              NULL, --nCONTFSMU_09 
                              NULL, --nCANTFSMU_09 
                              NULL, --nCONTFSMU_10 
                              NULL, --nCANTFSMU_10 
                              NULL, --nANCHO_BUENO_TOTAL_01 
                              NULL, --nANCHO_BUENO_OT_01 
                              NULL, --nANCHO_BUENO_TOTAL_02 
                              NULL, --nANCHO_BUENO_OT_02 
                              NULL, --nANCHO_BUENO_TOTAL_03 
                              NULL, --nANCHO_BUENO_OT_03 
                              NULL, --nANCHO_BUENO_TOTAL_04 
                              NULL, --nANCHO_BUENO_OT_04 
                              NULL, --nANCHO_BUENO_TOTAL_05 
                              NULL, --nANCHO_BUENO_OT_05 
                              NULL, --nANCHO_BUENO_TOTAL_06 
                              NULL, --nANCHO_BUENO_OT_06 
                              NULL, --nANCHO_BUENO_TOTAL_07 
                              NULL, --nANCHO_BUENO_OT_07 
                              NULL, --nANCHO_BUENO_TOTAL_08 
                              NULL, --nANCHO_BUENO_OT_08 
                              NULL, --nANCHO_BUENO_TOTAL_09 
                              NULL, --nANCHO_BUENO_OT_09 
                              NULL, --nANCHO_BUENO_TOTAL_10 
                              NULL, --nANCHO_BUENO_OT_10 
                              NULL, --nANCHO_BUENO_TOTAL 
                              NULL, --nANCHO_BUENO_OT 
                              NULL, --nNUMECORT 
                              NULL, --nMM_MERMPRCO_01 
                              NULL, --nMM_MERMPLAN_EXESO_01 
                              NULL, --nMM_MERMPLAN_01 
                              NULL, --nMM_MERMPRCO_02 
                              NULL, --nMM_MERMPLAN_EXESO_02 
                              NULL, --nMM_MERMPLAN_02 
                              NULL, --nMM_MERMPRCO_03 
                              NULL, --nMM_MERMPLAN_EXESO_03 
                              NULL, --nMM_MERMPLAN_03 
                              NULL, --nMM_MERMPRCO_04 
                              NULL, --nMM_MERMPLAN_EXESO_04 
                              NULL, --nMM_MERMPLAN_04 
                              NULL, --nMM_MERMPRCO_05 
                              NULL, --nMM_MERMPLAN_EXESO_05 
                              NULL, --nMM_MERMPLAN_05 
                              NULL, --nMM_MERMPRCO_06 
                              NULL, --nMM_MERMPLAN_EXESO_06 
                              NULL, --nMM_MERMPLAN_06 
                              NULL, --nMM_MERMPRCO_07 
                              NULL, --nMM_MERMPLAN_EXESO_07 
                              NULL, --nMM_MERMPLAN_07 
                              NULL, --nMM_MERMPRCO_08 
                              NULL, --nMM_MERMPLAN_EXESO_08 
                              NULL, --nMM_MERMPLAN_08 
                              NULL, --nMM_MERMPRCO_09 
                              NULL, --nMM_MERMPLAN_EXESO_09 
                              NULL, --nMM_MERMPLAN_09 
                              NULL, --nMM_MERMPRCO_10 
                              NULL, --nMM_MERMPLAN_EXESO_10 
                              NULL, --nMM_MERMPLAN_10 
                              NULL, --nMM_MERMPRCO 
                              NULL, --nMM_MERMPLAN_EXESO 
                              NULL); --nMM_MERMPLAN
							--t_MATERIAL(rMATERIAL_B2.IDENTIFICADOR).MermCabo_E := NVL(t_MATERIAL(rMATERIAL_B2.IDENTIFICADOR).MermCabo_E,0) + nMerma_CambBobi_M2_E;
--ELSE dbms_output.put_line('17 IDENTIFICADOR IS NULL(2) ');
                  END IF;
                  --Fin Parte ESTANDAR
               END IF;
               --
               IF rCaracteristica_Maquina.Caracteristica IS NOT NULL AND rCaracteristica_Maquina.EvenCodi IS NOT NULL AND rCaracteristica_Maquina.Captacion = 'ESTANDAR' THEN
                  nMerma_CambBobi_M1 := NVL(nMerma_CambBobi_M1_E,0);
                  nMerma_CambBobi_M2 := NVL(nMerma_CambBobi_M2_E,0);
                  --
                  IF rMATERIAL_B1.IDENTIFICADOR IS NOT NULL THEN
                     P_MATERIAL(rMATERIAL_B1,'U',
										  NULL,--nCantProd
										  NULL,--nCantCons_E
										  NULL,--nCantCons
										  NULL,--nCantAjus
										  NULL,--nAncho
										  NULL,--nFACTOR_CONVERSION_M2_KG
										  NULL,--nPrecio_ML_E
										  NULL,--vLog_Precio
										  NULL,--nMermEnhe_E
										  NULL,--nMermEnhe
										  NULL,--nMermAjus_E
										  NULL,--nMermAjus
										  NULL,--nMermCabo_E
										  nMerma_CambBobi_M1,--nMermCabo
										  NULL,--nMermPico_E
										  NULL,--nMermPico
                                NULL,--nMermTita
                                NULL,--nMermSane
                                NULL,--nCantCons_Bobinas
                                --
                                 NULL, --nCONTFSMU_01 
                                 NULL, --nCANTFSMU_01 
                                 NULL, --nCATOFSMU 
                                 NULL, --nCONTFSMU_02 
                                 NULL, --nCANTFSMU_02 
                                 NULL, --nCONTFSMU_03 
                                 NULL, --nCANTFSMU_03 
                                 NULL, --nCONTFSMU_04 
                                 NULL, --nCANTFSMU_04 
                                 NULL, --nCONTFSMU_05 
                                 NULL, --nCANTFSMU_05 
                                 NULL, --nCONTFSMU_06 
                                 NULL, --nCANTFSMU_06 
                                 NULL, --nCONTFSMU_07 
                                 NULL, --nCANTFSMU_07 
                                 NULL, --nCONTFSMU_08 
                                 NULL, --nCANTFSMU_08 
                                 NULL, --nCONTFSMU_09 
                                 NULL, --nCANTFSMU_09 
                                 NULL, --nCONTFSMU_10 
                                 NULL, --nCANTFSMU_10 
                                 NULL, --nANCHO_BUENO_TOTAL_01 
                                 NULL, --nANCHO_BUENO_OT_01 
                                 NULL, --nANCHO_BUENO_TOTAL_02 
                                 NULL, --nANCHO_BUENO_OT_02 
                                 NULL, --nANCHO_BUENO_TOTAL_03 
                                 NULL, --nANCHO_BUENO_OT_03 
                                 NULL, --nANCHO_BUENO_TOTAL_04 
                                 NULL, --nANCHO_BUENO_OT_04 
                                 NULL, --nANCHO_BUENO_TOTAL_05 
                                 NULL, --nANCHO_BUENO_OT_05 
                                 NULL, --nANCHO_BUENO_TOTAL_06 
                                 NULL, --nANCHO_BUENO_OT_06 
                                 NULL, --nANCHO_BUENO_TOTAL_07 
                                 NULL, --nANCHO_BUENO_OT_07 
                                 NULL, --nANCHO_BUENO_TOTAL_08 
                                 NULL, --nANCHO_BUENO_OT_08 
                                 NULL, --nANCHO_BUENO_TOTAL_09 
                                 NULL, --nANCHO_BUENO_OT_09 
                                 NULL, --nANCHO_BUENO_TOTAL_10 
                                 NULL, --nANCHO_BUENO_OT_10 
                                 NULL, --nANCHO_BUENO_TOTAL 
                                 NULL, --nANCHO_BUENO_OT 
                                 NULL, --nNUMECORT 
                                 NULL, --nMM_MERMPRCO_01 
                                 NULL, --nMM_MERMPLAN_EXESO_01 
                                 NULL, --nMM_MERMPLAN_01 
                                 NULL, --nMM_MERMPRCO_02 
                                 NULL, --nMM_MERMPLAN_EXESO_02 
                                 NULL, --nMM_MERMPLAN_02 
                                 NULL, --nMM_MERMPRCO_03 
                                 NULL, --nMM_MERMPLAN_EXESO_03 
                                 NULL, --nMM_MERMPLAN_03 
                                 NULL, --nMM_MERMPRCO_04 
                                 NULL, --nMM_MERMPLAN_EXESO_04 
                                 NULL, --nMM_MERMPLAN_04 
                                 NULL, --nMM_MERMPRCO_05 
                                 NULL, --nMM_MERMPLAN_EXESO_05 
                                 NULL, --nMM_MERMPLAN_05 
                                 NULL, --nMM_MERMPRCO_06 
                                 NULL, --nMM_MERMPLAN_EXESO_06 
                                 NULL, --nMM_MERMPLAN_06 
                                 NULL, --nMM_MERMPRCO_07 
                                 NULL, --nMM_MERMPLAN_EXESO_07 
                                 NULL, --nMM_MERMPLAN_07 
                                 NULL, --nMM_MERMPRCO_08 
                                 NULL, --nMM_MERMPLAN_EXESO_08 
                                 NULL, --nMM_MERMPLAN_08 
                                 NULL, --nMM_MERMPRCO_09 
                                 NULL, --nMM_MERMPLAN_EXESO_09 
                                 NULL, --nMM_MERMPLAN_09 
                                 NULL, --nMM_MERMPRCO_10 
                                 NULL, --nMM_MERMPLAN_EXESO_10 
                                 NULL, --nMM_MERMPLAN_10 
                                 NULL, --nMM_MERMPRCO 
                                 NULL, --nMM_MERMPLAN_EXESO 
                                 NULL); --nMM_MERMPLAN
							--t_MATERIAL(rMATERIAL_B1.IDENTIFICADOR).MermCabo := NVL(t_MATERIAL(rMATERIAL_B1.IDENTIFICADOR).MermCabo,0) + nMerma_CambBobi_M1;
--ELSE dbms_output.put_line('18 IDENTIFICADOR IS NULL ');
                  END IF;
                  --
                  IF rMATERIAL_B2.IDENTIFICADOR IS NOT NULL THEN
                     P_MATERIAL(rMATERIAL_B2,'U',
										  NULL,--nCantProd
										  NULL,--nCantCons_E
										  NULL,--nCantCons
										  NULL,--nCantAjus
										  NULL,--nAncho
										  NULL,--nFACTOR_CONVERSION_M2_KG
										  NULL,--nPrecio_ML_E
										  NULL,--vLog_Precio
										  NULL,--nMermEnhe_E
										  NULL,--nMermEnhe
										  NULL,--nMermAjus_E
										  NULL,--nMermAjus
										  NULL,--nMermCabo_E
										  nMerma_CambBobi_M2,--nMermCabo
										  NULL,--nMermPico_E
										  NULL,--nMermPico
                                NULL,--nMermTita
                                NULL,--nMermSane
                                NULL,--nCantCons_Bobinas
                                --
                                 NULL, --nCONTFSMU_01 
                                 NULL, --nCANTFSMU_01 
                                 NULL, --nCATOFSMU 
                                 NULL, --nCONTFSMU_02 
                                 NULL, --nCANTFSMU_02 
                                 NULL, --nCONTFSMU_03 
                                 NULL, --nCANTFSMU_03 
                                 NULL, --nCONTFSMU_04 
                                 NULL, --nCANTFSMU_04 
                                 NULL, --nCONTFSMU_05 
                                 NULL, --nCANTFSMU_05 
                                 NULL, --nCONTFSMU_06 
                                 NULL, --nCANTFSMU_06 
                                 NULL, --nCONTFSMU_07 
                                 NULL, --nCANTFSMU_07 
                                 NULL, --nCONTFSMU_08 
                                 NULL, --nCANTFSMU_08 
                                 NULL, --nCONTFSMU_09 
                                 NULL, --nCANTFSMU_09 
                                 NULL, --nCONTFSMU_10 
                                 NULL, --nCANTFSMU_10 
                                 NULL, --nANCHO_BUENO_TOTAL_01 
                                 NULL, --nANCHO_BUENO_OT_01 
                                 NULL, --nANCHO_BUENO_TOTAL_02 
                                 NULL, --nANCHO_BUENO_OT_02 
                                 NULL, --nANCHO_BUENO_TOTAL_03 
                                 NULL, --nANCHO_BUENO_OT_03 
                                 NULL, --nANCHO_BUENO_TOTAL_04 
                                 NULL, --nANCHO_BUENO_OT_04 
                                 NULL, --nANCHO_BUENO_TOTAL_05 
                                 NULL, --nANCHO_BUENO_OT_05 
                                 NULL, --nANCHO_BUENO_TOTAL_06 
                                 NULL, --nANCHO_BUENO_OT_06 
                                 NULL, --nANCHO_BUENO_TOTAL_07 
                                 NULL, --nANCHO_BUENO_OT_07 
                                 NULL, --nANCHO_BUENO_TOTAL_08 
                                 NULL, --nANCHO_BUENO_OT_08 
                                 NULL, --nANCHO_BUENO_TOTAL_09 
                                 NULL, --nANCHO_BUENO_OT_09 
                                 NULL, --nANCHO_BUENO_TOTAL_10 
                                 NULL, --nANCHO_BUENO_OT_10 
                                 NULL, --nANCHO_BUENO_TOTAL 
                                 NULL, --nANCHO_BUENO_OT 
                                 NULL, --nNUMECORT 
                                 NULL, --nMM_MERMPRCO_01 
                                 NULL, --nMM_MERMPLAN_EXESO_01 
                                 NULL, --nMM_MERMPLAN_01 
                                 NULL, --nMM_MERMPRCO_02 
                                 NULL, --nMM_MERMPLAN_EXESO_02 
                                 NULL, --nMM_MERMPLAN_02 
                                 NULL, --nMM_MERMPRCO_03 
                                 NULL, --nMM_MERMPLAN_EXESO_03 
                                 NULL, --nMM_MERMPLAN_03 
                                 NULL, --nMM_MERMPRCO_04 
                                 NULL, --nMM_MERMPLAN_EXESO_04 
                                 NULL, --nMM_MERMPLAN_04 
                                 NULL, --nMM_MERMPRCO_05 
                                 NULL, --nMM_MERMPLAN_EXESO_05 
                                 NULL, --nMM_MERMPLAN_05 
                                 NULL, --nMM_MERMPRCO_06 
                                 NULL, --nMM_MERMPLAN_EXESO_06 
                                 NULL, --nMM_MERMPLAN_06 
                                 NULL, --nMM_MERMPRCO_07 
                                 NULL, --nMM_MERMPLAN_EXESO_07 
                                 NULL, --nMM_MERMPLAN_07 
                                 NULL, --nMM_MERMPRCO_08 
                                 NULL, --nMM_MERMPLAN_EXESO_08 
                                 NULL, --nMM_MERMPLAN_08 
                                 NULL, --nMM_MERMPRCO_09 
                                 NULL, --nMM_MERMPLAN_EXESO_09 
                                 NULL, --nMM_MERMPLAN_09 
                                 NULL, --nMM_MERMPRCO_10 
                                 NULL, --nMM_MERMPLAN_EXESO_10 
                                 NULL, --nMM_MERMPLAN_10 
                                 NULL, --nMM_MERMPRCO 
                                 NULL, --nMM_MERMPLAN_EXESO 
                                 NULL); --nMM_MERMPLAN
							--t_MATERIAL(rMATERIAL_B2.IDENTIFICADOR).MermCabo := NVL(t_MATERIAL(rMATERIAL_B2.IDENTIFICADOR).MermCabo,0) + nMerma_CambBobi_M2;
--ELSE dbms_output.put_line('19 IDENTIFICADOR IS NULL(2) ');
                  END IF;
               --Si encuentra un Evento es una Merma asociada a un Evento (Captación Real)
               ELSIF rCaracteristica_Maquina.EvenCodi IS NOT NULL THEN
                 --Se realizan las busquedas de Mermas en las Maquinas Utilizadas en las Pasadas
                  FOR rMaquinas_Utilizadas_Eventos IN cMaquinas_Utilizadas_Eventos(rCaracteristica_Maquina.EvenCodi,rMaquinas.Contador) LOOP
                     rPRD_MAQUEVEN.Valor := NULL;
                     rPRD_MAQUEVEN.OrvaReal := NULL;
                     --
                     OPEN cPRD_MAQUEVEN(rMaquinas.MaquTipo,rMaquinas_Utilizadas_Eventos.MaquCodi, rCaracteristica_Maquina.EvenCodi);
                     FETCH cPRD_MAQUEVEN INTO rPRD_MAQUEVEN;
                     CLOSE cPRD_MAQUEVEN;
                     --
                     IF rPRD_MAQUEVEN.VALOR = 'PRD_MEEVFA' THEN
                        FOR rMERMA IN cMERMA(rMaquinas.Contador, rMaquinas.MaquTipo, rMaquinas_Utilizadas_Eventos.MaquCodi, rCaracteristica_Maquina.EvenCodi, rPRD_MAQUEVEN.ORVAREAL) LOOP
                           nMerma_CambBobi_M1 := NVL(nMerma_CambBobi_M1,0) + (NVL(rMERMA.Merma_M1,0) * nCoefCorr);
                           nMerma_CambBobi_M2 := NVL(nMerma_CambBobi_M2,0) + (NVL(rMERMA.Merma_M2,0) * nCoefCorr);
                           --
                           rMaterial_B1R.IDENTIFICADOR := NULL;
                           rMaterial_B2R.IDENTIFICADOR := NULL;
                           --
                           IF NVL(rMERMA.CoboBobi,0) > 0 THEN --Se trata de una Bobina Generada
                              rMaterial_B1R := F_MATERIAL(vEmpresa, nNumeOtre, rMaquinas.Contador, 
                                                          rMERMA.Tip_Arti, rMERMA.Cod_Arti, '|EMPRBOBI:'||rMERMA.EmprBobi||'|NUOTBOBI:'||rMERMA.NuotBobi||'|CONTBOBI:'||rMERMA.ContBobi||'|COBOBOBI:'||rMERMA.CoboBobi||'|LOTE:'||rMERMA.Lote,
                                                          1, NULL);
                           ELSE --Es un material de Almacen
                              rMaterial_B1R := F_MATERIAL(vEmpresa, nNumeOtre, rMaquinas.Contador, 
                                                          rMERMA.Tip_Arti, rMERMA.Cod_Arti, '|EMPRBOBI:'||NVL(rMERMA.EmprBobi,vEmpresa)||'|NUOTBOBI:'||NVL(rMERMA.NuotBobi,nNumeOtre)||'|LOTE:'||rMERMA.Lote||
																			 '|COBOMATE:'||rMERMA.ContBobi||'|BOBIMATE:'||rMERMA.CoboBobi, -- 11-11-2016 Solo para materiales tipo M
                                                          1, NULL);
                           END IF;
                           --
                           IF rMERMA.Tip_Arti2 IS NOT NULL THEN
                              IF NVL(rMERMA.CoboBobi2,0) > 0 THEN --Se trata de una Bobina Generada
                                 rMaterial_B2R := F_MATERIAL(vEmpresa, nNumeOtre, rMaquinas.Contador, 
                                                             rMERMA.Tip_Arti2, rMERMA.Cod_Arti2, '|EMPRBOBI:'||rMERMA.EmprBobi2||'|NUOTBOBI:'||rMERMA.NuotBobi2||'|CONTBOBI:'||rMERMA.ContBobi2||'|COBOBOBI:'||rMERMA.CoboBobi2||'|LOTE:'||rMERMA.Lote2,
                                                             2, NULL);
                              ELSE --Es un material de Almacen
                                 rMaterial_B2R := F_MATERIAL(vEmpresa, nNumeOtre, rMaquinas.Contador, 
                                                             rMERMA.Tip_Arti2, rMERMA.Cod_Arti2, '|EMPRBOBI:'||NVL(rMERMA.EmprBobi2,vEmpresa)||'|NUOTBOBI:'||NVL(rMERMA.NuotBobi2,nNumeOtre)||'|LOTE:'||rMERMA.Lote2||
												                         '|COBOMATE:'||rMERMA.ContBobi2||'|BOBIMATE:'||rMERMA.CoboBobi2, -- 11-11-2016 Solo para materiales tipo M
                                                             2, NULL);
                              END IF;
                           END IF;
                           --
                           IF rMATERIAL_B1R.IDENTIFICADOR IS NOT NULL THEN
                              P_MATERIAL(rMATERIAL_B1R,'U',
													  NULL,--nCantProd
													  NULL,--nCantCons_E
													  NULL,--nCantCons
													  NULL,--nCantAjus
													  NULL,--nAncho
													  NULL,--nFACTOR_CONVERSION_M2_KG
													  NULL,--nPrecio_ML_E
													  NULL,--vLog_Precio
													  NULL,--nMermEnhe_E
													  NULL,--nMermEnhe
													  NULL,--nMermAjus_E
													  NULL,--nMermAjus
													  NULL,--nMermCabo_E
													  (NVL(rMERMA.Merma_M1,0) * nCoefCorr),--nMermCabo
													  NULL,--nMermPico_E
													  NULL,--nMermPico
                                         NULL,--nMermTita
                                         NULL,--nMermSane
                                         NULL,--nCantCons_Bobinas
                                         --
                                          NULL, --nCONTFSMU_01 
                                          NULL, --nCANTFSMU_01 
                                          NULL, --nCATOFSMU 
                                          NULL, --nCONTFSMU_02 
                                          NULL, --nCANTFSMU_02 
                                          NULL, --nCONTFSMU_03 
                                          NULL, --nCANTFSMU_03 
                                          NULL, --nCONTFSMU_04 
                                          NULL, --nCANTFSMU_04 
                                          NULL, --nCONTFSMU_05 
                                          NULL, --nCANTFSMU_05 
                                          NULL, --nCONTFSMU_06 
                                          NULL, --nCANTFSMU_06 
                                          NULL, --nCONTFSMU_07 
                                          NULL, --nCANTFSMU_07 
                                          NULL, --nCONTFSMU_08 
                                          NULL, --nCANTFSMU_08 
                                          NULL, --nCONTFSMU_09 
                                          NULL, --nCANTFSMU_09 
                                          NULL, --nCONTFSMU_10 
                                          NULL, --nCANTFSMU_10 
                                          NULL, --nANCHO_BUENO_TOTAL_01 
                                          NULL, --nANCHO_BUENO_OT_01 
                                          NULL, --nANCHO_BUENO_TOTAL_02 
                                          NULL, --nANCHO_BUENO_OT_02 
                                          NULL, --nANCHO_BUENO_TOTAL_03 
                                          NULL, --nANCHO_BUENO_OT_03 
                                          NULL, --nANCHO_BUENO_TOTAL_04 
                                          NULL, --nANCHO_BUENO_OT_04 
                                          NULL, --nANCHO_BUENO_TOTAL_05 
                                          NULL, --nANCHO_BUENO_OT_05 
                                          NULL, --nANCHO_BUENO_TOTAL_06 
                                          NULL, --nANCHO_BUENO_OT_06 
                                          NULL, --nANCHO_BUENO_TOTAL_07 
                                          NULL, --nANCHO_BUENO_OT_07 
                                          NULL, --nANCHO_BUENO_TOTAL_08 
                                          NULL, --nANCHO_BUENO_OT_08 
                                          NULL, --nANCHO_BUENO_TOTAL_09 
                                          NULL, --nANCHO_BUENO_OT_09 
                                          NULL, --nANCHO_BUENO_TOTAL_10 
                                          NULL, --nANCHO_BUENO_OT_10 
                                          NULL, --nANCHO_BUENO_TOTAL 
                                          NULL, --nANCHO_BUENO_OT 
                                          NULL, --nNUMECORT 
                                          NULL, --nMM_MERMPRCO_01 
                                          NULL, --nMM_MERMPLAN_EXESO_01 
                                          NULL, --nMM_MERMPLAN_01 
                                          NULL, --nMM_MERMPRCO_02 
                                          NULL, --nMM_MERMPLAN_EXESO_02 
                                          NULL, --nMM_MERMPLAN_02 
                                          NULL, --nMM_MERMPRCO_03 
                                          NULL, --nMM_MERMPLAN_EXESO_03 
                                          NULL, --nMM_MERMPLAN_03 
                                          NULL, --nMM_MERMPRCO_04 
                                          NULL, --nMM_MERMPLAN_EXESO_04 
                                          NULL, --nMM_MERMPLAN_04 
                                          NULL, --nMM_MERMPRCO_05 
                                          NULL, --nMM_MERMPLAN_EXESO_05 
                                          NULL, --nMM_MERMPLAN_05 
                                          NULL, --nMM_MERMPRCO_06 
                                          NULL, --nMM_MERMPLAN_EXESO_06 
                                          NULL, --nMM_MERMPLAN_06 
                                          NULL, --nMM_MERMPRCO_07 
                                          NULL, --nMM_MERMPLAN_EXESO_07 
                                          NULL, --nMM_MERMPLAN_07 
                                          NULL, --nMM_MERMPRCO_08 
                                          NULL, --nMM_MERMPLAN_EXESO_08 
                                          NULL, --nMM_MERMPLAN_08 
                                          NULL, --nMM_MERMPRCO_09 
                                          NULL, --nMM_MERMPLAN_EXESO_09 
                                          NULL, --nMM_MERMPLAN_09 
                                          NULL, --nMM_MERMPRCO_10 
                                          NULL, --nMM_MERMPLAN_EXESO_10 
                                          NULL, --nMM_MERMPLAN_10 
                                          NULL, --nMM_MERMPRCO 
                                          NULL, --nMM_MERMPLAN_EXESO 
                                          NULL); --nMM_MERMPLAN
										--t_MATERIAL(rMATERIAL_B1R.IDENTIFICADOR).MermCabo := NVL(t_MATERIAL(rMATERIAL_B1R.IDENTIFICADOR).MermCabo,0) + (NVL(rMERMA.Merma_M1,0) * nCoefCorr);
                              --Actualización de Precio de MP
                              IF rMERMA.Tip_Arti IN (vTiarMpF4,vTiarSeF4,vP_TiarFiF4) THEN--AND t_MATERIAL(rMATERIAL_B1R.IDENTIFICADOR).Precio_ML IS NULL THEN --Si es Materia Prima
                                 vLogPreci := NULL;
                                 vPrecio := F_PRECIO(vEmpresa, nNumeOtre, 
																	  rMERMA.Tip_Arti, rMERMA.Cod_Arti, rMERMA.Lote,
																	  NULL, NULL, NULL, NULL);
											--
											P_MATERIAL(rMATERIAL_B1R,'U',
														  NULL,--nCantProd
														  NULL,--nCantCons_E
														  NULL,--nCantCons
														  NULL,--nCantAjus
														  NULL,--nAncho
														  NULL,--nFACTOR_CONVERSION_M2_KG
														  NULL,--nPrecio_ML_E
														  vPrecio,--vLog_Precio
														  NULL,--nMermEnhe_E
														  NULL,--nMermEnhe
														  NULL,--nMermAjus_E
														  NULL,--nMermAjus
														  NULL,--nMermCabo_E
														  NULL,--nMermCabo
														  NULL,--nMermPico_E
														  NULL,--nMermPico
                                            NULL,--nMermTita
                                            NULL,--nMermSane
                                            NULL,--nCantCons_Bobinas
                                            --
                                             NULL, --nCONTFSMU_01 
                                             NULL, --nCANTFSMU_01 
                                             NULL, --nCATOFSMU 
                                             NULL, --nCONTFSMU_02 
                                             NULL, --nCANTFSMU_02 
                                             NULL, --nCONTFSMU_03 
                                             NULL, --nCANTFSMU_03 
                                             NULL, --nCONTFSMU_04 
                                             NULL, --nCANTFSMU_04 
                                             NULL, --nCONTFSMU_05 
                                             NULL, --nCANTFSMU_05 
                                             NULL, --nCONTFSMU_06 
                                             NULL, --nCANTFSMU_06 
                                             NULL, --nCONTFSMU_07 
                                             NULL, --nCANTFSMU_07 
                                             NULL, --nCONTFSMU_08 
                                             NULL, --nCANTFSMU_08 
                                             NULL, --nCONTFSMU_09 
                                             NULL, --nCANTFSMU_09 
                                             NULL, --nCONTFSMU_10 
                                             NULL, --nCANTFSMU_10 
                                             NULL, --nANCHO_BUENO_TOTAL_01 
                                             NULL, --nANCHO_BUENO_OT_01 
                                             NULL, --nANCHO_BUENO_TOTAL_02 
                                             NULL, --nANCHO_BUENO_OT_02 
                                             NULL, --nANCHO_BUENO_TOTAL_03 
                                             NULL, --nANCHO_BUENO_OT_03 
                                             NULL, --nANCHO_BUENO_TOTAL_04 
                                             NULL, --nANCHO_BUENO_OT_04 
                                             NULL, --nANCHO_BUENO_TOTAL_05 
                                             NULL, --nANCHO_BUENO_OT_05 
                                             NULL, --nANCHO_BUENO_TOTAL_06 
                                             NULL, --nANCHO_BUENO_OT_06 
                                             NULL, --nANCHO_BUENO_TOTAL_07 
                                             NULL, --nANCHO_BUENO_OT_07 
                                             NULL, --nANCHO_BUENO_TOTAL_08 
                                             NULL, --nANCHO_BUENO_OT_08 
                                             NULL, --nANCHO_BUENO_TOTAL_09 
                                             NULL, --nANCHO_BUENO_OT_09 
                                             NULL, --nANCHO_BUENO_TOTAL_10 
                                             NULL, --nANCHO_BUENO_OT_10 
                                             NULL, --nANCHO_BUENO_TOTAL 
                                             NULL, --nANCHO_BUENO_OT 
                                             NULL, --nNUMECORT 
                                             NULL, --nMM_MERMPRCO_01 
                                             NULL, --nMM_MERMPLAN_EXESO_01 
                                             NULL, --nMM_MERMPLAN_01 
                                             NULL, --nMM_MERMPRCO_02 
                                             NULL, --nMM_MERMPLAN_EXESO_02 
                                             NULL, --nMM_MERMPLAN_02 
                                             NULL, --nMM_MERMPRCO_03 
                                             NULL, --nMM_MERMPLAN_EXESO_03 
                                             NULL, --nMM_MERMPLAN_03 
                                             NULL, --nMM_MERMPRCO_04 
                                             NULL, --nMM_MERMPLAN_EXESO_04 
                                             NULL, --nMM_MERMPLAN_04 
                                             NULL, --nMM_MERMPRCO_05 
                                             NULL, --nMM_MERMPLAN_EXESO_05 
                                             NULL, --nMM_MERMPLAN_05 
                                             NULL, --nMM_MERMPRCO_06 
                                             NULL, --nMM_MERMPLAN_EXESO_06 
                                             NULL, --nMM_MERMPLAN_06 
                                             NULL, --nMM_MERMPRCO_07 
                                             NULL, --nMM_MERMPLAN_EXESO_07 
                                             NULL, --nMM_MERMPLAN_07 
                                             NULL, --nMM_MERMPRCO_08 
                                             NULL, --nMM_MERMPLAN_EXESO_08 
                                             NULL, --nMM_MERMPLAN_08 
                                             NULL, --nMM_MERMPRCO_09 
                                             NULL, --nMM_MERMPLAN_EXESO_09 
                                             NULL, --nMM_MERMPLAN_09 
                                             NULL, --nMM_MERMPRCO_10 
                                             NULL, --nMM_MERMPLAN_EXESO_10 
                                             NULL, --nMM_MERMPLAN_10 
                                             NULL, --nMM_MERMPRCO 
                                             NULL, --nMM_MERMPLAN_EXESO 
                                             NULL); --nMM_MERMPLAN
											--t_MATERIAL(rMATERIAL_B1R.IDENTIFICADOR).Precio_ML := F_PRECIO(vEmpresa, nNumeOtre, 
                                 --                                                              rMERMA.Tip_Arti, rMERMA.Cod_Arti, rMERMA.Lote,
                                 --                                                              NULL, NULL, NULL, NULL);
                                 --t_MATERIAL(rMATERIAL_B1R.IDENTIFICADOR).Precio_ML_E := F_PRECIO_E(vEmpresa, nNumeOtre, 
                                 --                                                                  rMERMA.Tip_Arti, rMERMA.Cod_Arti, rMERMA.Lote,
                                 --                                                                  NULL, NULL, NULL, NULL);
                              END IF;
--ELSE dbms_output.put_line('20 IDENTIFICADOR IS NULL ');
									END IF;
                           --
                           IF rMATERIAL_B2R.IDENTIFICADOR IS NOT NULL THEN
                              P_MATERIAL(rMATERIAL_B2R,'U',
													  NULL,--nCantProd
													  NULL,--nCantCons_E
													  NULL,--nCantCons
													  NULL,--nCantAjus
													  NULL,--nAncho
													  NULL,--nFACTOR_CONVERSION_M2_KG
													  NULL,--nPrecio_ML_E
													  NULL,--vLog_Precio
													  NULL,--nMermEnhe_E
													  NULL,--nMermEnhe
													  NULL,--nMermAjus_E
													  NULL,--nMermAjus
													  NULL,--nMermCabo_E
													  (NVL(rMERMA.Merma_M2,0) * nCoefCorr),--nMermCabo
													  NULL,--nMermPico_E
													  NULL,--nMermPico
                                         NULL,--nMermTita
                                         NULL,--nMermSane
                                         NULL,--nCantCons_Bobinas
                                         --
                                          NULL, --nCONTFSMU_01 
                                          NULL, --nCANTFSMU_01 
                                          NULL, --nCATOFSMU 
                                          NULL, --nCONTFSMU_02 
                                          NULL, --nCANTFSMU_02 
                                          NULL, --nCONTFSMU_03 
                                          NULL, --nCANTFSMU_03 
                                          NULL, --nCONTFSMU_04 
                                          NULL, --nCANTFSMU_04 
                                          NULL, --nCONTFSMU_05 
                                          NULL, --nCANTFSMU_05 
                                          NULL, --nCONTFSMU_06 
                                          NULL, --nCANTFSMU_06 
                                          NULL, --nCONTFSMU_07 
                                          NULL, --nCANTFSMU_07 
                                          NULL, --nCONTFSMU_08 
                                          NULL, --nCANTFSMU_08 
                                          NULL, --nCONTFSMU_09 
                                          NULL, --nCANTFSMU_09 
                                          NULL, --nCONTFSMU_10 
                                          NULL, --nCANTFSMU_10 
                                          NULL, --nANCHO_BUENO_TOTAL_01 
                                          NULL, --nANCHO_BUENO_OT_01 
                                          NULL, --nANCHO_BUENO_TOTAL_02 
                                          NULL, --nANCHO_BUENO_OT_02 
                                          NULL, --nANCHO_BUENO_TOTAL_03 
                                          NULL, --nANCHO_BUENO_OT_03 
                                          NULL, --nANCHO_BUENO_TOTAL_04 
                                          NULL, --nANCHO_BUENO_OT_04 
                                          NULL, --nANCHO_BUENO_TOTAL_05 
                                          NULL, --nANCHO_BUENO_OT_05 
                                          NULL, --nANCHO_BUENO_TOTAL_06 
                                          NULL, --nANCHO_BUENO_OT_06 
                                          NULL, --nANCHO_BUENO_TOTAL_07 
                                          NULL, --nANCHO_BUENO_OT_07 
                                          NULL, --nANCHO_BUENO_TOTAL_08 
                                          NULL, --nANCHO_BUENO_OT_08 
                                          NULL, --nANCHO_BUENO_TOTAL_09 
                                          NULL, --nANCHO_BUENO_OT_09 
                                          NULL, --nANCHO_BUENO_TOTAL_10 
                                          NULL, --nANCHO_BUENO_OT_10 
                                          NULL, --nANCHO_BUENO_TOTAL 
                                          NULL, --nANCHO_BUENO_OT 
                                          NULL, --nNUMECORT 
                                          NULL, --nMM_MERMPRCO_01 
                                          NULL, --nMM_MERMPLAN_EXESO_01 
                                          NULL, --nMM_MERMPLAN_01 
                                          NULL, --nMM_MERMPRCO_02 
                                          NULL, --nMM_MERMPLAN_EXESO_02 
                                          NULL, --nMM_MERMPLAN_02 
                                          NULL, --nMM_MERMPRCO_03 
                                          NULL, --nMM_MERMPLAN_EXESO_03 
                                          NULL, --nMM_MERMPLAN_03 
                                          NULL, --nMM_MERMPRCO_04 
                                          NULL, --nMM_MERMPLAN_EXESO_04 
                                          NULL, --nMM_MERMPLAN_04 
                                          NULL, --nMM_MERMPRCO_05 
                                          NULL, --nMM_MERMPLAN_EXESO_05 
                                          NULL, --nMM_MERMPLAN_05 
                                          NULL, --nMM_MERMPRCO_06 
                                          NULL, --nMM_MERMPLAN_EXESO_06 
                                          NULL, --nMM_MERMPLAN_06 
                                          NULL, --nMM_MERMPRCO_07 
                                          NULL, --nMM_MERMPLAN_EXESO_07 
                                          NULL, --nMM_MERMPLAN_07 
                                          NULL, --nMM_MERMPRCO_08 
                                          NULL, --nMM_MERMPLAN_EXESO_08 
                                          NULL, --nMM_MERMPLAN_08 
                                          NULL, --nMM_MERMPRCO_09 
                                          NULL, --nMM_MERMPLAN_EXESO_09 
                                          NULL, --nMM_MERMPLAN_09 
                                          NULL, --nMM_MERMPRCO_10 
                                          NULL, --nMM_MERMPLAN_EXESO_10 
                                          NULL, --nMM_MERMPLAN_10 
                                          NULL, --nMM_MERMPRCO 
                                          NULL, --nMM_MERMPLAN_EXESO 
                                          NULL); --nMM_MERMPLAN
										--t_MATERIAL(rMATERIAL_B2R.IDENTIFICADOR).MermCabo := NVL(t_MATERIAL(rMATERIAL_B2R.IDENTIFICADOR).MermCabo,0) + (NVL(rMERMA.Merma_M2,0) * nCoefCorr);
                              --Actualización de Precio de MP
                              IF rMERMA.Tip_Arti2 IN (vTiarMpF4,vTiarSeF4,vP_TiarFiF4) THEN--AND t_MATERIAL(rMATERIAL_B2R.IDENTIFICADOR).Precio_ML IS NULL THEN --Si es Materia Prima
                                 vLogPreci := NULL;
                                 vPrecio := F_PRECIO(vEmpresa, nNumeOtre, 
																	  rMERMA.Tip_Arti2, rMERMA.Cod_Arti2, rMERMA.Lote2,
																	  NULL, NULL, NULL, NULL);
											--
											P_MATERIAL(rMATERIAL_B2R,'U',
														  NULL,--nCantProd
														  NULL,--nCantCons_E
														  NULL,--nCantCons
														  NULL,--nCantAjus
														  NULL,--nAncho
														  NULL,--nFACTOR_CONVERSION_M2_KG
														  NULL,--nPrecio_ML_E
														  vPrecio,--vLog_Precio
														  NULL,--nMermEnhe_E
														  NULL,--nMermEnhe
														  NULL,--nMermAjus_E
														  NULL,--nMermAjus
														  NULL,--nMermCabo_E
														  NULL,--nMermCabo
														  NULL,--nMermPico_E
														  NULL,--nMermPico
                                            NULL,--nMermTita
                                            NULL,--nMermSane
                                            NULL,--nCantCons_Bobinas
                                            --
                                             NULL, --nCONTFSMU_01 
                                             NULL, --nCANTFSMU_01 
                                             NULL, --nCATOFSMU 
                                             NULL, --nCONTFSMU_02 
                                             NULL, --nCANTFSMU_02 
                                             NULL, --nCONTFSMU_03 
                                             NULL, --nCANTFSMU_03 
                                             NULL, --nCONTFSMU_04 
                                             NULL, --nCANTFSMU_04 
                                             NULL, --nCONTFSMU_05 
                                             NULL, --nCANTFSMU_05 
                                             NULL, --nCONTFSMU_06 
                                             NULL, --nCANTFSMU_06 
                                             NULL, --nCONTFSMU_07 
                                             NULL, --nCANTFSMU_07 
                                             NULL, --nCONTFSMU_08 
                                             NULL, --nCANTFSMU_08 
                                             NULL, --nCONTFSMU_09 
                                             NULL, --nCANTFSMU_09 
                                             NULL, --nCONTFSMU_10 
                                             NULL, --nCANTFSMU_10 
                                             NULL, --nANCHO_BUENO_TOTAL_01 
                                             NULL, --nANCHO_BUENO_OT_01 
                                             NULL, --nANCHO_BUENO_TOTAL_02 
                                             NULL, --nANCHO_BUENO_OT_02 
                                             NULL, --nANCHO_BUENO_TOTAL_03 
                                             NULL, --nANCHO_BUENO_OT_03 
                                             NULL, --nANCHO_BUENO_TOTAL_04 
                                             NULL, --nANCHO_BUENO_OT_04 
                                             NULL, --nANCHO_BUENO_TOTAL_05 
                                             NULL, --nANCHO_BUENO_OT_05 
                                             NULL, --nANCHO_BUENO_TOTAL_06 
                                             NULL, --nANCHO_BUENO_OT_06 
                                             NULL, --nANCHO_BUENO_TOTAL_07 
                                             NULL, --nANCHO_BUENO_OT_07 
                                             NULL, --nANCHO_BUENO_TOTAL_08 
                                             NULL, --nANCHO_BUENO_OT_08 
                                             NULL, --nANCHO_BUENO_TOTAL_09 
                                             NULL, --nANCHO_BUENO_OT_09 
                                             NULL, --nANCHO_BUENO_TOTAL_10 
                                             NULL, --nANCHO_BUENO_OT_10 
                                             NULL, --nANCHO_BUENO_TOTAL 
                                             NULL, --nANCHO_BUENO_OT 
                                             NULL, --nNUMECORT 
                                             NULL, --nMM_MERMPRCO_01 
                                             NULL, --nMM_MERMPLAN_EXESO_01 
                                             NULL, --nMM_MERMPLAN_01 
                                             NULL, --nMM_MERMPRCO_02 
                                             NULL, --nMM_MERMPLAN_EXESO_02 
                                             NULL, --nMM_MERMPLAN_02 
                                             NULL, --nMM_MERMPRCO_03 
                                             NULL, --nMM_MERMPLAN_EXESO_03 
                                             NULL, --nMM_MERMPLAN_03 
                                             NULL, --nMM_MERMPRCO_04 
                                             NULL, --nMM_MERMPLAN_EXESO_04 
                                             NULL, --nMM_MERMPLAN_04 
                                             NULL, --nMM_MERMPRCO_05 
                                             NULL, --nMM_MERMPLAN_EXESO_05 
                                             NULL, --nMM_MERMPLAN_05 
                                             NULL, --nMM_MERMPRCO_06 
                                             NULL, --nMM_MERMPLAN_EXESO_06 
                                             NULL, --nMM_MERMPLAN_06 
                                             NULL, --nMM_MERMPRCO_07 
                                             NULL, --nMM_MERMPLAN_EXESO_07 
                                             NULL, --nMM_MERMPLAN_07 
                                             NULL, --nMM_MERMPRCO_08 
                                             NULL, --nMM_MERMPLAN_EXESO_08 
                                             NULL, --nMM_MERMPLAN_08 
                                             NULL, --nMM_MERMPRCO_09 
                                             NULL, --nMM_MERMPLAN_EXESO_09 
                                             NULL, --nMM_MERMPLAN_09 
                                             NULL, --nMM_MERMPRCO_10 
                                             NULL, --nMM_MERMPLAN_EXESO_10 
                                             NULL, --nMM_MERMPLAN_10 
                                             NULL, --nMM_MERMPRCO 
                                             NULL, --nMM_MERMPLAN_EXESO 
                                             NULL); --nMM_MERMPLAN
											--t_MATERIAL(rMATERIAL_B2R.IDENTIFICADOR).Precio_ML := F_PRECIO(vEmpresa, nNumeOtre, 
                                 --                                                              rMERMA.Tip_Arti2, rMERMA.Cod_Arti2, rMERMA.Lote2,
                                 --                                                              NULL, NULL, NULL, NULL);
                                 --t_MATERIAL(rMATERIAL_B2R.IDENTIFICADOR).Precio_ML_E := F_PRECIO_E(vEmpresa, nNumeOtre, 
                                 --                                                                  rMERMA.Tip_Arti2, rMERMA.Cod_Arti2, rMERMA.Lote2,
                                 --                                                                  NULL, NULL, NULL, NULL);
                              END IF;
--ELSE dbms_output.put_line('21 IDENTIFICADOR IS NULL(2) ');
									END IF;
                        END LOOP;
                     END IF;
                  END LOOP;
               END IF;
            END LOOP;
            --MERMAS POR PICOS
            --Se busca si la Maquina tiene valor de Ajuste Automatico o Real
            FOR rCaracteristica_Maquina IN cCaracteristica_Maquina('MERMPICO',rMaquinas.MaquCodi,vLinea,nNumePasa) LOOP --Pueden ser varios Eventos, tambien podria aplicar a varias Caracteristicas
               --Si se encuentra caracteristica es una Merma Automatica (Captación Estandar)
               IF rCaracteristica_Maquina.Caracteristica IS NOT NULL THEN
                  --Se realizan las busquedas de Mermas en las Maquinas Utilizadas en las Pasadas
                  FOR rMaquinas_Utilizadas IN cMaquinas_Utilizadas(rMaquinas.Contador) LOOP
                     nMaquCara_M1 := NULL;
                     nMaquCara_M2 := NULL;
                     --
                     OPEN cPRD_MAQUCARA(rMaquinas.MaquTipo,rMaquinas_Utilizadas.MaquCodi,rCaracteristica_Maquina.Caracteristica);
                     FETCH cPRD_MAQUCARA INTO nMaquCara_M1;
                     CLOSE cPRD_MAQUCARA;
                     --Se verifica si existe la Caracteristica 2 En caso de Laminadoras Material 2
                     IF rCaracteristica_Maquina.Caracteristica2 IS NOT NULL THEN
                        OPEN cPRD_MAQUCARA(rMaquinas.MaquTipo,rMaquinas_Utilizadas.MaquCodi,rCaracteristica_Maquina.Caracteristica2);
                        FETCH cPRD_MAQUCARA INTO nMaquCara_M2;
                        CLOSE cPRD_MAQUCARA;
                     END IF;
                     --
                     nMerma_Picos_M1_E := NVL(nMerma_Picos_M1_E,0) + NVL(nMaquCara_M1,0);
                     nMerma_Picos_M2_E := NVL(nMerma_Picos_M2_E,0) + NVL(nMaquCara_M2,0);
                  END LOOP;
                  --
                  IF rMATERIAL_B1.IDENTIFICADOR IS NOT NULL THEN
                     P_MATERIAL(rMATERIAL_B1,'U',
										  NULL,--nCantProd
										  NULL,--nCantCons_E
										  NULL,--nCantCons
										  NULL,--nCantAjus
										  NULL,--nAncho
										  NULL,--nFACTOR_CONVERSION_M2_KG
										  NULL,--nPrecio_ML_E
										  NULL,--vLog_Precio
										  NULL,--nMermEnhe_E
										  NULL,--nMermEnhe
										  NULL,--nMermAjus_E
										  NULL,--nMermAjus
										  NULL,--nMermCabo_E
										  NULL,--nMermCabo
										  nMerma_Picos_M1_E,--nMermPico_E
										  NULL,--nMermPico
                                NULL,--nMermTita
                                NULL,--nMermSane
                                NULL,--nCantCons_Bobinas
                                --
                                 NULL, --nCONTFSMU_01 
                                 NULL, --nCANTFSMU_01 
                                 NULL, --nCATOFSMU 
                                 NULL, --nCONTFSMU_02 
                                 NULL, --nCANTFSMU_02 
                                 NULL, --nCONTFSMU_03 
                                 NULL, --nCANTFSMU_03 
                                 NULL, --nCONTFSMU_04 
                                 NULL, --nCANTFSMU_04 
                                 NULL, --nCONTFSMU_05 
                                 NULL, --nCANTFSMU_05 
                                 NULL, --nCONTFSMU_06 
                                 NULL, --nCANTFSMU_06 
                                 NULL, --nCONTFSMU_07 
                                 NULL, --nCANTFSMU_07 
                                 NULL, --nCONTFSMU_08 
                                 NULL, --nCANTFSMU_08 
                                 NULL, --nCONTFSMU_09 
                                 NULL, --nCANTFSMU_09 
                                 NULL, --nCONTFSMU_10 
                                 NULL, --nCANTFSMU_10 
                                 NULL, --nANCHO_BUENO_TOTAL_01 
                                 NULL, --nANCHO_BUENO_OT_01 
                                 NULL, --nANCHO_BUENO_TOTAL_02 
                                 NULL, --nANCHO_BUENO_OT_02 
                                 NULL, --nANCHO_BUENO_TOTAL_03 
                                 NULL, --nANCHO_BUENO_OT_03 
                                 NULL, --nANCHO_BUENO_TOTAL_04 
                                 NULL, --nANCHO_BUENO_OT_04 
                                 NULL, --nANCHO_BUENO_TOTAL_05 
                                 NULL, --nANCHO_BUENO_OT_05 
                                 NULL, --nANCHO_BUENO_TOTAL_06 
                                 NULL, --nANCHO_BUENO_OT_06 
                                 NULL, --nANCHO_BUENO_TOTAL_07 
                                 NULL, --nANCHO_BUENO_OT_07 
                                 NULL, --nANCHO_BUENO_TOTAL_08 
                                 NULL, --nANCHO_BUENO_OT_08 
                                 NULL, --nANCHO_BUENO_TOTAL_09 
                                 NULL, --nANCHO_BUENO_OT_09 
                                 NULL, --nANCHO_BUENO_TOTAL_10 
                                 NULL, --nANCHO_BUENO_OT_10 
                                 NULL, --nANCHO_BUENO_TOTAL 
                                 NULL, --nANCHO_BUENO_OT 
                                 NULL, --nNUMECORT 
                                 NULL, --nMM_MERMPRCO_01 
                                 NULL, --nMM_MERMPLAN_EXESO_01 
                                 NULL, --nMM_MERMPLAN_01 
                                 NULL, --nMM_MERMPRCO_02 
                                 NULL, --nMM_MERMPLAN_EXESO_02 
                                 NULL, --nMM_MERMPLAN_02 
                                 NULL, --nMM_MERMPRCO_03 
                                 NULL, --nMM_MERMPLAN_EXESO_03 
                                 NULL, --nMM_MERMPLAN_03 
                                 NULL, --nMM_MERMPRCO_04 
                                 NULL, --nMM_MERMPLAN_EXESO_04 
                                 NULL, --nMM_MERMPLAN_04 
                                 NULL, --nMM_MERMPRCO_05 
                                 NULL, --nMM_MERMPLAN_EXESO_05 
                                 NULL, --nMM_MERMPLAN_05 
                                 NULL, --nMM_MERMPRCO_06 
                                 NULL, --nMM_MERMPLAN_EXESO_06 
                                 NULL, --nMM_MERMPLAN_06 
                                 NULL, --nMM_MERMPRCO_07 
                                 NULL, --nMM_MERMPLAN_EXESO_07 
                                 NULL, --nMM_MERMPLAN_07 
                                 NULL, --nMM_MERMPRCO_08 
                                 NULL, --nMM_MERMPLAN_EXESO_08 
                                 NULL, --nMM_MERMPLAN_08 
                                 NULL, --nMM_MERMPRCO_09 
                                 NULL, --nMM_MERMPLAN_EXESO_09 
                                 NULL, --nMM_MERMPLAN_09 
                                 NULL, --nMM_MERMPRCO_10 
                                 NULL, --nMM_MERMPLAN_EXESO_10 
                                 NULL, --nMM_MERMPLAN_10 
                                 NULL, --nMM_MERMPRCO 
                                 NULL, --nMM_MERMPLAN_EXESO 
                                 NULL); --nMM_MERMPLAN
							--t_MATERIAL(rMATERIAL_B1.IDENTIFICADOR).MermPico_E := NVL(t_MATERIAL(rMATERIAL_B1.IDENTIFICADOR).MermPico_E,0) + nMerma_Picos_M1_E;
--ELSE dbms_output.put_line('22 IDENTIFICADOR IS NULL ');
                  END IF;
                  --
                  IF rMATERIAL_B2.IDENTIFICADOR IS NOT NULL THEN
                     P_MATERIAL(rMATERIAL_B2,'U',
										  NULL,--nCantProd
										  NULL,--nCantCons_E
										  NULL,--nCantCons
										  NULL,--nCantAjus
										  NULL,--nAncho
										  NULL,--nFACTOR_CONVERSION_M2_KG
										  NULL,--nPrecio_ML_E
										  NULL,--vLog_Precio
										  NULL,--nMermEnhe_E
										  NULL,--nMermEnhe
										  NULL,--nMermAjus_E
										  NULL,--nMermAjus
										  NULL,--nMermCabo_E
										  NULL,--nMermCabo
										  nMerma_Picos_M2_E,--nMermPico_E
										  NULL,--nMermPico
                                NULL,--nMermTita
                                NULL,--nMermSane
                                NULL,--nCantCons_Bobinas
                                --
                                 NULL, --nCONTFSMU_01 
                                 NULL, --nCANTFSMU_01 
                                 NULL, --nCATOFSMU 
                                 NULL, --nCONTFSMU_02 
                                 NULL, --nCANTFSMU_02 
                                 NULL, --nCONTFSMU_03 
                                 NULL, --nCANTFSMU_03 
                                 NULL, --nCONTFSMU_04 
                                 NULL, --nCANTFSMU_04 
                                 NULL, --nCONTFSMU_05 
                                 NULL, --nCANTFSMU_05 
                                 NULL, --nCONTFSMU_06 
                                 NULL, --nCANTFSMU_06 
                                 NULL, --nCONTFSMU_07 
                                 NULL, --nCANTFSMU_07 
                                 NULL, --nCONTFSMU_08 
                                 NULL, --nCANTFSMU_08 
                                 NULL, --nCONTFSMU_09 
                                 NULL, --nCANTFSMU_09 
                                 NULL, --nCONTFSMU_10 
                                 NULL, --nCANTFSMU_10 
                                 NULL, --nANCHO_BUENO_TOTAL_01 
                                 NULL, --nANCHO_BUENO_OT_01 
                                 NULL, --nANCHO_BUENO_TOTAL_02 
                                 NULL, --nANCHO_BUENO_OT_02 
                                 NULL, --nANCHO_BUENO_TOTAL_03 
                                 NULL, --nANCHO_BUENO_OT_03 
                                 NULL, --nANCHO_BUENO_TOTAL_04 
                                 NULL, --nANCHO_BUENO_OT_04 
                                 NULL, --nANCHO_BUENO_TOTAL_05 
                                 NULL, --nANCHO_BUENO_OT_05 
                                 NULL, --nANCHO_BUENO_TOTAL_06 
                                 NULL, --nANCHO_BUENO_OT_06 
                                 NULL, --nANCHO_BUENO_TOTAL_07 
                                 NULL, --nANCHO_BUENO_OT_07 
                                 NULL, --nANCHO_BUENO_TOTAL_08 
                                 NULL, --nANCHO_BUENO_OT_08 
                                 NULL, --nANCHO_BUENO_TOTAL_09 
                                 NULL, --nANCHO_BUENO_OT_09 
                                 NULL, --nANCHO_BUENO_TOTAL_10 
                                 NULL, --nANCHO_BUENO_OT_10 
                                 NULL, --nANCHO_BUENO_TOTAL 
                                 NULL, --nANCHO_BUENO_OT 
                                 NULL, --nNUMECORT 
                                 NULL, --nMM_MERMPRCO_01 
                                 NULL, --nMM_MERMPLAN_EXESO_01 
                                 NULL, --nMM_MERMPLAN_01 
                                 NULL, --nMM_MERMPRCO_02 
                                 NULL, --nMM_MERMPLAN_EXESO_02 
                                 NULL, --nMM_MERMPLAN_02 
                                 NULL, --nMM_MERMPRCO_03 
                                 NULL, --nMM_MERMPLAN_EXESO_03 
                                 NULL, --nMM_MERMPLAN_03 
                                 NULL, --nMM_MERMPRCO_04 
                                 NULL, --nMM_MERMPLAN_EXESO_04 
                                 NULL, --nMM_MERMPLAN_04 
                                 NULL, --nMM_MERMPRCO_05 
                                 NULL, --nMM_MERMPLAN_EXESO_05 
                                 NULL, --nMM_MERMPLAN_05 
                                 NULL, --nMM_MERMPRCO_06 
                                 NULL, --nMM_MERMPLAN_EXESO_06 
                                 NULL, --nMM_MERMPLAN_06 
                                 NULL, --nMM_MERMPRCO_07 
                                 NULL, --nMM_MERMPLAN_EXESO_07 
                                 NULL, --nMM_MERMPLAN_07 
                                 NULL, --nMM_MERMPRCO_08 
                                 NULL, --nMM_MERMPLAN_EXESO_08 
                                 NULL, --nMM_MERMPLAN_08 
                                 NULL, --nMM_MERMPRCO_09 
                                 NULL, --nMM_MERMPLAN_EXESO_09 
                                 NULL, --nMM_MERMPLAN_09 
                                 NULL, --nMM_MERMPRCO_10 
                                 NULL, --nMM_MERMPLAN_EXESO_10 
                                 NULL, --nMM_MERMPLAN_10 
                                 NULL, --nMM_MERMPRCO 
                                 NULL, --nMM_MERMPLAN_EXESO 
                                 NULL); --nMM_MERMPLAN
							--t_MATERIAL(rMATERIAL_B2.IDENTIFICADOR).MermPico_E := NVL(t_MATERIAL(rMATERIAL_B2.IDENTIFICADOR).MermPico_E,0) + nMerma_Picos_M2_E;
--ELSE dbms_output.put_line('23 IDENTIFICADOR IS NULL(2) ');
                  END IF;
                  --Fin Parte ESTANDAR
               END IF;
               --
               IF rCaracteristica_Maquina.Caracteristica IS NOT NULL AND rCaracteristica_Maquina.Captacion = 'ESTANDAR' THEN   
                  nMerma_Picos_M1 := NVL(nMerma_Picos_M1_E,0);
                  nMerma_Picos_M2 := NVL(nMerma_Picos_M2_E,0);
                  --
                  IF rMATERIAL_B1.IDENTIFICADOR IS NOT NULL THEN
                     P_MATERIAL(rMATERIAL_B1,'U',
										  NULL,--nCantProd
										  NULL,--nCantCons_E
										  NULL,--nCantCons
										  NULL,--nCantAjus
										  NULL,--nAncho
										  NULL,--nFACTOR_CONVERSION_M2_KG
										  NULL,--nPrecio_ML_E
										  NULL,--vLog_Precio
										  NULL,--nMermEnhe_E
										  NULL,--nMermEnhe
										  NULL,--nMermAjus_E
										  NULL,--nMermAjus
										  NULL,--nMermCabo_E
										  NULL,--nMermCabo
										  NULL,--nMermPico_E
										  nMerma_Picos_M1,--nMermPico
                                NULL,--nMermTita
                                NULL,--nMermSane
                                NULL,--nCantCons_Bobinas
                                --
                                 NULL, --nCONTFSMU_01 
                                 NULL, --nCANTFSMU_01 
                                 NULL, --nCATOFSMU 
                                 NULL, --nCONTFSMU_02 
                                 NULL, --nCANTFSMU_02 
                                 NULL, --nCONTFSMU_03 
                                 NULL, --nCANTFSMU_03 
                                 NULL, --nCONTFSMU_04 
                                 NULL, --nCANTFSMU_04 
                                 NULL, --nCONTFSMU_05 
                                 NULL, --nCANTFSMU_05 
                                 NULL, --nCONTFSMU_06 
                                 NULL, --nCANTFSMU_06 
                                 NULL, --nCONTFSMU_07 
                                 NULL, --nCANTFSMU_07 
                                 NULL, --nCONTFSMU_08 
                                 NULL, --nCANTFSMU_08 
                                 NULL, --nCONTFSMU_09 
                                 NULL, --nCANTFSMU_09 
                                 NULL, --nCONTFSMU_10 
                                 NULL, --nCANTFSMU_10 
                                 NULL, --nANCHO_BUENO_TOTAL_01 
                                 NULL, --nANCHO_BUENO_OT_01 
                                 NULL, --nANCHO_BUENO_TOTAL_02 
                                 NULL, --nANCHO_BUENO_OT_02 
                                 NULL, --nANCHO_BUENO_TOTAL_03 
                                 NULL, --nANCHO_BUENO_OT_03 
                                 NULL, --nANCHO_BUENO_TOTAL_04 
                                 NULL, --nANCHO_BUENO_OT_04 
                                 NULL, --nANCHO_BUENO_TOTAL_05 
                                 NULL, --nANCHO_BUENO_OT_05 
                                 NULL, --nANCHO_BUENO_TOTAL_06 
                                 NULL, --nANCHO_BUENO_OT_06 
                                 NULL, --nANCHO_BUENO_TOTAL_07 
                                 NULL, --nANCHO_BUENO_OT_07 
                                 NULL, --nANCHO_BUENO_TOTAL_08 
                                 NULL, --nANCHO_BUENO_OT_08 
                                 NULL, --nANCHO_BUENO_TOTAL_09 
                                 NULL, --nANCHO_BUENO_OT_09 
                                 NULL, --nANCHO_BUENO_TOTAL_10 
                                 NULL, --nANCHO_BUENO_OT_10 
                                 NULL, --nANCHO_BUENO_TOTAL 
                                 NULL, --nANCHO_BUENO_OT 
                                 NULL, --nNUMECORT 
                                 NULL, --nMM_MERMPRCO_01 
                                 NULL, --nMM_MERMPLAN_EXESO_01 
                                 NULL, --nMM_MERMPLAN_01 
                                 NULL, --nMM_MERMPRCO_02 
                                 NULL, --nMM_MERMPLAN_EXESO_02 
                                 NULL, --nMM_MERMPLAN_02 
                                 NULL, --nMM_MERMPRCO_03 
                                 NULL, --nMM_MERMPLAN_EXESO_03 
                                 NULL, --nMM_MERMPLAN_03 
                                 NULL, --nMM_MERMPRCO_04 
                                 NULL, --nMM_MERMPLAN_EXESO_04 
                                 NULL, --nMM_MERMPLAN_04 
                                 NULL, --nMM_MERMPRCO_05 
                                 NULL, --nMM_MERMPLAN_EXESO_05 
                                 NULL, --nMM_MERMPLAN_05 
                                 NULL, --nMM_MERMPRCO_06 
                                 NULL, --nMM_MERMPLAN_EXESO_06 
                                 NULL, --nMM_MERMPLAN_06 
                                 NULL, --nMM_MERMPRCO_07 
                                 NULL, --nMM_MERMPLAN_EXESO_07 
                                 NULL, --nMM_MERMPLAN_07 
                                 NULL, --nMM_MERMPRCO_08 
                                 NULL, --nMM_MERMPLAN_EXESO_08 
                                 NULL, --nMM_MERMPLAN_08 
                                 NULL, --nMM_MERMPRCO_09 
                                 NULL, --nMM_MERMPLAN_EXESO_09 
                                 NULL, --nMM_MERMPLAN_09 
                                 NULL, --nMM_MERMPRCO_10 
                                 NULL, --nMM_MERMPLAN_EXESO_10 
                                 NULL, --nMM_MERMPLAN_10 
                                 NULL, --nMM_MERMPRCO 
                                 NULL, --nMM_MERMPLAN_EXESO 
                                 NULL); --nMM_MERMPLAN
							--t_MATERIAL(rMATERIAL_B1.IDENTIFICADOR).MermPico := NVL(t_MATERIAL(rMATERIAL_B1.IDENTIFICADOR).MermPico,0) + nMerma_Picos_M1;
--ELSE dbms_output.put_line('24 IDENTIFICADOR IS NULL ');
                  END IF;
                  --
                  IF rMATERIAL_B2.IDENTIFICADOR IS NOT NULL THEN
                     P_MATERIAL(rMATERIAL_B2,'U',
										  NULL,--nCantProd
										  NULL,--nCantCons_E
										  NULL,--nCantCons
										  NULL,--nCantAjus
										  NULL,--nAncho
										  NULL,--nFACTOR_CONVERSION_M2_KG
										  NULL,--nPrecio_ML_E
										  NULL,--vLog_Precio
										  NULL,--nMermEnhe_E
										  NULL,--nMermEnhe
										  NULL,--nMermAjus_E
										  NULL,--nMermAjus
										  NULL,--nMermCabo_E
										  NULL,--nMermCabo
										  NULL,--nMermPico_E
										  nMerma_Picos_M2,--nMermPico
                                NULL,--nMermTita
                                NULL,--nMermSane
                                NULL,--nCantCons_Bobinas
                                --
                                 NULL, --nCONTFSMU_01 
                                 NULL, --nCANTFSMU_01 
                                 NULL, --nCATOFSMU 
                                 NULL, --nCONTFSMU_02 
                                 NULL, --nCANTFSMU_02 
                                 NULL, --nCONTFSMU_03 
                                 NULL, --nCANTFSMU_03 
                                 NULL, --nCONTFSMU_04 
                                 NULL, --nCANTFSMU_04 
                                 NULL, --nCONTFSMU_05 
                                 NULL, --nCANTFSMU_05 
                                 NULL, --nCONTFSMU_06 
                                 NULL, --nCANTFSMU_06 
                                 NULL, --nCONTFSMU_07 
                                 NULL, --nCANTFSMU_07 
                                 NULL, --nCONTFSMU_08 
                                 NULL, --nCANTFSMU_08 
                                 NULL, --nCONTFSMU_09 
                                 NULL, --nCANTFSMU_09 
                                 NULL, --nCONTFSMU_10 
                                 NULL, --nCANTFSMU_10 
                                 NULL, --nANCHO_BUENO_TOTAL_01 
                                 NULL, --nANCHO_BUENO_OT_01 
                                 NULL, --nANCHO_BUENO_TOTAL_02 
                                 NULL, --nANCHO_BUENO_OT_02 
                                 NULL, --nANCHO_BUENO_TOTAL_03 
                                 NULL, --nANCHO_BUENO_OT_03 
                                 NULL, --nANCHO_BUENO_TOTAL_04 
                                 NULL, --nANCHO_BUENO_OT_04 
                                 NULL, --nANCHO_BUENO_TOTAL_05 
                                 NULL, --nANCHO_BUENO_OT_05 
                                 NULL, --nANCHO_BUENO_TOTAL_06 
                                 NULL, --nANCHO_BUENO_OT_06 
                                 NULL, --nANCHO_BUENO_TOTAL_07 
                                 NULL, --nANCHO_BUENO_OT_07 
                                 NULL, --nANCHO_BUENO_TOTAL_08 
                                 NULL, --nANCHO_BUENO_OT_08 
                                 NULL, --nANCHO_BUENO_TOTAL_09 
                                 NULL, --nANCHO_BUENO_OT_09 
                                 NULL, --nANCHO_BUENO_TOTAL_10 
                                 NULL, --nANCHO_BUENO_OT_10 
                                 NULL, --nANCHO_BUENO_TOTAL 
                                 NULL, --nANCHO_BUENO_OT 
                                 NULL, --nNUMECORT 
                                 NULL, --nMM_MERMPRCO_01 
                                 NULL, --nMM_MERMPLAN_EXESO_01 
                                 NULL, --nMM_MERMPLAN_01 
                                 NULL, --nMM_MERMPRCO_02 
                                 NULL, --nMM_MERMPLAN_EXESO_02 
                                 NULL, --nMM_MERMPLAN_02 
                                 NULL, --nMM_MERMPRCO_03 
                                 NULL, --nMM_MERMPLAN_EXESO_03 
                                 NULL, --nMM_MERMPLAN_03 
                                 NULL, --nMM_MERMPRCO_04 
                                 NULL, --nMM_MERMPLAN_EXESO_04 
                                 NULL, --nMM_MERMPLAN_04 
                                 NULL, --nMM_MERMPRCO_05 
                                 NULL, --nMM_MERMPLAN_EXESO_05 
                                 NULL, --nMM_MERMPLAN_05 
                                 NULL, --nMM_MERMPRCO_06 
                                 NULL, --nMM_MERMPLAN_EXESO_06 
                                 NULL, --nMM_MERMPLAN_06 
                                 NULL, --nMM_MERMPRCO_07 
                                 NULL, --nMM_MERMPLAN_EXESO_07 
                                 NULL, --nMM_MERMPLAN_07 
                                 NULL, --nMM_MERMPRCO_08 
                                 NULL, --nMM_MERMPLAN_EXESO_08 
                                 NULL, --nMM_MERMPLAN_08 
                                 NULL, --nMM_MERMPRCO_09 
                                 NULL, --nMM_MERMPLAN_EXESO_09 
                                 NULL, --nMM_MERMPLAN_09 
                                 NULL, --nMM_MERMPRCO_10 
                                 NULL, --nMM_MERMPLAN_EXESO_10 
                                 NULL, --nMM_MERMPLAN_10 
                                 NULL, --nMM_MERMPRCO 
                                 NULL, --nMM_MERMPLAN_EXESO 
                                 NULL); --nMM_MERMPLAN
							--t_MATERIAL(rMATERIAL_B2.IDENTIFICADOR).MermPico := NVL(t_MATERIAL(rMATERIAL_B2.IDENTIFICADOR).MermPico,0) + nMerma_Picos_M2;
--ELSE dbms_output.put_line('25 IDENTIFICADOR IS NULL(2) ');
                  END IF;
               --Si encuentra un Evento es una Merma asociada a un Evento (Captación Real)
               ELSIF rCaracteristica_Maquina.EvenCodi IS NOT NULL THEN
                 --Se realizan las busquedas de Mermas en las Maquinas Utilizadas en las Pasadas
                  FOR rMaquinas_Utilizadas_EvenMerm IN cMaquinas_Utilizadas_EvenMerm(rMaquinas.Contador,rCaracteristica_Maquina.EvenCodi) LOOP
                     rPRD_MAQUEVEN.Valor := NULL;
                     rPRD_MAQUEVEN.OrvaReal := NULL;
                     --
                     OPEN cPRD_MAQUEVEN(rMaquinas.MaquTipo,rMaquinas_Utilizadas_EvenMerm.MaquCodi, rCaracteristica_Maquina.EvenCodi);
                     FETCH cPRD_MAQUEVEN INTO rPRD_MAQUEVEN;
                     CLOSE cPRD_MAQUEVEN;
                     --
                     IF rPRD_MAQUEVEN.VALOR = 'PRD_MEEVFA' THEN
                        FOR rMERMA IN cMERMA(rMaquinas.Contador, rMaquinas.MaquTipo, rMaquinas_Utilizadas_EvenMerm.MaquCodi, rCaracteristica_Maquina.EvenCodi, rPRD_MAQUEVEN.ORVAREAL) LOOP
                           nMerma_Picos_M1 := NVL(nMerma_Picos_M1,0) + NVL(rMERMA.Merma_M1,0);
                           nMerma_Picos_M2 := NVL(nMerma_Picos_M2,0) + NVL(rMERMA.Merma_M2,0);
                           --
                           rMaterial_B1R.IDENTIFICADOR := NULL;
                           rMaterial_B2R.IDENTIFICADOR := NULL;
                           --
                           IF NVL(rMERMA.CoboBobi,0) > 0 THEN --Se trata de una Bobina Generada
                              rMaterial_B1R := F_MATERIAL(vEmpresa, nNumeOtre, rMaquinas.Contador, 
                                                          rMERMA.Tip_Arti, rMERMA.Cod_Arti, '|EMPRBOBI:'||rMERMA.EmprBobi||'|NUOTBOBI:'||rMERMA.NuotBobi||'|CONTBOBI:'||rMERMA.ContBobi||'|COBOBOBI:'||rMERMA.CoboBobi||'|LOTE:'||rMERMA.Lote,
                                                          1, NULL);
                           ELSE --Es un material de Almacen
                              rMaterial_B1R := F_MATERIAL(vEmpresa, nNumeOtre, rMaquinas.Contador, 
                                                          rMERMA.Tip_Arti, rMERMA.Cod_Arti, '|EMPRBOBI:'||NVL(rMERMA.EmprBobi,vEmpresa)||'|NUOTBOBI:'||NVL(rMERMA.NuotBobi,nNumeOtre)||'|LOTE:'||rMERMA.Lote||
																			 '|COBOMATE:'||rMERMA.ContBobi||'|BOBIMATE:'||rMERMA.CoboBobi, -- 11-11-2016 Solo para materiales tipo M
                                                          1, NULL);
                           END IF;
                           --
                           IF rMERMA.Tip_Arti2 IS NOT NULL THEN
                              IF NVL(rMERMA.CoboBobi2,0) > 0 THEN --Se trata de una Bobina Generada
                                 rMaterial_B2R := F_MATERIAL(vEmpresa, nNumeOtre, rMaquinas.Contador, 
                                                             rMERMA.Tip_Arti2, rMERMA.Cod_Arti2, '|EMPRBOBI:'||rMERMA.EmprBobi2||'|NUOTBOBI:'||rMERMA.NuotBobi2||'|CONTBOBI:'||rMERMA.ContBobi2||'|COBOBOBI:'||rMERMA.CoboBobi2||'|LOTE:'||rMERMA.Lote2,
                                                             2, NULL);
                              ELSE --Es un material de Almacen
                                 rMaterial_B2R := F_MATERIAL(vEmpresa, nNumeOtre, rMaquinas.Contador, 
                                                             rMERMA.Tip_Arti2, rMERMA.Cod_Arti2, '|EMPRBOBI:'||NVL(rMERMA.EmprBobi2,vEmpresa)||'|NUOTBOBI:'||NVL(rMERMA.NuotBobi2,nNumeOtre)||'|LOTE:'||rMERMA.Lote2||
												                         '|COBOMATE:'||rMERMA.ContBobi2||'|BOBIMATE:'||rMERMA.CoboBobi2, -- 11-11-2016 Solo para materiales tipo M
                                                             2, NULL);
                              END IF;
                           END IF;
                           --
                           IF rMATERIAL_B1R.IDENTIFICADOR IS NOT NULL THEN
                              P_MATERIAL(rMATERIAL_B1R,'U',
													  NULL,--nCantProd
													  NULL,--nCantCons_E
													  NULL,--nCantCons
													  NULL,--nCantAjus
													  NULL,--nAncho
													  NULL,--nFACTOR_CONVERSION_M2_KG
													  NULL,--nPrecio_ML_E
													  NULL,--vLog_Precio
													  NULL,--nMermEnhe_E
													  NULL,--nMermEnhe
													  NULL,--nMermAjus_E
													  NULL,--nMermAjus
													  NULL,--nMermCabo_E
													  NULL,--nMermCabo
													  NULL,--nMermPico_E
													  NVL(rMERMA.Merma_M1,0),--nMermPico
                                         NULL,--nMermTita
                                         NULL,--nMermSane
                                         NULL,--nCantCons_Bobinas
                                         --
                                          NULL, --nCONTFSMU_01 
                                          NULL, --nCANTFSMU_01 
                                          NULL, --nCATOFSMU 
                                          NULL, --nCONTFSMU_02 
                                          NULL, --nCANTFSMU_02 
                                          NULL, --nCONTFSMU_03 
                                          NULL, --nCANTFSMU_03 
                                          NULL, --nCONTFSMU_04 
                                          NULL, --nCANTFSMU_04 
                                          NULL, --nCONTFSMU_05 
                                          NULL, --nCANTFSMU_05 
                                          NULL, --nCONTFSMU_06 
                                          NULL, --nCANTFSMU_06 
                                          NULL, --nCONTFSMU_07 
                                          NULL, --nCANTFSMU_07 
                                          NULL, --nCONTFSMU_08 
                                          NULL, --nCANTFSMU_08 
                                          NULL, --nCONTFSMU_09 
                                          NULL, --nCANTFSMU_09 
                                          NULL, --nCONTFSMU_10 
                                          NULL, --nCANTFSMU_10 
                                          NULL, --nANCHO_BUENO_TOTAL_01 
                                          NULL, --nANCHO_BUENO_OT_01 
                                          NULL, --nANCHO_BUENO_TOTAL_02 
                                          NULL, --nANCHO_BUENO_OT_02 
                                          NULL, --nANCHO_BUENO_TOTAL_03 
                                          NULL, --nANCHO_BUENO_OT_03 
                                          NULL, --nANCHO_BUENO_TOTAL_04 
                                          NULL, --nANCHO_BUENO_OT_04 
                                          NULL, --nANCHO_BUENO_TOTAL_05 
                                          NULL, --nANCHO_BUENO_OT_05 
                                          NULL, --nANCHO_BUENO_TOTAL_06 
                                          NULL, --nANCHO_BUENO_OT_06 
                                          NULL, --nANCHO_BUENO_TOTAL_07 
                                          NULL, --nANCHO_BUENO_OT_07 
                                          NULL, --nANCHO_BUENO_TOTAL_08 
                                          NULL, --nANCHO_BUENO_OT_08 
                                          NULL, --nANCHO_BUENO_TOTAL_09 
                                          NULL, --nANCHO_BUENO_OT_09 
                                          NULL, --nANCHO_BUENO_TOTAL_10 
                                          NULL, --nANCHO_BUENO_OT_10 
                                          NULL, --nANCHO_BUENO_TOTAL 
                                          NULL, --nANCHO_BUENO_OT 
                                          NULL, --nNUMECORT 
                                          NULL, --nMM_MERMPRCO_01 
                                          NULL, --nMM_MERMPLAN_EXESO_01 
                                          NULL, --nMM_MERMPLAN_01 
                                          NULL, --nMM_MERMPRCO_02 
                                          NULL, --nMM_MERMPLAN_EXESO_02 
                                          NULL, --nMM_MERMPLAN_02 
                                          NULL, --nMM_MERMPRCO_03 
                                          NULL, --nMM_MERMPLAN_EXESO_03 
                                          NULL, --nMM_MERMPLAN_03 
                                          NULL, --nMM_MERMPRCO_04 
                                          NULL, --nMM_MERMPLAN_EXESO_04 
                                          NULL, --nMM_MERMPLAN_04 
                                          NULL, --nMM_MERMPRCO_05 
                                          NULL, --nMM_MERMPLAN_EXESO_05 
                                          NULL, --nMM_MERMPLAN_05 
                                          NULL, --nMM_MERMPRCO_06 
                                          NULL, --nMM_MERMPLAN_EXESO_06 
                                          NULL, --nMM_MERMPLAN_06 
                                          NULL, --nMM_MERMPRCO_07 
                                          NULL, --nMM_MERMPLAN_EXESO_07 
                                          NULL, --nMM_MERMPLAN_07 
                                          NULL, --nMM_MERMPRCO_08 
                                          NULL, --nMM_MERMPLAN_EXESO_08 
                                          NULL, --nMM_MERMPLAN_08 
                                          NULL, --nMM_MERMPRCO_09 
                                          NULL, --nMM_MERMPLAN_EXESO_09 
                                          NULL, --nMM_MERMPLAN_09 
                                          NULL, --nMM_MERMPRCO_10 
                                          NULL, --nMM_MERMPLAN_EXESO_10 
                                          NULL, --nMM_MERMPLAN_10 
                                          NULL, --nMM_MERMPRCO 
                                          NULL, --nMM_MERMPLAN_EXESO 
                                          NULL); --nMM_MERMPLAN
										--t_MATERIAL(rMATERIAL_B1R.IDENTIFICADOR).MermPico := NVL(t_MATERIAL(rMATERIAL_B1R.IDENTIFICADOR).MermPico,0) + NVL(rMERMA.Merma_M1,0);
                              --Actualización de Precio de MP
                              IF rMERMA.Tip_Arti IN (vTiarMpF4,vTiarSeF4,vP_TiarFiF4) THEN--AND t_MATERIAL(rMATERIAL_B1R.IDENTIFICADOR).Precio_ML IS NULL THEN --Si es Materia Prima
                                 vLogPreci := NULL;
                                 vPrecio := F_PRECIO(vEmpresa, nNumeOtre, 
																	  rMERMA.Tip_Arti, rMERMA.Cod_Arti, rMERMA.Lote,
																	  NULL, NULL, NULL, NULL);
											--
											P_MATERIAL(rMATERIAL_B1R,'U',
														  NULL,--nCantProd
														  NULL,--nCantCons_E
														  NULL,--nCantCons
														  NULL,--nCantAjus
														  NULL,--nAncho
														  NULL,--nFACTOR_CONVERSION_M2_KG
														  NULL,--nPrecio_ML_E
														  vPrecio,--vLog_Precio
														  NULL,--nMermEnhe_E
														  NULL,--nMermEnhe
														  NULL,--nMermAjus_E
														  NULL,--nMermAjus
														  NULL,--nMermCabo_E
														  NULL,--nMermCabo
														  NULL,--nMermPico_E
														  NULL,--nMermPico
                                            NULL,--nMermTita
                                            NULL,--nMermSane
                                            NULL,--nCantCons_Bobinas
                                            --
                                             NULL, --nCONTFSMU_01 
                                             NULL, --nCANTFSMU_01 
                                             NULL, --nCATOFSMU 
                                             NULL, --nCONTFSMU_02 
                                             NULL, --nCANTFSMU_02 
                                             NULL, --nCONTFSMU_03 
                                             NULL, --nCANTFSMU_03 
                                             NULL, --nCONTFSMU_04 
                                             NULL, --nCANTFSMU_04 
                                             NULL, --nCONTFSMU_05 
                                             NULL, --nCANTFSMU_05 
                                             NULL, --nCONTFSMU_06 
                                             NULL, --nCANTFSMU_06 
                                             NULL, --nCONTFSMU_07 
                                             NULL, --nCANTFSMU_07 
                                             NULL, --nCONTFSMU_08 
                                             NULL, --nCANTFSMU_08 
                                             NULL, --nCONTFSMU_09 
                                             NULL, --nCANTFSMU_09 
                                             NULL, --nCONTFSMU_10 
                                             NULL, --nCANTFSMU_10 
                                             NULL, --nANCHO_BUENO_TOTAL_01 
                                             NULL, --nANCHO_BUENO_OT_01 
                                             NULL, --nANCHO_BUENO_TOTAL_02 
                                             NULL, --nANCHO_BUENO_OT_02 
                                             NULL, --nANCHO_BUENO_TOTAL_03 
                                             NULL, --nANCHO_BUENO_OT_03 
                                             NULL, --nANCHO_BUENO_TOTAL_04 
                                             NULL, --nANCHO_BUENO_OT_04 
                                             NULL, --nANCHO_BUENO_TOTAL_05 
                                             NULL, --nANCHO_BUENO_OT_05 
                                             NULL, --nANCHO_BUENO_TOTAL_06 
                                             NULL, --nANCHO_BUENO_OT_06 
                                             NULL, --nANCHO_BUENO_TOTAL_07 
                                             NULL, --nANCHO_BUENO_OT_07 
                                             NULL, --nANCHO_BUENO_TOTAL_08 
                                             NULL, --nANCHO_BUENO_OT_08 
                                             NULL, --nANCHO_BUENO_TOTAL_09 
                                             NULL, --nANCHO_BUENO_OT_09 
                                             NULL, --nANCHO_BUENO_TOTAL_10 
                                             NULL, --nANCHO_BUENO_OT_10 
                                             NULL, --nANCHO_BUENO_TOTAL 
                                             NULL, --nANCHO_BUENO_OT 
                                             NULL, --nNUMECORT 
                                             NULL, --nMM_MERMPRCO_01 
                                             NULL, --nMM_MERMPLAN_EXESO_01 
                                             NULL, --nMM_MERMPLAN_01 
                                             NULL, --nMM_MERMPRCO_02 
                                             NULL, --nMM_MERMPLAN_EXESO_02 
                                             NULL, --nMM_MERMPLAN_02 
                                             NULL, --nMM_MERMPRCO_03 
                                             NULL, --nMM_MERMPLAN_EXESO_03 
                                             NULL, --nMM_MERMPLAN_03 
                                             NULL, --nMM_MERMPRCO_04 
                                             NULL, --nMM_MERMPLAN_EXESO_04 
                                             NULL, --nMM_MERMPLAN_04 
                                             NULL, --nMM_MERMPRCO_05 
                                             NULL, --nMM_MERMPLAN_EXESO_05 
                                             NULL, --nMM_MERMPLAN_05 
                                             NULL, --nMM_MERMPRCO_06 
                                             NULL, --nMM_MERMPLAN_EXESO_06 
                                             NULL, --nMM_MERMPLAN_06 
                                             NULL, --nMM_MERMPRCO_07 
                                             NULL, --nMM_MERMPLAN_EXESO_07 
                                             NULL, --nMM_MERMPLAN_07 
                                             NULL, --nMM_MERMPRCO_08 
                                             NULL, --nMM_MERMPLAN_EXESO_08 
                                             NULL, --nMM_MERMPLAN_08 
                                             NULL, --nMM_MERMPRCO_09 
                                             NULL, --nMM_MERMPLAN_EXESO_09 
                                             NULL, --nMM_MERMPLAN_09 
                                             NULL, --nMM_MERMPRCO_10 
                                             NULL, --nMM_MERMPLAN_EXESO_10 
                                             NULL, --nMM_MERMPLAN_10 
                                             NULL, --nMM_MERMPRCO 
                                             NULL, --nMM_MERMPLAN_EXESO 
                                             NULL); --nMM_MERMPLAN
											--t_MATERIAL(rMATERIAL_B1R.IDENTIFICADOR).Precio_ML := F_PRECIO(vEmpresa, nNumeOtre, 
                                 --                                                              rMERMA.Tip_Arti, rMERMA.Cod_Arti, rMERMA.Lote,
                                 --                                                              NULL, NULL, NULL, NULL);
                                 --t_MATERIAL(rMATERIAL_B1R.IDENTIFICADOR).Precio_ML_E := F_PRECIO_E(vEmpresa, nNumeOtre, 
                                 --                                                                  rMERMA.Tip_Arti, rMERMA.Cod_Arti, rMERMA.Lote,
                                 --                                                                  NULL, NULL, NULL, NULL);
                              END IF;
--ELSE dbms_output.put_line('26 IDENTIFICADOR IS NULL ');
									END IF;
                           --
                           IF rMATERIAL_B2R.IDENTIFICADOR IS NOT NULL THEN
                              P_MATERIAL(rMATERIAL_B2R,'U',
													  NULL,--nCantProd
													  NULL,--nCantCons_E
													  NULL,--nCantCons
													  NULL,--nCantAjus
													  NULL,--nAncho
													  NULL,--nFACTOR_CONVERSION_M2_KG
													  NULL,--nPrecio_ML_E
													  NULL,--vLog_Precio
													  NULL,--nMermEnhe_E
													  NULL,--nMermEnhe
													  NULL,--nMermAjus_E
													  NULL,--nMermAjus
													  NULL,--nMermCabo_E
													  NULL,--nMermCabo
													  NULL,--nMermPico_E
													  NVL(rMERMA.Merma_M2,0),--nMermPico
                                         NULL,--nMermTita
                                         NULL,--nMermSane
                                         NULL,--nCantCons_Bobinas
                                         --
                                          NULL, --nCONTFSMU_01 
                                          NULL, --nCANTFSMU_01 
                                          NULL, --nCATOFSMU 
                                          NULL, --nCONTFSMU_02 
                                          NULL, --nCANTFSMU_02 
                                          NULL, --nCONTFSMU_03 
                                          NULL, --nCANTFSMU_03 
                                          NULL, --nCONTFSMU_04 
                                          NULL, --nCANTFSMU_04 
                                          NULL, --nCONTFSMU_05 
                                          NULL, --nCANTFSMU_05 
                                          NULL, --nCONTFSMU_06 
                                          NULL, --nCANTFSMU_06 
                                          NULL, --nCONTFSMU_07 
                                          NULL, --nCANTFSMU_07 
                                          NULL, --nCONTFSMU_08 
                                          NULL, --nCANTFSMU_08 
                                          NULL, --nCONTFSMU_09 
                                          NULL, --nCANTFSMU_09 
                                          NULL, --nCONTFSMU_10 
                                          NULL, --nCANTFSMU_10 
                                          NULL, --nANCHO_BUENO_TOTAL_01 
                                          NULL, --nANCHO_BUENO_OT_01 
                                          NULL, --nANCHO_BUENO_TOTAL_02 
                                          NULL, --nANCHO_BUENO_OT_02 
                                          NULL, --nANCHO_BUENO_TOTAL_03 
                                          NULL, --nANCHO_BUENO_OT_03 
                                          NULL, --nANCHO_BUENO_TOTAL_04 
                                          NULL, --nANCHO_BUENO_OT_04 
                                          NULL, --nANCHO_BUENO_TOTAL_05 
                                          NULL, --nANCHO_BUENO_OT_05 
                                          NULL, --nANCHO_BUENO_TOTAL_06 
                                          NULL, --nANCHO_BUENO_OT_06 
                                          NULL, --nANCHO_BUENO_TOTAL_07 
                                          NULL, --nANCHO_BUENO_OT_07 
                                          NULL, --nANCHO_BUENO_TOTAL_08 
                                          NULL, --nANCHO_BUENO_OT_08 
                                          NULL, --nANCHO_BUENO_TOTAL_09 
                                          NULL, --nANCHO_BUENO_OT_09 
                                          NULL, --nANCHO_BUENO_TOTAL_10 
                                          NULL, --nANCHO_BUENO_OT_10 
                                          NULL, --nANCHO_BUENO_TOTAL 
                                          NULL, --nANCHO_BUENO_OT 
                                          NULL, --nNUMECORT 
                                          NULL, --nMM_MERMPRCO_01 
                                          NULL, --nMM_MERMPLAN_EXESO_01 
                                          NULL, --nMM_MERMPLAN_01 
                                          NULL, --nMM_MERMPRCO_02 
                                          NULL, --nMM_MERMPLAN_EXESO_02 
                                          NULL, --nMM_MERMPLAN_02 
                                          NULL, --nMM_MERMPRCO_03 
                                          NULL, --nMM_MERMPLAN_EXESO_03 
                                          NULL, --nMM_MERMPLAN_03 
                                          NULL, --nMM_MERMPRCO_04 
                                          NULL, --nMM_MERMPLAN_EXESO_04 
                                          NULL, --nMM_MERMPLAN_04 
                                          NULL, --nMM_MERMPRCO_05 
                                          NULL, --nMM_MERMPLAN_EXESO_05 
                                          NULL, --nMM_MERMPLAN_05 
                                          NULL, --nMM_MERMPRCO_06 
                                          NULL, --nMM_MERMPLAN_EXESO_06 
                                          NULL, --nMM_MERMPLAN_06 
                                          NULL, --nMM_MERMPRCO_07 
                                          NULL, --nMM_MERMPLAN_EXESO_07 
                                          NULL, --nMM_MERMPLAN_07 
                                          NULL, --nMM_MERMPRCO_08 
                                          NULL, --nMM_MERMPLAN_EXESO_08 
                                          NULL, --nMM_MERMPLAN_08 
                                          NULL, --nMM_MERMPRCO_09 
                                          NULL, --nMM_MERMPLAN_EXESO_09 
                                          NULL, --nMM_MERMPLAN_09 
                                          NULL, --nMM_MERMPRCO_10 
                                          NULL, --nMM_MERMPLAN_EXESO_10 
                                          NULL, --nMM_MERMPLAN_10 
                                          NULL, --nMM_MERMPRCO 
                                          NULL, --nMM_MERMPLAN_EXESO 
                                          NULL); --nMM_MERMPLAN
										--t_MATERIAL(rMATERIAL_B2R.IDENTIFICADOR).MermPico := NVL(t_MATERIAL(rMATERIAL_B2R.IDENTIFICADOR).MermPico,0) + NVL(rMERMA.Merma_M2,0);
                              --Actualización de Precio de MP
                              IF rMERMA.Tip_Arti2 IN (vTiarMpF4,vTiarSeF4,vP_TiarFiF4) THEN--AND t_MATERIAL(rMATERIAL_B2R.IDENTIFICADOR).Precio_ML IS NULL THEN --Si es Materia Prima
                                 vLogPreci := NULL;
                                 vPrecio := F_PRECIO(vEmpresa, nNumeOtre, 
																	  rMERMA.Tip_Arti2, rMERMA.Cod_Arti2, rMERMA.Lote2,
																	  NULL, NULL, NULL, NULL);
											--
											P_MATERIAL(rMATERIAL_B2R,'U',
														  NULL,--nCantProd
														  NULL,--nCantCons_E
														  NULL,--nCantCons
														  NULL,--nCantAjus
														  NULL,--nAncho
														  NULL,--nFACTOR_CONVERSION_M2_KG
														  NULL,--nPrecio_ML_E
														  vPrecio,--vLog_Precio
														  NULL,--nMermEnhe_E
														  NULL,--nMermEnhe
														  NULL,--nMermAjus_E
														  NULL,--nMermAjus
														  NULL,--nMermCabo_E
														  NULL,--nMermCabo
														  NULL,--nMermPico_E
														  NULL,--nMermPico
                                            NULL,--nMermTita
                                            NULL,--nMermSane
                                            NULL,--nCantCons_Bobinas
                                            --
                                             NULL, --nCONTFSMU_01 
                                             NULL, --nCANTFSMU_01 
                                             NULL, --nCATOFSMU 
                                             NULL, --nCONTFSMU_02 
                                             NULL, --nCANTFSMU_02 
                                             NULL, --nCONTFSMU_03 
                                             NULL, --nCANTFSMU_03 
                                             NULL, --nCONTFSMU_04 
                                             NULL, --nCANTFSMU_04 
                                             NULL, --nCONTFSMU_05 
                                             NULL, --nCANTFSMU_05 
                                             NULL, --nCONTFSMU_06 
                                             NULL, --nCANTFSMU_06 
                                             NULL, --nCONTFSMU_07 
                                             NULL, --nCANTFSMU_07 
                                             NULL, --nCONTFSMU_08 
                                             NULL, --nCANTFSMU_08 
                                             NULL, --nCONTFSMU_09 
                                             NULL, --nCANTFSMU_09 
                                             NULL, --nCONTFSMU_10 
                                             NULL, --nCANTFSMU_10 
                                             NULL, --nANCHO_BUENO_TOTAL_01 
                                             NULL, --nANCHO_BUENO_OT_01 
                                             NULL, --nANCHO_BUENO_TOTAL_02 
                                             NULL, --nANCHO_BUENO_OT_02 
                                             NULL, --nANCHO_BUENO_TOTAL_03 
                                             NULL, --nANCHO_BUENO_OT_03 
                                             NULL, --nANCHO_BUENO_TOTAL_04 
                                             NULL, --nANCHO_BUENO_OT_04 
                                             NULL, --nANCHO_BUENO_TOTAL_05 
                                             NULL, --nANCHO_BUENO_OT_05 
                                             NULL, --nANCHO_BUENO_TOTAL_06 
                                             NULL, --nANCHO_BUENO_OT_06 
                                             NULL, --nANCHO_BUENO_TOTAL_07 
                                             NULL, --nANCHO_BUENO_OT_07 
                                             NULL, --nANCHO_BUENO_TOTAL_08 
                                             NULL, --nANCHO_BUENO_OT_08 
                                             NULL, --nANCHO_BUENO_TOTAL_09 
                                             NULL, --nANCHO_BUENO_OT_09 
                                             NULL, --nANCHO_BUENO_TOTAL_10 
                                             NULL, --nANCHO_BUENO_OT_10 
                                             NULL, --nANCHO_BUENO_TOTAL 
                                             NULL, --nANCHO_BUENO_OT 
                                             NULL, --nNUMECORT 
                                             NULL, --nMM_MERMPRCO_01 
                                             NULL, --nMM_MERMPLAN_EXESO_01 
                                             NULL, --nMM_MERMPLAN_01 
                                             NULL, --nMM_MERMPRCO_02 
                                             NULL, --nMM_MERMPLAN_EXESO_02 
                                             NULL, --nMM_MERMPLAN_02 
                                             NULL, --nMM_MERMPRCO_03 
                                             NULL, --nMM_MERMPLAN_EXESO_03 
                                             NULL, --nMM_MERMPLAN_03 
                                             NULL, --nMM_MERMPRCO_04 
                                             NULL, --nMM_MERMPLAN_EXESO_04 
                                             NULL, --nMM_MERMPLAN_04 
                                             NULL, --nMM_MERMPRCO_05 
                                             NULL, --nMM_MERMPLAN_EXESO_05 
                                             NULL, --nMM_MERMPLAN_05 
                                             NULL, --nMM_MERMPRCO_06 
                                             NULL, --nMM_MERMPLAN_EXESO_06 
                                             NULL, --nMM_MERMPLAN_06 
                                             NULL, --nMM_MERMPRCO_07 
                                             NULL, --nMM_MERMPLAN_EXESO_07 
                                             NULL, --nMM_MERMPLAN_07 
                                             NULL, --nMM_MERMPRCO_08 
                                             NULL, --nMM_MERMPLAN_EXESO_08 
                                             NULL, --nMM_MERMPLAN_08 
                                             NULL, --nMM_MERMPRCO_09 
                                             NULL, --nMM_MERMPLAN_EXESO_09 
                                             NULL, --nMM_MERMPLAN_09 
                                             NULL, --nMM_MERMPRCO_10 
                                             NULL, --nMM_MERMPLAN_EXESO_10 
                                             NULL, --nMM_MERMPLAN_10 
                                             NULL, --nMM_MERMPRCO 
                                             NULL, --nMM_MERMPLAN_EXESO 
                                             NULL); --nMM_MERMPLAN
											--t_MATERIAL(rMATERIAL_B2R.IDENTIFICADOR).Precio_ML := F_PRECIO(vEmpresa, nNumeOtre, 
                                 --                                                              rMERMA.Tip_Arti2, rMERMA.Cod_Arti2, rMERMA.Lote2,
                                 --                                                              NULL, NULL, NULL, NULL);
                                 --t_MATERIAL(rMATERIAL_B2R.IDENTIFICADOR).Precio_ML_E := F_PRECIO_E(vEmpresa, nNumeOtre, 
                                 --                                                                  rMERMA.Tip_Arti2, rMERMA.Cod_Arti2, rMERMA.Lote2,
                                 --                                                                  NULL, NULL, NULL, NULL);
                              END IF;
--ELSE dbms_output.put_line('27 IDENTIFICADOR IS NULL(2) ');
									END IF;
                        END LOOP;
                     END IF;
                  END LOOP;
               END IF;
            END LOOP;
         END IF;
         --dbms_output.put_line('   MERMA ENHEBRADO->M1  ='||nMerma_Enhebrado_M1||  ' M2='||nMerma_Enhebrado_M2  ||' MERMA AJUSTE->M1  ='||nMerma_Ajuste_M1  ||' M2='||nMerma_Ajuste_M2  ||' CAMBIO BOBINA->M1=   '||nMerma_CambBobi_M1  ||' M2= '||nMerma_CambBobi_M2  ||' PICOS->M1  = '||nMerma_Picos_M1  ||' M2= '||nMerma_Picos_M2);
         --dbms_output.put_line('   MERMA ENHEBRADO_E->M1='||nMerma_Enhebrado_M1_E||' M2='||nMerma_Enhebrado_M2_E||' MERMA AJUSTE_E->M1='||nMerma_Ajuste_M1_E||' M2='||nMerma_Ajuste_M2_E||' CAMBIO BOBINA_E->M1= '||nMerma_CambBobi_M1_E||' M2= '||nMerma_CambBobi_M2_E||' PICOS_E->M1= '||nMerma_Picos_M1_E||' M2= '||nMerma_Picos_M2_E);
      END LOOP;
		--Se Establecen precios para productos sin el mismo
		FOR rANE_MER_MATERIAL_OT_SP IN cANE_MER_MATERIAL_OT_SP LOOP
--dbms_output.put_line('No encuentra precio: '||rMaterial_B1R.Tip_Arti||'-'||rMaterial_B1R.Cod_Arti||'-'||rMaterial_B1R.LOTE);
         rMaterial_B1R.Tip_Arti := rANE_MER_MATERIAL_OT_SP.Tip_Arti;
         rMaterial_B1R.Cod_Arti := rANE_MER_MATERIAL_OT_SP.Cod_Arti;
         rMaterial_B1R.LOTE := rANE_MER_MATERIAL_OT_SP.LOTE;
         rMaterial_B1R.IDENTIFICADOR := rANE_MER_MATERIAL_OT_SP.IDENTIFICADOR;
			--Actualización de Precio de MP
         IF rMaterial_B1R.Tip_Arti NOT IN (vTiarMpF4,vTiarSeF4,vP_TiarFiF4) THEN  --Se trata de una Bobina Generada
				IF rANE_MER_MATERIAL_OT_SP.PRECIO_ML IS NULL THEN
	--dbms_output.put_line('Buscar precio por metodo 1');
					vLogPreci := NULL;
					vPrecio := F_PRECIO(vEmpresa, nNumeOtre, 
											  rMaterial_B1R.Tip_Arti, rMaterial_B1R.Cod_Arti, '|EMPRBOBI:'||P_Utilidad.f_ValoCampo(rMaterial_B1R.LOTE,'EMPRBOBI')||'|NUOTBOBI:'||P_Utilidad.f_ValoCampo(rMaterial_B1R.LOTE,'NUOTBOBI')||'|CONTBOBI:'||P_Utilidad.f_ValoCampo(rMaterial_B1R.LOTE,'CONTBOBI')||'|COBOBOBI:'||P_Utilidad.f_ValoCampo(rMaterial_B1R.LOTE,'COBOBOBI')||'|LOTE:'||P_Utilidad.f_ValoCampo(rMaterial_B1R.LOTE,'LOTE'),
											  NULL, NULL, NULL, NULL);
					--
	--dbms_output.put_line('vPrecio:'||vPrecio);
					P_MATERIAL(rMaterial_B1R,'U',
								  NULL,--nCantProd
								  NULL,--nCantCons_E
								  NULL,--nCantCons
								  NULL,--nCantAjus
								  NULL,--nAncho
								  NULL,--nFACTOR_CONVERSION_M2_KG
								  NULL,--nPrecio_ML_E
								  vPrecio,--vLog_Precio
								  NULL,--nMermEnhe_E
								  NULL,--nMermEnhe
								  NULL,--nMermAjus_E
								  NULL,--nMermAjus
								  NULL,--nMermCabo_E
								  NULL,--nMermCabo
								  NULL,--nMermPico_E
								  NULL,--nMermPico
                          NULL,--nMermTita
                          NULL,--nMermSane
                          NULL,--nCantCons_Bobinas
                          --
                           NULL, --nCONTFSMU_01 
                           NULL, --nCANTFSMU_01 
                           NULL, --nCATOFSMU 
                           NULL, --nCONTFSMU_02 
                           NULL, --nCANTFSMU_02 
                           NULL, --nCONTFSMU_03 
                           NULL, --nCANTFSMU_03 
                           NULL, --nCONTFSMU_04 
                           NULL, --nCANTFSMU_04 
                           NULL, --nCONTFSMU_05 
                           NULL, --nCANTFSMU_05 
                           NULL, --nCONTFSMU_06 
                           NULL, --nCANTFSMU_06 
                           NULL, --nCONTFSMU_07 
                           NULL, --nCANTFSMU_07 
                           NULL, --nCONTFSMU_08 
                           NULL, --nCANTFSMU_08 
                           NULL, --nCONTFSMU_09 
                           NULL, --nCANTFSMU_09 
                           NULL, --nCONTFSMU_10 
                           NULL, --nCANTFSMU_10 
                           NULL, --nANCHO_BUENO_TOTAL_01 
                           NULL, --nANCHO_BUENO_OT_01 
                           NULL, --nANCHO_BUENO_TOTAL_02 
                           NULL, --nANCHO_BUENO_OT_02 
                           NULL, --nANCHO_BUENO_TOTAL_03 
                           NULL, --nANCHO_BUENO_OT_03 
                           NULL, --nANCHO_BUENO_TOTAL_04 
                           NULL, --nANCHO_BUENO_OT_04 
                           NULL, --nANCHO_BUENO_TOTAL_05 
                           NULL, --nANCHO_BUENO_OT_05 
                           NULL, --nANCHO_BUENO_TOTAL_06 
                           NULL, --nANCHO_BUENO_OT_06 
                           NULL, --nANCHO_BUENO_TOTAL_07 
                           NULL, --nANCHO_BUENO_OT_07 
                           NULL, --nANCHO_BUENO_TOTAL_08 
                           NULL, --nANCHO_BUENO_OT_08 
                           NULL, --nANCHO_BUENO_TOTAL_09 
                           NULL, --nANCHO_BUENO_OT_09 
                           NULL, --nANCHO_BUENO_TOTAL_10 
                           NULL, --nANCHO_BUENO_OT_10 
                           NULL, --nANCHO_BUENO_TOTAL 
                           NULL, --nANCHO_BUENO_OT 
                           NULL, --nNUMECORT 
                           NULL, --nMM_MERMPRCO_01 
                           NULL, --nMM_MERMPLAN_EXESO_01 
                           NULL, --nMM_MERMPLAN_01 
                           NULL, --nMM_MERMPRCO_02 
                           NULL, --nMM_MERMPLAN_EXESO_02 
                           NULL, --nMM_MERMPLAN_02 
                           NULL, --nMM_MERMPRCO_03 
                           NULL, --nMM_MERMPLAN_EXESO_03 
                           NULL, --nMM_MERMPLAN_03 
                           NULL, --nMM_MERMPRCO_04 
                           NULL, --nMM_MERMPLAN_EXESO_04 
                           NULL, --nMM_MERMPLAN_04 
                           NULL, --nMM_MERMPRCO_05 
                           NULL, --nMM_MERMPLAN_EXESO_05 
                           NULL, --nMM_MERMPLAN_05 
                           NULL, --nMM_MERMPRCO_06 
                           NULL, --nMM_MERMPLAN_EXESO_06 
                           NULL, --nMM_MERMPLAN_06 
                           NULL, --nMM_MERMPRCO_07 
                           NULL, --nMM_MERMPLAN_EXESO_07 
                           NULL, --nMM_MERMPLAN_07 
                           NULL, --nMM_MERMPRCO_08 
                           NULL, --nMM_MERMPLAN_EXESO_08 
                           NULL, --nMM_MERMPLAN_08 
                           NULL, --nMM_MERMPRCO_09 
                           NULL, --nMM_MERMPLAN_EXESO_09 
                           NULL, --nMM_MERMPLAN_09 
                           NULL, --nMM_MERMPRCO_10 
                           NULL, --nMM_MERMPLAN_EXESO_10 
                           NULL, --nMM_MERMPLAN_10 
                           NULL, --nMM_MERMPRCO 
                           NULL, --nMM_MERMPLAN_EXESO 
                           NULL); --nMM_MERMPLAN
					/*t_MATERIAL(rMATERIAL_B.IDENTIFICADOR).Precio_ML := F_PRECIO(vEmpresa, nNumeOtre, 
																									rMATERIAL_B.Tip_Arti, rMATERIAL_B.Cod_Arti, '|EMPRBOBI:'||P_Utilidad.f_ValoCampo(rMATERIAL_B.LOTE,'EMPRBOBI')||'|NUOTBOBI:'||P_Utilidad.f_ValoCampo(rMATERIAL_B.LOTE,'NUOTBOBI')||'|CONTBOBI:'||P_Utilidad.f_ValoCampo(rMATERIAL_B.LOTE,'CONTBOBI')||'|COBOBOBI:'||P_Utilidad.f_ValoCampo(rMATERIAL_B.LOTE,'COBOBOBI')||'|LOTE:'||P_Utilidad.f_ValoCampo(rMATERIAL_B.LOTE,'LOTE'),
																									NULL, NULL, NULL, NULL);
					t_MATERIAL(rMATERIAL_B.IDENTIFICADOR).Precio_ML_E := F_PRECIO_E(vEmpresa, nNumeOtre, 
																										 rMATERIAL_B.Tip_Arti, rMATERIAL_B.Cod_Arti, '|EMPRBOBI:'||P_Utilidad.f_ValoCampo(rMATERIAL_B.LOTE,'EMPRBOBI')||'|NUOTBOBI:'||P_Utilidad.f_ValoCampo(rMATERIAL_B.LOTE,'NUOTBOBI')||'|CONTBOBI:'||P_Utilidad.f_ValoCampo(rMATERIAL_B.LOTE,'CONTBOBI')||'|COBOBOBI:'||P_Utilidad.f_ValoCampo(rMATERIAL_B.LOTE,'COBOBOBI')||'|LOTE:'||P_Utilidad.f_ValoCampo(rMATERIAL_B.LOTE,'LOTE'),
																										 NULL, NULL, NULL, NULL);*/
				END IF;
				--
				IF rANE_MER_MATERIAL_OT_SP.ANCHO IS NULL THEN
					--Se busca la Bobina Utilizada
					rBOBIMAQU_U := F_BOBIMAQU(P_Utilidad.f_ValoCampo(rMaterial_B1R.LOTE,'EMPRBOBI'), P_Utilidad.f_ValoCampo(rMaterial_B1R.LOTE,'NUOTBOBI'), P_Utilidad.f_ValoCampo(rMaterial_B1R.LOTE,'CONTBOBI'), P_Utilidad.f_ValoCampo(rMaterial_B1R.LOTE,'COBOBOBI'));
					--
					IF NVL(rBOBIMAQU_U.ESTADO,'X') != 'X' THEN
						IF rBOBIMAQU_U.Ancho IS NULL AND vEmpresa||'-'||nNumeOtre != P_Utilidad.f_ValoCampo(rMaterial_B1R.LOTE,'EMPRBOBI')||'-'||P_Utilidad.f_ValoCampo(rMaterial_B1R.LOTE,'NUOTBOBI') THEN --Se calcula todo de la OT de la Bobina Utilizada, si no es de la misma Ot por que se entiende que si es de la misma Ot se calculara en Orden
							P_CONSUMO_MATERIALES(P_Utilidad.f_ValoCampo(rMaterial_B1R.LOTE,'EMPRBOBI'), P_Utilidad.f_ValoCampo(rMaterial_B1R.LOTE,'NUOTBOBI'));
							--Se busca la Bobina Utilizada con los Datos Actualizados
							rBOBIMAQU_U := F_BOBIMAQU(P_Utilidad.f_ValoCampo(rMaterial_B1R.LOTE,'EMPRBOBI'), P_Utilidad.f_ValoCampo(rMaterial_B1R.LOTE,'NUOTBOBI'), P_Utilidad.f_ValoCampo(rMaterial_B1R.LOTE,'CONTBOBI'), P_Utilidad.f_ValoCampo(rMaterial_B1R.LOTE,'COBOBOBI'));
						END IF;
					ELSE
						--647 No se encuentra @1. [Contador @1]
						P_ERRORES(vEmpresa, nNumeOtre, '647','la Bobina Utilizada '||P_Utilidad.f_ValoCampo(rMaterial_B1R.LOTE,'EMPRBOBI')||'-'||P_Utilidad.f_ValoCampo(rMaterial_B1R.LOTE,'NUOTBOBI')||'-'||P_Utilidad.f_ValoCampo(rMaterial_B1R.LOTE,'CONTBOBI')||'-'||P_Utilidad.f_ValoCampo(rMaterial_B1R.LOTE,'COBOBOBI')||'|9','R','E');
--dbms_output.put_line('Error 647: No se encuentra la Bobina Utilizada '||rConsumos.EmprBobi||'-'||rConsumos.NuotBobi||'-'||rConsumos.ContBobi||'-'||rConsumos.CoboBobi);
					END IF;
					--
					--IF rConsumos.ContMate = 1 THEN
						nAncho1 := rBOBIMAQU_U.ANCHO;
						nFCKG1 := rBOBIMAQU_U.FACTOR_CONVERSION_M2_KG;
					/*
					ELSE
						nAncho2 := rBOBIMAQU_U.ANCHO;
						nFCKG2 := rBOBIMAQU_U.FACTOR_CONVERSION_M2_KG;
					END IF;*/
--dbms_Output.put_line('FACTOR M2KG BOBINA: '||rConsumos.EmprBobi||'-'||rConsumos.NuotBobi||'-'||rConsumos.ContBobi||'-'||rConsumos.CoboBobi||'->'||rBOBIMAQU_U.FACTOR_CONVERSION_M2_KG);                  
					--
					IF NVL(rBOBIMAQU_U.FACTOR_CONVERSION_M2_KG,0) = 0 THEN
						--647 No se encuentra @1. [Contador @1]
						P_ERRORES(vEmpresa, nNumeOtre, '647','el Factor de Conversion de la Bobina Utilizada '||P_Utilidad.f_ValoCampo(rMaterial_B1R.LOTE,'EMPRBOBI')||'-'||P_Utilidad.f_ValoCampo(rMaterial_B1R.LOTE,'NUOTBOBI')||'-'||P_Utilidad.f_ValoCampo(rMaterial_B1R.LOTE,'CONTBOBI')||'-'||P_Utilidad.f_ValoCampo(rMaterial_B1R.LOTE,'COBOBOBI')||'|9.1','R','E');
					END IF;
				END IF;
			ELSE --Si es Materia Prima
				IF rANE_MER_MATERIAL_OT_SP.PRECIO_ML IS NULL THEN
--dbms_output.put_line('Buscar precio por metodo 2');
					vLogPreci := NULL;
					vPrecio := F_PRECIO(vEmpresa, nNumeOtre, 
											  rMaterial_B1R.Tip_Arti, rMaterial_B1R.Cod_Arti, rMaterial_B1R.Lote,
											  NULL, NULL, NULL, NULL);
					--
					P_MATERIAL(rMaterial_B1R,'U',
								  NULL,--nCantProd
								  NULL,--nCantCons_E
								  NULL,--nCantCons
								  NULL,--nCantAjus
								  NULL,--nAncho
								  NULL,--nFACTOR_CONVERSION_M2_KG
								  NULL,--nPrecio_ML_E
								  vPrecio,--vLog_Precio
								  NULL,--nMermEnhe_E
								  NULL,--nMermEnhe
								  NULL,--nMermAjus_E
								  NULL,--nMermAjus
								  NULL,--nMermCabo_E
								  NULL,--nMermCabo
								  NULL,--nMermPico_E
								  NULL,--nMermPico
                          NULL,--nMermTita
                          NULL,--nMermSane
                          NULL,--nCantCons_Bobinas
                          --
                           NULL, --nCONTFSMU_01 
                           NULL, --nCANTFSMU_01 
                           NULL, --nCATOFSMU 
                           NULL, --nCONTFSMU_02 
                           NULL, --nCANTFSMU_02 
                           NULL, --nCONTFSMU_03 
                           NULL, --nCANTFSMU_03 
                           NULL, --nCONTFSMU_04 
                           NULL, --nCANTFSMU_04 
                           NULL, --nCONTFSMU_05 
                           NULL, --nCANTFSMU_05 
                           NULL, --nCONTFSMU_06 
                           NULL, --nCANTFSMU_06 
                           NULL, --nCONTFSMU_07 
                           NULL, --nCANTFSMU_07 
                           NULL, --nCONTFSMU_08 
                           NULL, --nCANTFSMU_08 
                           NULL, --nCONTFSMU_09 
                           NULL, --nCANTFSMU_09 
                           NULL, --nCONTFSMU_10 
                           NULL, --nCANTFSMU_10 
                           NULL, --nANCHO_BUENO_TOTAL_01 
                           NULL, --nANCHO_BUENO_OT_01 
                           NULL, --nANCHO_BUENO_TOTAL_02 
                           NULL, --nANCHO_BUENO_OT_02 
                           NULL, --nANCHO_BUENO_TOTAL_03 
                           NULL, --nANCHO_BUENO_OT_03 
                           NULL, --nANCHO_BUENO_TOTAL_04 
                           NULL, --nANCHO_BUENO_OT_04 
                           NULL, --nANCHO_BUENO_TOTAL_05 
                           NULL, --nANCHO_BUENO_OT_05 
                           NULL, --nANCHO_BUENO_TOTAL_06 
                           NULL, --nANCHO_BUENO_OT_06 
                           NULL, --nANCHO_BUENO_TOTAL_07 
                           NULL, --nANCHO_BUENO_OT_07 
                           NULL, --nANCHO_BUENO_TOTAL_08 
                           NULL, --nANCHO_BUENO_OT_08 
                           NULL, --nANCHO_BUENO_TOTAL_09 
                           NULL, --nANCHO_BUENO_OT_09 
                           NULL, --nANCHO_BUENO_TOTAL_10 
                           NULL, --nANCHO_BUENO_OT_10 
                           NULL, --nANCHO_BUENO_TOTAL 
                           NULL, --nANCHO_BUENO_OT 
                           NULL, --nNUMECORT 
                           NULL, --nMM_MERMPRCO_01 
                           NULL, --nMM_MERMPLAN_EXESO_01 
                           NULL, --nMM_MERMPLAN_01 
                           NULL, --nMM_MERMPRCO_02 
                           NULL, --nMM_MERMPLAN_EXESO_02 
                           NULL, --nMM_MERMPLAN_02 
                           NULL, --nMM_MERMPRCO_03 
                           NULL, --nMM_MERMPLAN_EXESO_03 
                           NULL, --nMM_MERMPLAN_03 
                           NULL, --nMM_MERMPRCO_04 
                           NULL, --nMM_MERMPLAN_EXESO_04 
                           NULL, --nMM_MERMPLAN_04 
                           NULL, --nMM_MERMPRCO_05 
                           NULL, --nMM_MERMPLAN_EXESO_05 
                           NULL, --nMM_MERMPLAN_05 
                           NULL, --nMM_MERMPRCO_06 
                           NULL, --nMM_MERMPLAN_EXESO_06 
                           NULL, --nMM_MERMPLAN_06 
                           NULL, --nMM_MERMPRCO_07 
                           NULL, --nMM_MERMPLAN_EXESO_07 
                           NULL, --nMM_MERMPLAN_07 
                           NULL, --nMM_MERMPRCO_08 
                           NULL, --nMM_MERMPLAN_EXESO_08 
                           NULL, --nMM_MERMPLAN_08 
                           NULL, --nMM_MERMPRCO_09 
                           NULL, --nMM_MERMPLAN_EXESO_09 
                           NULL, --nMM_MERMPLAN_09 
                           NULL, --nMM_MERMPRCO_10 
                           NULL, --nMM_MERMPLAN_EXESO_10 
                           NULL, --nMM_MERMPLAN_10 
                           NULL, --nMM_MERMPRCO 
                           NULL, --nMM_MERMPLAN_EXESO 
                           NULL); --nMM_MERMPLAN
					/*t_MATERIAL(rMATERIAL_B.IDENTIFICADOR).Precio_ML := F_PRECIO(vEmpresa, nNumeOtre, 
																									rMATERIAL_B.Tip_Arti, rMATERIAL_B.Cod_Arti, rMATERIAL_B.Lote,
																									NULL, NULL, NULL, NULL);
					t_MATERIAL(rMATERIAL_B.IDENTIFICADOR).Precio_ML_E := F_PRECIO_E(vEmpresa, nNumeOtre, 
																										 rMATERIAL_B.Tip_Arti, rMATERIAL_B.Cod_Arti, rMATERIAL_B.Lote,
																										 NULL, NULL, NULL, NULL);*/
				END IF;
				--
				IF rANE_MER_MATERIAL_OT_SP.ANCHO IS NULL OR rANE_MER_MATERIAL_OT_SP.FACTOR_CONVERSION_M2_KG IS NULL THEN
					rArticulo.ANCHO := NULL;
					rArticulo.COD_LFS := NULL;
					rArticulo.UNIDSTOC := NULL;
					rArticulo.FCKG := NULL;
					--
					OPEN cArticulo(vEmpresa, rMaterial_B1R.Tip_Arti, rMaterial_B1R.Cod_Arti, P_Utilidad.f_ValoCampo(rANE_MER_MATERIAL_OT_SP.LOTE,'LOTE'));--3132
					FETCH cArticulo INTO rArticulo;
					CLOSE cArticulo;
--dbms_output.put_line('BUS ANCH:'||rConsumos.EmprBobi||', '||rConsumos.Tip_Arti||', '||rConsumos.Cod_Arti||' ANCHO->'||rArticulo.ANCHO);                                 
					--
					nAncho1 := rArticulo.ANCHO;
					nFCKG1 := rArticulo.FCKG;
--dbms_Output.put_line('FACTOR M2KG MATERIAL: '||rArticulo.FCKG);
					--
					IF NVL(rArticulo.FCKG,0) = 0 THEN
						IF vMaprPrCl = 'N' THEN
							--647 No se encuentra @1. [Contador @1]
							P_ERRORES(vEmpresa, nNumeOtre, '647','el Factor de Conversion del Material '||vEmpresa||'-'||rMaterial_B1R.Tip_Arti||'-'||rMaterial_B1R.Cod_Arti||'|8.1','R','E');
						ELSE
							--647 No se encuentra @1. [Contador @1]
							P_ERRORES(vEmpresa, nNumeOtre, '647','el Factor de Conversion del Material (Material Propiedad del Cliente) '||vEmpresa||'-'||rMaterial_B1R.Tip_Arti||'-'||rMaterial_B1R.Cod_Arti||'|8.2','R','A');
					  END IF;
					END IF;
				END IF;
			END IF;
--
			IF rANE_MER_MATERIAL_OT_SP.ANCHO IS NULL THEN
					P_MATERIAL(rMaterial_B1R,'U',
					           NULL,--nCantProd
								  NULL,--nCantCons_E
								  NULL,--nCantCons
								  NULL,--nCantAjus
								  nAncho1,--nAncho
								  NULL,--nFACTOR_CONVERSION_M2_KG 
								  NULL,--nPrecio_ML_E
								  NULL,--vLog_Precio
								  NULL,--nMermEnhe_E
								  NULL,--nMermEnhe
								  NULL,--nMermAjus_E
								  NULL,--nMermAjus
								  NULL,--nMermCabo_E
								  NULL,--nMermCabo
								  NULL,--nMermPico_E
								  NULL,--nMermPico
                          NULL,--nMermTita
                          NULL,--nMermSane
                          NULL,--nCantCons_Bobinas
                          --
                           NULL, --nCONTFSMU_01 
                           NULL, --nCANTFSMU_01 
                           NULL, --nCATOFSMU 
                           NULL, --nCONTFSMU_02 
                           NULL, --nCANTFSMU_02 
                           NULL, --nCONTFSMU_03 
                           NULL, --nCANTFSMU_03 
                           NULL, --nCONTFSMU_04 
                           NULL, --nCANTFSMU_04 
                           NULL, --nCONTFSMU_05 
                           NULL, --nCANTFSMU_05 
                           NULL, --nCONTFSMU_06 
                           NULL, --nCANTFSMU_06 
                           NULL, --nCONTFSMU_07 
                           NULL, --nCANTFSMU_07 
                           NULL, --nCONTFSMU_08 
                           NULL, --nCANTFSMU_08 
                           NULL, --nCONTFSMU_09 
                           NULL, --nCANTFSMU_09 
                           NULL, --nCONTFSMU_10 
                           NULL, --nCANTFSMU_10 
                           NULL, --nANCHO_BUENO_TOTAL_01 
                           NULL, --nANCHO_BUENO_OT_01 
                           NULL, --nANCHO_BUENO_TOTAL_02 
                           NULL, --nANCHO_BUENO_OT_02 
                           NULL, --nANCHO_BUENO_TOTAL_03 
                           NULL, --nANCHO_BUENO_OT_03 
                           NULL, --nANCHO_BUENO_TOTAL_04 
                           NULL, --nANCHO_BUENO_OT_04 
                           NULL, --nANCHO_BUENO_TOTAL_05 
                           NULL, --nANCHO_BUENO_OT_05 
                           NULL, --nANCHO_BUENO_TOTAL_06 
                           NULL, --nANCHO_BUENO_OT_06 
                           NULL, --nANCHO_BUENO_TOTAL_07 
                           NULL, --nANCHO_BUENO_OT_07 
                           NULL, --nANCHO_BUENO_TOTAL_08 
                           NULL, --nANCHO_BUENO_OT_08 
                           NULL, --nANCHO_BUENO_TOTAL_09 
                           NULL, --nANCHO_BUENO_OT_09 
                           NULL, --nANCHO_BUENO_TOTAL_10 
                           NULL, --nANCHO_BUENO_OT_10 
                           NULL, --nANCHO_BUENO_TOTAL 
                           NULL, --nANCHO_BUENO_OT 
                           NULL, --nNUMECORT 
                           NULL, --nMM_MERMPRCO_01 
                           NULL, --nMM_MERMPLAN_EXESO_01 
                           NULL, --nMM_MERMPLAN_01 
                           NULL, --nMM_MERMPRCO_02 
                           NULL, --nMM_MERMPLAN_EXESO_02 
                           NULL, --nMM_MERMPLAN_02 
                           NULL, --nMM_MERMPRCO_03 
                           NULL, --nMM_MERMPLAN_EXESO_03 
                           NULL, --nMM_MERMPLAN_03 
                           NULL, --nMM_MERMPRCO_04 
                           NULL, --nMM_MERMPLAN_EXESO_04 
                           NULL, --nMM_MERMPLAN_04 
                           NULL, --nMM_MERMPRCO_05 
                           NULL, --nMM_MERMPLAN_EXESO_05 
                           NULL, --nMM_MERMPLAN_05 
                           NULL, --nMM_MERMPRCO_06 
                           NULL, --nMM_MERMPLAN_EXESO_06 
                           NULL, --nMM_MERMPLAN_06 
                           NULL, --nMM_MERMPRCO_07 
                           NULL, --nMM_MERMPLAN_EXESO_07 
                           NULL, --nMM_MERMPLAN_07 
                           NULL, --nMM_MERMPRCO_08 
                           NULL, --nMM_MERMPLAN_EXESO_08 
                           NULL, --nMM_MERMPLAN_08 
                           NULL, --nMM_MERMPRCO_09 
                           NULL, --nMM_MERMPLAN_EXESO_09 
                           NULL, --nMM_MERMPLAN_09 
                           NULL, --nMM_MERMPRCO_10 
                           NULL, --nMM_MERMPLAN_EXESO_10 
                           NULL, --nMM_MERMPLAN_10 
                           NULL, --nMM_MERMPRCO 
                           NULL, --nMM_MERMPLAN_EXESO 
                           NULL); --nMM_MERMPLAN
               --Se actualiza el ancho del Material en caso de no existir
               --IF t_MATERIAL(rMaterial_B1R.IDENTIFICADOR).Ancho IS NULL THEN
--dbms_Output.put_line('ANCHO1:'||nAncho1);               
                  --t_MATERIAL(rMaterial_B1R.IDENTIFICADOR).Ancho := nAncho1;
               --END IF;
			END IF;
			--
			IF rANE_MER_MATERIAL_OT_SP.FACTOR_CONVERSION_M2_KG IS NULL THEN
--dbms_Output.put_line('FACTORXXX02 BOBINA EN 2: '||rMaterial_B1R.IDENTIFICADOR||'-'||rMaterial_B1R.COD_ARTI||'LOTE:'||rMaterial_B1R.LOTE||'-> nFCKG1:'||nFCKG1); 
					P_MATERIAL(rMaterial_B1R,'U',
					           NULL,--nCantProd
								  NULL,--nCantCons_E
								  NULL,--nCantCons
								  NULL,--nCantAjus
								  NULL,--nAncho
								  nFCKG1,--nFACTOR_CONVERSION_M2_KG
								  NULL,--nPrecio_ML_E
								  NULL,--vLog_Precio
								  NULL,--nMermEnhe_E
								  NULL,--nMermEnhe
								  NULL,--nMermAjus_E
								  NULL,--nMermAjus
								  NULL,--nMermCabo_E
								  NULL,--nMermCabo
								  NULL,--nMermPico_E
								  NULL,--nMermPico
                          NULL,--nMermTita
                          NULL,--nMermSane
                          NULL,--nCantCons_Bobinas
                          --
                           NULL, --nCONTFSMU_01 
                           NULL, --nCANTFSMU_01 
                           NULL, --nCATOFSMU 
                           NULL, --nCONTFSMU_02 
                           NULL, --nCANTFSMU_02 
                           NULL, --nCONTFSMU_03 
                           NULL, --nCANTFSMU_03 
                           NULL, --nCONTFSMU_04 
                           NULL, --nCANTFSMU_04 
                           NULL, --nCONTFSMU_05 
                           NULL, --nCANTFSMU_05 
                           NULL, --nCONTFSMU_06 
                           NULL, --nCANTFSMU_06 
                           NULL, --nCONTFSMU_07 
                           NULL, --nCANTFSMU_07 
                           NULL, --nCONTFSMU_08 
                           NULL, --nCANTFSMU_08 
                           NULL, --nCONTFSMU_09 
                           NULL, --nCANTFSMU_09 
                           NULL, --nCONTFSMU_10 
                           NULL, --nCANTFSMU_10 
                           NULL, --nANCHO_BUENO_TOTAL_01 
                           NULL, --nANCHO_BUENO_OT_01 
                           NULL, --nANCHO_BUENO_TOTAL_02 
                           NULL, --nANCHO_BUENO_OT_02 
                           NULL, --nANCHO_BUENO_TOTAL_03 
                           NULL, --nANCHO_BUENO_OT_03 
                           NULL, --nANCHO_BUENO_TOTAL_04 
                           NULL, --nANCHO_BUENO_OT_04 
                           NULL, --nANCHO_BUENO_TOTAL_05 
                           NULL, --nANCHO_BUENO_OT_05 
                           NULL, --nANCHO_BUENO_TOTAL_06 
                           NULL, --nANCHO_BUENO_OT_06 
                           NULL, --nANCHO_BUENO_TOTAL_07 
                           NULL, --nANCHO_BUENO_OT_07 
                           NULL, --nANCHO_BUENO_TOTAL_08 
                           NULL, --nANCHO_BUENO_OT_08 
                           NULL, --nANCHO_BUENO_TOTAL_09 
                           NULL, --nANCHO_BUENO_OT_09 
                           NULL, --nANCHO_BUENO_TOTAL_10 
                           NULL, --nANCHO_BUENO_OT_10 
                           NULL, --nANCHO_BUENO_TOTAL 
                           NULL, --nANCHO_BUENO_OT 
                           NULL, --nNUMECORT 
                           NULL, --nMM_MERMPRCO_01 
                           NULL, --nMM_MERMPLAN_EXESO_01 
                           NULL, --nMM_MERMPLAN_01 
                           NULL, --nMM_MERMPRCO_02 
                           NULL, --nMM_MERMPLAN_EXESO_02 
                           NULL, --nMM_MERMPLAN_02 
                           NULL, --nMM_MERMPRCO_03 
                           NULL, --nMM_MERMPLAN_EXESO_03 
                           NULL, --nMM_MERMPLAN_03 
                           NULL, --nMM_MERMPRCO_04 
                           NULL, --nMM_MERMPLAN_EXESO_04 
                           NULL, --nMM_MERMPLAN_04 
                           NULL, --nMM_MERMPRCO_05 
                           NULL, --nMM_MERMPLAN_EXESO_05 
                           NULL, --nMM_MERMPLAN_05 
                           NULL, --nMM_MERMPRCO_06 
                           NULL, --nMM_MERMPLAN_EXESO_06 
                           NULL, --nMM_MERMPLAN_06 
                           NULL, --nMM_MERMPRCO_07 
                           NULL, --nMM_MERMPLAN_EXESO_07 
                           NULL, --nMM_MERMPLAN_07 
                           NULL, --nMM_MERMPRCO_08 
                           NULL, --nMM_MERMPLAN_EXESO_08 
                           NULL, --nMM_MERMPLAN_08 
                           NULL, --nMM_MERMPRCO_09 
                           NULL, --nMM_MERMPLAN_EXESO_09 
                           NULL, --nMM_MERMPLAN_09 
                           NULL, --nMM_MERMPRCO_10 
                           NULL, --nMM_MERMPLAN_EXESO_10 
                           NULL, --nMM_MERMPLAN_10 
                           NULL, --nMM_MERMPRCO 
                           NULL, --nMM_MERMPLAN_EXESO 
                           NULL); --nMM_MERMPLAN
               --Se actualiza el FCKG del Material en caso de no existir
               --IF t_MATERIAL(rMaterial_B1R.IDENTIFICADOR).FACTOR_CONVERSION_M2_KG IS NULL THEN
--dbms_Output.put_line('MATERIAL 1 LFS: '||rArticulo.COD_LFS||' COD_ARTI: '||t_MATERIAL(rMaterial_B1R.IDENTIFICADOR).COD_ARTI||'-> nFCKG1:'||nFCKG1);               
                  --t_MATERIAL(rMaterial_B1R.IDENTIFICADOR).FACTOR_CONVERSION_M2_KG := nFCKG1;
               --END IF;
			END IF;
--					
      END LOOP;
   END ;--P_CONSUMO_MATERIALES
   PROCEDURE P_Ancho_Bueno(vEmpresa PRD_BOBIMAQU.EMPRESA%TYPE, nNumeOtre PRD_BOBIMAQU.NUMEOTRE%TYPE) IS 
      rMATERIAL_B ST_MATERIAL;
      --
      rBOBIMAQU_B ST_BOBIMAQU;
      --
      nAncho ARTICULO.ANCHO%TYPE;
      --
      nFCKG LFS.FCKG%TYPE;
      --
      --rANCHO_UTIL_B ST_ANCHO_UTIL;
      rANCHO_UTIL_B_01 ST_ANCHO_UTIL;
      rANCHO_UTIL_B_02 ST_ANCHO_UTIL;
      rANCHO_UTIL_B_03 ST_ANCHO_UTIL;
      rANCHO_UTIL_B_04 ST_ANCHO_UTIL;
      rANCHO_UTIL_B_05 ST_ANCHO_UTIL;
      rANCHO_UTIL_B_06 ST_ANCHO_UTIL;
      rANCHO_UTIL_B_07 ST_ANCHO_UTIL;
      rANCHO_UTIL_B_08 ST_ANCHO_UTIL;
      rANCHO_UTIL_B_09 ST_ANCHO_UTIL;
      rANCHO_UTIL_B_10 ST_ANCHO_UTIL;
      --
      nANCHO_UTILIZADO_UTIL_BOBINA NUMBER := 0;
      --
      nCATOFSMU NUMBER;
      rAncho_Util ST_ANCHO_UTIL;
      --
      nContador_Busqueda_Anterior PRD_MAPAMAQU.CONTADOR%TYPE;
      --
      nANCHO_BUENO_TOTAL NUMBER := 0;
      nANCHO_BUENO_OT NUMBER := 0;
            --
		CURSOR cANE_MER_BOBIMAQU_OT IS
			SELECT EMPRESA,NUMEOTRE,CONTADOR,CONTBOBI,TIP_ARTI,COD_ARTI,ANCHO_BUENO,MERMTIRA,MERMSANE,LOTE,PRECIO_ML,NUMERO_BOBINAS_CORTE,IDENTIFICADOR, DESBARBE, ANCHO
			FROM ANALESTA.ANE_MER_BOBIMAQU_OT
			WHERE EMPRESA = vEmpresa
			  AND NUMEOTRE = nNumeOtre;
      --
      CURSOR cMaterial IS
          SELECT EMPRESA,NUMEOTRE,CONTADOR,CONTMATE,CONTMAEV,
                  IDENTIFICADOR,
                  TIP_ARTI,COD_ARTI,LOTE,CANTCONS,CANTCONS_BOBINAS,CANTPROD,CANTAJUS,MERMENHE,MERMAJUS,MERMCABO,MERMPICO,MERMTIRA,MERMSANE,
                  CONTFSMU_01,CONTFSMU_02,CONTFSMU_03,CONTFSMU_04,CONTFSMU_05,CONTFSMU_06,CONTFSMU_07,CONTFSMU_08,CONTFSMU_09,CONTFSMU_10,
                  CANTFSMU_01,CANTFSMU_02,CANTFSMU_03,CANTFSMU_04,CANTFSMU_05,CANTFSMU_06,CANTFSMU_07,CANTFSMU_08,CANTFSMU_09,CANTFSMU_10,
                  CATOFSMU,MM_MERMPLAN_01,MM_MERMPLAN_02,MM_MERMPLAN_03,MM_MERMPLAN_04,MM_MERMPLAN_05,MM_MERMPLAN_06,MM_MERMPLAN_07,MM_MERMPLAN_08,MM_MERMPLAN_09,MM_MERMPLAN_10,
                  MM_MERMPLAN,MERMPLAN,
                  MM_MERMPLAN_EXESO_01,MM_MERMPLAN_EXESO_02,MM_MERMPLAN_EXESO_03,MM_MERMPLAN_EXESO_04,MM_MERMPLAN_EXESO_05,MM_MERMPLAN_EXESO_06,MM_MERMPLAN_EXESO_07,MM_MERMPLAN_EXESO_08,MM_MERMPLAN_EXESO_09,MM_MERMPLAN_EXESO_10,
                  MM_MERMPLAN_EXESO,MERMPLAN_EXESO,
                  PRE_CORTE,
                  NUMECORT_01,NUMECORT_02,NUMECORT_03,NUMECORT_04,NUMECORT_05,NUMECORT_06,NUMECORT_07,NUMECORT_08,NUMECORT_09,NUMECORT_10,
                  NUMECORT,
                  MM_MERMPRCO_01,MM_MERMPRCO_02,MM_MERMPRCO_03,MM_MERMPRCO_04,MM_MERMPRCO_05,MM_MERMPRCO_06,MM_MERMPRCO_07,MM_MERMPRCO_08,MM_MERMPRCO_09,MM_MERMPRCO_10,
                  MM_MERMPRCO,MERMPRCO,
                  CANTCONS_E,MERMENHE_E,MERMAJUS_E,MERMCABO_E,MERMPICO_E,MERMTIRA_E,MERMSANE_E,MM_MERMPLAN_E,MERMPLAN_E,
                  ANCHO,
                  ANCHO_BUENO_OT_01,ANCHO_BUENO_TOTAL_01,ANCHO_BUENO_OT_02,ANCHO_BUENO_TOTAL_02,ANCHO_BUENO_OT_03,ANCHO_BUENO_TOTAL_03,ANCHO_BUENO_OT_04,ANCHO_BUENO_TOTAL_04,ANCHO_BUENO_OT_05,ANCHO_BUENO_TOTAL_05,
                  ANCHO_BUENO_OT_06,ANCHO_BUENO_TOTAL_06,ANCHO_BUENO_OT_07,ANCHO_BUENO_TOTAL_07,ANCHO_BUENO_OT_08,ANCHO_BUENO_TOTAL_08,ANCHO_BUENO_OT_09,ANCHO_BUENO_TOTAL_09,ANCHO_BUENO_OT_10,ANCHO_BUENO_TOTAL_10,
                  ANCHO_BUENO_TOTAL,ANCHO_BUENO_OT,
                  CANTIDAD_CONSUMIDA_FINAL_01,CANTIDAD_CONSUMIDA_FINAL_02,CANTIDAD_CONSUMIDA_FINAL_03,CANTIDAD_CONSUMIDA_FINAL_04,CANTIDAD_CONSUMIDA_FINAL_05,CANTIDAD_CONSUMIDA_FINAL_06,CANTIDAD_CONSUMIDA_FINAL_07,CANTIDAD_CONSUMIDA_FINAL_08,CANTIDAD_CONSUMIDA_FINAL_09,CANTIDAD_CONSUMIDA_FINAL_10,
                  CANTIDAD_CONSUMIDA_FINAL_TOTAL,
                  PRECIO_ML,PRECIO_ML_E,FACTOR_CONVERSION_M2_KG
             FROM ANALESTA.ANE_MER_MATERIAL_OT
             WHERE EMPRESA = vEmpresa 
               AND NUMEOTRE = nNumeOtre;
   BEGIN--P_Ancho_Bueno
      --Se actualizan los Valores de Cantidades Totales Consumidas en Fases Siguientes Multiples
      FOR rMaquinas IN cMaquinas(vEmpresa,nNumeOtre) LOOP
         nCATOFSMU := 0;
--dbms_output.put_line('INICIA nCATOFSMU = '||nCATOFSMU||' MAQUINA = '||rMaquinas.CONTADOR);
         --
         FOR nI In 1..T_ANCHO_UTIL.COUNT LOOP
            biIndice   := nI;
            rAncho_Util := T_ANCHO_UTIL(biIndice);
            --
--dbms_output.put_line('1er LOOP T_ANCHO_UTIL: '||rAncho_Util.EMPRESA||'-'||rAncho_Util.NUMEOTRE||'-'||rAncho_Util.CONTADOR||'-FS:'||rAncho_Util.FASESIGU||' ANCHO_BUENO_TOTAL: '||rAncho_Util.ANCHO_UTILIZADO_OT||' VERIF CONTADOR:'|| rAncho_Util.CONTADOR||' = '||rMaquinas.CONTADOR||' CONTADOR DE MATERIALES: '||T_MATERIAL.COUNT);
            IF rAncho_Util.CONTADOR = rMaquinas.CONTADOR THEN--Verifico si es de la Maquina
               rAncho_Util.CANTFSMU := 0;
               --
               --FOR nM In 1..T_MATERIAL.COUNT LOOP
               --   biIndice_M   := nM;
               --   rMATERIAL := T_MATERIAL(biIndice_M);
               FOR rMaterial IN cMaterial LOOP
                  --
--dbms_output.put_line('2do LOOP T_MATERIAL: '|| rMATERIAL.CONTADOR||' = '||rAncho_Util.CONTFSMU||'  AND '||rMATERIAL.TIP_ARTI||' != '||vTIARREST||' AND '||NVL(rMATERIAL.CANTPROD,0)||' != 0');
                  IF rMATERIAL.CONTADOR = rAncho_Util.CONTFSMU AND rMATERIAL.TIP_ARTI != vTIARREST AND NVL(rMATERIAL.CANTPROD,0) != 0 THEN --La cantidad != 0 es para eliminar los materiales de ajuste
                     rAncho_Util.CANTFSMU := rAncho_Util.CANTFSMU + NVL(rMATERIAL.CANTCONS,0); --Acumulo la cantidad consumida en la fase multiple siguiente final
--dbms_output.put_line('ACUMULA nCATOFSMU = '||nCATOFSMU||' + '||NVL(rMATERIAL.CANTCONS,0));
                     nCATOFSMU := nCATOFSMU + NVL(rMATERIAL.CANTCONS,0); --Acumulo la cantidad consumida en la fase multiple siguiente final para los totales
                  END IF;
               END LOOP;
               --Se actualiza con la Cantidad Total de la Fase Multiple Siguiente Final
               T_ANCHO_UTIL(biIndice) := rAncho_Util;
            END IF;
         END LOOP;
         --Se actualiza la Cantidad Total (Que se ha acumulado en la anterios iteraccion)
         FOR nI In 1..T_ANCHO_UTIL.COUNT LOOP
            biIndice   := nI;
            rAncho_Util := T_ANCHO_UTIL(biIndice);
            --
            IF rAncho_Util.CONTADOR = rMaquinas.CONTADOR THEN
--dbms_output.put_line('ACTUALIZA nCATOFSMU = '||nCATOFSMU||' MAQUINA = '||rMaquinas.CONTADOR||' VALOR DE CANTFSMU = '||rAncho_Util.CANTFSMU);
               rAncho_Util.CATOFSMU := nCATOFSMU;
               --Se actualiza con la Cantidad Total de la Fase Multiple Siguiente Final
               T_ANCHO_UTIL(biIndice) := rAncho_Util;
            END IF;
         END LOOP;
      END LOOP;
      --Se recorren los Materiales
      --FOR nI In 1..T_MATERIAL.COUNT LOOP
         --biIndice   := nI;
         --rMATERIAL_B := T_MATERIAL(biIndice);
      FOR rMaterial IN cMaterial LOOP
		   rMATERIAL_B.EMPRESA := rMaterial.EMPRESA;
		   rMATERIAL_B.NUMEOTRE := rMaterial.NUMEOTRE;
		   rMATERIAL_B.CONTADOR := rMaterial.CONTADOR;
		   rMATERIAL_B.CONTMATE := rMaterial.CONTMATE;
		   rMATERIAL_B.CONTMAEV := rMaterial.CONTMAEV;
		   rMATERIAL_B.IDENTIFICADOR := rMaterial.IDENTIFICADOR;
		   rMATERIAL_B.TIP_ARTI := rMaterial.TIP_ARTI;
		   rMATERIAL_B.COD_ARTI := rMaterial.COD_ARTI;
		   rMATERIAL_B.LOTE := rMaterial.LOTE;
		   rMATERIAL_B.CANTCONS := rMaterial.CANTCONS;
		   rMATERIAL_B.CANTCONS_BOBINAS := rMaterial.CANTCONS_BOBINAS;
		   rMATERIAL_B.CANTPROD := rMaterial.CANTPROD;
		   rMATERIAL_B.CANTAJUS := rMaterial.CANTAJUS;
		   rMATERIAL_B.MERMENHE := rMaterial.MERMENHE;
		   rMATERIAL_B.MERMAJUS := rMaterial.MERMAJUS;
		   rMATERIAL_B.MERMCABO := rMaterial.MERMCABO;
		   rMATERIAL_B.MERMPICO := rMaterial.MERMPICO;
		   rMATERIAL_B.MERMTIRA := rMaterial.MERMTIRA;
		   rMATERIAL_B.MERMSANE := rMaterial.MERMSANE;
		   rMATERIAL_B.CONTFSMU_01 := rMaterial.CONTFSMU_01;
		   rMATERIAL_B.CONTFSMU_02 := rMaterial.CONTFSMU_02;
		   rMATERIAL_B.CONTFSMU_03 := rMaterial.CONTFSMU_03;
		   rMATERIAL_B.CONTFSMU_04 := rMaterial.CONTFSMU_04;
		   rMATERIAL_B.CONTFSMU_05 := rMaterial.CONTFSMU_05;
		   rMATERIAL_B.CONTFSMU_06 := rMaterial.CONTFSMU_06;
		   rMATERIAL_B.CONTFSMU_07 := rMaterial.CONTFSMU_07;
		   rMATERIAL_B.CONTFSMU_08 := rMaterial.CONTFSMU_08;
		   rMATERIAL_B.CONTFSMU_09 := rMaterial.CONTFSMU_09;
		   rMATERIAL_B.CONTFSMU_10 := rMaterial.CONTFSMU_10;
		   rMATERIAL_B.CANTFSMU_01 := rMaterial.CANTFSMU_01;
		   rMATERIAL_B.CANTFSMU_02 := rMaterial.CANTFSMU_02;
		   rMATERIAL_B.CANTFSMU_03 := rMaterial.CANTFSMU_03;
		   rMATERIAL_B.CANTFSMU_04 := rMaterial.CANTFSMU_04;
		   rMATERIAL_B.CANTFSMU_05 := rMaterial.CANTFSMU_05;
		   rMATERIAL_B.CANTFSMU_06 := rMaterial.CANTFSMU_06;
		   rMATERIAL_B.CANTFSMU_07 := rMaterial.CANTFSMU_07;
		   rMATERIAL_B.CANTFSMU_08 := rMaterial.CANTFSMU_08;
		   rMATERIAL_B.CANTFSMU_09 := rMaterial.CANTFSMU_09;
		   rMATERIAL_B.CANTFSMU_10 := rMaterial.CANTFSMU_10;
		   rMATERIAL_B.CATOFSMU := rMaterial.CATOFSMU;
		   rMATERIAL_B.MM_MERMPLAN_01 := rMaterial.MM_MERMPLAN_01;
		   rMATERIAL_B.MM_MERMPLAN_02 := rMaterial.MM_MERMPLAN_02;
		   rMATERIAL_B.MM_MERMPLAN_03 := rMaterial.MM_MERMPLAN_03;
		   rMATERIAL_B.MM_MERMPLAN_04 := rMaterial.MM_MERMPLAN_04;
		   rMATERIAL_B.MM_MERMPLAN_05 := rMaterial.MM_MERMPLAN_05;
		   rMATERIAL_B.MM_MERMPLAN_06 := rMaterial.MM_MERMPLAN_06;
		   rMATERIAL_B.MM_MERMPLAN_07 := rMaterial.MM_MERMPLAN_07;
		   rMATERIAL_B.MM_MERMPLAN_08 := rMaterial.MM_MERMPLAN_08;
		   rMATERIAL_B.MM_MERMPLAN_09 := rMaterial.MM_MERMPLAN_09;
		   rMATERIAL_B.MM_MERMPLAN_10 := rMaterial.MM_MERMPLAN_10;
		   rMATERIAL_B.MM_MERMPLAN := rMaterial.MM_MERMPLAN;
			rMATERIAL_B.MERMPLAN := rMaterial.MERMPLAN;
		   rMATERIAL_B.MM_MERMPLAN_EXESO_01 := rMaterial.MM_MERMPLAN_EXESO_01;
		   rMATERIAL_B.MM_MERMPLAN_EXESO_02 := rMaterial.MM_MERMPLAN_EXESO_02;
		   rMATERIAL_B.MM_MERMPLAN_EXESO_03 := rMaterial.MM_MERMPLAN_EXESO_03;
		   rMATERIAL_B.MM_MERMPLAN_EXESO_04 := rMaterial.MM_MERMPLAN_EXESO_04;
		   rMATERIAL_B.MM_MERMPLAN_EXESO_05 := rMaterial.MM_MERMPLAN_EXESO_05;
		   rMATERIAL_B.MM_MERMPLAN_EXESO_06 := rMaterial.MM_MERMPLAN_EXESO_06;
		   rMATERIAL_B.MM_MERMPLAN_EXESO_07 := rMaterial.MM_MERMPLAN_EXESO_07;
		   rMATERIAL_B.MM_MERMPLAN_EXESO_08 := rMaterial.MM_MERMPLAN_EXESO_08;
		   rMATERIAL_B.MM_MERMPLAN_EXESO_09 := rMaterial.MM_MERMPLAN_EXESO_09;
		   rMATERIAL_B.MM_MERMPLAN_EXESO_10 := rMaterial.MM_MERMPLAN_EXESO_10;
		   rMATERIAL_B.MM_MERMPLAN_EXESO := rMaterial.MM_MERMPLAN_EXESO;
		   rMATERIAL_B.MERMPLAN_EXESO := rMaterial.MERMPLAN_EXESO;
		   rMATERIAL_B.PRE_CORTE := rMaterial.PRE_CORTE;
		   rMATERIAL_B.NUMECORT_01 := rMaterial.NUMECORT_01;
		   rMATERIAL_B.NUMECORT_02 := rMaterial.NUMECORT_02;
		   rMATERIAL_B.NUMECORT_03 := rMaterial.NUMECORT_03;
		   rMATERIAL_B.NUMECORT_04 := rMaterial.NUMECORT_04;
		   rMATERIAL_B.NUMECORT_05 := rMaterial.NUMECORT_05;
		   rMATERIAL_B.NUMECORT_06 := rMaterial.NUMECORT_06;
		   rMATERIAL_B.NUMECORT_07 := rMaterial.NUMECORT_07;
		   rMATERIAL_B.NUMECORT_08 := rMaterial.NUMECORT_08;
		   rMATERIAL_B.NUMECORT_09 := rMaterial.NUMECORT_09;
		   rMATERIAL_B.NUMECORT_10 := rMaterial.NUMECORT_10;
		   rMATERIAL_B.NUMECORT := rMaterial.NUMECORT;
		   rMATERIAL_B.MM_MERMPRCO_01 := rMaterial.MM_MERMPRCO_01;
		   rMATERIAL_B.MM_MERMPRCO_02 := rMaterial.MM_MERMPRCO_02;
		   rMATERIAL_B.MM_MERMPRCO_03 := rMaterial.MM_MERMPRCO_03;
		   rMATERIAL_B.MM_MERMPRCO_04 := rMaterial.MM_MERMPRCO_04;
		   rMATERIAL_B.MM_MERMPRCO_05 := rMaterial.MM_MERMPRCO_05;
		   rMATERIAL_B.MM_MERMPRCO_06 := rMaterial.MM_MERMPRCO_06;
		   rMATERIAL_B.MM_MERMPRCO_07 := rMaterial.MM_MERMPRCO_07;
		   rMATERIAL_B.MM_MERMPRCO_08 := rMaterial.MM_MERMPRCO_08;
		   rMATERIAL_B.MM_MERMPRCO_09 := rMaterial.MM_MERMPRCO_09;
		   rMATERIAL_B.MM_MERMPRCO_10 := rMaterial.MM_MERMPRCO_10;
		   rMATERIAL_B.MM_MERMPRCO := rMaterial.MM_MERMPRCO;
			rMATERIAL_B.MERMPRCO := rMaterial.MERMPRCO;
		   rMATERIAL_B.CANTCONS_E := rMaterial.CANTCONS_E;
		   rMATERIAL_B.MERMENHE_E := rMaterial.MERMENHE_E;
		   rMATERIAL_B.MERMAJUS_E := rMaterial.MERMAJUS_E;
		   rMATERIAL_B.MERMCABO_E := rMaterial.MERMCABO_E;
		   rMATERIAL_B.MERMPICO_E := rMaterial.MERMPICO_E;
		   rMATERIAL_B.MERMTIRA_E := rMaterial.MERMTIRA_E;
		   rMATERIAL_B.MERMSANE_E := rMaterial.MERMSANE_E;
		   rMATERIAL_B.MM_MERMPLAN_E := rMaterial.MM_MERMPLAN_E;
		   rMATERIAL_B.MERMPLAN_E := rMaterial.MERMPLAN_E;
		   rMATERIAL_B.ANCHO := rMaterial.ANCHO;
		   rMATERIAL_B.ANCHO_BUENO_OT_01 := rMaterial.ANCHO_BUENO_OT_01;
		   rMATERIAL_B.ANCHO_BUENO_TOTAL_01 := rMaterial.ANCHO_BUENO_TOTAL_01;
		   rMATERIAL_B.ANCHO_BUENO_OT_02 := rMaterial.ANCHO_BUENO_OT_02;
		   rMATERIAL_B.ANCHO_BUENO_TOTAL_02 := rMaterial.ANCHO_BUENO_TOTAL_02;
		   rMATERIAL_B.ANCHO_BUENO_OT_03 := rMaterial.ANCHO_BUENO_OT_03;
		   rMATERIAL_B.ANCHO_BUENO_TOTAL_03 := rMaterial.ANCHO_BUENO_TOTAL_03;
		   rMATERIAL_B.ANCHO_BUENO_OT_04 := rMaterial.ANCHO_BUENO_OT_04;
		   rMATERIAL_B.ANCHO_BUENO_TOTAL_04 := rMaterial.ANCHO_BUENO_TOTAL_04;
		   rMATERIAL_B.ANCHO_BUENO_OT_05 := rMaterial.ANCHO_BUENO_OT_05;
		   rMATERIAL_B.ANCHO_BUENO_TOTAL_05 := rMaterial.ANCHO_BUENO_TOTAL_05;
		   rMATERIAL_B.ANCHO_BUENO_OT_06 := rMaterial.ANCHO_BUENO_OT_06;
		   rMATERIAL_B.ANCHO_BUENO_TOTAL_06 := rMaterial.ANCHO_BUENO_TOTAL_06;
		   rMATERIAL_B.ANCHO_BUENO_OT_07 := rMaterial.ANCHO_BUENO_OT_07;
		   rMATERIAL_B.ANCHO_BUENO_TOTAL_07 := rMaterial.ANCHO_BUENO_TOTAL_07;
		   rMATERIAL_B.ANCHO_BUENO_OT_08 := rMaterial.ANCHO_BUENO_OT_08;
		   rMATERIAL_B.ANCHO_BUENO_TOTAL_08 := rMaterial.ANCHO_BUENO_TOTAL_08;
		   rMATERIAL_B.ANCHO_BUENO_OT_09 := rMaterial.ANCHO_BUENO_OT_09;
		   rMATERIAL_B.ANCHO_BUENO_TOTAL_09 := rMaterial.ANCHO_BUENO_TOTAL_09;
		   rMATERIAL_B.ANCHO_BUENO_OT_10 := rMaterial.ANCHO_BUENO_OT_10;
		   rMATERIAL_B.ANCHO_BUENO_TOTAL_10 := rMaterial.ANCHO_BUENO_TOTAL_10;
		   rMATERIAL_B.ANCHO_BUENO_TOTAL := rMaterial.ANCHO_BUENO_TOTAL;
		   rMATERIAL_B.ANCHO_BUENO_OT := rMaterial.ANCHO_BUENO_OT;
		   rMATERIAL_B.CANTIDAD_CONSUMIDA_FINAL_01 := rMaterial.CANTIDAD_CONSUMIDA_FINAL_01;
		   rMATERIAL_B.CANTIDAD_CONSUMIDA_FINAL_02 := rMaterial.CANTIDAD_CONSUMIDA_FINAL_02;
		   rMATERIAL_B.CANTIDAD_CONSUMIDA_FINAL_03 := rMaterial.CANTIDAD_CONSUMIDA_FINAL_03;
		   rMATERIAL_B.CANTIDAD_CONSUMIDA_FINAL_04 := rMaterial.CANTIDAD_CONSUMIDA_FINAL_04;
		   rMATERIAL_B.CANTIDAD_CONSUMIDA_FINAL_05 := rMaterial.CANTIDAD_CONSUMIDA_FINAL_05;
		   rMATERIAL_B.CANTIDAD_CONSUMIDA_FINAL_06 := rMaterial.CANTIDAD_CONSUMIDA_FINAL_06;
		   rMATERIAL_B.CANTIDAD_CONSUMIDA_FINAL_07 := rMaterial.CANTIDAD_CONSUMIDA_FINAL_07;
		   rMATERIAL_B.CANTIDAD_CONSUMIDA_FINAL_08 := rMaterial.CANTIDAD_CONSUMIDA_FINAL_08;
		   rMATERIAL_B.CANTIDAD_CONSUMIDA_FINAL_09 := rMaterial.CANTIDAD_CONSUMIDA_FINAL_09;
		   rMATERIAL_B.CANTIDAD_CONSUMIDA_FINAL_10 := rMaterial.CANTIDAD_CONSUMIDA_FINAL_10;
		   rMATERIAL_B.CANTIDAD_CONSUMIDA_FINAL_TOTAL := rMaterial.CANTIDAD_CONSUMIDA_FINAL_TOTAL;
		   rMATERIAL_B.PRECIO_ML := rMaterial.PRECIO_ML;
		   rMATERIAL_B.PRECIO_ML_E := rMaterial.PRECIO_ML_E;
		   rMATERIAL_B.FACTOR_CONVERSION_M2_KG := rMaterial.FACTOR_CONVERSION_M2_KG;
         --Actualizacion de Cantidad Total Consumida al Final de las Fases
         IF rMATERIAL_B.Tip_Arti != vTIARREST THEN --Material de Restos
            /*
            rANCHO_UTIL_B := F_ANCHO_UTIL(vEmpresa,nNumeOtre,rMaterial_B.Contador,1);
--dbms_output.put_line('BUSQUEDA PARA ASIGNAR: EN FASE = '||rANCHO_UTIL_B.CANTFSMU||' TOTAL = '||rANCHO_UTIL_B.CATOFSMU);  
            --
            t_MATERIAL(rMaterial_B.IDENTIFICADOR).CONTFSMU_01 := rANCHO_UTIL_B.CONTFSMU;
            t_MATERIAL(rMaterial_B.IDENTIFICADOR).CANTFSMU_01 := rANCHO_UTIL_B.CANTFSMU;
            t_MATERIAL(rMaterial_B.IDENTIFICADOR).CATOFSMU := rANCHO_UTIL_B.CATOFSMU;
            --
            rANCHO_UTIL_B := F_ANCHO_UTIL(vEmpresa,nNumeOtre,rMaterial_B.Contador,2);
            --
            t_MATERIAL(rMaterial_B.IDENTIFICADOR).CONTFSMU_02 := rANCHO_UTIL_B.CONTFSMU;
            t_MATERIAL(rMaterial_B.IDENTIFICADOR).CANTFSMU_02 := rANCHO_UTIL_B.CANTFSMU;
            --
            rANCHO_UTIL_B := F_ANCHO_UTIL(vEmpresa,nNumeOtre,rMaterial_B.Contador,3);
            --
            t_MATERIAL(rMaterial_B.IDENTIFICADOR).CONTFSMU_03 := rANCHO_UTIL_B.CONTFSMU;
            t_MATERIAL(rMaterial_B.IDENTIFICADOR).CANTFSMU_03 := rANCHO_UTIL_B.CANTFSMU;
            --
            rANCHO_UTIL_B := F_ANCHO_UTIL(vEmpresa,nNumeOtre,rMaterial_B.Contador,4);
            --
            t_MATERIAL(rMaterial_B.IDENTIFICADOR).CONTFSMU_04 := rANCHO_UTIL_B.CONTFSMU;
            t_MATERIAL(rMaterial_B.IDENTIFICADOR).CANTFSMU_04 := rANCHO_UTIL_B.CANTFSMU;
            --
            rANCHO_UTIL_B := F_ANCHO_UTIL(vEmpresa,nNumeOtre,rMaterial_B.Contador,5);
            --
            t_MATERIAL(rMaterial_B.IDENTIFICADOR).CONTFSMU_05 := rANCHO_UTIL_B.CONTFSMU;
            t_MATERIAL(rMaterial_B.IDENTIFICADOR).CANTFSMU_05 := rANCHO_UTIL_B.CANTFSMU;
            --
            rANCHO_UTIL_B := F_ANCHO_UTIL(vEmpresa,nNumeOtre,rMaterial_B.Contador,6);
            --
            t_MATERIAL(rMaterial_B.IDENTIFICADOR).CONTFSMU_06 := rANCHO_UTIL_B.CONTFSMU;
            t_MATERIAL(rMaterial_B.IDENTIFICADOR).CANTFSMU_06 := rANCHO_UTIL_B.CANTFSMU;
            --
            rANCHO_UTIL_B := F_ANCHO_UTIL(vEmpresa,nNumeOtre,rMaterial_B.Contador,7);
            --
            t_MATERIAL(rMaterial_B.IDENTIFICADOR).CONTFSMU_07 := rANCHO_UTIL_B.CONTFSMU;
            t_MATERIAL(rMaterial_B.IDENTIFICADOR).CANTFSMU_07 := rANCHO_UTIL_B.CANTFSMU;
            --
            rANCHO_UTIL_B := F_ANCHO_UTIL(vEmpresa,nNumeOtre,rMaterial_B.Contador,8);
            --
            t_MATERIAL(rMaterial_B.IDENTIFICADOR).CONTFSMU_08 := rANCHO_UTIL_B.CONTFSMU;
            t_MATERIAL(rMaterial_B.IDENTIFICADOR).CANTFSMU_08 := rANCHO_UTIL_B.CANTFSMU;
            --
            rANCHO_UTIL_B := F_ANCHO_UTIL(vEmpresa,nNumeOtre,rMaterial_B.Contador,9);
            --
            t_MATERIAL(rMaterial_B.IDENTIFICADOR).CONTFSMU_09 := rANCHO_UTIL_B.CONTFSMU;
            t_MATERIAL(rMaterial_B.IDENTIFICADOR).CANTFSMU_09 := rANCHO_UTIL_B.CANTFSMU;
            --
            rANCHO_UTIL_B := F_ANCHO_UTIL(vEmpresa,nNumeOtre,rMaterial_B.Contador,10);
            --
            t_MATERIAL(rMaterial_B.IDENTIFICADOR).CONTFSMU_10 := rANCHO_UTIL_B.CONTFSMU;
            t_MATERIAL(rMaterial_B.IDENTIFICADOR).CANTFSMU_10 := rANCHO_UTIL_B.CANTFSMU;
            */
            --
            rANCHO_UTIL_B_01 := F_ANCHO_UTIL(vEmpresa,nNumeOtre,rMaterial_B.Contador,1);
            rANCHO_UTIL_B_02 := F_ANCHO_UTIL(vEmpresa,nNumeOtre,rMaterial_B.Contador,2);
            rANCHO_UTIL_B_03 := F_ANCHO_UTIL(vEmpresa,nNumeOtre,rMaterial_B.Contador,3);
            rANCHO_UTIL_B_04 := F_ANCHO_UTIL(vEmpresa,nNumeOtre,rMaterial_B.Contador,4);
            rANCHO_UTIL_B_05 := F_ANCHO_UTIL(vEmpresa,nNumeOtre,rMaterial_B.Contador,5);
            rANCHO_UTIL_B_06 := F_ANCHO_UTIL(vEmpresa,nNumeOtre,rMaterial_B.Contador,6);
            rANCHO_UTIL_B_07 := F_ANCHO_UTIL(vEmpresa,nNumeOtre,rMaterial_B.Contador,7);
            rANCHO_UTIL_B_08 := F_ANCHO_UTIL(vEmpresa,nNumeOtre,rMaterial_B.Contador,8);
            rANCHO_UTIL_B_09 := F_ANCHO_UTIL(vEmpresa,nNumeOtre,rMaterial_B.Contador,9);
            rANCHO_UTIL_B_10 := F_ANCHO_UTIL(vEmpresa,nNumeOtre,rMaterial_B.Contador,10);
            --
            P_MATERIAL(rMaterial_B,'U',
							  NULL,--nCantProd
							  NULL,--nCantCons_E
							  NULL,--nCantCons
							  NULL,--nCantAjus
							  NULL,--nAncho
							  NULL,--nFACTOR_CONVERSION_M2_KG
							  NULL,--nPrecio_ML_E
							  NULL,--vLog_Precio
							  NULL,--nMermEnhe_E
							  NULL,--nMermEnhe
							  NULL,--nMermAjus_E
							  NULL,--nMermAjus
							  NULL,--nMermCabo_E
							  NULL,--nMermCabo
							  NULL,--nMermPico_E
                       NULL,--nMermPico
                       NULL,--nMermTita
                       NULL,--nMermSane
                       NULL,--nCantCons_Bobinas
                       --
                        rANCHO_UTIL_B_01.CONTFSMU, --nCONTFSMU_01 
                        rANCHO_UTIL_B_01.CANTFSMU, --nCANTFSMU_01 
                        rANCHO_UTIL_B_01.CATOFSMU, --nCATOFSMU 
                        rANCHO_UTIL_B_02.CONTFSMU, --nCONTFSMU_02 
                        rANCHO_UTIL_B_02.CANTFSMU, --nCANTFSMU_02 
                        rANCHO_UTIL_B_03.CONTFSMU, --nCONTFSMU_03 
                        rANCHO_UTIL_B_03.CANTFSMU, --nCANTFSMU_03 
                        rANCHO_UTIL_B_04.CONTFSMU, --nCONTFSMU_04 
                        rANCHO_UTIL_B_04.CANTFSMU, --nCANTFSMU_04 
                        rANCHO_UTIL_B_05.CONTFSMU, --nCONTFSMU_05 
                        rANCHO_UTIL_B_05.CANTFSMU, --nCANTFSMU_05 
                        rANCHO_UTIL_B_06.CONTFSMU, --nCONTFSMU_06 
                        rANCHO_UTIL_B_06.CANTFSMU, --nCANTFSMU_06 
                        rANCHO_UTIL_B_07.CONTFSMU, --nCONTFSMU_07 
                        rANCHO_UTIL_B_07.CANTFSMU, --nCANTFSMU_07 
                        rANCHO_UTIL_B_08.CONTFSMU, --nCONTFSMU_08 
                        rANCHO_UTIL_B_08.CANTFSMU, --nCANTFSMU_08 
                        rANCHO_UTIL_B_09.CONTFSMU, --nCONTFSMU_09 
                        rANCHO_UTIL_B_09.CANTFSMU, --nCANTFSMU_09 
                        rANCHO_UTIL_B_10.CONTFSMU, --nCONTFSMU_10 
                        rANCHO_UTIL_B_10.CANTFSMU, --nCANTFSMU_10 
                        NULL, --nANCHO_BUENO_TOTAL_01 
                        NULL, --nANCHO_BUENO_OT_01 
                        NULL, --nANCHO_BUENO_TOTAL_02 
                        NULL, --nANCHO_BUENO_OT_02 
                        NULL, --nANCHO_BUENO_TOTAL_03 
                        NULL, --nANCHO_BUENO_OT_03 
                        NULL, --nANCHO_BUENO_TOTAL_04 
                        NULL, --nANCHO_BUENO_OT_04 
                        NULL, --nANCHO_BUENO_TOTAL_05 
                        NULL, --nANCHO_BUENO_OT_05 
                        NULL, --nANCHO_BUENO_TOTAL_06 
                        NULL, --nANCHO_BUENO_OT_06 
                        NULL, --nANCHO_BUENO_TOTAL_07 
                        NULL, --nANCHO_BUENO_OT_07 
                        NULL, --nANCHO_BUENO_TOTAL_08 
                        NULL, --nANCHO_BUENO_OT_08 
                        NULL, --nANCHO_BUENO_TOTAL_09 
                        NULL, --nANCHO_BUENO_OT_09 
                        NULL, --nANCHO_BUENO_TOTAL_10 
                        NULL, --nANCHO_BUENO_OT_10 
                        NULL, --nANCHO_BUENO_TOTAL 
                        NULL, --nANCHO_BUENO_OT 
                        NULL, --nNUMECORT 
                        NULL, --nMM_MERMPRCO_01 
                        NULL, --nMM_MERMPLAN_EXESO_01 
                        NULL, --nMM_MERMPLAN_01 
                        NULL, --nMM_MERMPRCO_02 
                        NULL, --nMM_MERMPLAN_EXESO_02 
                        NULL, --nMM_MERMPLAN_02 
                        NULL, --nMM_MERMPRCO_03 
                        NULL, --nMM_MERMPLAN_EXESO_03 
                        NULL, --nMM_MERMPLAN_03 
                        NULL, --nMM_MERMPRCO_04 
                        NULL, --nMM_MERMPLAN_EXESO_04 
                        NULL, --nMM_MERMPLAN_04 
                        NULL, --nMM_MERMPRCO_05 
                        NULL, --nMM_MERMPLAN_EXESO_05 
                        NULL, --nMM_MERMPLAN_05 
                        NULL, --nMM_MERMPRCO_06 
                        NULL, --nMM_MERMPLAN_EXESO_06 
                        NULL, --nMM_MERMPLAN_06 
                        NULL, --nMM_MERMPRCO_07 
                        NULL, --nMM_MERMPLAN_EXESO_07 
                        NULL, --nMM_MERMPLAN_07 
                        NULL, --nMM_MERMPRCO_08 
                        NULL, --nMM_MERMPLAN_EXESO_08 
                        NULL, --nMM_MERMPLAN_08 
                        NULL, --nMM_MERMPRCO_09 
                        NULL, --nMM_MERMPLAN_EXESO_09 
                        NULL, --nMM_MERMPLAN_09 
                        NULL, --nMM_MERMPRCO_10 
                        NULL, --nMM_MERMPLAN_EXESO_10 
                        NULL, --nMM_MERMPLAN_10 
                        NULL, --nMM_MERMPRCO 
                        NULL, --nMM_MERMPLAN_EXESO 
                        NULL); --nMM_MERMPLAN
								
         END IF;
--dbms_Output.put_line('BUSQUEDA ANCHO BUENO: '||rMATERIAL_B.COD_ARTI||' LOTE: '||rMATERIAL_B.Lote||' ANCHO: '||rMATERIAL_B.Ancho||' ANCHO BUENO OT: '||rMATERIAL_B.Ancho_Bueno_OT||' ANCHO BUENO TOTAL: '||rMATERIAL_B.Ancho_Bueno_Total);               
         --Se actualiza el Ancho en Caso de ser Material de Cliente
         IF vMaprPrCl = 'S' THEN
            --t_MATERIAL(rMaterial_B.IDENTIFICADOR).Ancho := nCp_Ancho_Mm_Prod;
            P_MATERIAL(rMaterial_B,'U',
							  NULL,--nCantProd
							  NULL,--nCantCons_E
							  NULL,--nCantCons
							  NULL,--nCantAjus
							  nCp_Ancho_Mm_Prod,--nAncho
							  NULL,--nFACTOR_CONVERSION_M2_KG
							  NULL,--nPrecio_ML_E
							  NULL,--vLog_Precio
							  NULL,--nMermEnhe_E
							  NULL,--nMermEnhe
							  NULL,--nMermAjus_E
							  NULL,--nMermAjus
							  NULL,--nMermCabo_E
							  NULL,--nMermCabo
							  NULL,--nMermPico_E
                       NULL,--nMermPico
                       NULL,--nMermTita
                       NULL,--nMermSane
                       NULL,--nCantCons_Bobinas
                       --
                        NULL, --nCONTFSMU_01 
                        NULL, --nCANTFSMU_01 
                        NULL, --nCATOFSMU 
                        NULL, --nCONTFSMU_02 
                        NULL, --nCANTFSMU_02 
                        NULL, --nCONTFSMU_03 
                        NULL, --nCANTFSMU_03 
                        NULL, --nCONTFSMU_04 
                        NULL, --nCANTFSMU_04 
                        NULL, --nCONTFSMU_05 
                        NULL, --nCANTFSMU_05 
                        NULL, --nCONTFSMU_06 
                        NULL, --nCANTFSMU_06 
                        NULL, --nCONTFSMU_07 
                        NULL, --nCANTFSMU_07 
                        NULL, --nCONTFSMU_08 
                        NULL, --nCANTFSMU_08 
                        NULL, --nCONTFSMU_09 
                        NULL, --nCANTFSMU_09 
                        NULL, --nCONTFSMU_10 
                        NULL, --nCANTFSMU_10 
                        NULL, --nANCHO_BUENO_TOTAL_01 
                        NULL, --nANCHO_BUENO_OT_01 
                        NULL, --nANCHO_BUENO_TOTAL_02 
                        NULL, --nANCHO_BUENO_OT_02 
                        NULL, --nANCHO_BUENO_TOTAL_03 
                        NULL, --nANCHO_BUENO_OT_03 
                        NULL, --nANCHO_BUENO_TOTAL_04 
                        NULL, --nANCHO_BUENO_OT_04 
                        NULL, --nANCHO_BUENO_TOTAL_05 
                        NULL, --nANCHO_BUENO_OT_05 
                        NULL, --nANCHO_BUENO_TOTAL_06 
                        NULL, --nANCHO_BUENO_OT_06 
                        NULL, --nANCHO_BUENO_TOTAL_07 
                        NULL, --nANCHO_BUENO_OT_07 
                        NULL, --nANCHO_BUENO_TOTAL_08 
                        NULL, --nANCHO_BUENO_OT_08 
                        NULL, --nANCHO_BUENO_TOTAL_09 
                        NULL, --nANCHO_BUENO_OT_09 
                        NULL, --nANCHO_BUENO_TOTAL_10 
                        NULL, --nANCHO_BUENO_OT_10 
                        NULL, --nANCHO_BUENO_TOTAL 
                        NULL, --nANCHO_BUENO_OT 
                        NULL, --nNUMECORT 
                        NULL, --nMM_MERMPRCO_01 
                        NULL, --nMM_MERMPLAN_EXESO_01 
                        NULL, --nMM_MERMPLAN_01 
                        NULL, --nMM_MERMPRCO_02 
                        NULL, --nMM_MERMPLAN_EXESO_02 
                        NULL, --nMM_MERMPLAN_02 
                        NULL, --nMM_MERMPRCO_03 
                        NULL, --nMM_MERMPLAN_EXESO_03 
                        NULL, --nMM_MERMPLAN_03 
                        NULL, --nMM_MERMPRCO_04 
                        NULL, --nMM_MERMPLAN_EXESO_04 
                        NULL, --nMM_MERMPLAN_04 
                        NULL, --nMM_MERMPRCO_05 
                        NULL, --nMM_MERMPLAN_EXESO_05 
                        NULL, --nMM_MERMPLAN_05 
                        NULL, --nMM_MERMPRCO_06 
                        NULL, --nMM_MERMPLAN_EXESO_06 
                        NULL, --nMM_MERMPLAN_06 
                        NULL, --nMM_MERMPRCO_07 
                        NULL, --nMM_MERMPLAN_EXESO_07 
                        NULL, --nMM_MERMPLAN_07 
                        NULL, --nMM_MERMPRCO_08 
                        NULL, --nMM_MERMPLAN_EXESO_08 
                        NULL, --nMM_MERMPLAN_08 
                        NULL, --nMM_MERMPRCO_09 
                        NULL, --nMM_MERMPLAN_EXESO_09 
                        NULL, --nMM_MERMPLAN_09 
                        NULL, --nMM_MERMPRCO_10 
                        NULL, --nMM_MERMPLAN_EXESO_10 
                        NULL, --nMM_MERMPLAN_10 
                        NULL, --nMM_MERMPRCO 
                        NULL, --nMM_MERMPLAN_EXESO 
                        NULL); --nMM_MERMPLAN
         END IF;
         --Actualización de Ancho en el material en caso de Faltar
         IF rMATERIAL_B.Ancho IS NULL THEN
            IF rMATERIAL_B.Tip_Arti = vTIARREST THEN --Material de Restos
               nAncho := 0;
               nFCKG := 0;
            ELSIF rMATERIAL_B.Tip_Arti IN (vTiarMpF4,vTiarSeF4,vP_TiarFiF4) THEN --Si es Materia Prima se Busca el Ancho en Maestro de Articulos
               rArticulo.ANCHO := NULL;
               rArticulo.COD_LFS := NULL;
               rArticulo.UNIDSTOC := NULL;
               rArticulo.FCKG := NULL;
               --
               OPEN cArticulo(rMATERIAL_B.Empresa, rMATERIAL_B.Tip_Arti, rMATERIAL_B.Cod_Arti, P_Utilidad.f_ValoCampo(rMATERIAL_B.LOTE,'LOTE'));
               FETCH cArticulo INTO rArticulo;
               CLOSE cArticulo;
--dbms_Output.put_line('BUSCA ANCHO5:'||rMATERIAL_B.Empresa||', '||rMATERIAL_B.Tip_Arti||', '||rMATERIAL_B.Cod_Arti||' ANCHO->'||rArticulo.ANCHO);               
               --
               nAncho := rArticulo.ANCHO;
               nFCKG := rArticulo.FCKG;
            ELSE
               rBOBIMAQU_U := F_BOBIMAQU(P_Utilidad.f_ValoCampo(rMATERIAL_B.LOTE,'EMPRBOBI'), P_Utilidad.f_ValoCampo(rMATERIAL_B.LOTE,'NUOTBOBI'), P_Utilidad.f_ValoCampo(rMATERIAL_B.LOTE,'CONTBOBI'), P_Utilidad.f_ValoCampo(rMATERIAL_B.LOTE,'COBOBOBI'));
               --
               IF NVL(rBOBIMAQU_U.ESTADO,'X') != 'X' THEN
                  IF rBOBIMAQU_U.Ancho IS NULL AND vEmpresa||'-'||nNumeOtre != P_Utilidad.f_ValoCampo(rMATERIAL_B.LOTE,'EMPRBOBI')||'-'||P_Utilidad.f_ValoCampo(rMATERIAL_B.LOTE,'NUOTBOBI') THEN --Se calcula todo de la OT de la Bobina Utilizada, si no es de la misma Ot por que se entiende que si es de la misma Ot se calculara en Orden
                     P_CONSUMO_MATERIALES(P_Utilidad.f_ValoCampo(rMATERIAL_B.LOTE,'EMPRBOBI'), P_Utilidad.f_ValoCampo(rMATERIAL_B.LOTE,'NUOTBOBI'));
                     --Se busca la Bobina Utilizada con los Datos Actualizados
                     rBOBIMAQU_U := F_BOBIMAQU(P_Utilidad.f_ValoCampo(rMATERIAL_B.LOTE,'EMPRBOBI'), P_Utilidad.f_ValoCampo(rMATERIAL_B.LOTE,'NUOTBOBI'), P_Utilidad.f_ValoCampo(rMATERIAL_B.LOTE,'CONTBOBI'), P_Utilidad.f_ValoCampo(rMATERIAL_B.LOTE,'COBOBOBI'));
                  END IF;
               ELSE
                  --647 No se encuentra @1. [Contador @2]
                  P_ERRORES(vEmpresa, nNumeOtre, '647','la Bobina Utilizada ContBobi Maquina: '||P_Utilidad.f_ValoCampo(rMATERIAL_B.LOTE,'CONTBOBI')||' ContBobi: '||P_Utilidad.f_ValoCampo(rMATERIAL_B.LOTE,'COBOBOBI')||'|21','R','E');
                  --dbms_output.put_line('Error: No se encuentra la Bobina Utilizada '||P_Utilidad.f_ValoCampo(rMATERIAL_B.LOTE,'EMPRBOBI')||'-'||P_Utilidad.f_ValoCampo(rMATERIAL_B.LOTE,'NUOTBOBI')||'-'||P_Utilidad.f_ValoCampo(rMATERIAL_B.LOTE,'CONTBOBI')||'-'||P_Utilidad.f_ValoCampo(rMATERIAL_B.LOTE,'COBOBOBI'));
               END IF;
               --
               nAncho := rBOBIMAQU_U.ANCHO;
               nFCKG := rBOBIMAQU_U.FACTOR_CONVERSION_M2_KG;
            END IF;
            --Se actualiza el ancho del Material en caso de no existir
--dbms_Output.put_line('PREVIO ANCHO5:'||nAncho);                           
            --IF t_MATERIAL(rMaterial_B.IDENTIFICADOR).Ancho IS NULL THEN 
            IF rMaterial_B.Ancho IS NULL THEN 
               IF nAncho IS NOT NULL THEN
--dbms_Output.put_line('ANCHO5:'||nAncho);               
                  --t_MATERIAL(rMaterial_B.IDENTIFICADOR).Ancho := nAncho;
                  P_MATERIAL(rMaterial_B,'U',
							  NULL,--nCantProd
							  NULL,--nCantCons_E
							  NULL,--nCantCons
							  NULL,--nCantAjus
							  nAncho,--nAncho
							  NULL,--nFACTOR_CONVERSION_M2_KG
							  NULL,--nPrecio_ML_E
							  NULL,--vLog_Precio
							  NULL,--nMermEnhe_E
							  NULL,--nMermEnhe
							  NULL,--nMermAjus_E
							  NULL,--nMermAjus
							  NULL,--nMermCabo_E
							  NULL,--nMermCabo
							  NULL,--nMermPico_E
                       NULL,--nMermPico
                       NULL,--nMermTita
                       NULL,--nMermSane
                       NULL,--nCantCons_Bobinas
                       --
                        NULL, --nCONTFSMU_01 
                        NULL, --nCANTFSMU_01 
                        NULL, --nCATOFSMU 
                        NULL, --nCONTFSMU_02 
                        NULL, --nCANTFSMU_02 
                        NULL, --nCONTFSMU_03 
                        NULL, --nCANTFSMU_03 
                        NULL, --nCONTFSMU_04 
                        NULL, --nCANTFSMU_04 
                        NULL, --nCONTFSMU_05 
                        NULL, --nCANTFSMU_05 
                        NULL, --nCONTFSMU_06 
                        NULL, --nCANTFSMU_06 
                        NULL, --nCONTFSMU_07 
                        NULL, --nCANTFSMU_07 
                        NULL, --nCONTFSMU_08 
                        NULL, --nCANTFSMU_08 
                        NULL, --nCONTFSMU_09 
                        NULL, --nCANTFSMU_09 
                        NULL, --nCONTFSMU_10 
                        NULL, --nCANTFSMU_10 
                        NULL, --nANCHO_BUENO_TOTAL_01 
                        NULL, --nANCHO_BUENO_OT_01 
                        NULL, --nANCHO_BUENO_TOTAL_02 
                        NULL, --nANCHO_BUENO_OT_02 
                        NULL, --nANCHO_BUENO_TOTAL_03 
                        NULL, --nANCHO_BUENO_OT_03 
                        NULL, --nANCHO_BUENO_TOTAL_04 
                        NULL, --nANCHO_BUENO_OT_04 
                        NULL, --nANCHO_BUENO_TOTAL_05 
                        NULL, --nANCHO_BUENO_OT_05 
                        NULL, --nANCHO_BUENO_TOTAL_06 
                        NULL, --nANCHO_BUENO_OT_06 
                        NULL, --nANCHO_BUENO_TOTAL_07 
                        NULL, --nANCHO_BUENO_OT_07 
                        NULL, --nANCHO_BUENO_TOTAL_08 
                        NULL, --nANCHO_BUENO_OT_08 
                        NULL, --nANCHO_BUENO_TOTAL_09 
                        NULL, --nANCHO_BUENO_OT_09 
                        NULL, --nANCHO_BUENO_TOTAL_10 
                        NULL, --nANCHO_BUENO_OT_10 
                        NULL, --nANCHO_BUENO_TOTAL 
                        NULL, --nANCHO_BUENO_OT 
                        NULL, --nNUMECORT 
                        NULL, --nMM_MERMPRCO_01 
                        NULL, --nMM_MERMPLAN_EXESO_01 
                        NULL, --nMM_MERMPLAN_01 
                        NULL, --nMM_MERMPRCO_02 
                        NULL, --nMM_MERMPLAN_EXESO_02 
                        NULL, --nMM_MERMPLAN_02 
                        NULL, --nMM_MERMPRCO_03 
                        NULL, --nMM_MERMPLAN_EXESO_03 
                        NULL, --nMM_MERMPLAN_03 
                        NULL, --nMM_MERMPRCO_04 
                        NULL, --nMM_MERMPLAN_EXESO_04 
                        NULL, --nMM_MERMPLAN_04 
                        NULL, --nMM_MERMPRCO_05 
                        NULL, --nMM_MERMPLAN_EXESO_05 
                        NULL, --nMM_MERMPLAN_05 
                        NULL, --nMM_MERMPRCO_06 
                        NULL, --nMM_MERMPLAN_EXESO_06 
                        NULL, --nMM_MERMPLAN_06 
                        NULL, --nMM_MERMPRCO_07 
                        NULL, --nMM_MERMPLAN_EXESO_07 
                        NULL, --nMM_MERMPLAN_07 
                        NULL, --nMM_MERMPRCO_08 
                        NULL, --nMM_MERMPLAN_EXESO_08 
                        NULL, --nMM_MERMPLAN_08 
                        NULL, --nMM_MERMPRCO_09 
                        NULL, --nMM_MERMPLAN_EXESO_09 
                        NULL, --nMM_MERMPLAN_09 
                        NULL, --nMM_MERMPRCO_10 
                        NULL, --nMM_MERMPLAN_EXESO_10 
                        NULL, --nMM_MERMPLAN_10 
                        NULL, --nMM_MERMPRCO 
                        NULL, --nMM_MERMPLAN_EXESO 
                        NULL); --nMM_MERMPLAN
               ELSE
--dbms_Output.put_line('NO ENCUENTRA ANCHO5:'||nAncho);               
                  --647 No se encuentra @1. [Contador @2]
                  P_ERRORES(vEmpresa, nNumeOtre, '647','el Ancho en el Material Contador: '||rMaterial_B.Contador||' Articulo: '||rMaterial_B.Tip_Arti||'-'||rMaterial_B.Cod_Arti||'|21.1','R','E');
               END IF;
            END IF;
            --Se actualiza el FCKG del Material en caso de no existir
            --IF t_MATERIAL(rMaterial_B.IDENTIFICADOR).FACTOR_CONVERSION_M2_KG IS NULL AND nFCKG IS NOT NULL THEN
				IF rMaterial_B.FACTOR_CONVERSION_M2_KG IS NULL AND nFCKG IS NOT NULL THEN
               --t_MATERIAL(rMaterial_B.IDENTIFICADOR).FACTOR_CONVERSION_M2_KG := nFCKG;
               P_MATERIAL(rMaterial_B,'U',
							  NULL,--nCantProd
							  NULL,--nCantCons_E
							  NULL,--nCantCons
							  NULL,--nCantAjus
							  NULL,--nAncho
							  nFCKG,--nFACTOR_CONVERSION_M2_KG
							  NULL,--nPrecio_ML_E
							  NULL,--vLog_Precio
							  NULL,--nMermEnhe_E
							  NULL,--nMermEnhe
							  NULL,--nMermAjus_E
							  NULL,--nMermAjus
							  NULL,--nMermCabo_E
							  NULL,--nMermCabo
							  NULL,--nMermPico_E
                       NULL,--nMermPico
                       NULL,--nMermTita
                       NULL,--nMermSane
                       NULL,--nCantCons_Bobinas
                       --
                        NULL, --nCONTFSMU_01 
                        NULL, --nCANTFSMU_01 
                        NULL, --nCATOFSMU 
                        NULL, --nCONTFSMU_02 
                        NULL, --nCANTFSMU_02 
                        NULL, --nCONTFSMU_03 
                        NULL, --nCANTFSMU_03 
                        NULL, --nCONTFSMU_04 
                        NULL, --nCANTFSMU_04 
                        NULL, --nCONTFSMU_05 
                        NULL, --nCANTFSMU_05 
                        NULL, --nCONTFSMU_06 
                        NULL, --nCANTFSMU_06 
                        NULL, --nCONTFSMU_07 
                        NULL, --nCANTFSMU_07 
                        NULL, --nCONTFSMU_08 
                        NULL, --nCANTFSMU_08 
                        NULL, --nCONTFSMU_09 
                        NULL, --nCANTFSMU_09 
                        NULL, --nCONTFSMU_10 
                        NULL, --nCANTFSMU_10 
                        NULL, --nANCHO_BUENO_TOTAL_01 
                        NULL, --nANCHO_BUENO_OT_01 
                        NULL, --nANCHO_BUENO_TOTAL_02 
                        NULL, --nANCHO_BUENO_OT_02 
                        NULL, --nANCHO_BUENO_TOTAL_03 
                        NULL, --nANCHO_BUENO_OT_03 
                        NULL, --nANCHO_BUENO_TOTAL_04 
                        NULL, --nANCHO_BUENO_OT_04 
                        NULL, --nANCHO_BUENO_TOTAL_05 
                        NULL, --nANCHO_BUENO_OT_05 
                        NULL, --nANCHO_BUENO_TOTAL_06 
                        NULL, --nANCHO_BUENO_OT_06 
                        NULL, --nANCHO_BUENO_TOTAL_07 
                        NULL, --nANCHO_BUENO_OT_07 
                        NULL, --nANCHO_BUENO_TOTAL_08 
                        NULL, --nANCHO_BUENO_OT_08 
                        NULL, --nANCHO_BUENO_TOTAL_09 
                        NULL, --nANCHO_BUENO_OT_09 
                        NULL, --nANCHO_BUENO_TOTAL_10 
                        NULL, --nANCHO_BUENO_OT_10 
                        NULL, --nANCHO_BUENO_TOTAL 
                        NULL, --nANCHO_BUENO_OT 
                        NULL, --nNUMECORT 
                        NULL, --nMM_MERMPRCO_01 
                        NULL, --nMM_MERMPLAN_EXESO_01 
                        NULL, --nMM_MERMPLAN_01 
                        NULL, --nMM_MERMPRCO_02 
                        NULL, --nMM_MERMPLAN_EXESO_02 
                        NULL, --nMM_MERMPLAN_02 
                        NULL, --nMM_MERMPRCO_03 
                        NULL, --nMM_MERMPLAN_EXESO_03 
                        NULL, --nMM_MERMPLAN_03 
                        NULL, --nMM_MERMPRCO_04 
                        NULL, --nMM_MERMPLAN_EXESO_04 
                        NULL, --nMM_MERMPLAN_04 
                        NULL, --nMM_MERMPRCO_05 
                        NULL, --nMM_MERMPLAN_EXESO_05 
                        NULL, --nMM_MERMPLAN_05 
                        NULL, --nMM_MERMPRCO_06 
                        NULL, --nMM_MERMPLAN_EXESO_06 
                        NULL, --nMM_MERMPLAN_06 
                        NULL, --nMM_MERMPRCO_07 
                        NULL, --nMM_MERMPLAN_EXESO_07 
                        NULL, --nMM_MERMPLAN_07 
                        NULL, --nMM_MERMPRCO_08 
                        NULL, --nMM_MERMPLAN_EXESO_08 
                        NULL, --nMM_MERMPLAN_08 
                        NULL, --nMM_MERMPRCO_09 
                        NULL, --nMM_MERMPLAN_EXESO_09 
                        NULL, --nMM_MERMPLAN_09 
                        NULL, --nMM_MERMPRCO_10 
                        NULL, --nMM_MERMPLAN_EXESO_10 
                        NULL, --nMM_MERMPLAN_10 
                        NULL, --nMM_MERMPRCO 
                        NULL, --nMM_MERMPLAN_EXESO 
                        NULL); --nMM_MERMPLAN
            END IF;
--dbms_Output.put_line('   FIN BUSQUEDA ANCHO: '||rMATERIAL_B.COD_ARTI||' LOTE: '||rMATERIAL_B.Lote||' ANCHO: '||t_MATERIAL(rMaterial_B.IDENTIFICADOR).Ancho||' ANCHO BUENO OT: '||rMATERIAL_B.Ancho_Bueno_OT||' ANCHO BUENO TOTAL: '||rMATERIAL_B.Ancho_Bueno_Total);               
         END IF;
------>  

         --Si es nulo es porque el proceso de identificacion de anchos productivos no encontro alguna cortadora en el proceso que sigue este material, por lo que se asigna el ancho del material
         IF rMATERIAL_B.ANCHO_BUENO_TOTAL_01 IS NULL THEN
--dbms_Output.put_line('      ASIGNACION ANCHO BUENO: '||rMATERIAL_B.COD_ARTI||' LOTE: '||rMATERIAL_B.Lote||' ANCHO: '||t_MATERIAL(rMaterial_B.IDENTIFICADOR).Ancho||' ANCHO BUENO OT: '||rMATERIAL_B.Ancho_Bueno_OT||' ANCHO BUENO TOTAL: '||rMATERIAL_B.Ancho_Bueno_Total);               
            --t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_01 := t_MATERIAL(rMaterial_B.IDENTIFICADOR).Ancho;
            --t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_OT_01 := t_MATERIAL(rMaterial_B.IDENTIFICADOR).Ancho;
            P_MATERIAL(rMaterial_B,'U',
							  NULL,--nCantProd
							  NULL,--nCantCons_E
							  NULL,--nCantCons
							  NULL,--nCantAjus
							  NULL,--nAncho
							  NULL,--nFACTOR_CONVERSION_M2_KG
							  NULL,--nPrecio_ML_E
							  NULL,--vLog_Precio
							  NULL,--nMermEnhe_E
							  NULL,--nMermEnhe
							  NULL,--nMermAjus_E
							  NULL,--nMermAjus
							  NULL,--nMermCabo_E
							  NULL,--nMermCabo
							  NULL,--nMermPico_E
                       NULL,--nMermPico
                       NULL,--nMermTita
                       NULL,--nMermSane
                       NULL,--nCantCons_Bobinas
                       --
                        NULL, --nCONTFSMU_01 
                        NULL, --nCANTFSMU_01 
                        NULL, --nCATOFSMU 
                        NULL, --nCONTFSMU_02 
                        NULL, --nCANTFSMU_02 
                        NULL, --nCONTFSMU_03 
                        NULL, --nCANTFSMU_03 
                        NULL, --nCONTFSMU_04 
                        NULL, --nCANTFSMU_04 
                        NULL, --nCONTFSMU_05 
                        NULL, --nCANTFSMU_05 
                        NULL, --nCONTFSMU_06 
                        NULL, --nCANTFSMU_06 
                        NULL, --nCONTFSMU_07 
                        NULL, --nCANTFSMU_07 
                        NULL, --nCONTFSMU_08 
                        NULL, --nCANTFSMU_08 
                        NULL, --nCONTFSMU_09 
                        NULL, --nCANTFSMU_09 
                        NULL, --nCONTFSMU_10 
                        NULL, --nCANTFSMU_10 
                        rMaterial_B.Ancho, --nANCHO_BUENO_TOTAL_01 
                        rMaterial_B.Ancho, --nANCHO_BUENO_OT_01 
                        NULL, --nANCHO_BUENO_TOTAL_02 
                        NULL, --nANCHO_BUENO_OT_02 
                        NULL, --nANCHO_BUENO_TOTAL_03 
                        NULL, --nANCHO_BUENO_OT_03 
                        NULL, --nANCHO_BUENO_TOTAL_04 
                        NULL, --nANCHO_BUENO_OT_04 
                        NULL, --nANCHO_BUENO_TOTAL_05 
                        NULL, --nANCHO_BUENO_OT_05 
                        NULL, --nANCHO_BUENO_TOTAL_06 
                        NULL, --nANCHO_BUENO_OT_06 
                        NULL, --nANCHO_BUENO_TOTAL_07 
                        NULL, --nANCHO_BUENO_OT_07 
                        NULL, --nANCHO_BUENO_TOTAL_08 
                        NULL, --nANCHO_BUENO_OT_08 
                        NULL, --nANCHO_BUENO_TOTAL_09 
                        NULL, --nANCHO_BUENO_OT_09 
                        NULL, --nANCHO_BUENO_TOTAL_10 
                        NULL, --nANCHO_BUENO_OT_10 
                        NULL, --nANCHO_BUENO_TOTAL 
                        NULL, --nANCHO_BUENO_OT 
                        NULL, --nNUMECORT 
                        NULL, --nMM_MERMPRCO_01 
                        NULL, --nMM_MERMPLAN_EXESO_01 
                        NULL, --nMM_MERMPLAN_01 
                        NULL, --nMM_MERMPRCO_02 
                        NULL, --nMM_MERMPLAN_EXESO_02 
                        NULL, --nMM_MERMPLAN_02 
                        NULL, --nMM_MERMPRCO_03 
                        NULL, --nMM_MERMPLAN_EXESO_03 
                        NULL, --nMM_MERMPLAN_03 
                        NULL, --nMM_MERMPRCO_04 
                        NULL, --nMM_MERMPLAN_EXESO_04 
                        NULL, --nMM_MERMPLAN_04 
                        NULL, --nMM_MERMPRCO_05 
                        NULL, --nMM_MERMPLAN_EXESO_05 
                        NULL, --nMM_MERMPLAN_05 
                        NULL, --nMM_MERMPRCO_06 
                        NULL, --nMM_MERMPLAN_EXESO_06 
                        NULL, --nMM_MERMPLAN_06 
                        NULL, --nMM_MERMPRCO_07 
                        NULL, --nMM_MERMPLAN_EXESO_07 
                        NULL, --nMM_MERMPLAN_07 
                        NULL, --nMM_MERMPRCO_08 
                        NULL, --nMM_MERMPLAN_EXESO_08 
                        NULL, --nMM_MERMPLAN_08 
                        NULL, --nMM_MERMPRCO_09 
                        NULL, --nMM_MERMPLAN_EXESO_09 
                        NULL, --nMM_MERMPLAN_09 
                        NULL, --nMM_MERMPRCO_10 
                        NULL, --nMM_MERMPLAN_EXESO_10 
                        NULL, --nMM_MERMPLAN_10 
                        NULL, --nMM_MERMPRCO 
                        NULL, --nMM_MERMPLAN_EXESO 
                        NULL); --nMM_MERMPLAN
         END IF;
         -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
         --NO SE ASIGNA EL ANCHO BUENO TOTAL PARA 02 HASYA 10 PORQUE SE ENTIENDE QUE SI EXISTEN ES POR QUE SE ENCONTRARON CORTADORAS DE  FASES SIGUIENTES MULTIPLES Y ESTAS DEFINEN EL ANCHO BUENO TOTAL
         --EN PRINCIPIO ESTO ES PARA LAS OTS QUE NO TIENEN CORTADORA FINAL
         -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
         --------------------------------
         --CALCULO DE ANCHO_BUENO_TOTAL--
         --------------------------------
         --Bajo este concepto
         --                                                              = CANTFSMU_01
         --Valor calculado Ej:                                  (CANTIDAD_CONSUMIDA_ULTIMA_FASE_01)                                         (CANTIDAD_CONSUMIDA_ULTIMA_FASE_01)
         --                    ( ( (ANCHO_BUENO_TOTAL_01) * -------------------------------------------- ) + ( (ANCHO_BUENO_TOTAL_02) * -------------------------------------------- ) + ....)  --Se encuentran los mm de ANCH_TOTAL patiendo de los ANCHOS encontrados y los Consumos de Material en la Ultima Fase
         --                                                 (TOTAL_DE_CANTIDADES_CONSUMIDAS_ULTIMA_FASE)                                (TOTAL_DE_CANTIDADES_CONSUMIDAS_ULTIMA_FASE)
         --                                                              = CATOFSMU
         --
         --IF NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).CATOFSMU,0) != 0 THEN
         IF NVL(rMaterial_B.CATOFSMU,0) != 0 THEN
            --Se busca si la Maquina pertenece a Fases Multiples Definidas
            nContador_Busqueda_Anterior := NULL;
            --
            nANCHO_BUENO_TOTAL := 0;
            nANCHO_BUENO_OT := 0;
            --
            nContador_Busqueda_Anterior := F_MAQUINA_FASESIMU_CONTANTE(vEmpresa, nNumeOtre, rMaterial_B.CONTADOR);
            --Si la Maquina pertenece a Fases Multiples Definidas hay que buscar todos los anchos Multiples En Fase 1
            IF nContador_Busqueda_Anterior IS NOT NULL THEN
               nCATOFSMU := 0;
               --Se suman las cantidades Totales de las Maquinas(Por ser Fases Siguientes Multiples la CANTFSMU = CATOFSMU)
               FOR nI In 1..T_MAQUINA_FASESIMU.COUNT LOOP
                  biIndice_M   := nI;
                  rMAQUINA_FASESIMU := T_MAQUINA_FASESIMU(biIndice_M);
                  --
                  IF  rMAQUINA_FASESIMU.EMPRESA = vEmpresa 
                  AND rMAQUINA_FASESIMU.NUMEOTRE = nNumeOtre 
                  AND rMAQUINA_FASESIMU.CONTADOR_ANTERIOR = nContador_Busqueda_Anterior THEN
                     rANCHO_UTIL_B_01 := F_ANCHO_UTIL(vEmpresa,nNumeOtre,rMAQUINA_FASESIMU.CONTADOR,1);
                     --
                     nCATOFSMU := nCATOFSMU + NVL(rANCHO_UTIL_B_01.CATOFSMU,0);
                  END IF;
               END LOOP;
               --Se calcula El Ancho Promedio
               FOR nI In 1..T_MAQUINA_FASESIMU.COUNT LOOP
                  biIndice_M   := nI;
                  rMAQUINA_FASESIMU := T_MAQUINA_FASESIMU(biIndice_M);
                  --
                  IF  rMAQUINA_FASESIMU.EMPRESA = vEmpresa 
                  AND rMAQUINA_FASESIMU.NUMEOTRE = nNumeOtre 
                  AND rMAQUINA_FASESIMU.CONTADOR_ANTERIOR = nContador_Busqueda_Anterior THEN
                     rANCHO_UTIL_B_01 := F_ANCHO_UTIL(vEmpresa,nNumeOtre,rMAQUINA_FASESIMU.CONTADOR,1);
--dbms_Output.put_line('BUSQUEDA POR FASE SIGUIENTE MULTIPLE MATERIAL ->'||rMaterial_B.CONTADOR||'-'||rMaterial_B.COD_ARTI||'-'||rMaterial_B.CONTADOR||'-'||rMaterial_B.LOTE||' Ancho: '||rMaterial_B.ANCHO||' Ancho Util:' ||rANCHO_UTIL_B.ANCHO_UTILIZADO_UTIL_BOBINA||' CANTFSMU: '||rANCHO_UTIL_B.CANTFSMU||' nCATOFSMU: '||nCATOFSMU);                        
                     --
                     IF NVL(nCATOFSMU,0) != 0 THEN
--dbms_Output.put_line('nANCHO_BUENO_TOTAL := '||nANCHO_BUENO_TOTAL||' + ('||NVL(rANCHO_UTIL_B.ANCHO_UTILIZADO_OT,0)||' * ('||NVL(rANCHO_UTIL_B.CANTFSMU,0)||' / '||NVL(nCATOFSMU,0)||'))');
                        nANCHO_BUENO_TOTAL := nANCHO_BUENO_TOTAL + (NVL(rANCHO_UTIL_B_01.ANCHO_UTILIZADO_OT,0) * (NVL(rANCHO_UTIL_B_01.CANTFSMU,0) / NVL(nCATOFSMU,0)));
                        nANCHO_BUENO_OT := nANCHO_BUENO_OT + (NVL(rANCHO_UTIL_B_01.ANCHO_USADO_Y_EXPEDIDO_OT,0) * (NVL(rANCHO_UTIL_B_01.CANTFSMU,0) / NVL(nCATOFSMU,0)));
                     END IF;
                  END IF;
               END LOOP;
               --
               --t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL := nANCHO_BUENO_TOTAL;
               --t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_OT := nANCHO_BUENO_OT;
               --
--dbms_Output.put_line('NUMERO DE CORTES FASE SIGUIENTE MULTIPLE MATERIAL ->'||rMaterial_B.CONTADOR||'-'||rMaterial_B.COD_ARTI||'-'||rMaterial_B.CONTADOR||'-'||rMaterial_B.LOTE||' Ancho: '||rMaterial_B.ANCHO||' Cortes: '||t_MATERIAL(rMaterial_B.IDENTIFICADOR).NUMECORT_01);                        
               --t_MATERIAL(rMaterial_B.IDENTIFICADOR).NUMECORT := t_MATERIAL(rMaterial_B.IDENTIFICADOR).NUMECORT_01;
               P_MATERIAL(rMaterial_B,'U',
							  NULL,--nCantProd
							  NULL,--nCantCons_E
							  NULL,--nCantCons
							  NULL,--nCantAjus
							  NULL,--nAncho
							  NULL,--nFACTOR_CONVERSION_M2_KG
							  NULL,--nPrecio_ML_E
							  NULL,--vLog_Precio
							  NULL,--nMermEnhe_E
							  NULL,--nMermEnhe
							  NULL,--nMermAjus_E
							  NULL,--nMermAjus
							  NULL,--nMermCabo_E
							  NULL,--nMermCabo
							  NULL,--nMermPico_E
                       NULL,--nMermPico
                       NULL,--nMermTita
                       NULL,--nMermSane
                       NULL,--nCantCons_Bobinas
                       --
                        NULL, --nCONTFSMU_01 
                        NULL, --nCANTFSMU_01 
                        NULL, --nCATOFSMU 
                        NULL, --nCONTFSMU_02 
                        NULL, --nCANTFSMU_02 
                        NULL, --nCONTFSMU_03 
                        NULL, --nCANTFSMU_03 
                        NULL, --nCONTFSMU_04 
                        NULL, --nCANTFSMU_04 
                        NULL, --nCONTFSMU_05 
                        NULL, --nCANTFSMU_05 
                        NULL, --nCONTFSMU_06 
                        NULL, --nCANTFSMU_06 
                        NULL, --nCONTFSMU_07 
                        NULL, --nCANTFSMU_07 
                        NULL, --nCONTFSMU_08 
                        NULL, --nCANTFSMU_08 
                        NULL, --nCONTFSMU_09 
                        NULL, --nCANTFSMU_09 
                        NULL, --nCONTFSMU_10 
                        NULL, --nCANTFSMU_10 
                        NULL, --nANCHO_BUENO_TOTAL_01 
                        NULL, --nANCHO_BUENO_OT_01 
                        NULL, --nANCHO_BUENO_TOTAL_02 
                        NULL, --nANCHO_BUENO_OT_02 
                        NULL, --nANCHO_BUENO_TOTAL_03 
                        NULL, --nANCHO_BUENO_OT_03 
                        NULL, --nANCHO_BUENO_TOTAL_04 
                        NULL, --nANCHO_BUENO_OT_04 
                        NULL, --nANCHO_BUENO_TOTAL_05 
                        NULL, --nANCHO_BUENO_OT_05 
                        NULL, --nANCHO_BUENO_TOTAL_06 
                        NULL, --nANCHO_BUENO_OT_06 
                        NULL, --nANCHO_BUENO_TOTAL_07 
                        NULL, --nANCHO_BUENO_OT_07 
                        NULL, --nANCHO_BUENO_TOTAL_08 
                        NULL, --nANCHO_BUENO_OT_08 
                        NULL, --nANCHO_BUENO_TOTAL_09 
                        NULL, --nANCHO_BUENO_OT_09 
                        NULL, --nANCHO_BUENO_TOTAL_10 
                        NULL, --nANCHO_BUENO_OT_10 
                        nANCHO_BUENO_TOTAL, --nANCHO_BUENO_TOTAL 
                        nANCHO_BUENO_OT, --nANCHO_BUENO_OT 
                        rMaterial_B.NUMECORT_01, --nNUMECORT 
                        NULL, --nMM_MERMPRCO_01 
                        NULL, --nMM_MERMPLAN_EXESO_01 
                        NULL, --nMM_MERMPLAN_01 
                        NULL, --nMM_MERMPRCO_02 
                        NULL, --nMM_MERMPLAN_EXESO_02 
                        NULL, --nMM_MERMPLAN_02 
                        NULL, --nMM_MERMPRCO_03 
                        NULL, --nMM_MERMPLAN_EXESO_03 
                        NULL, --nMM_MERMPLAN_03 
                        NULL, --nMM_MERMPRCO_04 
                        NULL, --nMM_MERMPLAN_EXESO_04 
                        NULL, --nMM_MERMPLAN_04 
                        NULL, --nMM_MERMPRCO_05 
                        NULL, --nMM_MERMPLAN_EXESO_05 
                        NULL, --nMM_MERMPLAN_05 
                        NULL, --nMM_MERMPRCO_06 
                        NULL, --nMM_MERMPLAN_EXESO_06 
                        NULL, --nMM_MERMPLAN_06 
                        NULL, --nMM_MERMPRCO_07 
                        NULL, --nMM_MERMPLAN_EXESO_07 
                        NULL, --nMM_MERMPLAN_07 
                        NULL, --nMM_MERMPRCO_08 
                        NULL, --nMM_MERMPLAN_EXESO_08 
                        NULL, --nMM_MERMPLAN_08 
                        NULL, --nMM_MERMPRCO_09 
                        NULL, --nMM_MERMPLAN_EXESO_09 
                        NULL, --nMM_MERMPLAN_09 
                        NULL, --nMM_MERMPRCO_10 
                        NULL, --nMM_MERMPLAN_EXESO_10 
                        NULL, --nMM_MERMPLAN_10 
                        NULL, --nMM_MERMPRCO 
                        NULL, --nMM_MERMPLAN_EXESO 
                        NULL); --nMM_MERMPLAN
            ELSE --Se comporta como Promedio Normal
               /*
               t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL := (
                                                                        (NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_01,0) * (NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).CANTFSMU_01,0) / NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).CATOFSMU,0))) +
                                                                        (NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_02,0) * (NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).CANTFSMU_02,0) / NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).CATOFSMU,0))) +
                                                                        (NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_03,0) * (NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).CANTFSMU_03,0) / NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).CATOFSMU,0))) +
                                                                        (NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_04,0) * (NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).CANTFSMU_04,0) / NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).CATOFSMU,0))) +
                                                                        (NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_05,0) * (NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).CANTFSMU_05,0) / NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).CATOFSMU,0))) +
                                                                        (NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_06,0) * (NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).CANTFSMU_06,0) / NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).CATOFSMU,0))) +
                                                                        (NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_07,0) * (NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).CANTFSMU_07,0) / NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).CATOFSMU,0))) +
                                                                        (NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_08,0) * (NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).CANTFSMU_08,0) / NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).CATOFSMU,0))) +
                                                                        (NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_09,0) * (NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).CANTFSMU_09,0) / NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).CATOFSMU,0))) +
                                                                        (NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_10,0) * (NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).CANTFSMU_10,0) / NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).CATOFSMU,0)))
                                                                       );
               --
               t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_OT := (
                                                                        (NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_OT_01,0) * (NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).CANTFSMU_01,0) / NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).CATOFSMU,0))) +
                                                                        (NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_OT_02,0) * (NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).CANTFSMU_02,0) / NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).CATOFSMU,0))) +
                                                                        (NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_OT_03,0) * (NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).CANTFSMU_03,0) / NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).CATOFSMU,0))) +
                                                                        (NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_OT_04,0) * (NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).CANTFSMU_04,0) / NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).CATOFSMU,0))) +
                                                                        (NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_OT_05,0) * (NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).CANTFSMU_05,0) / NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).CATOFSMU,0))) +
                                                                        (NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_OT_06,0) * (NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).CANTFSMU_06,0) / NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).CATOFSMU,0))) +
                                                                        (NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_OT_07,0) * (NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).CANTFSMU_07,0) / NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).CATOFSMU,0))) +
                                                                        (NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_OT_08,0) * (NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).CANTFSMU_08,0) / NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).CATOFSMU,0))) +
                                                                        (NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_OT_09,0) * (NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).CANTFSMU_09,0) / NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).CATOFSMU,0))) +
                                                                        (NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_OT_10,0) * (NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).CANTFSMU_10,0) / NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).CATOFSMU,0)))
                                                                       );
--dbms_Output.put_line('NUMERO DE CORTES MATERIAL ->'||rMaterial_B.CONTADOR||'-'||rMaterial_B.COD_ARTI||'-'||rMaterial_B.CONTADOR||'-'||rMaterial_B.LOTE||' Ancho: '||rMaterial_B.ANCHO||' Cortes: '||t_MATERIAL(rMaterial_B.IDENTIFICADOR).NUMECORT_01||' + '||t_MATERIAL(rMaterial_B.IDENTIFICADOR).NUMECORT_02||' + '||t_MATERIAL(rMaterial_B.IDENTIFICADOR).NUMECORT_03||' + '||t_MATERIAL(rMaterial_B.IDENTIFICADOR).NUMECORT_04||' + '||t_MATERIAL(rMaterial_B.IDENTIFICADOR).NUMECORT_05||' + '||t_MATERIAL(rMaterial_B.IDENTIFICADOR).NUMECORT_06||' + '||t_MATERIAL(rMaterial_B.IDENTIFICADOR).NUMECORT_07||' + '||t_MATERIAL(rMaterial_B.IDENTIFICADOR).NUMECORT_08||' + '||t_MATERIAL(rMaterial_B.IDENTIFICADOR).NUMECORT_09||' + '||t_MATERIAL(rMaterial_B.IDENTIFICADOR).NUMECORT_10);
               t_MATERIAL(rMaterial_B.IDENTIFICADOR).NUMECORT := t_MATERIAL(rMaterial_B.IDENTIFICADOR).NUMECORT_01 + t_MATERIAL(rMaterial_B.IDENTIFICADOR).NUMECORT_02 + t_MATERIAL(rMaterial_B.IDENTIFICADOR).NUMECORT_03 + t_MATERIAL(rMaterial_B.IDENTIFICADOR).NUMECORT_04 + t_MATERIAL(rMaterial_B.IDENTIFICADOR).NUMECORT_05 + t_MATERIAL(rMaterial_B.IDENTIFICADOR).NUMECORT_06 + t_MATERIAL(rMaterial_B.IDENTIFICADOR).NUMECORT_07 + t_MATERIAL(rMaterial_B.IDENTIFICADOR).NUMECORT_08 + t_MATERIAL(rMaterial_B.IDENTIFICADOR).NUMECORT_09 + t_MATERIAL(rMaterial_B.IDENTIFICADOR).NUMECORT_10;
               */
               P_MATERIAL(rMaterial_B,'U',
							  NULL,--nCantProd
							  NULL,--nCantCons_E
							  NULL,--nCantCons
							  NULL,--nCantAjus
							  NULL,--nAncho
							  NULL,--nFACTOR_CONVERSION_M2_KG
							  NULL,--nPrecio_ML_E
							  NULL,--vLog_Precio
							  NULL,--nMermEnhe_E
							  NULL,--nMermEnhe
							  NULL,--nMermAjus_E
							  NULL,--nMermAjus
							  NULL,--nMermCabo_E
							  NULL,--nMermCabo
							  NULL,--nMermPico_E
                       NULL,--nMermPico
                       NULL,--nMermTita
                       NULL,--nMermSane
                       NULL,--nCantCons_Bobinas
                       --
                        NULL, --nCONTFSMU_01 
                        NULL, --nCANTFSMU_01 
                        NULL, --nCATOFSMU 
                        NULL, --nCONTFSMU_02 
                        NULL, --nCANTFSMU_02 
                        NULL, --nCONTFSMU_03 
                        NULL, --nCANTFSMU_03 
                        NULL, --nCONTFSMU_04 
                        NULL, --nCANTFSMU_04 
                        NULL, --nCONTFSMU_05 
                        NULL, --nCANTFSMU_05 
                        NULL, --nCONTFSMU_06 
                        NULL, --nCANTFSMU_06 
                        NULL, --nCONTFSMU_07 
                        NULL, --nCANTFSMU_07 
                        NULL, --nCONTFSMU_08 
                        NULL, --nCANTFSMU_08 
                        NULL, --nCONTFSMU_09 
                        NULL, --nCANTFSMU_09 
                        NULL, --nCONTFSMU_10 
                        NULL, --nCANTFSMU_10 
                        NULL, --nANCHO_BUENO_TOTAL_01 
                        NULL, --nANCHO_BUENO_OT_01 
                        NULL, --nANCHO_BUENO_TOTAL_02 
                        NULL, --nANCHO_BUENO_OT_02 
                        NULL, --nANCHO_BUENO_TOTAL_03 
                        NULL, --nANCHO_BUENO_OT_03 
                        NULL, --nANCHO_BUENO_TOTAL_04 
                        NULL, --nANCHO_BUENO_OT_04 
                        NULL, --nANCHO_BUENO_TOTAL_05 
                        NULL, --nANCHO_BUENO_OT_05 
                        NULL, --nANCHO_BUENO_TOTAL_06 
                        NULL, --nANCHO_BUENO_OT_06 
                        NULL, --nANCHO_BUENO_TOTAL_07 
                        NULL, --nANCHO_BUENO_OT_07 
                        NULL, --nANCHO_BUENO_TOTAL_08 
                        NULL, --nANCHO_BUENO_OT_08 
                        NULL, --nANCHO_BUENO_TOTAL_09 
                        NULL, --nANCHO_BUENO_OT_09 
                        NULL, --nANCHO_BUENO_TOTAL_10 
                        NULL, --nANCHO_BUENO_OT_10 
                        (
                           (NVL(rMaterial_B.ANCHO_BUENO_TOTAL_01,0) * (NVL(rMaterial_B.CANTFSMU_01,0) / NVL(rMaterial_B.CATOFSMU,0))) +
                           (NVL(rMaterial_B.ANCHO_BUENO_TOTAL_02,0) * (NVL(rMaterial_B.CANTFSMU_02,0) / NVL(rMaterial_B.CATOFSMU,0))) +
                           (NVL(rMaterial_B.ANCHO_BUENO_TOTAL_03,0) * (NVL(rMaterial_B.CANTFSMU_03,0) / NVL(rMaterial_B.CATOFSMU,0))) +
                           (NVL(rMaterial_B.ANCHO_BUENO_TOTAL_04,0) * (NVL(rMaterial_B.CANTFSMU_04,0) / NVL(rMaterial_B.CATOFSMU,0))) +
                           (NVL(rMaterial_B.ANCHO_BUENO_TOTAL_05,0) * (NVL(rMaterial_B.CANTFSMU_05,0) / NVL(rMaterial_B.CATOFSMU,0))) +
                           (NVL(rMaterial_B.ANCHO_BUENO_TOTAL_06,0) * (NVL(rMaterial_B.CANTFSMU_06,0) / NVL(rMaterial_B.CATOFSMU,0))) +
                           (NVL(rMaterial_B.ANCHO_BUENO_TOTAL_07,0) * (NVL(rMaterial_B.CANTFSMU_07,0) / NVL(rMaterial_B.CATOFSMU,0))) +
                           (NVL(rMaterial_B.ANCHO_BUENO_TOTAL_08,0) * (NVL(rMaterial_B.CANTFSMU_08,0) / NVL(rMaterial_B.CATOFSMU,0))) +
                           (NVL(rMaterial_B.ANCHO_BUENO_TOTAL_09,0) * (NVL(rMaterial_B.CANTFSMU_09,0) / NVL(rMaterial_B.CATOFSMU,0))) +
                           (NVL(rMaterial_B.ANCHO_BUENO_TOTAL_10,0) * (NVL(rMaterial_B.CANTFSMU_10,0) / NVL(rMaterial_B.CATOFSMU,0)))
                          ), --nANCHO_BUENO_TOTAL 
                        (
                           (NVL(rMaterial_B.ANCHO_BUENO_OT_01,0) * (NVL(rMaterial_B.CANTFSMU_01,0) / NVL(rMaterial_B.CATOFSMU,0))) +
                           (NVL(rMaterial_B.ANCHO_BUENO_OT_02,0) * (NVL(rMaterial_B.CANTFSMU_02,0) / NVL(rMaterial_B.CATOFSMU,0))) +
                           (NVL(rMaterial_B.ANCHO_BUENO_OT_03,0) * (NVL(rMaterial_B.CANTFSMU_03,0) / NVL(rMaterial_B.CATOFSMU,0))) +
                           (NVL(rMaterial_B.ANCHO_BUENO_OT_04,0) * (NVL(rMaterial_B.CANTFSMU_04,0) / NVL(rMaterial_B.CATOFSMU,0))) +
                           (NVL(rMaterial_B.ANCHO_BUENO_OT_05,0) * (NVL(rMaterial_B.CANTFSMU_05,0) / NVL(rMaterial_B.CATOFSMU,0))) +
                           (NVL(rMaterial_B.ANCHO_BUENO_OT_06,0) * (NVL(rMaterial_B.CANTFSMU_06,0) / NVL(rMaterial_B.CATOFSMU,0))) +
                           (NVL(rMaterial_B.ANCHO_BUENO_OT_07,0) * (NVL(rMaterial_B.CANTFSMU_07,0) / NVL(rMaterial_B.CATOFSMU,0))) +
                           (NVL(rMaterial_B.ANCHO_BUENO_OT_08,0) * (NVL(rMaterial_B.CANTFSMU_08,0) / NVL(rMaterial_B.CATOFSMU,0))) +
                           (NVL(rMaterial_B.ANCHO_BUENO_OT_09,0) * (NVL(rMaterial_B.CANTFSMU_09,0) / NVL(rMaterial_B.CATOFSMU,0))) +
                           (NVL(rMaterial_B.ANCHO_BUENO_OT_10,0) * (NVL(rMaterial_B.CANTFSMU_10,0) / NVL(rMaterial_B.CATOFSMU,0)))
                          ), --nANCHO_BUENO_OT 
                        rMaterial_B.NUMECORT_01 + rMaterial_B.NUMECORT_02 + rMaterial_B.NUMECORT_03 + rMaterial_B.NUMECORT_04 + rMaterial_B.NUMECORT_05 + rMaterial_B.NUMECORT_06 + rMaterial_B.NUMECORT_07 + rMaterial_B.NUMECORT_08 + rMaterial_B.NUMECORT_09 + rMaterial_B.NUMECORT_10, --nNUMECORT 
                        NULL, --nMM_MERMPRCO_01 
                        NULL, --nMM_MERMPLAN_EXESO_01 
                        NULL, --nMM_MERMPLAN_01 
                        NULL, --nMM_MERMPRCO_02 
                        NULL, --nMM_MERMPLAN_EXESO_02 
                        NULL, --nMM_MERMPLAN_02 
                        NULL, --nMM_MERMPRCO_03 
                        NULL, --nMM_MERMPLAN_EXESO_03 
                        NULL, --nMM_MERMPLAN_03 
                        NULL, --nMM_MERMPRCO_04 
                        NULL, --nMM_MERMPLAN_EXESO_04 
                        NULL, --nMM_MERMPLAN_04 
                        NULL, --nMM_MERMPRCO_05 
                        NULL, --nMM_MERMPLAN_EXESO_05 
                        NULL, --nMM_MERMPLAN_05 
                        NULL, --nMM_MERMPRCO_06 
                        NULL, --nMM_MERMPLAN_EXESO_06 
                        NULL, --nMM_MERMPLAN_06 
                        NULL, --nMM_MERMPRCO_07 
                        NULL, --nMM_MERMPLAN_EXESO_07 
                        NULL, --nMM_MERMPLAN_07 
                        NULL, --nMM_MERMPRCO_08 
                        NULL, --nMM_MERMPLAN_EXESO_08 
                        NULL, --nMM_MERMPLAN_08 
                        NULL, --nMM_MERMPRCO_09 
                        NULL, --nMM_MERMPLAN_EXESO_09 
                        NULL, --nMM_MERMPLAN_09 
                        NULL, --nMM_MERMPRCO_10 
                        NULL, --nMM_MERMPLAN_EXESO_10 
                        NULL, --nMM_MERMPLAN_10 
                        NULL, --nMM_MERMPRCO 
                        NULL, --nMM_MERMPLAN_EXESO 
                        NULL); --nMM_MERMPLAN
            END IF;
--dbms_Output.put_line('MATERIAL ANCHO TOTAL: '||rMATERIAL_B.COD_ARTI||' LOTE: '||rMATERIAL_B.Lote||' CONTADOR: '||rMaterial_B.CONTADOR||' ANCHO: '||t_MATERIAL(rMaterial_B.IDENTIFICADOR).Ancho||' ANCHO BUENO TOTAL: '||t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL||' ANCHO BUENO TOTAL 01: '||t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_01||' ANCHO BUENO TOTAL 02: '||t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_02||' CANTIDAD TOTAL EN FASE SIG MUL 01: '||t_MATERIAL(rMaterial_B.IDENTIFICADOR).CANTFSMU_01||' CANTIDAD TOTAL EN FASE SIG MUL 02: '||t_MATERIAL(rMaterial_B.IDENTIFICADOR).CANTFSMU_02||' CANTIDAD TOTAL EN FASE SIG TODAS: '||t_MATERIAL(rMaterial_B.IDENTIFICADOR).CATOFSMU);               
         ELSE
--dbms_Output.put_line('MATERIAL NO CALCULADO EL ANCHO TOTAL: '||rMATERIAL_B.COD_ARTI||' LOTE: '||rMATERIAL_B.Lote||' CONTADOR: '||rMaterial_B.CONTADOR||' ANCHO: '||t_MATERIAL(rMaterial_B.IDENTIFICADOR).Ancho||' ANCHO BUENO TOTAL 01: '||t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_01||' CANTIDAD TOTAL EN FASE SIG MUL: '||t_MATERIAL(rMaterial_B.IDENTIFICADOR).CANTFSMU_01||' CANTIDAD TOTAL EN FASE SIG TODAS: '||t_MATERIAL(rMaterial_B.IDENTIFICADOR).CATOFSMU);               
            --t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL := t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_01;
            --t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_OT := t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_OT_01;
            P_MATERIAL(rMaterial_B,'U',
							  NULL,--nCantProd
							  NULL,--nCantCons_E
							  NULL,--nCantCons
							  NULL,--nCantAjus
							  NULL,--nAncho
							  NULL,--nFACTOR_CONVERSION_M2_KG
							  NULL,--nPrecio_ML_E
							  NULL,--vLog_Precio
							  NULL,--nMermEnhe_E
							  NULL,--nMermEnhe
							  NULL,--nMermAjus_E
							  NULL,--nMermAjus
							  NULL,--nMermCabo_E
							  NULL,--nMermCabo
							  NULL,--nMermPico_E
                       NULL,--nMermPico
                       NULL,--nMermTita
                       NULL,--nMermSane
                       NULL,--nCantCons_Bobinas
                       --
                        NULL, --nCONTFSMU_01 
                        NULL, --nCANTFSMU_01 
                        NULL, --nCATOFSMU 
                        NULL, --nCONTFSMU_02 
                        NULL, --nCANTFSMU_02 
                        NULL, --nCONTFSMU_03 
                        NULL, --nCANTFSMU_03 
                        NULL, --nCONTFSMU_04 
                        NULL, --nCANTFSMU_04 
                        NULL, --nCONTFSMU_05 
                        NULL, --nCANTFSMU_05 
                        NULL, --nCONTFSMU_06 
                        NULL, --nCANTFSMU_06 
                        NULL, --nCONTFSMU_07 
                        NULL, --nCANTFSMU_07 
                        NULL, --nCONTFSMU_08 
                        NULL, --nCANTFSMU_08 
                        NULL, --nCONTFSMU_09 
                        NULL, --nCANTFSMU_09 
                        NULL, --nCONTFSMU_10 
                        NULL, --nCANTFSMU_10 
                        NULL, --nANCHO_BUENO_TOTAL_01 
                        NULL, --nANCHO_BUENO_OT_01 
                        NULL, --nANCHO_BUENO_TOTAL_02 
                        NULL, --nANCHO_BUENO_OT_02 
                        NULL, --nANCHO_BUENO_TOTAL_03 
                        NULL, --nANCHO_BUENO_OT_03 
                        NULL, --nANCHO_BUENO_TOTAL_04 
                        NULL, --nANCHO_BUENO_OT_04 
                        NULL, --nANCHO_BUENO_TOTAL_05 
                        NULL, --nANCHO_BUENO_OT_05 
                        NULL, --nANCHO_BUENO_TOTAL_06 
                        NULL, --nANCHO_BUENO_OT_06 
                        NULL, --nANCHO_BUENO_TOTAL_07 
                        NULL, --nANCHO_BUENO_OT_07 
                        NULL, --nANCHO_BUENO_TOTAL_08 
                        NULL, --nANCHO_BUENO_OT_08 
                        NULL, --nANCHO_BUENO_TOTAL_09 
                        NULL, --nANCHO_BUENO_OT_09 
                        NULL, --nANCHO_BUENO_TOTAL_10 
                        NULL, --nANCHO_BUENO_OT_10 
                        rMaterial_B.ANCHO_BUENO_TOTAL_01, --nANCHO_BUENO_TOTAL 
                        rMaterial_B.ANCHO_BUENO_OT_01, --nANCHO_BUENO_OT 
                        NULL, --nNUMECORT 
                        NULL, --nMM_MERMPRCO_01 
                        NULL, --nMM_MERMPLAN_EXESO_01 
                        NULL, --nMM_MERMPLAN_01 
                        NULL, --nMM_MERMPRCO_02 
                        NULL, --nMM_MERMPLAN_EXESO_02 
                        NULL, --nMM_MERMPLAN_02 
                        NULL, --nMM_MERMPRCO_03 
                        NULL, --nMM_MERMPLAN_EXESO_03 
                        NULL, --nMM_MERMPLAN_03 
                        NULL, --nMM_MERMPRCO_04 
                        NULL, --nMM_MERMPLAN_EXESO_04 
                        NULL, --nMM_MERMPLAN_04 
                        NULL, --nMM_MERMPRCO_05 
                        NULL, --nMM_MERMPLAN_EXESO_05 
                        NULL, --nMM_MERMPLAN_05 
                        NULL, --nMM_MERMPRCO_06 
                        NULL, --nMM_MERMPLAN_EXESO_06 
                        NULL, --nMM_MERMPLAN_06 
                        NULL, --nMM_MERMPRCO_07 
                        NULL, --nMM_MERMPLAN_EXESO_07 
                        NULL, --nMM_MERMPLAN_07 
                        NULL, --nMM_MERMPRCO_08 
                        NULL, --nMM_MERMPLAN_EXESO_08 
                        NULL, --nMM_MERMPLAN_08 
                        NULL, --nMM_MERMPRCO_09 
                        NULL, --nMM_MERMPLAN_EXESO_09 
                        NULL, --nMM_MERMPLAN_09 
                        NULL, --nMM_MERMPRCO_10 
                        NULL, --nMM_MERMPLAN_EXESO_10 
                        NULL, --nMM_MERMPLAN_10 
                        NULL, --nMM_MERMPRCO 
                        NULL, --nMM_MERMPLAN_EXESO 
                        NULL); --nMM_MERMPLAN
         END IF;
         ------------------------------------
         --FIN CALCULO DE ANCHO_BUENO_TOTAL--
         ------------------------------------
         ------------------------------------------------------------------------
         --BUSQUEDA DE MM DE MERMAS DE PLANIFICACION Y EXESOS ANCHO_BUENO_TOTAL--
         ------------------------------------------------------------------------
         IF rMATERIAL_B.Tip_Arti != vTIARREST THEN
            --IF t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL IS NOT NULL THEN 
            IF rMaterial_B.ANCHO_BUENO_TOTAL IS NOT NULL THEN 
               --Busqueda de Exceso de Merma de Planificación
               IF rMATERIAL_B.MM_MERMPLAN IS NOT NULL THEN 
                  --IF t_MATERIAL(rMaterial_B.IDENTIFICADOR).Ancho - t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL > rMATERIAL_B.MM_MERMPLAN THEN
                  IF rMaterial_B.Ancho - rMaterial_B.ANCHO_BUENO_TOTAL > rMATERIAL_B.MM_MERMPLAN THEN
                     IF rMaterial_B.PRE_CORTE = 'S' THEN
                        --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPRCO := t_MATERIAL(rMaterial_B.IDENTIFICADOR).Ancho - t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL - rMATERIAL_B.MM_MERMPLAN;
                        --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_EXESO := 0;
                        P_MATERIAL(rMaterial_B,'U',
                                   NULL,--nCantProd
                                   NULL,--nCantCons_E
                                   NULL,--nCantCons
                                   NULL,--nCantAjus
                                   NULL,--nAncho
                                   NULL,--nFACTOR_CONVERSION_M2_KG
                                   NULL,--nPrecio_ML_E
                                   NULL,--vLog_Precio
                                   NULL,--nMermEnhe_E
                                   NULL,--nMermEnhe
                                   NULL,--nMermAjus_E
                                   NULL,--nMermAjus
                                   NULL,--nMermCabo_E
                                   NULL,--nMermCabo
                                   NULL,--nMermPico_E
                                   NULL,--nMermPico
                                   NULL,--nMermTita
                                   NULL,--nMermSane
                                   NULL,--nCantCons_Bobinas
                                   --
                                    NULL, --nCONTFSMU_01 
                                    NULL, --nCANTFSMU_01 
                                    NULL, --nCATOFSMU 
                                    NULL, --nCONTFSMU_02 
                                    NULL, --nCANTFSMU_02 
                                    NULL, --nCONTFSMU_03 
                                    NULL, --nCANTFSMU_03 
                                    NULL, --nCONTFSMU_04 
                                    NULL, --nCANTFSMU_04 
                                    NULL, --nCONTFSMU_05 
                                    NULL, --nCANTFSMU_05 
                                    NULL, --nCONTFSMU_06 
                                    NULL, --nCANTFSMU_06 
                                    NULL, --nCONTFSMU_07 
                                    NULL, --nCANTFSMU_07 
                                    NULL, --nCONTFSMU_08 
                                    NULL, --nCANTFSMU_08 
                                    NULL, --nCONTFSMU_09 
                                    NULL, --nCANTFSMU_09 
                                    NULL, --nCONTFSMU_10 
                                    NULL, --nCANTFSMU_10 
                                    NULL, --nANCHO_BUENO_TOTAL_01 
                                    NULL, --nANCHO_BUENO_OT_01 
                                    NULL, --nANCHO_BUENO_TOTAL_02 
                                    NULL, --nANCHO_BUENO_OT_02 
                                    NULL, --nANCHO_BUENO_TOTAL_03 
                                    NULL, --nANCHO_BUENO_OT_03 
                                    NULL, --nANCHO_BUENO_TOTAL_04 
                                    NULL, --nANCHO_BUENO_OT_04 
                                    NULL, --nANCHO_BUENO_TOTAL_05 
                                    NULL, --nANCHO_BUENO_OT_05 
                                    NULL, --nANCHO_BUENO_TOTAL_06 
                                    NULL, --nANCHO_BUENO_OT_06 
                                    NULL, --nANCHO_BUENO_TOTAL_07 
                                    NULL, --nANCHO_BUENO_OT_07 
                                    NULL, --nANCHO_BUENO_TOTAL_08 
                                    NULL, --nANCHO_BUENO_OT_08 
                                    NULL, --nANCHO_BUENO_TOTAL_09 
                                    NULL, --nANCHO_BUENO_OT_09 
                                    NULL, --nANCHO_BUENO_TOTAL_10 
                                    NULL, --nANCHO_BUENO_OT_10 
                                    NULL, --nANCHO_BUENO_TOTAL 
                                    NULL, --nANCHO_BUENO_OT 
                                    NULL, --nNUMECORT 
                                    NULL, --nMM_MERMPRCO_01 
                                    NULL, --nMM_MERMPLAN_EXESO_01 
                                    NULL, --nMM_MERMPLAN_01 
                                    NULL, --nMM_MERMPRCO_02 
                                    NULL, --nMM_MERMPLAN_EXESO_02 
                                    NULL, --nMM_MERMPLAN_02 
                                    NULL, --nMM_MERMPRCO_03 
                                    NULL, --nMM_MERMPLAN_EXESO_03 
                                    NULL, --nMM_MERMPLAN_03 
                                    NULL, --nMM_MERMPRCO_04 
                                    NULL, --nMM_MERMPLAN_EXESO_04 
                                    NULL, --nMM_MERMPLAN_04 
                                    NULL, --nMM_MERMPRCO_05 
                                    NULL, --nMM_MERMPLAN_EXESO_05 
                                    NULL, --nMM_MERMPLAN_05 
                                    NULL, --nMM_MERMPRCO_06 
                                    NULL, --nMM_MERMPLAN_EXESO_06 
                                    NULL, --nMM_MERMPLAN_06 
                                    NULL, --nMM_MERMPRCO_07 
                                    NULL, --nMM_MERMPLAN_EXESO_07 
                                    NULL, --nMM_MERMPLAN_07 
                                    NULL, --nMM_MERMPRCO_08 
                                    NULL, --nMM_MERMPLAN_EXESO_08 
                                    NULL, --nMM_MERMPLAN_08 
                                    NULL, --nMM_MERMPRCO_09 
                                    NULL, --nMM_MERMPLAN_EXESO_09 
                                    NULL, --nMM_MERMPLAN_09 
                                    NULL, --nMM_MERMPRCO_10 
                                    NULL, --nMM_MERMPLAN_EXESO_10 
                                    NULL, --nMM_MERMPLAN_10 
                                    rMaterial_B.Ancho - rMaterial_B.ANCHO_BUENO_TOTAL - rMATERIAL_B.MM_MERMPLAN, --nMM_MERMPRCO 
                                    0, --nMM_MERMPLAN_EXESO 
                                    NULL); --nMM_MERMPLAN
                     ELSE
                        --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_EXESO := t_MATERIAL(rMaterial_B.IDENTIFICADOR).Ancho - t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL - rMATERIAL_B.MM_MERMPLAN;
                        --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPRCO := 0;
                        P_MATERIAL(rMaterial_B,'U',
                                   NULL,--nCantProd
                                   NULL,--nCantCons_E
                                   NULL,--nCantCons
                                   NULL,--nCantAjus
                                   NULL,--nAncho
                                   NULL,--nFACTOR_CONVERSION_M2_KG
                                   NULL,--nPrecio_ML_E
                                   NULL,--vLog_Precio
                                   NULL,--nMermEnhe_E
                                   NULL,--nMermEnhe
                                   NULL,--nMermAjus_E
                                   NULL,--nMermAjus
                                   NULL,--nMermCabo_E
                                   NULL,--nMermCabo
                                   NULL,--nMermPico_E
                                   NULL,--nMermPico
                                   NULL,--nMermTita
                                   NULL,--nMermSane
                                   NULL,--nCantCons_Bobinas
                                   --
                                    NULL, --nCONTFSMU_01 
                                    NULL, --nCANTFSMU_01 
                                    NULL, --nCATOFSMU 
                                    NULL, --nCONTFSMU_02 
                                    NULL, --nCANTFSMU_02 
                                    NULL, --nCONTFSMU_03 
                                    NULL, --nCANTFSMU_03 
                                    NULL, --nCONTFSMU_04 
                                    NULL, --nCANTFSMU_04 
                                    NULL, --nCONTFSMU_05 
                                    NULL, --nCANTFSMU_05 
                                    NULL, --nCONTFSMU_06 
                                    NULL, --nCANTFSMU_06 
                                    NULL, --nCONTFSMU_07 
                                    NULL, --nCANTFSMU_07 
                                    NULL, --nCONTFSMU_08 
                                    NULL, --nCANTFSMU_08 
                                    NULL, --nCONTFSMU_09 
                                    NULL, --nCANTFSMU_09 
                                    NULL, --nCONTFSMU_10 
                                    NULL, --nCANTFSMU_10 
                                    NULL, --nANCHO_BUENO_TOTAL_01 
                                    NULL, --nANCHO_BUENO_OT_01 
                                    NULL, --nANCHO_BUENO_TOTAL_02 
                                    NULL, --nANCHO_BUENO_OT_02 
                                    NULL, --nANCHO_BUENO_TOTAL_03 
                                    NULL, --nANCHO_BUENO_OT_03 
                                    NULL, --nANCHO_BUENO_TOTAL_04 
                                    NULL, --nANCHO_BUENO_OT_04 
                                    NULL, --nANCHO_BUENO_TOTAL_05 
                                    NULL, --nANCHO_BUENO_OT_05 
                                    NULL, --nANCHO_BUENO_TOTAL_06 
                                    NULL, --nANCHO_BUENO_OT_06 
                                    NULL, --nANCHO_BUENO_TOTAL_07 
                                    NULL, --nANCHO_BUENO_OT_07 
                                    NULL, --nANCHO_BUENO_TOTAL_08 
                                    NULL, --nANCHO_BUENO_OT_08 
                                    NULL, --nANCHO_BUENO_TOTAL_09 
                                    NULL, --nANCHO_BUENO_OT_09 
                                    NULL, --nANCHO_BUENO_TOTAL_10 
                                    NULL, --nANCHO_BUENO_OT_10 
                                    NULL, --nANCHO_BUENO_TOTAL 
                                    NULL, --nANCHO_BUENO_OT 
                                    NULL, --nNUMECORT 
                                    NULL, --nMM_MERMPRCO_01 
                                    NULL, --nMM_MERMPLAN_EXESO_01 
                                    NULL, --nMM_MERMPLAN_01 
                                    NULL, --nMM_MERMPRCO_02 
                                    NULL, --nMM_MERMPLAN_EXESO_02 
                                    NULL, --nMM_MERMPLAN_02 
                                    NULL, --nMM_MERMPRCO_03 
                                    NULL, --nMM_MERMPLAN_EXESO_03 
                                    NULL, --nMM_MERMPLAN_03 
                                    NULL, --nMM_MERMPRCO_04 
                                    NULL, --nMM_MERMPLAN_EXESO_04 
                                    NULL, --nMM_MERMPLAN_04 
                                    NULL, --nMM_MERMPRCO_05 
                                    NULL, --nMM_MERMPLAN_EXESO_05 
                                    NULL, --nMM_MERMPLAN_05 
                                    NULL, --nMM_MERMPRCO_06 
                                    NULL, --nMM_MERMPLAN_EXESO_06 
                                    NULL, --nMM_MERMPLAN_06 
                                    NULL, --nMM_MERMPRCO_07 
                                    NULL, --nMM_MERMPLAN_EXESO_07 
                                    NULL, --nMM_MERMPLAN_07 
                                    NULL, --nMM_MERMPRCO_08 
                                    NULL, --nMM_MERMPLAN_EXESO_08 
                                    NULL, --nMM_MERMPLAN_08 
                                    NULL, --nMM_MERMPRCO_09 
                                    NULL, --nMM_MERMPLAN_EXESO_09 
                                    NULL, --nMM_MERMPLAN_09 
                                    NULL, --nMM_MERMPRCO_10 
                                    NULL, --nMM_MERMPLAN_EXESO_10 
                                    NULL, --nMM_MERMPLAN_10 
                                    0, --nMM_MERMPRCO 
                                    rMaterial_B.Ancho - rMaterial_B.ANCHO_BUENO_TOTAL - rMATERIAL_B.MM_MERMPLAN, --nMM_MERMPLAN_EXESO 
                                    NULL); --nMM_MERMPLAN
                     END IF;
                  ELSE
                     --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_EXESO := 0;
                     --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPRCO := 0;
                     --La Merma de Planificación fue menor a lo Estandar / Real (SE ACTUALIZA: YA NO SE BASA EN LA CONFIGURACION)
                     --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN := t_MATERIAL(rMaterial_B.IDENTIFICADOR).Ancho - t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL;
                     P_MATERIAL(rMaterial_B,'U',
                                   NULL,--nCantProd
                                   NULL,--nCantCons_E
                                   NULL,--nCantCons
                                   NULL,--nCantAjus
                                   NULL,--nAncho
                                   NULL,--nFACTOR_CONVERSION_M2_KG
                                   NULL,--nPrecio_ML_E
                                   NULL,--vLog_Precio
                                   NULL,--nMermEnhe_E
                                   NULL,--nMermEnhe
                                   NULL,--nMermAjus_E
                                   NULL,--nMermAjus
                                   NULL,--nMermCabo_E
                                   NULL,--nMermCabo
                                   NULL,--nMermPico_E
                                   NULL,--nMermPico
                                   NULL,--nMermTita
                                   NULL,--nMermSane
                                   NULL,--nCantCons_Bobinas
                                   --
                                    NULL, --nCONTFSMU_01 
                                    NULL, --nCANTFSMU_01 
                                    NULL, --nCATOFSMU 
                                    NULL, --nCONTFSMU_02 
                                    NULL, --nCANTFSMU_02 
                                    NULL, --nCONTFSMU_03 
                                    NULL, --nCANTFSMU_03 
                                    NULL, --nCONTFSMU_04 
                                    NULL, --nCANTFSMU_04 
                                    NULL, --nCONTFSMU_05 
                                    NULL, --nCANTFSMU_05 
                                    NULL, --nCONTFSMU_06 
                                    NULL, --nCANTFSMU_06 
                                    NULL, --nCONTFSMU_07 
                                    NULL, --nCANTFSMU_07 
                                    NULL, --nCONTFSMU_08 
                                    NULL, --nCANTFSMU_08 
                                    NULL, --nCONTFSMU_09 
                                    NULL, --nCANTFSMU_09 
                                    NULL, --nCONTFSMU_10 
                                    NULL, --nCANTFSMU_10 
                                    NULL, --nANCHO_BUENO_TOTAL_01 
                                    NULL, --nANCHO_BUENO_OT_01 
                                    NULL, --nANCHO_BUENO_TOTAL_02 
                                    NULL, --nANCHO_BUENO_OT_02 
                                    NULL, --nANCHO_BUENO_TOTAL_03 
                                    NULL, --nANCHO_BUENO_OT_03 
                                    NULL, --nANCHO_BUENO_TOTAL_04 
                                    NULL, --nANCHO_BUENO_OT_04 
                                    NULL, --nANCHO_BUENO_TOTAL_05 
                                    NULL, --nANCHO_BUENO_OT_05 
                                    NULL, --nANCHO_BUENO_TOTAL_06 
                                    NULL, --nANCHO_BUENO_OT_06 
                                    NULL, --nANCHO_BUENO_TOTAL_07 
                                    NULL, --nANCHO_BUENO_OT_07 
                                    NULL, --nANCHO_BUENO_TOTAL_08 
                                    NULL, --nANCHO_BUENO_OT_08 
                                    NULL, --nANCHO_BUENO_TOTAL_09 
                                    NULL, --nANCHO_BUENO_OT_09 
                                    NULL, --nANCHO_BUENO_TOTAL_10 
                                    NULL, --nANCHO_BUENO_OT_10 
                                    NULL, --nANCHO_BUENO_TOTAL 
                                    NULL, --nANCHO_BUENO_OT 
                                    NULL, --nNUMECORT 
                                    NULL, --nMM_MERMPRCO_01 
                                    NULL, --nMM_MERMPLAN_EXESO_01 
                                    NULL, --nMM_MERMPLAN_01 
                                    NULL, --nMM_MERMPRCO_02 
                                    NULL, --nMM_MERMPLAN_EXESO_02 
                                    NULL, --nMM_MERMPLAN_02 
                                    NULL, --nMM_MERMPRCO_03 
                                    NULL, --nMM_MERMPLAN_EXESO_03 
                                    NULL, --nMM_MERMPLAN_03 
                                    NULL, --nMM_MERMPRCO_04 
                                    NULL, --nMM_MERMPLAN_EXESO_04 
                                    NULL, --nMM_MERMPLAN_04 
                                    NULL, --nMM_MERMPRCO_05 
                                    NULL, --nMM_MERMPLAN_EXESO_05 
                                    NULL, --nMM_MERMPLAN_05 
                                    NULL, --nMM_MERMPRCO_06 
                                    NULL, --nMM_MERMPLAN_EXESO_06 
                                    NULL, --nMM_MERMPLAN_06 
                                    NULL, --nMM_MERMPRCO_07 
                                    NULL, --nMM_MERMPLAN_EXESO_07 
                                    NULL, --nMM_MERMPLAN_07 
                                    NULL, --nMM_MERMPRCO_08 
                                    NULL, --nMM_MERMPLAN_EXESO_08 
                                    NULL, --nMM_MERMPLAN_08 
                                    NULL, --nMM_MERMPRCO_09 
                                    NULL, --nMM_MERMPLAN_EXESO_09 
                                    NULL, --nMM_MERMPLAN_09 
                                    NULL, --nMM_MERMPRCO_10 
                                    NULL, --nMM_MERMPLAN_EXESO_10 
                                    NULL, --nMM_MERMPLAN_10 
                                    0, --nMM_MERMPRCO 
                                    0, --nMM_MERMPLAN_EXESO 
                                    rMaterial_B.Ancho - rMaterial_B.ANCHO_BUENO_TOTAL); --nMM_MERMPLAN
                  END IF;
               ELSE--Si no existe la Merma Planificada Estandar / Real
                  --Se asigna la merma encontrada a Excesos o Pre_Corte ya que no fue Planificada como Estandar
                  IF rMaterial_B.PRE_CORTE = 'S' THEN
                     --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPRCO := t_MATERIAL(rMaterial_B.IDENTIFICADOR).Ancho - t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL;
                     P_MATERIAL(rMaterial_B,'U',
                                NULL,--nCantProd
                                NULL,--nCantCons_E
                                NULL,--nCantCons
                                NULL,--nCantAjus
                                NULL,--nAncho
                                NULL,--nFACTOR_CONVERSION_M2_KG
                                NULL,--nPrecio_ML_E
                                NULL,--vLog_Precio
                                NULL,--nMermEnhe_E
                                NULL,--nMermEnhe
                                NULL,--nMermAjus_E
                                NULL,--nMermAjus
                                NULL,--nMermCabo_E
                                NULL,--nMermCabo
                                NULL,--nMermPico_E
                                NULL,--nMermPico
                                NULL,--nMermTita
                                NULL,--nMermSane
                                NULL,--nCantCons_Bobinas
                                --
                                 NULL, --nCONTFSMU_01 
                                 NULL, --nCANTFSMU_01 
                                 NULL, --nCATOFSMU 
                                 NULL, --nCONTFSMU_02 
                                 NULL, --nCANTFSMU_02 
                                 NULL, --nCONTFSMU_03 
                                 NULL, --nCANTFSMU_03 
                                 NULL, --nCONTFSMU_04 
                                 NULL, --nCANTFSMU_04 
                                 NULL, --nCONTFSMU_05 
                                 NULL, --nCANTFSMU_05 
                                 NULL, --nCONTFSMU_06 
                                 NULL, --nCANTFSMU_06 
                                 NULL, --nCONTFSMU_07 
                                 NULL, --nCANTFSMU_07 
                                 NULL, --nCONTFSMU_08 
                                 NULL, --nCANTFSMU_08 
                                 NULL, --nCONTFSMU_09 
                                 NULL, --nCANTFSMU_09 
                                 NULL, --nCONTFSMU_10 
                                 NULL, --nCANTFSMU_10 
                                 NULL, --nANCHO_BUENO_TOTAL_01 
                                 NULL, --nANCHO_BUENO_OT_01 
                                 NULL, --nANCHO_BUENO_TOTAL_02 
                                 NULL, --nANCHO_BUENO_OT_02 
                                 NULL, --nANCHO_BUENO_TOTAL_03 
                                 NULL, --nANCHO_BUENO_OT_03 
                                 NULL, --nANCHO_BUENO_TOTAL_04 
                                 NULL, --nANCHO_BUENO_OT_04 
                                 NULL, --nANCHO_BUENO_TOTAL_05 
                                 NULL, --nANCHO_BUENO_OT_05 
                                 NULL, --nANCHO_BUENO_TOTAL_06 
                                 NULL, --nANCHO_BUENO_OT_06 
                                 NULL, --nANCHO_BUENO_TOTAL_07 
                                 NULL, --nANCHO_BUENO_OT_07 
                                 NULL, --nANCHO_BUENO_TOTAL_08 
                                 NULL, --nANCHO_BUENO_OT_08 
                                 NULL, --nANCHO_BUENO_TOTAL_09 
                                 NULL, --nANCHO_BUENO_OT_09 
                                 NULL, --nANCHO_BUENO_TOTAL_10 
                                 NULL, --nANCHO_BUENO_OT_10 
                                 NULL, --nANCHO_BUENO_TOTAL 
                                 NULL, --nANCHO_BUENO_OT 
                                 NULL, --nNUMECORT 
                                 NULL, --nMM_MERMPRCO_01 
                                 NULL, --nMM_MERMPLAN_EXESO_01 
                                 NULL, --nMM_MERMPLAN_01 
                                 NULL, --nMM_MERMPRCO_02 
                                 NULL, --nMM_MERMPLAN_EXESO_02 
                                 NULL, --nMM_MERMPLAN_02 
                                 NULL, --nMM_MERMPRCO_03 
                                 NULL, --nMM_MERMPLAN_EXESO_03 
                                 NULL, --nMM_MERMPLAN_03 
                                 NULL, --nMM_MERMPRCO_04 
                                 NULL, --nMM_MERMPLAN_EXESO_04 
                                 NULL, --nMM_MERMPLAN_04 
                                 NULL, --nMM_MERMPRCO_05 
                                 NULL, --nMM_MERMPLAN_EXESO_05 
                                 NULL, --nMM_MERMPLAN_05 
                                 NULL, --nMM_MERMPRCO_06 
                                 NULL, --nMM_MERMPLAN_EXESO_06 
                                 NULL, --nMM_MERMPLAN_06 
                                 NULL, --nMM_MERMPRCO_07 
                                 NULL, --nMM_MERMPLAN_EXESO_07 
                                 NULL, --nMM_MERMPLAN_07 
                                 NULL, --nMM_MERMPRCO_08 
                                 NULL, --nMM_MERMPLAN_EXESO_08 
                                 NULL, --nMM_MERMPLAN_08 
                                 NULL, --nMM_MERMPRCO_09 
                                 NULL, --nMM_MERMPLAN_EXESO_09 
                                 NULL, --nMM_MERMPLAN_09 
                                 NULL, --nMM_MERMPRCO_10 
                                 NULL, --nMM_MERMPLAN_EXESO_10 
                                 NULL, --nMM_MERMPLAN_10 
                                 rMaterial_B.Ancho - rMaterial_B.ANCHO_BUENO_TOTAL, --nMM_MERMPRCO 
                                 NULL, --nMM_MERMPLAN_EXESO 
                                 0); --nMM_MERMPLAN
                  ELSE
                     --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_EXESO := t_MATERIAL(rMaterial_B.IDENTIFICADOR).Ancho - t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL;
                     P_MATERIAL(rMaterial_B,'U',
                                NULL,--nCantProd
                                NULL,--nCantCons_E
                                NULL,--nCantCons
                                NULL,--nCantAjus
                                NULL,--nAncho
                                NULL,--nFACTOR_CONVERSION_M2_KG
                                NULL,--nPrecio_ML_E
                                NULL,--vLog_Precio
                                NULL,--nMermEnhe_E
                                NULL,--nMermEnhe
                                NULL,--nMermAjus_E
                                NULL,--nMermAjus
                                NULL,--nMermCabo_E
                                NULL,--nMermCabo
                                NULL,--nMermPico_E
                                NULL,--nMermPico
                                NULL,--nMermTita
                                NULL,--nMermSane
                                NULL,--nCantCons_Bobinas
                                --
                                 NULL, --nCONTFSMU_01 
                                 NULL, --nCANTFSMU_01 
                                 NULL, --nCATOFSMU 
                                 NULL, --nCONTFSMU_02 
                                 NULL, --nCANTFSMU_02 
                                 NULL, --nCONTFSMU_03 
                                 NULL, --nCANTFSMU_03 
                                 NULL, --nCONTFSMU_04 
                                 NULL, --nCANTFSMU_04 
                                 NULL, --nCONTFSMU_05 
                                 NULL, --nCANTFSMU_05 
                                 NULL, --nCONTFSMU_06 
                                 NULL, --nCANTFSMU_06 
                                 NULL, --nCONTFSMU_07 
                                 NULL, --nCANTFSMU_07 
                                 NULL, --nCONTFSMU_08 
                                 NULL, --nCANTFSMU_08 
                                 NULL, --nCONTFSMU_09 
                                 NULL, --nCANTFSMU_09 
                                 NULL, --nCONTFSMU_10 
                                 NULL, --nCANTFSMU_10 
                                 NULL, --nANCHO_BUENO_TOTAL_01 
                                 NULL, --nANCHO_BUENO_OT_01 
                                 NULL, --nANCHO_BUENO_TOTAL_02 
                                 NULL, --nANCHO_BUENO_OT_02 
                                 NULL, --nANCHO_BUENO_TOTAL_03 
                                 NULL, --nANCHO_BUENO_OT_03 
                                 NULL, --nANCHO_BUENO_TOTAL_04 
                                 NULL, --nANCHO_BUENO_OT_04 
                                 NULL, --nANCHO_BUENO_TOTAL_05 
                                 NULL, --nANCHO_BUENO_OT_05 
                                 NULL, --nANCHO_BUENO_TOTAL_06 
                                 NULL, --nANCHO_BUENO_OT_06 
                                 NULL, --nANCHO_BUENO_TOTAL_07 
                                 NULL, --nANCHO_BUENO_OT_07 
                                 NULL, --nANCHO_BUENO_TOTAL_08 
                                 NULL, --nANCHO_BUENO_OT_08 
                                 NULL, --nANCHO_BUENO_TOTAL_09 
                                 NULL, --nANCHO_BUENO_OT_09 
                                 NULL, --nANCHO_BUENO_TOTAL_10 
                                 NULL, --nANCHO_BUENO_OT_10 
                                 NULL, --nANCHO_BUENO_TOTAL 
                                 NULL, --nANCHO_BUENO_OT 
                                 NULL, --nNUMECORT 
                                 NULL, --nMM_MERMPRCO_01 
                                 NULL, --nMM_MERMPLAN_EXESO_01 
                                 NULL, --nMM_MERMPLAN_01 
                                 NULL, --nMM_MERMPRCO_02 
                                 NULL, --nMM_MERMPLAN_EXESO_02 
                                 NULL, --nMM_MERMPLAN_02 
                                 NULL, --nMM_MERMPRCO_03 
                                 NULL, --nMM_MERMPLAN_EXESO_03 
                                 NULL, --nMM_MERMPLAN_03 
                                 NULL, --nMM_MERMPRCO_04 
                                 NULL, --nMM_MERMPLAN_EXESO_04 
                                 NULL, --nMM_MERMPLAN_04 
                                 NULL, --nMM_MERMPRCO_05 
                                 NULL, --nMM_MERMPLAN_EXESO_05 
                                 NULL, --nMM_MERMPLAN_05 
                                 NULL, --nMM_MERMPRCO_06 
                                 NULL, --nMM_MERMPLAN_EXESO_06 
                                 NULL, --nMM_MERMPLAN_06 
                                 NULL, --nMM_MERMPRCO_07 
                                 NULL, --nMM_MERMPLAN_EXESO_07 
                                 NULL, --nMM_MERMPLAN_07 
                                 NULL, --nMM_MERMPRCO_08 
                                 NULL, --nMM_MERMPLAN_EXESO_08 
                                 NULL, --nMM_MERMPLAN_08 
                                 NULL, --nMM_MERMPRCO_09 
                                 NULL, --nMM_MERMPLAN_EXESO_09 
                                 NULL, --nMM_MERMPLAN_09 
                                 NULL, --nMM_MERMPRCO_10 
                                 NULL, --nMM_MERMPLAN_EXESO_10 
                                 NULL, --nMM_MERMPLAN_10 
                                 NULL, --nMM_MERMPRCO 
                                 rMaterial_B.Ancho - rMaterial_B.ANCHO_BUENO_TOTAL, --nMM_MERMPLAN_EXESO 
                                 0); --nMM_MERMPLAN
                  END IF;
                  --
                  --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN := 0;
               END IF;
            ELSE
               --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_EXESO := 0;
               --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPRCO := 0;
               P_MATERIAL(rMaterial_B,'U',
                          NULL,--nCantProd
                          NULL,--nCantCons_E
                          NULL,--nCantCons
                          NULL,--nCantAjus
                          NULL,--nAncho
                          NULL,--nFACTOR_CONVERSION_M2_KG
                          NULL,--nPrecio_ML_E
                          NULL,--vLog_Precio
                          NULL,--nMermEnhe_E
                          NULL,--nMermEnhe
                          NULL,--nMermAjus_E
                          NULL,--nMermAjus
                          NULL,--nMermCabo_E
                          NULL,--nMermCabo
                          NULL,--nMermPico_E
                          NULL,--nMermPico
                          NULL,--nMermTita
                          NULL,--nMermSane
                          NULL,--nCantCons_Bobinas
                          --
                           NULL, --nCONTFSMU_01 
                           NULL, --nCANTFSMU_01 
                           NULL, --nCATOFSMU 
                           NULL, --nCONTFSMU_02 
                           NULL, --nCANTFSMU_02 
                           NULL, --nCONTFSMU_03 
                           NULL, --nCANTFSMU_03 
                           NULL, --nCONTFSMU_04 
                           NULL, --nCANTFSMU_04 
                           NULL, --nCONTFSMU_05 
                           NULL, --nCANTFSMU_05 
                           NULL, --nCONTFSMU_06 
                           NULL, --nCANTFSMU_06 
                           NULL, --nCONTFSMU_07 
                           NULL, --nCANTFSMU_07 
                           NULL, --nCONTFSMU_08 
                           NULL, --nCANTFSMU_08 
                           NULL, --nCONTFSMU_09 
                           NULL, --nCANTFSMU_09 
                           NULL, --nCONTFSMU_10 
                           NULL, --nCANTFSMU_10 
                           NULL, --nANCHO_BUENO_TOTAL_01 
                           NULL, --nANCHO_BUENO_OT_01 
                           NULL, --nANCHO_BUENO_TOTAL_02 
                           NULL, --nANCHO_BUENO_OT_02 
                           NULL, --nANCHO_BUENO_TOTAL_03 
                           NULL, --nANCHO_BUENO_OT_03 
                           NULL, --nANCHO_BUENO_TOTAL_04 
                           NULL, --nANCHO_BUENO_OT_04 
                           NULL, --nANCHO_BUENO_TOTAL_05 
                           NULL, --nANCHO_BUENO_OT_05 
                           NULL, --nANCHO_BUENO_TOTAL_06 
                           NULL, --nANCHO_BUENO_OT_06 
                           NULL, --nANCHO_BUENO_TOTAL_07 
                           NULL, --nANCHO_BUENO_OT_07 
                           NULL, --nANCHO_BUENO_TOTAL_08 
                           NULL, --nANCHO_BUENO_OT_08 
                           NULL, --nANCHO_BUENO_TOTAL_09 
                           NULL, --nANCHO_BUENO_OT_09 
                           NULL, --nANCHO_BUENO_TOTAL_10 
                           NULL, --nANCHO_BUENO_OT_10 
                           NULL, --nANCHO_BUENO_TOTAL 
                           NULL, --nANCHO_BUENO_OT 
                           NULL, --nNUMECORT 
                           NULL, --nMM_MERMPRCO_01 
                           NULL, --nMM_MERMPLAN_EXESO_01 
                           NULL, --nMM_MERMPLAN_01 
                           NULL, --nMM_MERMPRCO_02 
                           NULL, --nMM_MERMPLAN_EXESO_02 
                           NULL, --nMM_MERMPLAN_02 
                           NULL, --nMM_MERMPRCO_03 
                           NULL, --nMM_MERMPLAN_EXESO_03 
                           NULL, --nMM_MERMPLAN_03 
                           NULL, --nMM_MERMPRCO_04 
                           NULL, --nMM_MERMPLAN_EXESO_04 
                           NULL, --nMM_MERMPLAN_04 
                           NULL, --nMM_MERMPRCO_05 
                           NULL, --nMM_MERMPLAN_EXESO_05 
                           NULL, --nMM_MERMPLAN_05 
                           NULL, --nMM_MERMPRCO_06 
                           NULL, --nMM_MERMPLAN_EXESO_06 
                           NULL, --nMM_MERMPLAN_06 
                           NULL, --nMM_MERMPRCO_07 
                           NULL, --nMM_MERMPLAN_EXESO_07 
                           NULL, --nMM_MERMPLAN_07 
                           NULL, --nMM_MERMPRCO_08 
                           NULL, --nMM_MERMPLAN_EXESO_08 
                           NULL, --nMM_MERMPLAN_08 
                           NULL, --nMM_MERMPRCO_09 
                           NULL, --nMM_MERMPLAN_EXESO_09 
                           NULL, --nMM_MERMPLAN_09 
                           NULL, --nMM_MERMPRCO_10 
                           NULL, --nMM_MERMPLAN_EXESO_10 
                           NULL, --nMM_MERMPLAN_10 
                           0, --nMM_MERMPRCO 
                           0, --nMM_MERMPLAN_EXESO 
                           NULL); --nMM_MERMPLAN
            END IF;
         END IF;
         ----------------------------------------------------------------------------
         --FIN BUSQUEDA DE MM DE MERMAS DE PLANIFICACION Y EXESOS ANCHO_BUENO_TOTAL--
         ----------------------------------------------------------------------------
         --------------------------------------------------------
         --BUSQUEDA DE MM DE MERMAS DE PLANIFICACION Y EXESOS 1--
         --------------------------------------------------------
         --IF t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_01 IS NOT NULL AND rMATERIAL_B.Tip_Arti != vTIARREST THEN 
         IF rMaterial_B.ANCHO_BUENO_TOTAL_01 IS NOT NULL AND rMATERIAL_B.Tip_Arti != vTIARREST THEN 
            --Busqueda de Exceso de Merma de Planificación
            IF rMATERIAL_B.MM_MERMPLAN_01 IS NOT NULL THEN 
               --IF t_MATERIAL(rMaterial_B.IDENTIFICADOR).Ancho - t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_01 > rMATERIAL_B.MM_MERMPLAN_01 THEN
               IF rMaterial_B.Ancho - rMaterial_B.ANCHO_BUENO_TOTAL_01 > rMATERIAL_B.MM_MERMPLAN_01 THEN
                  IF rMaterial_B.PRE_CORTE = 'S' THEN
                     --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPRCO_01 := t_MATERIAL(rMaterial_B.IDENTIFICADOR).Ancho - t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_01 - rMATERIAL_B.MM_MERMPLAN_01;
                     --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_EXESO_01:= 0;
                     --
                     P_MATERIAL(rMaterial_B,'U',
                                 NULL,--nCantProd
                                 NULL,--nCantCons_E
                                 NULL,--nCantCons
                                 NULL,--nCantAjus
                                 NULL,--nAncho
                                 NULL,--nFACTOR_CONVERSION_M2_KG
                                 NULL,--nPrecio_ML_E
                                 NULL,--vLog_Precio
                                 NULL,--nMermEnhe_E
                                 NULL,--nMermEnhe
                                 NULL,--nMermAjus_E
                                 NULL,--nMermAjus
                                 NULL,--nMermCabo_E
                                 NULL,--nMermCabo
                                 NULL,--nMermPico_E
                                 NULL,--nMermPico
                                 NULL,--nMermTita
                                 NULL,--nMermSane
                                 NULL,--nCantCons_Bobinas
                                 --
                                 NULL, --nCONTFSMU_01 
                                 NULL, --nCANTFSMU_01 
                                 NULL, --nCATOFSMU 
                                 NULL, --nCONTFSMU_02 
                                 NULL, --nCANTFSMU_02 
                                 NULL, --nCONTFSMU_03 
                                 NULL, --nCANTFSMU_03 
                                 NULL, --nCONTFSMU_04 
                                 NULL, --nCANTFSMU_04 
                                 NULL, --nCONTFSMU_05 
                                 NULL, --nCANTFSMU_05 
                                 NULL, --nCONTFSMU_06 
                                 NULL, --nCANTFSMU_06 
                                 NULL, --nCONTFSMU_07 
                                 NULL, --nCANTFSMU_07 
                                 NULL, --nCONTFSMU_08 
                                 NULL, --nCANTFSMU_08 
                                 NULL, --nCONTFSMU_09 
                                 NULL, --nCANTFSMU_09 
                                 NULL, --nCONTFSMU_10 
                                 NULL, --nCANTFSMU_10 
                                 NULL, --nANCHO_BUENO_TOTAL_01 
                                 NULL, --nANCHO_BUENO_OT_01 
                                 NULL, --nANCHO_BUENO_TOTAL_02 
                                 NULL, --nANCHO_BUENO_OT_02 
                                 NULL, --nANCHO_BUENO_TOTAL_03 
                                 NULL, --nANCHO_BUENO_OT_03 
                                 NULL, --nANCHO_BUENO_TOTAL_04 
                                 NULL, --nANCHO_BUENO_OT_04 
                                 NULL, --nANCHO_BUENO_TOTAL_05 
                                 NULL, --nANCHO_BUENO_OT_05 
                                 NULL, --nANCHO_BUENO_TOTAL_06 
                                 NULL, --nANCHO_BUENO_OT_06 
                                 NULL, --nANCHO_BUENO_TOTAL_07 
                                 NULL, --nANCHO_BUENO_OT_07 
                                 NULL, --nANCHO_BUENO_TOTAL_08 
                                 NULL, --nANCHO_BUENO_OT_08 
                                 NULL, --nANCHO_BUENO_TOTAL_09 
                                 NULL, --nANCHO_BUENO_OT_09 
                                 NULL, --nANCHO_BUENO_TOTAL_10 
                                 NULL, --nANCHO_BUENO_OT_10 
                                 NULL, --nANCHO_BUENO_TOTAL 
                                 NULL, --nANCHO_BUENO_OT 
                                 NULL, --nNUMECORT 
                                 rMaterial_B.Ancho - rMaterial_B.ANCHO_BUENO_TOTAL_01 - rMATERIAL_B.MM_MERMPLAN_01, --nMM_MERMPRCO_01 
                                 0, --nMM_MERMPLAN_EXESO_01 
                                 NULL, --nMM_MERMPLAN_01 
                                 NULL, --nMM_MERMPRCO_02 
                                 NULL, --nMM_MERMPLAN_EXESO_02 
                                 NULL, --nMM_MERMPLAN_02 
                                 NULL, --nMM_MERMPRCO_03 
                                 NULL, --nMM_MERMPLAN_EXESO_03 
                                 NULL, --nMM_MERMPLAN_03 
                                 NULL, --nMM_MERMPRCO_04 
                                 NULL, --nMM_MERMPLAN_EXESO_04 
                                 NULL, --nMM_MERMPLAN_04 
                                 NULL, --nMM_MERMPRCO_05 
                                 NULL, --nMM_MERMPLAN_EXESO_05 
                                 NULL, --nMM_MERMPLAN_05 
                                 NULL, --nMM_MERMPRCO_06 
                                 NULL, --nMM_MERMPLAN_EXESO_06 
                                 NULL, --nMM_MERMPLAN_06 
                                 NULL, --nMM_MERMPRCO_07 
                                 NULL, --nMM_MERMPLAN_EXESO_07 
                                 NULL, --nMM_MERMPLAN_07 
                                 NULL, --nMM_MERMPRCO_08 
                                 NULL, --nMM_MERMPLAN_EXESO_08 
                                 NULL, --nMM_MERMPLAN_08 
                                 NULL, --nMM_MERMPRCO_09 
                                 NULL, --nMM_MERMPLAN_EXESO_09 
                                 NULL, --nMM_MERMPLAN_09 
                                 NULL, --nMM_MERMPRCO_10 
                                 NULL, --nMM_MERMPLAN_EXESO_10 
                                 NULL, --nMM_MERMPLAN_10 
                                 NULL, --nMM_MERMPRCO 
                                 NULL, --nMM_MERMPLAN_EXESO 
                                 NULL); --nMM_MERMPLAN
                  ELSE
                     --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_EXESO_01 := t_MATERIAL(rMaterial_B.IDENTIFICADOR).Ancho - t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_01 - rMATERIAL_B.MM_MERMPLAN_01;
                     --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPRCO_01 := 0;
                     P_MATERIAL(rMaterial_B,'U',
                                 NULL,--nCantProd
                                 NULL,--nCantCons_E
                                 NULL,--nCantCons
                                 NULL,--nCantAjus
                                 NULL,--nAncho
                                 NULL,--nFACTOR_CONVERSION_M2_KG
                                 NULL,--nPrecio_ML_E
                                 NULL,--vLog_Precio
                                 NULL,--nMermEnhe_E
                                 NULL,--nMermEnhe
                                 NULL,--nMermAjus_E
                                 NULL,--nMermAjus
                                 NULL,--nMermCabo_E
                                 NULL,--nMermCabo
                                 NULL,--nMermPico_E
                                 NULL,--nMermPico
                                 NULL,--nMermTita
                                 NULL,--nMermSane
                                 NULL,--nCantCons_Bobinas
                                 --
                                 NULL, --nCONTFSMU_01 
                                 NULL, --nCANTFSMU_01 
                                 NULL, --nCATOFSMU 
                                 NULL, --nCONTFSMU_02 
                                 NULL, --nCANTFSMU_02 
                                 NULL, --nCONTFSMU_03 
                                 NULL, --nCANTFSMU_03 
                                 NULL, --nCONTFSMU_04 
                                 NULL, --nCANTFSMU_04 
                                 NULL, --nCONTFSMU_05 
                                 NULL, --nCANTFSMU_05 
                                 NULL, --nCONTFSMU_06 
                                 NULL, --nCANTFSMU_06 
                                 NULL, --nCONTFSMU_07 
                                 NULL, --nCANTFSMU_07 
                                 NULL, --nCONTFSMU_08 
                                 NULL, --nCANTFSMU_08 
                                 NULL, --nCONTFSMU_09 
                                 NULL, --nCANTFSMU_09 
                                 NULL, --nCONTFSMU_10 
                                 NULL, --nCANTFSMU_10 
                                 NULL, --nANCHO_BUENO_TOTAL_01 
                                 NULL, --nANCHO_BUENO_OT_01 
                                 NULL, --nANCHO_BUENO_TOTAL_02 
                                 NULL, --nANCHO_BUENO_OT_02 
                                 NULL, --nANCHO_BUENO_TOTAL_03 
                                 NULL, --nANCHO_BUENO_OT_03 
                                 NULL, --nANCHO_BUENO_TOTAL_04 
                                 NULL, --nANCHO_BUENO_OT_04 
                                 NULL, --nANCHO_BUENO_TOTAL_05 
                                 NULL, --nANCHO_BUENO_OT_05 
                                 NULL, --nANCHO_BUENO_TOTAL_06 
                                 NULL, --nANCHO_BUENO_OT_06 
                                 NULL, --nANCHO_BUENO_TOTAL_07 
                                 NULL, --nANCHO_BUENO_OT_07 
                                 NULL, --nANCHO_BUENO_TOTAL_08 
                                 NULL, --nANCHO_BUENO_OT_08 
                                 NULL, --nANCHO_BUENO_TOTAL_09 
                                 NULL, --nANCHO_BUENO_OT_09 
                                 NULL, --nANCHO_BUENO_TOTAL_10 
                                 NULL, --nANCHO_BUENO_OT_10 
                                 NULL, --nANCHO_BUENO_TOTAL 
                                 NULL, --nANCHO_BUENO_OT 
                                 NULL, --nNUMECORT 
                                 0, --nMM_MERMPRCO_01 
                                 rMaterial_B.Ancho - rMaterial_B.ANCHO_BUENO_TOTAL_01 - rMATERIAL_B.MM_MERMPLAN_01, --nMM_MERMPLAN_EXESO_01 
                                 NULL, --nMM_MERMPLAN_01 
                                 NULL, --nMM_MERMPRCO_02 
                                 NULL, --nMM_MERMPLAN_EXESO_02 
                                 NULL, --nMM_MERMPLAN_02 
                                 NULL, --nMM_MERMPRCO_03 
                                 NULL, --nMM_MERMPLAN_EXESO_03 
                                 NULL, --nMM_MERMPLAN_03 
                                 NULL, --nMM_MERMPRCO_04 
                                 NULL, --nMM_MERMPLAN_EXESO_04 
                                 NULL, --nMM_MERMPLAN_04 
                                 NULL, --nMM_MERMPRCO_05 
                                 NULL, --nMM_MERMPLAN_EXESO_05 
                                 NULL, --nMM_MERMPLAN_05 
                                 NULL, --nMM_MERMPRCO_06 
                                 NULL, --nMM_MERMPLAN_EXESO_06 
                                 NULL, --nMM_MERMPLAN_06 
                                 NULL, --nMM_MERMPRCO_07 
                                 NULL, --nMM_MERMPLAN_EXESO_07 
                                 NULL, --nMM_MERMPLAN_07 
                                 NULL, --nMM_MERMPRCO_08 
                                 NULL, --nMM_MERMPLAN_EXESO_08 
                                 NULL, --nMM_MERMPLAN_08 
                                 NULL, --nMM_MERMPRCO_09 
                                 NULL, --nMM_MERMPLAN_EXESO_09 
                                 NULL, --nMM_MERMPLAN_09 
                                 NULL, --nMM_MERMPRCO_10 
                                 NULL, --nMM_MERMPLAN_EXESO_10 
                                 NULL, --nMM_MERMPLAN_10 
                                 NULL, --nMM_MERMPRCO 
                                 NULL, --nMM_MERMPLAN_EXESO 
                                 NULL); --nMM_MERMPLAN
                  END IF;
               ELSE
                  --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_EXESO_01 := 0;
                  --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPRCO_01 := 0;
                  --La Merma de Planificación fue menor a lo Estandar / Real (SE ACTUALIZA: YA NO SE BASA EN LA CONFIGURACION)
                  --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_01 := t_MATERIAL(rMaterial_B.IDENTIFICADOR).Ancho - t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_01;
                  P_MATERIAL(rMaterial_B,'U',
                              NULL,--nCantProd
                              NULL,--nCantCons_E
                              NULL,--nCantCons
                              NULL,--nCantAjus
                              NULL,--nAncho
                              NULL,--nFACTOR_CONVERSION_M2_KG
                              NULL,--nPrecio_ML_E
                              NULL,--vLog_Precio
                              NULL,--nMermEnhe_E
                              NULL,--nMermEnhe
                              NULL,--nMermAjus_E
                              NULL,--nMermAjus
                              NULL,--nMermCabo_E
                              NULL,--nMermCabo
                              NULL,--nMermPico_E
                              NULL,--nMermPico
                              NULL,--nMermTita
                              NULL,--nMermSane
                              NULL,--nCantCons_Bobinas
                              --
                              NULL, --nCONTFSMU_01 
                              NULL, --nCANTFSMU_01 
                              NULL, --nCATOFSMU 
                              NULL, --nCONTFSMU_02 
                              NULL, --nCANTFSMU_02 
                              NULL, --nCONTFSMU_03 
                              NULL, --nCANTFSMU_03 
                              NULL, --nCONTFSMU_04 
                              NULL, --nCANTFSMU_04 
                              NULL, --nCONTFSMU_05 
                              NULL, --nCANTFSMU_05 
                              NULL, --nCONTFSMU_06 
                              NULL, --nCANTFSMU_06 
                              NULL, --nCONTFSMU_07 
                              NULL, --nCANTFSMU_07 
                              NULL, --nCONTFSMU_08 
                              NULL, --nCANTFSMU_08 
                              NULL, --nCONTFSMU_09 
                              NULL, --nCANTFSMU_09 
                              NULL, --nCONTFSMU_10 
                              NULL, --nCANTFSMU_10 
                              NULL, --nANCHO_BUENO_TOTAL_01 
                              NULL, --nANCHO_BUENO_OT_01 
                              NULL, --nANCHO_BUENO_TOTAL_02 
                              NULL, --nANCHO_BUENO_OT_02 
                              NULL, --nANCHO_BUENO_TOTAL_03 
                              NULL, --nANCHO_BUENO_OT_03 
                              NULL, --nANCHO_BUENO_TOTAL_04 
                              NULL, --nANCHO_BUENO_OT_04 
                              NULL, --nANCHO_BUENO_TOTAL_05 
                              NULL, --nANCHO_BUENO_OT_05 
                              NULL, --nANCHO_BUENO_TOTAL_06 
                              NULL, --nANCHO_BUENO_OT_06 
                              NULL, --nANCHO_BUENO_TOTAL_07 
                              NULL, --nANCHO_BUENO_OT_07 
                              NULL, --nANCHO_BUENO_TOTAL_08 
                              NULL, --nANCHO_BUENO_OT_08 
                              NULL, --nANCHO_BUENO_TOTAL_09 
                              NULL, --nANCHO_BUENO_OT_09 
                              NULL, --nANCHO_BUENO_TOTAL_10 
                              NULL, --nANCHO_BUENO_OT_10 
                              NULL, --nANCHO_BUENO_TOTAL 
                              NULL, --nANCHO_BUENO_OT 
                              NULL, --nNUMECORT 
                              0, --nMM_MERMPRCO_01 
                              0, --nMM_MERMPLAN_EXESO_01 
                              rMaterial_B.Ancho - rMaterial_B.ANCHO_BUENO_TOTAL_01, --nMM_MERMPLAN_01 
                              NULL, --nMM_MERMPRCO_02 
                              NULL, --nMM_MERMPLAN_EXESO_02 
                              NULL, --nMM_MERMPLAN_02 
                              NULL, --nMM_MERMPRCO_03 
                              NULL, --nMM_MERMPLAN_EXESO_03 
                              NULL, --nMM_MERMPLAN_03 
                              NULL, --nMM_MERMPRCO_04 
                              NULL, --nMM_MERMPLAN_EXESO_04 
                              NULL, --nMM_MERMPLAN_04 
                              NULL, --nMM_MERMPRCO_05 
                              NULL, --nMM_MERMPLAN_EXESO_05 
                              NULL, --nMM_MERMPLAN_05 
                              NULL, --nMM_MERMPRCO_06 
                              NULL, --nMM_MERMPLAN_EXESO_06 
                              NULL, --nMM_MERMPLAN_06 
                              NULL, --nMM_MERMPRCO_07 
                              NULL, --nMM_MERMPLAN_EXESO_07 
                              NULL, --nMM_MERMPLAN_07 
                              NULL, --nMM_MERMPRCO_08 
                              NULL, --nMM_MERMPLAN_EXESO_08 
                              NULL, --nMM_MERMPLAN_08 
                              NULL, --nMM_MERMPRCO_09 
                              NULL, --nMM_MERMPLAN_EXESO_09 
                              NULL, --nMM_MERMPLAN_09 
                              NULL, --nMM_MERMPRCO_10 
                              NULL, --nMM_MERMPLAN_EXESO_10 
                              NULL, --nMM_MERMPLAN_10 
                              NULL, --nMM_MERMPRCO 
                              NULL, --nMM_MERMPLAN_EXESO 
                              NULL); --nMM_MERMPLAN
               END IF;
            ELSE--Si no existe la Merma Planificada Estandar / Real
               --Se asigna la merma encontrada a Excesos o Pre_Corte ya que no fue Planificada como Estandar
               IF rMaterial_B.PRE_CORTE = 'S' THEN
                  --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPRCO_01 := t_MATERIAL(rMaterial_B.IDENTIFICADOR).Ancho - t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_01;
                  P_MATERIAL(rMaterial_B,'U',
                              NULL,--nCantProd
                              NULL,--nCantCons_E
                              NULL,--nCantCons
                              NULL,--nCantAjus
                              NULL,--nAncho
                              NULL,--nFACTOR_CONVERSION_M2_KG
                              NULL,--nPrecio_ML_E
                              NULL,--vLog_Precio
                              NULL,--nMermEnhe_E
                              NULL,--nMermEnhe
                              NULL,--nMermAjus_E
                              NULL,--nMermAjus
                              NULL,--nMermCabo_E
                              NULL,--nMermCabo
                              NULL,--nMermPico_E
                              NULL,--nMermPico
                              NULL,--nMermTita
                              NULL,--nMermSane
                              NULL,--nCantCons_Bobinas
                              --
                              NULL, --nCONTFSMU_01 
                              NULL, --nCANTFSMU_01 
                              NULL, --nCATOFSMU 
                              NULL, --nCONTFSMU_02 
                              NULL, --nCANTFSMU_02 
                              NULL, --nCONTFSMU_03 
                              NULL, --nCANTFSMU_03 
                              NULL, --nCONTFSMU_04 
                              NULL, --nCANTFSMU_04 
                              NULL, --nCONTFSMU_05 
                              NULL, --nCANTFSMU_05 
                              NULL, --nCONTFSMU_06 
                              NULL, --nCANTFSMU_06 
                              NULL, --nCONTFSMU_07 
                              NULL, --nCANTFSMU_07 
                              NULL, --nCONTFSMU_08 
                              NULL, --nCANTFSMU_08 
                              NULL, --nCONTFSMU_09 
                              NULL, --nCANTFSMU_09 
                              NULL, --nCONTFSMU_10 
                              NULL, --nCANTFSMU_10 
                              NULL, --nANCHO_BUENO_TOTAL_01 
                              NULL, --nANCHO_BUENO_OT_01 
                              NULL, --nANCHO_BUENO_TOTAL_02 
                              NULL, --nANCHO_BUENO_OT_02 
                              NULL, --nANCHO_BUENO_TOTAL_03 
                              NULL, --nANCHO_BUENO_OT_03 
                              NULL, --nANCHO_BUENO_TOTAL_04 
                              NULL, --nANCHO_BUENO_OT_04 
                              NULL, --nANCHO_BUENO_TOTAL_05 
                              NULL, --nANCHO_BUENO_OT_05 
                              NULL, --nANCHO_BUENO_TOTAL_06 
                              NULL, --nANCHO_BUENO_OT_06 
                              NULL, --nANCHO_BUENO_TOTAL_07 
                              NULL, --nANCHO_BUENO_OT_07 
                              NULL, --nANCHO_BUENO_TOTAL_08 
                              NULL, --nANCHO_BUENO_OT_08 
                              NULL, --nANCHO_BUENO_TOTAL_09 
                              NULL, --nANCHO_BUENO_OT_09 
                              NULL, --nANCHO_BUENO_TOTAL_10 
                              NULL, --nANCHO_BUENO_OT_10 
                              NULL, --nANCHO_BUENO_TOTAL 
                              NULL, --nANCHO_BUENO_OT 
                              NULL, --nNUMECORT 
                              rMaterial_B.Ancho - rMaterial_B.ANCHO_BUENO_TOTAL_01, --nMM_MERMPRCO_01 
                              NULL, --nMM_MERMPLAN_EXESO_01 
                              0, --nMM_MERMPLAN_01 
                              NULL, --nMM_MERMPRCO_02 
                              NULL, --nMM_MERMPLAN_EXESO_02 
                              NULL, --nMM_MERMPLAN_02 
                              NULL, --nMM_MERMPRCO_03 
                              NULL, --nMM_MERMPLAN_EXESO_03 
                              NULL, --nMM_MERMPLAN_03 
                              NULL, --nMM_MERMPRCO_04 
                              NULL, --nMM_MERMPLAN_EXESO_04 
                              NULL, --nMM_MERMPLAN_04 
                              NULL, --nMM_MERMPRCO_05 
                              NULL, --nMM_MERMPLAN_EXESO_05 
                              NULL, --nMM_MERMPLAN_05 
                              NULL, --nMM_MERMPRCO_06 
                              NULL, --nMM_MERMPLAN_EXESO_06 
                              NULL, --nMM_MERMPLAN_06 
                              NULL, --nMM_MERMPRCO_07 
                              NULL, --nMM_MERMPLAN_EXESO_07 
                              NULL, --nMM_MERMPLAN_07 
                              NULL, --nMM_MERMPRCO_08 
                              NULL, --nMM_MERMPLAN_EXESO_08 
                              NULL, --nMM_MERMPLAN_08 
                              NULL, --nMM_MERMPRCO_09 
                              NULL, --nMM_MERMPLAN_EXESO_09 
                              NULL, --nMM_MERMPLAN_09 
                              NULL, --nMM_MERMPRCO_10 
                              NULL, --nMM_MERMPLAN_EXESO_10 
                              NULL, --nMM_MERMPLAN_10 
                              NULL, --nMM_MERMPRCO 
                              NULL, --nMM_MERMPLAN_EXESO 
                              NULL); --nMM_MERMPLAN
               ELSE
                  --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_EXESO_01 := t_MATERIAL(rMaterial_B.IDENTIFICADOR).Ancho - t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_01;
                  P_MATERIAL(rMaterial_B,'U',
                              NULL,--nCantProd
                              NULL,--nCantCons_E
                              NULL,--nCantCons
                              NULL,--nCantAjus
                              NULL,--nAncho
                              NULL,--nFACTOR_CONVERSION_M2_KG
                              NULL,--nPrecio_ML_E
                              NULL,--vLog_Precio
                              NULL,--nMermEnhe_E
                              NULL,--nMermEnhe
                              NULL,--nMermAjus_E
                              NULL,--nMermAjus
                              NULL,--nMermCabo_E
                              NULL,--nMermCabo
                              NULL,--nMermPico_E
                              NULL,--nMermPico
                              NULL,--nMermTita
                              NULL,--nMermSane
                              NULL,--nCantCons_Bobinas
                              --
                              NULL, --nCONTFSMU_01 
                              NULL, --nCANTFSMU_01 
                              NULL, --nCATOFSMU 
                              NULL, --nCONTFSMU_02 
                              NULL, --nCANTFSMU_02 
                              NULL, --nCONTFSMU_03 
                              NULL, --nCANTFSMU_03 
                              NULL, --nCONTFSMU_04 
                              NULL, --nCANTFSMU_04 
                              NULL, --nCONTFSMU_05 
                              NULL, --nCANTFSMU_05 
                              NULL, --nCONTFSMU_06 
                              NULL, --nCANTFSMU_06 
                              NULL, --nCONTFSMU_07 
                              NULL, --nCANTFSMU_07 
                              NULL, --nCONTFSMU_08 
                              NULL, --nCANTFSMU_08 
                              NULL, --nCONTFSMU_09 
                              NULL, --nCANTFSMU_09 
                              NULL, --nCONTFSMU_10 
                              NULL, --nCANTFSMU_10 
                              NULL, --nANCHO_BUENO_TOTAL_01 
                              NULL, --nANCHO_BUENO_OT_01 
                              NULL, --nANCHO_BUENO_TOTAL_02 
                              NULL, --nANCHO_BUENO_OT_02 
                              NULL, --nANCHO_BUENO_TOTAL_03 
                              NULL, --nANCHO_BUENO_OT_03 
                              NULL, --nANCHO_BUENO_TOTAL_04 
                              NULL, --nANCHO_BUENO_OT_04 
                              NULL, --nANCHO_BUENO_TOTAL_05 
                              NULL, --nANCHO_BUENO_OT_05 
                              NULL, --nANCHO_BUENO_TOTAL_06 
                              NULL, --nANCHO_BUENO_OT_06 
                              NULL, --nANCHO_BUENO_TOTAL_07 
                              NULL, --nANCHO_BUENO_OT_07 
                              NULL, --nANCHO_BUENO_TOTAL_08 
                              NULL, --nANCHO_BUENO_OT_08 
                              NULL, --nANCHO_BUENO_TOTAL_09 
                              NULL, --nANCHO_BUENO_OT_09 
                              NULL, --nANCHO_BUENO_TOTAL_10 
                              NULL, --nANCHO_BUENO_OT_10 
                              NULL, --nANCHO_BUENO_TOTAL 
                              NULL, --nANCHO_BUENO_OT 
                              NULL, --nNUMECORT 
                              NULL, --nMM_MERMPRCO_01 
                              rMaterial_B.Ancho - rMaterial_B.ANCHO_BUENO_TOTAL_01, --nMM_MERMPLAN_EXESO_01 
                              0, --nMM_MERMPLAN_01 
                              NULL, --nMM_MERMPRCO_02 
                              NULL, --nMM_MERMPLAN_EXESO_02 
                              NULL, --nMM_MERMPLAN_02 
                              NULL, --nMM_MERMPRCO_03 
                              NULL, --nMM_MERMPLAN_EXESO_03 
                              NULL, --nMM_MERMPLAN_03 
                              NULL, --nMM_MERMPRCO_04 
                              NULL, --nMM_MERMPLAN_EXESO_04 
                              NULL, --nMM_MERMPLAN_04 
                              NULL, --nMM_MERMPRCO_05 
                              NULL, --nMM_MERMPLAN_EXESO_05 
                              NULL, --nMM_MERMPLAN_05 
                              NULL, --nMM_MERMPRCO_06 
                              NULL, --nMM_MERMPLAN_EXESO_06 
                              NULL, --nMM_MERMPLAN_06 
                              NULL, --nMM_MERMPRCO_07 
                              NULL, --nMM_MERMPLAN_EXESO_07 
                              NULL, --nMM_MERMPLAN_07 
                              NULL, --nMM_MERMPRCO_08 
                              NULL, --nMM_MERMPLAN_EXESO_08 
                              NULL, --nMM_MERMPLAN_08 
                              NULL, --nMM_MERMPRCO_09 
                              NULL, --nMM_MERMPLAN_EXESO_09 
                              NULL, --nMM_MERMPLAN_09 
                              NULL, --nMM_MERMPRCO_10 
                              NULL, --nMM_MERMPLAN_EXESO_10 
                              NULL, --nMM_MERMPLAN_10 
                              NULL, --nMM_MERMPRCO 
                              NULL, --nMM_MERMPLAN_EXESO 
                              NULL); --nMM_MERMPLAN
               END IF;
               --
               --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_01 := 0;
            END IF;
         END IF;
         ------------------------------------------------------------
         --FIN BUSQUEDA DE MM DE MERMAS DE PLANIFICACION Y EXESOS 1--
         ------------------------------------------------------------
         --------------------------------------------------------
         --BUSQUEDA DE MM DE MERMAS DE PLANIFICACION Y EXESOS 2--
         --------------------------------------------------------
         --IF t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_02 IS NOT NULL AND rMATERIAL_B.Tip_Arti != vTIARREST THEN 
         IF rMaterial_B.ANCHO_BUENO_TOTAL_02 IS NOT NULL AND rMATERIAL_B.Tip_Arti != vTIARREST THEN 
            --Busqueda de Exceso de Merma de Planificación
            IF rMATERIAL_B.MM_MERMPLAN_02 IS NOT NULL THEN 
               --IF t_MATERIAL(rMaterial_B.IDENTIFICADOR).Ancho - t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_02 > rMATERIAL_B.MM_MERMPLAN_02 THEN
               IF rMaterial_B.Ancho - rMaterial_B.ANCHO_BUENO_TOTAL_02 > rMATERIAL_B.MM_MERMPLAN_02 THEN
                  IF rMaterial_B.PRE_CORTE = 'S' THEN
                     --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPRCO_02 := t_MATERIAL(rMaterial_B.IDENTIFICADOR).Ancho - t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_02 - rMATERIAL_B.MM_MERMPLAN_02;
                     --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_EXESO_02 := 0;
                     --
                     P_MATERIAL(rMaterial_B,'U',
                                 NULL,--nCantProd
                                 NULL,--nCantCons_E
                                 NULL,--nCantCons
                                 NULL,--nCantAjus
                                 NULL,--nAncho
                                 NULL,--nFACTOR_CONVERSION_M2_KG
                                 NULL,--nPrecio_ML_E
                                 NULL,--vLog_Precio
                                 NULL,--nMermEnhe_E
                                 NULL,--nMermEnhe
                                 NULL,--nMermAjus_E
                                 NULL,--nMermAjus
                                 NULL,--nMermCabo_E
                                 NULL,--nMermCabo
                                 NULL,--nMermPico_E
                                 NULL,--nMermPico
                                 NULL,--nMermTita
                                 NULL,--nMermSane
                                 NULL,--nCantCons_Bobinas
                                 --
                                 NULL, --nCONTFSMU_01 
                                 NULL, --nCANTFSMU_01 
                                 NULL, --nCATOFSMU 
                                 NULL, --nCONTFSMU_02 
                                 NULL, --nCANTFSMU_02 
                                 NULL, --nCONTFSMU_03 
                                 NULL, --nCANTFSMU_03 
                                 NULL, --nCONTFSMU_04 
                                 NULL, --nCANTFSMU_04 
                                 NULL, --nCONTFSMU_05 
                                 NULL, --nCANTFSMU_05 
                                 NULL, --nCONTFSMU_06 
                                 NULL, --nCANTFSMU_06 
                                 NULL, --nCONTFSMU_07 
                                 NULL, --nCANTFSMU_07 
                                 NULL, --nCONTFSMU_08 
                                 NULL, --nCANTFSMU_08 
                                 NULL, --nCONTFSMU_09 
                                 NULL, --nCANTFSMU_09 
                                 NULL, --nCONTFSMU_10 
                                 NULL, --nCANTFSMU_10 
                                 NULL, --nANCHO_BUENO_TOTAL_01 
                                 NULL, --nANCHO_BUENO_OT_01 
                                 NULL, --nANCHO_BUENO_TOTAL_02 
                                 NULL, --nANCHO_BUENO_OT_02 
                                 NULL, --nANCHO_BUENO_TOTAL_03 
                                 NULL, --nANCHO_BUENO_OT_03 
                                 NULL, --nANCHO_BUENO_TOTAL_04 
                                 NULL, --nANCHO_BUENO_OT_04 
                                 NULL, --nANCHO_BUENO_TOTAL_05 
                                 NULL, --nANCHO_BUENO_OT_05 
                                 NULL, --nANCHO_BUENO_TOTAL_06 
                                 NULL, --nANCHO_BUENO_OT_06 
                                 NULL, --nANCHO_BUENO_TOTAL_07 
                                 NULL, --nANCHO_BUENO_OT_07 
                                 NULL, --nANCHO_BUENO_TOTAL_08 
                                 NULL, --nANCHO_BUENO_OT_08 
                                 NULL, --nANCHO_BUENO_TOTAL_09 
                                 NULL, --nANCHO_BUENO_OT_09 
                                 NULL, --nANCHO_BUENO_TOTAL_10 
                                 NULL, --nANCHO_BUENO_OT_10 
                                 NULL, --nANCHO_BUENO_TOTAL 
                                 NULL, --nANCHO_BUENO_OT 
                                 NULL, --nNUMECORT 
                                 NULL, --nMM_MERMPRCO_01 
                                 NULL, --nMM_MERMPLAN_EXESO_01 
                                 NULL, --nMM_MERMPLAN_01 
                                 rMaterial_B.Ancho - rMaterial_B.ANCHO_BUENO_TOTAL_02 - rMATERIAL_B.MM_MERMPLAN_02, --nMM_MERMPRCO_02 
                                 0, --nMM_MERMPLAN_EXESO_02 
                                 NULL, --nMM_MERMPLAN_02 
                                 NULL, --nMM_MERMPRCO_03 
                                 NULL, --nMM_MERMPLAN_EXESO_03 
                                 NULL, --nMM_MERMPLAN_03 
                                 NULL, --nMM_MERMPRCO_04 
                                 NULL, --nMM_MERMPLAN_EXESO_04 
                                 NULL, --nMM_MERMPLAN_04 
                                 NULL, --nMM_MERMPRCO_05 
                                 NULL, --nMM_MERMPLAN_EXESO_05 
                                 NULL, --nMM_MERMPLAN_05 
                                 NULL, --nMM_MERMPRCO_06 
                                 NULL, --nMM_MERMPLAN_EXESO_06 
                                 NULL, --nMM_MERMPLAN_06 
                                 NULL, --nMM_MERMPRCO_07 
                                 NULL, --nMM_MERMPLAN_EXESO_07 
                                 NULL, --nMM_MERMPLAN_07 
                                 NULL, --nMM_MERMPRCO_08 
                                 NULL, --nMM_MERMPLAN_EXESO_08 
                                 NULL, --nMM_MERMPLAN_08 
                                 NULL, --nMM_MERMPRCO_09 
                                 NULL, --nMM_MERMPLAN_EXESO_09 
                                 NULL, --nMM_MERMPLAN_09 
                                 NULL, --nMM_MERMPRCO_10 
                                 NULL, --nMM_MERMPLAN_EXESO_10 
                                 NULL, --nMM_MERMPLAN_10 
                                 NULL, --nMM_MERMPRCO 
                                 NULL, --nMM_MERMPLAN_EXESO 
                                 NULL); --nMM_MERMPLAN
                  ELSE
                     --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_EXESO_02 := t_MATERIAL(rMaterial_B.IDENTIFICADOR).Ancho - t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_02 - rMATERIAL_B.MM_MERMPLAN_02;
                     --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPRCO_02 := 0;
                     --
                     P_MATERIAL(rMaterial_B,'U',
                                 NULL,--nCantProd
                                 NULL,--nCantCons_E
                                 NULL,--nCantCons
                                 NULL,--nCantAjus
                                 NULL,--nAncho
                                 NULL,--nFACTOR_CONVERSION_M2_KG
                                 NULL,--nPrecio_ML_E
                                 NULL,--vLog_Precio
                                 NULL,--nMermEnhe_E
                                 NULL,--nMermEnhe
                                 NULL,--nMermAjus_E
                                 NULL,--nMermAjus
                                 NULL,--nMermCabo_E
                                 NULL,--nMermCabo
                                 NULL,--nMermPico_E
                                 NULL,--nMermPico
                                 NULL,--nMermTita
                                 NULL,--nMermSane
                                 NULL,--nCantCons_Bobinas
                                 --
                                 NULL, --nCONTFSMU_01 
                                 NULL, --nCANTFSMU_01 
                                 NULL, --nCATOFSMU 
                                 NULL, --nCONTFSMU_02 
                                 NULL, --nCANTFSMU_02 
                                 NULL, --nCONTFSMU_03 
                                 NULL, --nCANTFSMU_03 
                                 NULL, --nCONTFSMU_04 
                                 NULL, --nCANTFSMU_04 
                                 NULL, --nCONTFSMU_05 
                                 NULL, --nCANTFSMU_05 
                                 NULL, --nCONTFSMU_06 
                                 NULL, --nCANTFSMU_06 
                                 NULL, --nCONTFSMU_07 
                                 NULL, --nCANTFSMU_07 
                                 NULL, --nCONTFSMU_08 
                                 NULL, --nCANTFSMU_08 
                                 NULL, --nCONTFSMU_09 
                                 NULL, --nCANTFSMU_09 
                                 NULL, --nCONTFSMU_10 
                                 NULL, --nCANTFSMU_10 
                                 NULL, --nANCHO_BUENO_TOTAL_01 
                                 NULL, --nANCHO_BUENO_OT_01 
                                 NULL, --nANCHO_BUENO_TOTAL_02 
                                 NULL, --nANCHO_BUENO_OT_02 
                                 NULL, --nANCHO_BUENO_TOTAL_03 
                                 NULL, --nANCHO_BUENO_OT_03 
                                 NULL, --nANCHO_BUENO_TOTAL_04 
                                 NULL, --nANCHO_BUENO_OT_04 
                                 NULL, --nANCHO_BUENO_TOTAL_05 
                                 NULL, --nANCHO_BUENO_OT_05 
                                 NULL, --nANCHO_BUENO_TOTAL_06 
                                 NULL, --nANCHO_BUENO_OT_06 
                                 NULL, --nANCHO_BUENO_TOTAL_07 
                                 NULL, --nANCHO_BUENO_OT_07 
                                 NULL, --nANCHO_BUENO_TOTAL_08 
                                 NULL, --nANCHO_BUENO_OT_08 
                                 NULL, --nANCHO_BUENO_TOTAL_09 
                                 NULL, --nANCHO_BUENO_OT_09 
                                 NULL, --nANCHO_BUENO_TOTAL_10 
                                 NULL, --nANCHO_BUENO_OT_10 
                                 NULL, --nANCHO_BUENO_TOTAL 
                                 NULL, --nANCHO_BUENO_OT 
                                 NULL, --nNUMECORT 
                                 NULL, --nMM_MERMPRCO_01 
                                 NULL, --nMM_MERMPLAN_EXESO_01 
                                 NULL, --nMM_MERMPLAN_01 
                                 0, --nMM_MERMPRCO_02 
                                 rMaterial_B.Ancho - rMaterial_B.ANCHO_BUENO_TOTAL_02 - rMATERIAL_B.MM_MERMPLAN_02, --nMM_MERMPLAN_EXESO_02 
                                 NULL, --nMM_MERMPLAN_02 
                                 NULL, --nMM_MERMPRCO_03 
                                 NULL, --nMM_MERMPLAN_EXESO_03 
                                 NULL, --nMM_MERMPLAN_03 
                                 NULL, --nMM_MERMPRCO_04 
                                 NULL, --nMM_MERMPLAN_EXESO_04 
                                 NULL, --nMM_MERMPLAN_04 
                                 NULL, --nMM_MERMPRCO_05 
                                 NULL, --nMM_MERMPLAN_EXESO_05 
                                 NULL, --nMM_MERMPLAN_05 
                                 NULL, --nMM_MERMPRCO_06 
                                 NULL, --nMM_MERMPLAN_EXESO_06 
                                 NULL, --nMM_MERMPLAN_06 
                                 NULL, --nMM_MERMPRCO_07 
                                 NULL, --nMM_MERMPLAN_EXESO_07 
                                 NULL, --nMM_MERMPLAN_07 
                                 NULL, --nMM_MERMPRCO_08 
                                 NULL, --nMM_MERMPLAN_EXESO_08 
                                 NULL, --nMM_MERMPLAN_08 
                                 NULL, --nMM_MERMPRCO_09 
                                 NULL, --nMM_MERMPLAN_EXESO_09 
                                 NULL, --nMM_MERMPLAN_09 
                                 NULL, --nMM_MERMPRCO_10 
                                 NULL, --nMM_MERMPLAN_EXESO_10 
                                 NULL, --nMM_MERMPLAN_10 
                                 NULL, --nMM_MERMPRCO 
                                 NULL, --nMM_MERMPLAN_EXESO 
                                 NULL); --nMM_MERMPLAN
                  END IF;
               ELSE
                  --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_EXESO_02 := 0;
                  --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPRCO_02 := 0;
                  --La Merma de Planificación fue menor a lo Estandar / Real (SE ACTUALIZA: YA NO SE BASA EN LA CONFIGURACION)
                  --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_02 := t_MATERIAL(rMaterial_B.IDENTIFICADOR).Ancho - t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_02;
                  --
                  P_MATERIAL(rMaterial_B,'U',
                              NULL,--nCantProd
                              NULL,--nCantCons_E
                              NULL,--nCantCons
                              NULL,--nCantAjus
                              NULL,--nAncho
                              NULL,--nFACTOR_CONVERSION_M2_KG
                              NULL,--nPrecio_ML_E
                              NULL,--vLog_Precio
                              NULL,--nMermEnhe_E
                              NULL,--nMermEnhe
                              NULL,--nMermAjus_E
                              NULL,--nMermAjus
                              NULL,--nMermCabo_E
                              NULL,--nMermCabo
                              NULL,--nMermPico_E
                              NULL,--nMermPico
                              NULL,--nMermTita
                              NULL,--nMermSane
                              NULL,--nCantCons_Bobinas
                              --
                              NULL, --nCONTFSMU_01 
                              NULL, --nCANTFSMU_01 
                              NULL, --nCATOFSMU 
                              NULL, --nCONTFSMU_02 
                              NULL, --nCANTFSMU_02 
                              NULL, --nCONTFSMU_03 
                              NULL, --nCANTFSMU_03 
                              NULL, --nCONTFSMU_04 
                              NULL, --nCANTFSMU_04 
                              NULL, --nCONTFSMU_05 
                              NULL, --nCANTFSMU_05 
                              NULL, --nCONTFSMU_06 
                              NULL, --nCANTFSMU_06 
                              NULL, --nCONTFSMU_07 
                              NULL, --nCANTFSMU_07 
                              NULL, --nCONTFSMU_08 
                              NULL, --nCANTFSMU_08 
                              NULL, --nCONTFSMU_09 
                              NULL, --nCANTFSMU_09 
                              NULL, --nCONTFSMU_10 
                              NULL, --nCANTFSMU_10 
                              NULL, --nANCHO_BUENO_TOTAL_01 
                              NULL, --nANCHO_BUENO_OT_01 
                              NULL, --nANCHO_BUENO_TOTAL_02 
                              NULL, --nANCHO_BUENO_OT_02 
                              NULL, --nANCHO_BUENO_TOTAL_03 
                              NULL, --nANCHO_BUENO_OT_03 
                              NULL, --nANCHO_BUENO_TOTAL_04 
                              NULL, --nANCHO_BUENO_OT_04 
                              NULL, --nANCHO_BUENO_TOTAL_05 
                              NULL, --nANCHO_BUENO_OT_05 
                              NULL, --nANCHO_BUENO_TOTAL_06 
                              NULL, --nANCHO_BUENO_OT_06 
                              NULL, --nANCHO_BUENO_TOTAL_07 
                              NULL, --nANCHO_BUENO_OT_07 
                              NULL, --nANCHO_BUENO_TOTAL_08 
                              NULL, --nANCHO_BUENO_OT_08 
                              NULL, --nANCHO_BUENO_TOTAL_09 
                              NULL, --nANCHO_BUENO_OT_09 
                              NULL, --nANCHO_BUENO_TOTAL_10 
                              NULL, --nANCHO_BUENO_OT_10 
                              NULL, --nANCHO_BUENO_TOTAL 
                              NULL, --nANCHO_BUENO_OT 
                              NULL, --nNUMECORT 
                              NULL, --nMM_MERMPRCO_01 
                              NULL, --nMM_MERMPLAN_EXESO_01 
                              NULL, --nMM_MERMPLAN_01 
                              0, --nMM_MERMPRCO_02 
                              0, --nMM_MERMPLAN_EXESO_02 
                              rMaterial_B.Ancho - rMaterial_B.ANCHO_BUENO_TOTAL_02, --nMM_MERMPLAN_02 
                              NULL, --nMM_MERMPRCO_03 
                              NULL, --nMM_MERMPLAN_EXESO_03 
                              NULL, --nMM_MERMPLAN_03 
                              NULL, --nMM_MERMPRCO_04 
                              NULL, --nMM_MERMPLAN_EXESO_04 
                              NULL, --nMM_MERMPLAN_04 
                              NULL, --nMM_MERMPRCO_05 
                              NULL, --nMM_MERMPLAN_EXESO_05 
                              NULL, --nMM_MERMPLAN_05 
                              NULL, --nMM_MERMPRCO_06 
                              NULL, --nMM_MERMPLAN_EXESO_06 
                              NULL, --nMM_MERMPLAN_06 
                              NULL, --nMM_MERMPRCO_07 
                              NULL, --nMM_MERMPLAN_EXESO_07 
                              NULL, --nMM_MERMPLAN_07 
                              NULL, --nMM_MERMPRCO_08 
                              NULL, --nMM_MERMPLAN_EXESO_08 
                              NULL, --nMM_MERMPLAN_08 
                              NULL, --nMM_MERMPRCO_09 
                              NULL, --nMM_MERMPLAN_EXESO_09 
                              NULL, --nMM_MERMPLAN_09 
                              NULL, --nMM_MERMPRCO_10 
                              NULL, --nMM_MERMPLAN_EXESO_10 
                              NULL, --nMM_MERMPLAN_10 
                              NULL, --nMM_MERMPRCO 
                              NULL, --nMM_MERMPLAN_EXESO 
                              NULL); --nMM_MERMPLAN
               END IF;
            ELSE--Si no existe la Merma Planificada Estandar / Real
               --Se asigna la merma encontrada a Excesos o Pre_Corte ya que no fue Planificada como Estandar
               IF rMaterial_B.PRE_CORTE = 'S' THEN
                  --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPRCO_02 := t_MATERIAL(rMaterial_B.IDENTIFICADOR).Ancho - t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_02;
                  P_MATERIAL(rMaterial_B,'U',
                              NULL,--nCantProd
                              NULL,--nCantCons_E
                              NULL,--nCantCons
                              NULL,--nCantAjus
                              NULL,--nAncho
                              NULL,--nFACTOR_CONVERSION_M2_KG
                              NULL,--nPrecio_ML_E
                              NULL,--vLog_Precio
                              NULL,--nMermEnhe_E
                              NULL,--nMermEnhe
                              NULL,--nMermAjus_E
                              NULL,--nMermAjus
                              NULL,--nMermCabo_E
                              NULL,--nMermCabo
                              NULL,--nMermPico_E
                              NULL,--nMermPico
                              NULL,--nMermTita
                              NULL,--nMermSane
                              NULL,--nCantCons_Bobinas
                              --
                              NULL, --nCONTFSMU_01 
                              NULL, --nCANTFSMU_01 
                              NULL, --nCATOFSMU 
                              NULL, --nCONTFSMU_02 
                              NULL, --nCANTFSMU_02 
                              NULL, --nCONTFSMU_03 
                              NULL, --nCANTFSMU_03 
                              NULL, --nCONTFSMU_04 
                              NULL, --nCANTFSMU_04 
                              NULL, --nCONTFSMU_05 
                              NULL, --nCANTFSMU_05 
                              NULL, --nCONTFSMU_06 
                              NULL, --nCANTFSMU_06 
                              NULL, --nCONTFSMU_07 
                              NULL, --nCANTFSMU_07 
                              NULL, --nCONTFSMU_08 
                              NULL, --nCANTFSMU_08 
                              NULL, --nCONTFSMU_09 
                              NULL, --nCANTFSMU_09 
                              NULL, --nCONTFSMU_10 
                              NULL, --nCANTFSMU_10 
                              NULL, --nANCHO_BUENO_TOTAL_01 
                              NULL, --nANCHO_BUENO_OT_01 
                              NULL, --nANCHO_BUENO_TOTAL_02 
                              NULL, --nANCHO_BUENO_OT_02 
                              NULL, --nANCHO_BUENO_TOTAL_03 
                              NULL, --nANCHO_BUENO_OT_03 
                              NULL, --nANCHO_BUENO_TOTAL_04 
                              NULL, --nANCHO_BUENO_OT_04 
                              NULL, --nANCHO_BUENO_TOTAL_05 
                              NULL, --nANCHO_BUENO_OT_05 
                              NULL, --nANCHO_BUENO_TOTAL_06 
                              NULL, --nANCHO_BUENO_OT_06 
                              NULL, --nANCHO_BUENO_TOTAL_07 
                              NULL, --nANCHO_BUENO_OT_07 
                              NULL, --nANCHO_BUENO_TOTAL_08 
                              NULL, --nANCHO_BUENO_OT_08 
                              NULL, --nANCHO_BUENO_TOTAL_09 
                              NULL, --nANCHO_BUENO_OT_09 
                              NULL, --nANCHO_BUENO_TOTAL_10 
                              NULL, --nANCHO_BUENO_OT_10 
                              NULL, --nANCHO_BUENO_TOTAL 
                              NULL, --nANCHO_BUENO_OT 
                              NULL, --nNUMECORT 
                              NULL, --nMM_MERMPRCO_01 
                              NULL, --nMM_MERMPLAN_EXESO_01 
                              NULL, --nMM_MERMPLAN_01 
                              rMaterial_B.Ancho - rMaterial_B.ANCHO_BUENO_TOTAL_02, --nMM_MERMPRCO_02 
                              NULL, --nMM_MERMPLAN_EXESO_02 
                              0, --nMM_MERMPLAN_02 
                              NULL, --nMM_MERMPRCO_03 
                              NULL, --nMM_MERMPLAN_EXESO_03 
                              NULL, --nMM_MERMPLAN_03 
                              NULL, --nMM_MERMPRCO_04 
                              NULL, --nMM_MERMPLAN_EXESO_04 
                              NULL, --nMM_MERMPLAN_04 
                              NULL, --nMM_MERMPRCO_05 
                              NULL, --nMM_MERMPLAN_EXESO_05 
                              NULL, --nMM_MERMPLAN_05 
                              NULL, --nMM_MERMPRCO_06 
                              NULL, --nMM_MERMPLAN_EXESO_06 
                              NULL, --nMM_MERMPLAN_06 
                              NULL, --nMM_MERMPRCO_07 
                              NULL, --nMM_MERMPLAN_EXESO_07 
                              NULL, --nMM_MERMPLAN_07 
                              NULL, --nMM_MERMPRCO_08 
                              NULL, --nMM_MERMPLAN_EXESO_08 
                              NULL, --nMM_MERMPLAN_08 
                              NULL, --nMM_MERMPRCO_09 
                              NULL, --nMM_MERMPLAN_EXESO_09 
                              NULL, --nMM_MERMPLAN_09 
                              NULL, --nMM_MERMPRCO_10 
                              NULL, --nMM_MERMPLAN_EXESO_10 
                              NULL, --nMM_MERMPLAN_10 
                              NULL, --nMM_MERMPRCO 
                              NULL, --nMM_MERMPLAN_EXESO 
                              NULL); --nMM_MERMPLAN
               ELSE
                  --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_EXESO_02 := t_MATERIAL(rMaterial_B.IDENTIFICADOR).Ancho - t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_02;
                  P_MATERIAL(rMaterial_B,'U',
                              NULL,--nCantProd
                              NULL,--nCantCons_E
                              NULL,--nCantCons
                              NULL,--nCantAjus
                              NULL,--nAncho
                              NULL,--nFACTOR_CONVERSION_M2_KG
                              NULL,--nPrecio_ML_E
                              NULL,--vLog_Precio
                              NULL,--nMermEnhe_E
                              NULL,--nMermEnhe
                              NULL,--nMermAjus_E
                              NULL,--nMermAjus
                              NULL,--nMermCabo_E
                              NULL,--nMermCabo
                              NULL,--nMermPico_E
                              NULL,--nMermPico
                              NULL,--nMermTita
                              NULL,--nMermSane
                              NULL,--nCantCons_Bobinas
                              --
                              NULL, --nCONTFSMU_01 
                              NULL, --nCANTFSMU_01 
                              NULL, --nCATOFSMU 
                              NULL, --nCONTFSMU_02 
                              NULL, --nCANTFSMU_02 
                              NULL, --nCONTFSMU_03 
                              NULL, --nCANTFSMU_03 
                              NULL, --nCONTFSMU_04 
                              NULL, --nCANTFSMU_04 
                              NULL, --nCONTFSMU_05 
                              NULL, --nCANTFSMU_05 
                              NULL, --nCONTFSMU_06 
                              NULL, --nCANTFSMU_06 
                              NULL, --nCONTFSMU_07 
                              NULL, --nCANTFSMU_07 
                              NULL, --nCONTFSMU_08 
                              NULL, --nCANTFSMU_08 
                              NULL, --nCONTFSMU_09 
                              NULL, --nCANTFSMU_09 
                              NULL, --nCONTFSMU_10 
                              NULL, --nCANTFSMU_10 
                              NULL, --nANCHO_BUENO_TOTAL_01 
                              NULL, --nANCHO_BUENO_OT_01 
                              NULL, --nANCHO_BUENO_TOTAL_02 
                              NULL, --nANCHO_BUENO_OT_02 
                              NULL, --nANCHO_BUENO_TOTAL_03 
                              NULL, --nANCHO_BUENO_OT_03 
                              NULL, --nANCHO_BUENO_TOTAL_04 
                              NULL, --nANCHO_BUENO_OT_04 
                              NULL, --nANCHO_BUENO_TOTAL_05 
                              NULL, --nANCHO_BUENO_OT_05 
                              NULL, --nANCHO_BUENO_TOTAL_06 
                              NULL, --nANCHO_BUENO_OT_06 
                              NULL, --nANCHO_BUENO_TOTAL_07 
                              NULL, --nANCHO_BUENO_OT_07 
                              NULL, --nANCHO_BUENO_TOTAL_08 
                              NULL, --nANCHO_BUENO_OT_08 
                              NULL, --nANCHO_BUENO_TOTAL_09 
                              NULL, --nANCHO_BUENO_OT_09 
                              NULL, --nANCHO_BUENO_TOTAL_10 
                              NULL, --nANCHO_BUENO_OT_10 
                              NULL, --nANCHO_BUENO_TOTAL 
                              NULL, --nANCHO_BUENO_OT 
                              NULL, --nNUMECORT 
                              NULL, --nMM_MERMPRCO_01 
                              NULL, --nMM_MERMPLAN_EXESO_01 
                              NULL, --nMM_MERMPLAN_01 
                              NULL, --nMM_MERMPRCO_02 
                              rMaterial_B.Ancho - rMaterial_B.ANCHO_BUENO_TOTAL_02, --nMM_MERMPLAN_EXESO_02 
                              0, --nMM_MERMPLAN_02 
                              NULL, --nMM_MERMPRCO_03 
                              NULL, --nMM_MERMPLAN_EXESO_03 
                              NULL, --nMM_MERMPLAN_03 
                              NULL, --nMM_MERMPRCO_04 
                              NULL, --nMM_MERMPLAN_EXESO_04 
                              NULL, --nMM_MERMPLAN_04 
                              NULL, --nMM_MERMPRCO_05 
                              NULL, --nMM_MERMPLAN_EXESO_05 
                              NULL, --nMM_MERMPLAN_05 
                              NULL, --nMM_MERMPRCO_06 
                              NULL, --nMM_MERMPLAN_EXESO_06 
                              NULL, --nMM_MERMPLAN_06 
                              NULL, --nMM_MERMPRCO_07 
                              NULL, --nMM_MERMPLAN_EXESO_07 
                              NULL, --nMM_MERMPLAN_07 
                              NULL, --nMM_MERMPRCO_08 
                              NULL, --nMM_MERMPLAN_EXESO_08 
                              NULL, --nMM_MERMPLAN_08 
                              NULL, --nMM_MERMPRCO_09 
                              NULL, --nMM_MERMPLAN_EXESO_09 
                              NULL, --nMM_MERMPLAN_09 
                              NULL, --nMM_MERMPRCO_10 
                              NULL, --nMM_MERMPLAN_EXESO_10 
                              NULL, --nMM_MERMPLAN_10 
                              NULL, --nMM_MERMPRCO 
                              NULL, --nMM_MERMPLAN_EXESO 
                              NULL); --nMM_MERMPLAN
               END IF;
               --
               --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_02 := 0;
            END IF;
         END IF;
         ------------------------------------------------------------
         --FIN BUSQUEDA DE MM DE MERMAS DE PLANIFICACION Y EXESOS 2--
         ------------------------------------------------------------
         --------------------------------------------------------
         --BUSQUEDA DE MM DE MERMAS DE PLANIFICACION Y EXESOS 3--
         --------------------------------------------------------
         --IF t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_03 IS NOT NULL AND rMATERIAL_B.Tip_Arti != vTIARREST THEN 
         IF rMaterial_B.ANCHO_BUENO_TOTAL_03 IS NOT NULL AND rMATERIAL_B.Tip_Arti != vTIARREST THEN 
            --Busqueda de Exceso de Merma de Planificación
            IF rMATERIAL_B.MM_MERMPLAN_03 IS NOT NULL THEN 
               --IF t_MATERIAL(rMaterial_B.IDENTIFICADOR).Ancho - t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_03 > rMATERIAL_B.MM_MERMPLAN_03 THEN
               IF rMaterial_B.Ancho - rMaterial_B.ANCHO_BUENO_TOTAL_03 > rMATERIAL_B.MM_MERMPLAN_03 THEN
                  IF rMaterial_B.PRE_CORTE = 'S' THEN
                     --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPRCO_03 := t_MATERIAL(rMaterial_B.IDENTIFICADOR).Ancho - t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_03 - rMATERIAL_B.MM_MERMPLAN_03;
                     --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_EXESO_03 := 0;
                     --
                     P_MATERIAL(rMaterial_B,'U',
                                 NULL,--nCantProd
                                 NULL,--nCantCons_E
                                 NULL,--nCantCons
                                 NULL,--nCantAjus
                                 NULL,--nAncho
                                 NULL,--nFACTOR_CONVERSION_M2_KG
                                 NULL,--nPrecio_ML_E
                                 NULL,--vLog_Precio
                                 NULL,--nMermEnhe_E
                                 NULL,--nMermEnhe
                                 NULL,--nMermAjus_E
                                 NULL,--nMermAjus
                                 NULL,--nMermCabo_E
                                 NULL,--nMermCabo
                                 NULL,--nMermPico_E
                                 NULL,--nMermPico
                                 NULL,--nMermTita
                                 NULL,--nMermSane
                                 NULL,--nCantCons_Bobinas
                                 --
                                 NULL, --nCONTFSMU_01 
                                 NULL, --nCANTFSMU_01 
                                 NULL, --nCATOFSMU 
                                 NULL, --nCONTFSMU_02 
                                 NULL, --nCANTFSMU_02 
                                 NULL, --nCONTFSMU_03 
                                 NULL, --nCANTFSMU_03 
                                 NULL, --nCONTFSMU_04 
                                 NULL, --nCANTFSMU_04 
                                 NULL, --nCONTFSMU_05 
                                 NULL, --nCANTFSMU_05 
                                 NULL, --nCONTFSMU_06 
                                 NULL, --nCANTFSMU_06 
                                 NULL, --nCONTFSMU_07 
                                 NULL, --nCANTFSMU_07 
                                 NULL, --nCONTFSMU_08 
                                 NULL, --nCANTFSMU_08 
                                 NULL, --nCONTFSMU_09 
                                 NULL, --nCANTFSMU_09 
                                 NULL, --nCONTFSMU_10 
                                 NULL, --nCANTFSMU_10 
                                 NULL, --nANCHO_BUENO_TOTAL_01 
                                 NULL, --nANCHO_BUENO_OT_01 
                                 NULL, --nANCHO_BUENO_TOTAL_02 
                                 NULL, --nANCHO_BUENO_OT_02 
                                 NULL, --nANCHO_BUENO_TOTAL_03 
                                 NULL, --nANCHO_BUENO_OT_03 
                                 NULL, --nANCHO_BUENO_TOTAL_04 
                                 NULL, --nANCHO_BUENO_OT_04 
                                 NULL, --nANCHO_BUENO_TOTAL_05 
                                 NULL, --nANCHO_BUENO_OT_05 
                                 NULL, --nANCHO_BUENO_TOTAL_06 
                                 NULL, --nANCHO_BUENO_OT_06 
                                 NULL, --nANCHO_BUENO_TOTAL_07 
                                 NULL, --nANCHO_BUENO_OT_07 
                                 NULL, --nANCHO_BUENO_TOTAL_08 
                                 NULL, --nANCHO_BUENO_OT_08 
                                 NULL, --nANCHO_BUENO_TOTAL_09 
                                 NULL, --nANCHO_BUENO_OT_09 
                                 NULL, --nANCHO_BUENO_TOTAL_10 
                                 NULL, --nANCHO_BUENO_OT_10 
                                 NULL, --nANCHO_BUENO_TOTAL 
                                 NULL, --nANCHO_BUENO_OT 
                                 NULL, --nNUMECORT 
                                 NULL, --nMM_MERMPRCO_01 
                                 NULL, --nMM_MERMPLAN_EXESO_01 
                                 NULL, --nMM_MERMPLAN_01 
                                 NULL, --nMM_MERMPRCO_02 
                                 NULL, --nMM_MERMPLAN_EXESO_02 
                                 NULL, --nMM_MERMPLAN_02 
                                 rMaterial_B.Ancho - rMaterial_B.ANCHO_BUENO_TOTAL_03 - rMATERIAL_B.MM_MERMPLAN_03, --nMM_MERMPRCO_03 
                                 0, --nMM_MERMPLAN_EXESO_03 
                                 NULL, --nMM_MERMPLAN_03 
                                 NULL, --nMM_MERMPRCO_04 
                                 NULL, --nMM_MERMPLAN_EXESO_04 
                                 NULL, --nMM_MERMPLAN_04 
                                 NULL, --nMM_MERMPRCO_05 
                                 NULL, --nMM_MERMPLAN_EXESO_05 
                                 NULL, --nMM_MERMPLAN_05 
                                 NULL, --nMM_MERMPRCO_06 
                                 NULL, --nMM_MERMPLAN_EXESO_06 
                                 NULL, --nMM_MERMPLAN_06 
                                 NULL, --nMM_MERMPRCO_07 
                                 NULL, --nMM_MERMPLAN_EXESO_07 
                                 NULL, --nMM_MERMPLAN_07 
                                 NULL, --nMM_MERMPRCO_08 
                                 NULL, --nMM_MERMPLAN_EXESO_08 
                                 NULL, --nMM_MERMPLAN_08 
                                 NULL, --nMM_MERMPRCO_09 
                                 NULL, --nMM_MERMPLAN_EXESO_09 
                                 NULL, --nMM_MERMPLAN_09 
                                 NULL, --nMM_MERMPRCO_10 
                                 NULL, --nMM_MERMPLAN_EXESO_10 
                                 NULL, --nMM_MERMPLAN_10 
                                 NULL, --nMM_MERMPRCO 
                                 NULL, --nMM_MERMPLAN_EXESO 
                                 NULL); --nMM_MERMPLAN
                  ELSE
                     --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_EXESO_03 := t_MATERIAL(rMaterial_B.IDENTIFICADOR).Ancho - t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_03 - rMATERIAL_B.MM_MERMPLAN_03;
                     --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPRCO_03 := 0;
                     --
                     P_MATERIAL(rMaterial_B,'U',
                                 NULL,--nCantProd
                                 NULL,--nCantCons_E
                                 NULL,--nCantCons
                                 NULL,--nCantAjus
                                 NULL,--nAncho
                                 NULL,--nFACTOR_CONVERSION_M2_KG
                                 NULL,--nPrecio_ML_E
                                 NULL,--vLog_Precio
                                 NULL,--nMermEnhe_E
                                 NULL,--nMermEnhe
                                 NULL,--nMermAjus_E
                                 NULL,--nMermAjus
                                 NULL,--nMermCabo_E
                                 NULL,--nMermCabo
                                 NULL,--nMermPico_E
                                 NULL,--nMermPico
                                 NULL,--nMermTita
                                 NULL,--nMermSane
                                 NULL,--nCantCons_Bobinas
                                 --
                                 NULL, --nCONTFSMU_01 
                                 NULL, --nCANTFSMU_01 
                                 NULL, --nCATOFSMU 
                                 NULL, --nCONTFSMU_02 
                                 NULL, --nCANTFSMU_02 
                                 NULL, --nCONTFSMU_03 
                                 NULL, --nCANTFSMU_03 
                                 NULL, --nCONTFSMU_04 
                                 NULL, --nCANTFSMU_04 
                                 NULL, --nCONTFSMU_05 
                                 NULL, --nCANTFSMU_05 
                                 NULL, --nCONTFSMU_06 
                                 NULL, --nCANTFSMU_06 
                                 NULL, --nCONTFSMU_07 
                                 NULL, --nCANTFSMU_07 
                                 NULL, --nCONTFSMU_08 
                                 NULL, --nCANTFSMU_08 
                                 NULL, --nCONTFSMU_09 
                                 NULL, --nCANTFSMU_09 
                                 NULL, --nCONTFSMU_10 
                                 NULL, --nCANTFSMU_10 
                                 NULL, --nANCHO_BUENO_TOTAL_01 
                                 NULL, --nANCHO_BUENO_OT_01 
                                 NULL, --nANCHO_BUENO_TOTAL_02 
                                 NULL, --nANCHO_BUENO_OT_02 
                                 NULL, --nANCHO_BUENO_TOTAL_03 
                                 NULL, --nANCHO_BUENO_OT_03 
                                 NULL, --nANCHO_BUENO_TOTAL_04 
                                 NULL, --nANCHO_BUENO_OT_04 
                                 NULL, --nANCHO_BUENO_TOTAL_05 
                                 NULL, --nANCHO_BUENO_OT_05 
                                 NULL, --nANCHO_BUENO_TOTAL_06 
                                 NULL, --nANCHO_BUENO_OT_06 
                                 NULL, --nANCHO_BUENO_TOTAL_07 
                                 NULL, --nANCHO_BUENO_OT_07 
                                 NULL, --nANCHO_BUENO_TOTAL_08 
                                 NULL, --nANCHO_BUENO_OT_08 
                                 NULL, --nANCHO_BUENO_TOTAL_09 
                                 NULL, --nANCHO_BUENO_OT_09 
                                 NULL, --nANCHO_BUENO_TOTAL_10 
                                 NULL, --nANCHO_BUENO_OT_10 
                                 NULL, --nANCHO_BUENO_TOTAL 
                                 NULL, --nANCHO_BUENO_OT 
                                 NULL, --nNUMECORT 
                                 NULL, --nMM_MERMPRCO_01 
                                 NULL, --nMM_MERMPLAN_EXESO_01 
                                 NULL, --nMM_MERMPLAN_01 
                                 NULL, --nMM_MERMPRCO_02 
                                 NULL, --nMM_MERMPLAN_EXESO_02 
                                 NULL, --nMM_MERMPLAN_02 
                                 0, --nMM_MERMPRCO_03 
                                 rMaterial_B.Ancho - rMaterial_B.ANCHO_BUENO_TOTAL_03 - rMATERIAL_B.MM_MERMPLAN_03, --nMM_MERMPLAN_EXESO_03 
                                 NULL, --nMM_MERMPLAN_03 
                                 NULL, --nMM_MERMPRCO_04 
                                 NULL, --nMM_MERMPLAN_EXESO_04 
                                 NULL, --nMM_MERMPLAN_04 
                                 NULL, --nMM_MERMPRCO_05 
                                 NULL, --nMM_MERMPLAN_EXESO_05 
                                 NULL, --nMM_MERMPLAN_05 
                                 NULL, --nMM_MERMPRCO_06 
                                 NULL, --nMM_MERMPLAN_EXESO_06 
                                 NULL, --nMM_MERMPLAN_06 
                                 NULL, --nMM_MERMPRCO_07 
                                 NULL, --nMM_MERMPLAN_EXESO_07 
                                 NULL, --nMM_MERMPLAN_07 
                                 NULL, --nMM_MERMPRCO_08 
                                 NULL, --nMM_MERMPLAN_EXESO_08 
                                 NULL, --nMM_MERMPLAN_08 
                                 NULL, --nMM_MERMPRCO_09 
                                 NULL, --nMM_MERMPLAN_EXESO_09 
                                 NULL, --nMM_MERMPLAN_09 
                                 NULL, --nMM_MERMPRCO_10 
                                 NULL, --nMM_MERMPLAN_EXESO_10 
                                 NULL, --nMM_MERMPLAN_10 
                                 NULL, --nMM_MERMPRCO 
                                 NULL, --nMM_MERMPLAN_EXESO 
                                 NULL); --nMM_MERMPLAN
                  END IF;
               ELSE
                  --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_EXESO_03 := 0;
                  --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPRCO_03 := 0;
                  --La Merma de Planificación fue menor a lo Estandar / Real (SE ACTUALIZA: YA NO SE BASA EN LA CONFIGURACION)
                  --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_03 := t_MATERIAL(rMaterial_B.IDENTIFICADOR).Ancho - t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_03;
                  P_MATERIAL(rMaterial_B,'U',
                              NULL,--nCantProd
                              NULL,--nCantCons_E
                              NULL,--nCantCons
                              NULL,--nCantAjus
                              NULL,--nAncho
                              NULL,--nFACTOR_CONVERSION_M2_KG
                              NULL,--nPrecio_ML_E
                              NULL,--vLog_Precio
                              NULL,--nMermEnhe_E
                              NULL,--nMermEnhe
                              NULL,--nMermAjus_E
                              NULL,--nMermAjus
                              NULL,--nMermCabo_E
                              NULL,--nMermCabo
                              NULL,--nMermPico_E
                              NULL,--nMermPico
                              NULL,--nMermTita
                              NULL,--nMermSane
                              NULL,--nCantCons_Bobinas
                              --
                              NULL, --nCONTFSMU_01 
                              NULL, --nCANTFSMU_01 
                              NULL, --nCATOFSMU 
                              NULL, --nCONTFSMU_02 
                              NULL, --nCANTFSMU_02 
                              NULL, --nCONTFSMU_03 
                              NULL, --nCANTFSMU_03 
                              NULL, --nCONTFSMU_04 
                              NULL, --nCANTFSMU_04 
                              NULL, --nCONTFSMU_05 
                              NULL, --nCANTFSMU_05 
                              NULL, --nCONTFSMU_06 
                              NULL, --nCANTFSMU_06 
                              NULL, --nCONTFSMU_07 
                              NULL, --nCANTFSMU_07 
                              NULL, --nCONTFSMU_08 
                              NULL, --nCANTFSMU_08 
                              NULL, --nCONTFSMU_09 
                              NULL, --nCANTFSMU_09 
                              NULL, --nCONTFSMU_10 
                              NULL, --nCANTFSMU_10 
                              NULL, --nANCHO_BUENO_TOTAL_01 
                              NULL, --nANCHO_BUENO_OT_01 
                              NULL, --nANCHO_BUENO_TOTAL_02 
                              NULL, --nANCHO_BUENO_OT_02 
                              NULL, --nANCHO_BUENO_TOTAL_03 
                              NULL, --nANCHO_BUENO_OT_03 
                              NULL, --nANCHO_BUENO_TOTAL_04 
                              NULL, --nANCHO_BUENO_OT_04 
                              NULL, --nANCHO_BUENO_TOTAL_05 
                              NULL, --nANCHO_BUENO_OT_05 
                              NULL, --nANCHO_BUENO_TOTAL_06 
                              NULL, --nANCHO_BUENO_OT_06 
                              NULL, --nANCHO_BUENO_TOTAL_07 
                              NULL, --nANCHO_BUENO_OT_07 
                              NULL, --nANCHO_BUENO_TOTAL_08 
                              NULL, --nANCHO_BUENO_OT_08 
                              NULL, --nANCHO_BUENO_TOTAL_09 
                              NULL, --nANCHO_BUENO_OT_09 
                              NULL, --nANCHO_BUENO_TOTAL_10 
                              NULL, --nANCHO_BUENO_OT_10 
                              NULL, --nANCHO_BUENO_TOTAL 
                              NULL, --nANCHO_BUENO_OT 
                              NULL, --nNUMECORT 
                              NULL, --nMM_MERMPRCO_01 
                              NULL, --nMM_MERMPLAN_EXESO_01 
                              NULL, --nMM_MERMPLAN_01 
                              NULL, --nMM_MERMPRCO_02 
                              NULL, --nMM_MERMPLAN_EXESO_02 
                              NULL, --nMM_MERMPLAN_02 
                              0, --nMM_MERMPRCO_03 
                              0, --nMM_MERMPLAN_EXESO_03 
                              rMaterial_B.Ancho - rMaterial_B.ANCHO_BUENO_TOTAL_03, --nMM_MERMPLAN_03 
                              NULL, --nMM_MERMPRCO_04 
                              NULL, --nMM_MERMPLAN_EXESO_04 
                              NULL, --nMM_MERMPLAN_04 
                              NULL, --nMM_MERMPRCO_05 
                              NULL, --nMM_MERMPLAN_EXESO_05 
                              NULL, --nMM_MERMPLAN_05 
                              NULL, --nMM_MERMPRCO_06 
                              NULL, --nMM_MERMPLAN_EXESO_06 
                              NULL, --nMM_MERMPLAN_06 
                              NULL, --nMM_MERMPRCO_07 
                              NULL, --nMM_MERMPLAN_EXESO_07 
                              NULL, --nMM_MERMPLAN_07 
                              NULL, --nMM_MERMPRCO_08 
                              NULL, --nMM_MERMPLAN_EXESO_08 
                              NULL, --nMM_MERMPLAN_08 
                              NULL, --nMM_MERMPRCO_09 
                              NULL, --nMM_MERMPLAN_EXESO_09 
                              NULL, --nMM_MERMPLAN_09 
                              NULL, --nMM_MERMPRCO_10 
                              NULL, --nMM_MERMPLAN_EXESO_10 
                              NULL, --nMM_MERMPLAN_10 
                              NULL, --nMM_MERMPRCO 
                              NULL, --nMM_MERMPLAN_EXESO 
                              NULL); --nMM_MERMPLAN
               END IF;
            ELSE--Si no existe la Merma Planificada Estandar / Real
               --Se asigna la merma encontrada a Excesos o Pre_Corte ya que no fue Planificada como Estandar
               IF rMaterial_B.PRE_CORTE = 'S' THEN
                  --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPRCO_03 := t_MATERIAL(rMaterial_B.IDENTIFICADOR).Ancho - t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_03;
                  P_MATERIAL(rMaterial_B,'U',
                              NULL,--nCantProd
                              NULL,--nCantCons_E
                              NULL,--nCantCons
                              NULL,--nCantAjus
                              NULL,--nAncho
                              NULL,--nFACTOR_CONVERSION_M2_KG
                              NULL,--nPrecio_ML_E
                              NULL,--vLog_Precio
                              NULL,--nMermEnhe_E
                              NULL,--nMermEnhe
                              NULL,--nMermAjus_E
                              NULL,--nMermAjus
                              NULL,--nMermCabo_E
                              NULL,--nMermCabo
                              NULL,--nMermPico_E
                              NULL,--nMermPico
                              NULL,--nMermTita
                              NULL,--nMermSane
                              NULL,--nCantCons_Bobinas
                              --
                              NULL, --nCONTFSMU_01 
                              NULL, --nCANTFSMU_01 
                              NULL, --nCATOFSMU 
                              NULL, --nCONTFSMU_02 
                              NULL, --nCANTFSMU_02 
                              NULL, --nCONTFSMU_03 
                              NULL, --nCANTFSMU_03 
                              NULL, --nCONTFSMU_04 
                              NULL, --nCANTFSMU_04 
                              NULL, --nCONTFSMU_05 
                              NULL, --nCANTFSMU_05 
                              NULL, --nCONTFSMU_06 
                              NULL, --nCANTFSMU_06 
                              NULL, --nCONTFSMU_07 
                              NULL, --nCANTFSMU_07 
                              NULL, --nCONTFSMU_08 
                              NULL, --nCANTFSMU_08 
                              NULL, --nCONTFSMU_09 
                              NULL, --nCANTFSMU_09 
                              NULL, --nCONTFSMU_10 
                              NULL, --nCANTFSMU_10 
                              NULL, --nANCHO_BUENO_TOTAL_01 
                              NULL, --nANCHO_BUENO_OT_01 
                              NULL, --nANCHO_BUENO_TOTAL_02 
                              NULL, --nANCHO_BUENO_OT_02 
                              NULL, --nANCHO_BUENO_TOTAL_03 
                              NULL, --nANCHO_BUENO_OT_03 
                              NULL, --nANCHO_BUENO_TOTAL_04 
                              NULL, --nANCHO_BUENO_OT_04 
                              NULL, --nANCHO_BUENO_TOTAL_05 
                              NULL, --nANCHO_BUENO_OT_05 
                              NULL, --nANCHO_BUENO_TOTAL_06 
                              NULL, --nANCHO_BUENO_OT_06 
                              NULL, --nANCHO_BUENO_TOTAL_07 
                              NULL, --nANCHO_BUENO_OT_07 
                              NULL, --nANCHO_BUENO_TOTAL_08 
                              NULL, --nANCHO_BUENO_OT_08 
                              NULL, --nANCHO_BUENO_TOTAL_09 
                              NULL, --nANCHO_BUENO_OT_09 
                              NULL, --nANCHO_BUENO_TOTAL_10 
                              NULL, --nANCHO_BUENO_OT_10 
                              NULL, --nANCHO_BUENO_TOTAL 
                              NULL, --nANCHO_BUENO_OT 
                              NULL, --nNUMECORT 
                              NULL, --nMM_MERMPRCO_01 
                              NULL, --nMM_MERMPLAN_EXESO_01 
                              NULL, --nMM_MERMPLAN_01 
                              NULL, --nMM_MERMPRCO_02 
                              NULL, --nMM_MERMPLAN_EXESO_02 
                              NULL, --nMM_MERMPLAN_02 
                              rMaterial_B.Ancho - rMaterial_B.ANCHO_BUENO_TOTAL_03, --nMM_MERMPRCO_03 
                              NULL, --nMM_MERMPLAN_EXESO_03 
                              0, --nMM_MERMPLAN_03 
                              NULL, --nMM_MERMPRCO_04 
                              NULL, --nMM_MERMPLAN_EXESO_04 
                              NULL, --nMM_MERMPLAN_04 
                              NULL, --nMM_MERMPRCO_05 
                              NULL, --nMM_MERMPLAN_EXESO_05 
                              NULL, --nMM_MERMPLAN_05 
                              NULL, --nMM_MERMPRCO_06 
                              NULL, --nMM_MERMPLAN_EXESO_06 
                              NULL, --nMM_MERMPLAN_06 
                              NULL, --nMM_MERMPRCO_07 
                              NULL, --nMM_MERMPLAN_EXESO_07 
                              NULL, --nMM_MERMPLAN_07 
                              NULL, --nMM_MERMPRCO_08 
                              NULL, --nMM_MERMPLAN_EXESO_08 
                              NULL, --nMM_MERMPLAN_08 
                              NULL, --nMM_MERMPRCO_09 
                              NULL, --nMM_MERMPLAN_EXESO_09 
                              NULL, --nMM_MERMPLAN_09 
                              NULL, --nMM_MERMPRCO_10 
                              NULL, --nMM_MERMPLAN_EXESO_10 
                              NULL, --nMM_MERMPLAN_10 
                              NULL, --nMM_MERMPRCO 
                              NULL, --nMM_MERMPLAN_EXESO 
                              NULL); --nMM_MERMPLAN
               ELSE
                  --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_EXESO_03 := t_MATERIAL(rMaterial_B.IDENTIFICADOR).Ancho - t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_03;
                  P_MATERIAL(rMaterial_B,'U',
                              NULL,--nCantProd
                              NULL,--nCantCons_E
                              NULL,--nCantCons
                              NULL,--nCantAjus
                              NULL,--nAncho
                              NULL,--nFACTOR_CONVERSION_M2_KG
                              NULL,--nPrecio_ML_E
                              NULL,--vLog_Precio
                              NULL,--nMermEnhe_E
                              NULL,--nMermEnhe
                              NULL,--nMermAjus_E
                              NULL,--nMermAjus
                              NULL,--nMermCabo_E
                              NULL,--nMermCabo
                              NULL,--nMermPico_E
                              NULL,--nMermPico
                              NULL,--nMermTita
                              NULL,--nMermSane
                              NULL,--nCantCons_Bobinas
                              --
                              NULL, --nCONTFSMU_01 
                              NULL, --nCANTFSMU_01 
                              NULL, --nCATOFSMU 
                              NULL, --nCONTFSMU_02 
                              NULL, --nCANTFSMU_02 
                              NULL, --nCONTFSMU_03 
                              NULL, --nCANTFSMU_03 
                              NULL, --nCONTFSMU_04 
                              NULL, --nCANTFSMU_04 
                              NULL, --nCONTFSMU_05 
                              NULL, --nCANTFSMU_05 
                              NULL, --nCONTFSMU_06 
                              NULL, --nCANTFSMU_06 
                              NULL, --nCONTFSMU_07 
                              NULL, --nCANTFSMU_07 
                              NULL, --nCONTFSMU_08 
                              NULL, --nCANTFSMU_08 
                              NULL, --nCONTFSMU_09 
                              NULL, --nCANTFSMU_09 
                              NULL, --nCONTFSMU_10 
                              NULL, --nCANTFSMU_10 
                              NULL, --nANCHO_BUENO_TOTAL_01 
                              NULL, --nANCHO_BUENO_OT_01 
                              NULL, --nANCHO_BUENO_TOTAL_02 
                              NULL, --nANCHO_BUENO_OT_02 
                              NULL, --nANCHO_BUENO_TOTAL_03 
                              NULL, --nANCHO_BUENO_OT_03 
                              NULL, --nANCHO_BUENO_TOTAL_04 
                              NULL, --nANCHO_BUENO_OT_04 
                              NULL, --nANCHO_BUENO_TOTAL_05 
                              NULL, --nANCHO_BUENO_OT_05 
                              NULL, --nANCHO_BUENO_TOTAL_06 
                              NULL, --nANCHO_BUENO_OT_06 
                              NULL, --nANCHO_BUENO_TOTAL_07 
                              NULL, --nANCHO_BUENO_OT_07 
                              NULL, --nANCHO_BUENO_TOTAL_08 
                              NULL, --nANCHO_BUENO_OT_08 
                              NULL, --nANCHO_BUENO_TOTAL_09 
                              NULL, --nANCHO_BUENO_OT_09 
                              NULL, --nANCHO_BUENO_TOTAL_10 
                              NULL, --nANCHO_BUENO_OT_10 
                              NULL, --nANCHO_BUENO_TOTAL 
                              NULL, --nANCHO_BUENO_OT 
                              NULL, --nNUMECORT 
                              NULL, --nMM_MERMPRCO_01 
                              NULL, --nMM_MERMPLAN_EXESO_01 
                              NULL, --nMM_MERMPLAN_01 
                              NULL, --nMM_MERMPRCO_02 
                              NULL, --nMM_MERMPLAN_EXESO_02 
                              NULL, --nMM_MERMPLAN_02 
                              NULL, --nMM_MERMPRCO_03 
                              rMaterial_B.Ancho - rMaterial_B.ANCHO_BUENO_TOTAL_03, --nMM_MERMPLAN_EXESO_03 
                              0, --nMM_MERMPLAN_03 
                              NULL, --nMM_MERMPRCO_04 
                              NULL, --nMM_MERMPLAN_EXESO_04 
                              NULL, --nMM_MERMPLAN_04 
                              NULL, --nMM_MERMPRCO_05 
                              NULL, --nMM_MERMPLAN_EXESO_05 
                              NULL, --nMM_MERMPLAN_05 
                              NULL, --nMM_MERMPRCO_06 
                              NULL, --nMM_MERMPLAN_EXESO_06 
                              NULL, --nMM_MERMPLAN_06 
                              NULL, --nMM_MERMPRCO_07 
                              NULL, --nMM_MERMPLAN_EXESO_07 
                              NULL, --nMM_MERMPLAN_07 
                              NULL, --nMM_MERMPRCO_08 
                              NULL, --nMM_MERMPLAN_EXESO_08 
                              NULL, --nMM_MERMPLAN_08 
                              NULL, --nMM_MERMPRCO_09 
                              NULL, --nMM_MERMPLAN_EXESO_09 
                              NULL, --nMM_MERMPLAN_09 
                              NULL, --nMM_MERMPRCO_10 
                              NULL, --nMM_MERMPLAN_EXESO_10 
                              NULL, --nMM_MERMPLAN_10 
                              NULL, --nMM_MERMPRCO 
                              NULL, --nMM_MERMPLAN_EXESO 
                              NULL); --nMM_MERMPLAN
               END IF;
               --
               --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_03 := 0;
            END IF;
         END IF;
         ------------------------------------------------------------
         --FIN BUSQUEDA DE MM DE MERMAS DE PLANIFICACION Y EXESOS 3--
         ------------------------------------------------------------
         --------------------------------------------------------
         --BUSQUEDA DE MM DE MERMAS DE PLANIFICACION Y EXESOS 4--
         --------------------------------------------------------
         --IF t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_04 IS NOT NULL AND rMATERIAL_B.Tip_Arti != vTIARREST THEN 
         IF rMaterial_B.ANCHO_BUENO_TOTAL_04 IS NOT NULL AND rMATERIAL_B.Tip_Arti != vTIARREST THEN 
            --Busqueda de Exceso de Merma de Planificación
            IF rMATERIAL_B.MM_MERMPLAN_04 IS NOT NULL THEN 
               --IF t_MATERIAL(rMaterial_B.IDENTIFICADOR).Ancho - t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_04 > rMATERIAL_B.MM_MERMPLAN_04 THEN
               IF rMaterial_B.Ancho - rMaterial_B.ANCHO_BUENO_TOTAL_04 > rMATERIAL_B.MM_MERMPLAN_04 THEN
                  IF rMaterial_B.PRE_CORTE = 'S' THEN
                     --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPRCO_04 := t_MATERIAL(rMaterial_B.IDENTIFICADOR).Ancho - t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_04 - rMATERIAL_B.MM_MERMPLAN_04;
                     --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_EXESO_04 := 0;
                     --
                     P_MATERIAL(rMaterial_B,'U',
                                 NULL,--nCantProd
                                 NULL,--nCantCons_E
                                 NULL,--nCantCons
                                 NULL,--nCantAjus
                                 NULL,--nAncho
                                 NULL,--nFACTOR_CONVERSION_M2_KG
                                 NULL,--nPrecio_ML_E
                                 NULL,--vLog_Precio
                                 NULL,--nMermEnhe_E
                                 NULL,--nMermEnhe
                                 NULL,--nMermAjus_E
                                 NULL,--nMermAjus
                                 NULL,--nMermCabo_E
                                 NULL,--nMermCabo
                                 NULL,--nMermPico_E
                                 NULL,--nMermPico
                                 NULL,--nMermTita
                                 NULL,--nMermSane
                                 NULL,--nCantCons_Bobinas
                                 --
                                 NULL, --nCONTFSMU_01 
                                 NULL, --nCANTFSMU_01 
                                 NULL, --nCATOFSMU 
                                 NULL, --nCONTFSMU_02 
                                 NULL, --nCANTFSMU_02 
                                 NULL, --nCONTFSMU_03 
                                 NULL, --nCANTFSMU_03 
                                 NULL, --nCONTFSMU_04 
                                 NULL, --nCANTFSMU_04 
                                 NULL, --nCONTFSMU_05 
                                 NULL, --nCANTFSMU_05 
                                 NULL, --nCONTFSMU_06 
                                 NULL, --nCANTFSMU_06 
                                 NULL, --nCONTFSMU_07 
                                 NULL, --nCANTFSMU_07 
                                 NULL, --nCONTFSMU_08 
                                 NULL, --nCANTFSMU_08 
                                 NULL, --nCONTFSMU_09 
                                 NULL, --nCANTFSMU_09 
                                 NULL, --nCONTFSMU_10 
                                 NULL, --nCANTFSMU_10 
                                 NULL, --nANCHO_BUENO_TOTAL_01 
                                 NULL, --nANCHO_BUENO_OT_01 
                                 NULL, --nANCHO_BUENO_TOTAL_02 
                                 NULL, --nANCHO_BUENO_OT_02 
                                 NULL, --nANCHO_BUENO_TOTAL_03 
                                 NULL, --nANCHO_BUENO_OT_03 
                                 NULL, --nANCHO_BUENO_TOTAL_04 
                                 NULL, --nANCHO_BUENO_OT_04 
                                 NULL, --nANCHO_BUENO_TOTAL_05 
                                 NULL, --nANCHO_BUENO_OT_05 
                                 NULL, --nANCHO_BUENO_TOTAL_06 
                                 NULL, --nANCHO_BUENO_OT_06 
                                 NULL, --nANCHO_BUENO_TOTAL_07 
                                 NULL, --nANCHO_BUENO_OT_07 
                                 NULL, --nANCHO_BUENO_TOTAL_08 
                                 NULL, --nANCHO_BUENO_OT_08 
                                 NULL, --nANCHO_BUENO_TOTAL_09 
                                 NULL, --nANCHO_BUENO_OT_09 
                                 NULL, --nANCHO_BUENO_TOTAL_10 
                                 NULL, --nANCHO_BUENO_OT_10 
                                 NULL, --nANCHO_BUENO_TOTAL 
                                 NULL, --nANCHO_BUENO_OT 
                                 NULL, --nNUMECORT 
                                 NULL, --nMM_MERMPRCO_01 
                                 NULL, --nMM_MERMPLAN_EXESO_01 
                                 NULL, --nMM_MERMPLAN_01 
                                 NULL, --nMM_MERMPRCO_02 
                                 NULL, --nMM_MERMPLAN_EXESO_02 
                                 NULL, --nMM_MERMPLAN_02 
                                 NULL, --nMM_MERMPRCO_03 
                                 NULL, --nMM_MERMPLAN_EXESO_03 
                                 NULL, --nMM_MERMPLAN_03 
                                 rMaterial_B.Ancho - rMaterial_B.ANCHO_BUENO_TOTAL_04 - rMATERIAL_B.MM_MERMPLAN_04, --nMM_MERMPRCO_04 
                                 0, --nMM_MERMPLAN_EXESO_04 
                                 NULL, --nMM_MERMPLAN_04 
                                 NULL, --nMM_MERMPRCO_05 
                                 NULL, --nMM_MERMPLAN_EXESO_05 
                                 NULL, --nMM_MERMPLAN_05 
                                 NULL, --nMM_MERMPRCO_06 
                                 NULL, --nMM_MERMPLAN_EXESO_06 
                                 NULL, --nMM_MERMPLAN_06 
                                 NULL, --nMM_MERMPRCO_07 
                                 NULL, --nMM_MERMPLAN_EXESO_07 
                                 NULL, --nMM_MERMPLAN_07 
                                 NULL, --nMM_MERMPRCO_08 
                                 NULL, --nMM_MERMPLAN_EXESO_08 
                                 NULL, --nMM_MERMPLAN_08 
                                 NULL, --nMM_MERMPRCO_09 
                                 NULL, --nMM_MERMPLAN_EXESO_09 
                                 NULL, --nMM_MERMPLAN_09 
                                 NULL, --nMM_MERMPRCO_10 
                                 NULL, --nMM_MERMPLAN_EXESO_10 
                                 NULL, --nMM_MERMPLAN_10 
                                 NULL, --nMM_MERMPRCO 
                                 NULL, --nMM_MERMPLAN_EXESO 
                                 NULL); --nMM_MERMPLAN
                  ELSE
                     --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_EXESO_04 := t_MATERIAL(rMaterial_B.IDENTIFICADOR).Ancho - t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_04 - rMATERIAL_B.MM_MERMPLAN_04;
                     --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPRCO_04 := 0;
                     --
                     P_MATERIAL(rMaterial_B,'U',
                                 NULL,--nCantProd
                                 NULL,--nCantCons_E
                                 NULL,--nCantCons
                                 NULL,--nCantAjus
                                 NULL,--nAncho
                                 NULL,--nFACTOR_CONVERSION_M2_KG
                                 NULL,--nPrecio_ML_E
                                 NULL,--vLog_Precio
                                 NULL,--nMermEnhe_E
                                 NULL,--nMermEnhe
                                 NULL,--nMermAjus_E
                                 NULL,--nMermAjus
                                 NULL,--nMermCabo_E
                                 NULL,--nMermCabo
                                 NULL,--nMermPico_E
                                 NULL,--nMermPico
                                 NULL,--nMermTita
                                 NULL,--nMermSane
                                 NULL,--nCantCons_Bobinas
                                 --
                                 NULL, --nCONTFSMU_01 
                                 NULL, --nCANTFSMU_01 
                                 NULL, --nCATOFSMU 
                                 NULL, --nCONTFSMU_02 
                                 NULL, --nCANTFSMU_02 
                                 NULL, --nCONTFSMU_03 
                                 NULL, --nCANTFSMU_03 
                                 NULL, --nCONTFSMU_04 
                                 NULL, --nCANTFSMU_04 
                                 NULL, --nCONTFSMU_05 
                                 NULL, --nCANTFSMU_05 
                                 NULL, --nCONTFSMU_06 
                                 NULL, --nCANTFSMU_06 
                                 NULL, --nCONTFSMU_07 
                                 NULL, --nCANTFSMU_07 
                                 NULL, --nCONTFSMU_08 
                                 NULL, --nCANTFSMU_08 
                                 NULL, --nCONTFSMU_09 
                                 NULL, --nCANTFSMU_09 
                                 NULL, --nCONTFSMU_10 
                                 NULL, --nCANTFSMU_10 
                                 NULL, --nANCHO_BUENO_TOTAL_01 
                                 NULL, --nANCHO_BUENO_OT_01 
                                 NULL, --nANCHO_BUENO_TOTAL_02 
                                 NULL, --nANCHO_BUENO_OT_02 
                                 NULL, --nANCHO_BUENO_TOTAL_03 
                                 NULL, --nANCHO_BUENO_OT_03 
                                 NULL, --nANCHO_BUENO_TOTAL_04 
                                 NULL, --nANCHO_BUENO_OT_04 
                                 NULL, --nANCHO_BUENO_TOTAL_05 
                                 NULL, --nANCHO_BUENO_OT_05 
                                 NULL, --nANCHO_BUENO_TOTAL_06 
                                 NULL, --nANCHO_BUENO_OT_06 
                                 NULL, --nANCHO_BUENO_TOTAL_07 
                                 NULL, --nANCHO_BUENO_OT_07 
                                 NULL, --nANCHO_BUENO_TOTAL_08 
                                 NULL, --nANCHO_BUENO_OT_08 
                                 NULL, --nANCHO_BUENO_TOTAL_09 
                                 NULL, --nANCHO_BUENO_OT_09 
                                 NULL, --nANCHO_BUENO_TOTAL_10 
                                 NULL, --nANCHO_BUENO_OT_10 
                                 NULL, --nANCHO_BUENO_TOTAL 
                                 NULL, --nANCHO_BUENO_OT 
                                 NULL, --nNUMECORT 
                                 NULL, --nMM_MERMPRCO_01 
                                 NULL, --nMM_MERMPLAN_EXESO_01 
                                 NULL, --nMM_MERMPLAN_01 
                                 NULL, --nMM_MERMPRCO_02 
                                 NULL, --nMM_MERMPLAN_EXESO_02 
                                 NULL, --nMM_MERMPLAN_02 
                                 NULL, --nMM_MERMPRCO_03 
                                 NULL, --nMM_MERMPLAN_EXESO_03 
                                 NULL, --nMM_MERMPLAN_03 
                                 0, --nMM_MERMPRCO_04 
                                 rMaterial_B.Ancho - rMaterial_B.ANCHO_BUENO_TOTAL_04 - rMATERIAL_B.MM_MERMPLAN_04, --nMM_MERMPLAN_EXESO_04 
                                 NULL, --nMM_MERMPLAN_04 
                                 NULL, --nMM_MERMPRCO_05 
                                 NULL, --nMM_MERMPLAN_EXESO_05 
                                 NULL, --nMM_MERMPLAN_05 
                                 NULL, --nMM_MERMPRCO_06 
                                 NULL, --nMM_MERMPLAN_EXESO_06 
                                 NULL, --nMM_MERMPLAN_06 
                                 NULL, --nMM_MERMPRCO_07 
                                 NULL, --nMM_MERMPLAN_EXESO_07 
                                 NULL, --nMM_MERMPLAN_07 
                                 NULL, --nMM_MERMPRCO_08 
                                 NULL, --nMM_MERMPLAN_EXESO_08 
                                 NULL, --nMM_MERMPLAN_08 
                                 NULL, --nMM_MERMPRCO_09 
                                 NULL, --nMM_MERMPLAN_EXESO_09 
                                 NULL, --nMM_MERMPLAN_09 
                                 NULL, --nMM_MERMPRCO_10 
                                 NULL, --nMM_MERMPLAN_EXESO_10 
                                 NULL, --nMM_MERMPLAN_10 
                                 NULL, --nMM_MERMPRCO 
                                 NULL, --nMM_MERMPLAN_EXESO 
                                 NULL); --nMM_MERMPLAN
                  END IF;
               ELSE
                  --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_EXESO_04 := 0;
                  --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPRCO_04 := 0;
                  --La Merma de Planificación fue menor a lo Estandar / Real (SE ACTUALIZA: YA NO SE BASA EN LA CONFIGURACION)
                  --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_04 := t_MATERIAL(rMaterial_B.IDENTIFICADOR).Ancho - t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_04;
                  P_MATERIAL(rMaterial_B,'U',
                              NULL,--nCantProd
                              NULL,--nCantCons_E
                              NULL,--nCantCons
                              NULL,--nCantAjus
                              NULL,--nAncho
                              NULL,--nFACTOR_CONVERSION_M2_KG
                              NULL,--nPrecio_ML_E
                              NULL,--vLog_Precio
                              NULL,--nMermEnhe_E
                              NULL,--nMermEnhe
                              NULL,--nMermAjus_E
                              NULL,--nMermAjus
                              NULL,--nMermCabo_E
                              NULL,--nMermCabo
                              NULL,--nMermPico_E
                              NULL,--nMermPico
                              NULL,--nMermTita
                              NULL,--nMermSane
                              NULL,--nCantCons_Bobinas
                              --
                              NULL, --nCONTFSMU_01 
                              NULL, --nCANTFSMU_01 
                              NULL, --nCATOFSMU 
                              NULL, --nCONTFSMU_02 
                              NULL, --nCANTFSMU_02 
                              NULL, --nCONTFSMU_03 
                              NULL, --nCANTFSMU_03 
                              NULL, --nCONTFSMU_04 
                              NULL, --nCANTFSMU_04 
                              NULL, --nCONTFSMU_05 
                              NULL, --nCANTFSMU_05 
                              NULL, --nCONTFSMU_06 
                              NULL, --nCANTFSMU_06 
                              NULL, --nCONTFSMU_07 
                              NULL, --nCANTFSMU_07 
                              NULL, --nCONTFSMU_08 
                              NULL, --nCANTFSMU_08 
                              NULL, --nCONTFSMU_09 
                              NULL, --nCANTFSMU_09 
                              NULL, --nCONTFSMU_10 
                              NULL, --nCANTFSMU_10 
                              NULL, --nANCHO_BUENO_TOTAL_01 
                              NULL, --nANCHO_BUENO_OT_01 
                              NULL, --nANCHO_BUENO_TOTAL_02 
                              NULL, --nANCHO_BUENO_OT_02 
                              NULL, --nANCHO_BUENO_TOTAL_03 
                              NULL, --nANCHO_BUENO_OT_03 
                              NULL, --nANCHO_BUENO_TOTAL_04 
                              NULL, --nANCHO_BUENO_OT_04 
                              NULL, --nANCHO_BUENO_TOTAL_05 
                              NULL, --nANCHO_BUENO_OT_05 
                              NULL, --nANCHO_BUENO_TOTAL_06 
                              NULL, --nANCHO_BUENO_OT_06 
                              NULL, --nANCHO_BUENO_TOTAL_07 
                              NULL, --nANCHO_BUENO_OT_07 
                              NULL, --nANCHO_BUENO_TOTAL_08 
                              NULL, --nANCHO_BUENO_OT_08 
                              NULL, --nANCHO_BUENO_TOTAL_09 
                              NULL, --nANCHO_BUENO_OT_09 
                              NULL, --nANCHO_BUENO_TOTAL_10 
                              NULL, --nANCHO_BUENO_OT_10 
                              NULL, --nANCHO_BUENO_TOTAL 
                              NULL, --nANCHO_BUENO_OT 
                              NULL, --nNUMECORT 
                              NULL, --nMM_MERMPRCO_01 
                              NULL, --nMM_MERMPLAN_EXESO_01 
                              NULL, --nMM_MERMPLAN_01 
                              NULL, --nMM_MERMPRCO_02 
                              NULL, --nMM_MERMPLAN_EXESO_02 
                              NULL, --nMM_MERMPLAN_02 
                              NULL, --nMM_MERMPRCO_03 
                              NULL, --nMM_MERMPLAN_EXESO_03 
                              NULL, --nMM_MERMPLAN_03 
                              0, --nMM_MERMPRCO_04 
                              0, --nMM_MERMPLAN_EXESO_04 
                              rMaterial_B.Ancho - rMaterial_B.ANCHO_BUENO_TOTAL_04, --nMM_MERMPLAN_04 
                              NULL, --nMM_MERMPRCO_05 
                              NULL, --nMM_MERMPLAN_EXESO_05 
                              NULL, --nMM_MERMPLAN_05 
                              NULL, --nMM_MERMPRCO_06 
                              NULL, --nMM_MERMPLAN_EXESO_06 
                              NULL, --nMM_MERMPLAN_06 
                              NULL, --nMM_MERMPRCO_07 
                              NULL, --nMM_MERMPLAN_EXESO_07 
                              NULL, --nMM_MERMPLAN_07 
                              NULL, --nMM_MERMPRCO_08 
                              NULL, --nMM_MERMPLAN_EXESO_08 
                              NULL, --nMM_MERMPLAN_08 
                              NULL, --nMM_MERMPRCO_09 
                              NULL, --nMM_MERMPLAN_EXESO_09 
                              NULL, --nMM_MERMPLAN_09 
                              NULL, --nMM_MERMPRCO_10 
                              NULL, --nMM_MERMPLAN_EXESO_10 
                              NULL, --nMM_MERMPLAN_10 
                              NULL, --nMM_MERMPRCO 
                              NULL, --nMM_MERMPLAN_EXESO 
                              NULL); --nMM_MERMPLAN
               END IF;
            ELSE--Si no existe la Merma Planificada Estandar / Real
               --Se asigna la merma encontrada a Excesos o Pre_Corte ya que no fue Planificada como Estandar
               IF rMaterial_B.PRE_CORTE = 'S' THEN
                  --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPRCO_04 := t_MATERIAL(rMaterial_B.IDENTIFICADOR).Ancho - t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_04;
                  P_MATERIAL(rMaterial_B,'U',
                              NULL,--nCantProd
                              NULL,--nCantCons_E
                              NULL,--nCantCons
                              NULL,--nCantAjus
                              NULL,--nAncho
                              NULL,--nFACTOR_CONVERSION_M2_KG
                              NULL,--nPrecio_ML_E
                              NULL,--vLog_Precio
                              NULL,--nMermEnhe_E
                              NULL,--nMermEnhe
                              NULL,--nMermAjus_E
                              NULL,--nMermAjus
                              NULL,--nMermCabo_E
                              NULL,--nMermCabo
                              NULL,--nMermPico_E
                              NULL,--nMermPico
                              NULL,--nMermTita
                              NULL,--nMermSane
                              NULL,--nCantCons_Bobinas
                              --
                              NULL, --nCONTFSMU_01 
                              NULL, --nCANTFSMU_01 
                              NULL, --nCATOFSMU 
                              NULL, --nCONTFSMU_02 
                              NULL, --nCANTFSMU_02 
                              NULL, --nCONTFSMU_03 
                              NULL, --nCANTFSMU_03 
                              NULL, --nCONTFSMU_04 
                              NULL, --nCANTFSMU_04 
                              NULL, --nCONTFSMU_05 
                              NULL, --nCANTFSMU_05 
                              NULL, --nCONTFSMU_06 
                              NULL, --nCANTFSMU_06 
                              NULL, --nCONTFSMU_07 
                              NULL, --nCANTFSMU_07 
                              NULL, --nCONTFSMU_08 
                              NULL, --nCANTFSMU_08 
                              NULL, --nCONTFSMU_09 
                              NULL, --nCANTFSMU_09 
                              NULL, --nCONTFSMU_10 
                              NULL, --nCANTFSMU_10 
                              NULL, --nANCHO_BUENO_TOTAL_01 
                              NULL, --nANCHO_BUENO_OT_01 
                              NULL, --nANCHO_BUENO_TOTAL_02 
                              NULL, --nANCHO_BUENO_OT_02 
                              NULL, --nANCHO_BUENO_TOTAL_03 
                              NULL, --nANCHO_BUENO_OT_03 
                              NULL, --nANCHO_BUENO_TOTAL_04 
                              NULL, --nANCHO_BUENO_OT_04 
                              NULL, --nANCHO_BUENO_TOTAL_05 
                              NULL, --nANCHO_BUENO_OT_05 
                              NULL, --nANCHO_BUENO_TOTAL_06 
                              NULL, --nANCHO_BUENO_OT_06 
                              NULL, --nANCHO_BUENO_TOTAL_07 
                              NULL, --nANCHO_BUENO_OT_07 
                              NULL, --nANCHO_BUENO_TOTAL_08 
                              NULL, --nANCHO_BUENO_OT_08 
                              NULL, --nANCHO_BUENO_TOTAL_09 
                              NULL, --nANCHO_BUENO_OT_09 
                              NULL, --nANCHO_BUENO_TOTAL_10 
                              NULL, --nANCHO_BUENO_OT_10 
                              NULL, --nANCHO_BUENO_TOTAL 
                              NULL, --nANCHO_BUENO_OT 
                              NULL, --nNUMECORT 
                              NULL, --nMM_MERMPRCO_01 
                              NULL, --nMM_MERMPLAN_EXESO_01 
                              NULL, --nMM_MERMPLAN_01 
                              NULL, --nMM_MERMPRCO_02 
                              NULL, --nMM_MERMPLAN_EXESO_02 
                              NULL, --nMM_MERMPLAN_02 
                              NULL, --nMM_MERMPRCO_03 
                              NULL, --nMM_MERMPLAN_EXESO_03 
                              NULL, --nMM_MERMPLAN_03 
                              rMaterial_B.Ancho - rMaterial_B.ANCHO_BUENO_TOTAL_04, --nMM_MERMPRCO_04 
                              NULL, --nMM_MERMPLAN_EXESO_04 
                              0, --nMM_MERMPLAN_04 
                              NULL, --nMM_MERMPRCO_05 
                              NULL, --nMM_MERMPLAN_EXESO_05 
                              NULL, --nMM_MERMPLAN_05 
                              NULL, --nMM_MERMPRCO_06 
                              NULL, --nMM_MERMPLAN_EXESO_06 
                              NULL, --nMM_MERMPLAN_06 
                              NULL, --nMM_MERMPRCO_07 
                              NULL, --nMM_MERMPLAN_EXESO_07 
                              NULL, --nMM_MERMPLAN_07 
                              NULL, --nMM_MERMPRCO_08 
                              NULL, --nMM_MERMPLAN_EXESO_08 
                              NULL, --nMM_MERMPLAN_08 
                              NULL, --nMM_MERMPRCO_09 
                              NULL, --nMM_MERMPLAN_EXESO_09 
                              NULL, --nMM_MERMPLAN_09 
                              NULL, --nMM_MERMPRCO_10 
                              NULL, --nMM_MERMPLAN_EXESO_10 
                              NULL, --nMM_MERMPLAN_10 
                              NULL, --nMM_MERMPRCO 
                              NULL, --nMM_MERMPLAN_EXESO 
                              NULL); --nMM_MERMPLAN
               ELSE
                  --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_EXESO_04 := t_MATERIAL(rMaterial_B.IDENTIFICADOR).Ancho - t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_04;
                  P_MATERIAL(rMaterial_B,'U',
                              NULL,--nCantProd
                              NULL,--nCantCons_E
                              NULL,--nCantCons
                              NULL,--nCantAjus
                              NULL,--nAncho
                              NULL,--nFACTOR_CONVERSION_M2_KG
                              NULL,--nPrecio_ML_E
                              NULL,--vLog_Precio
                              NULL,--nMermEnhe_E
                              NULL,--nMermEnhe
                              NULL,--nMermAjus_E
                              NULL,--nMermAjus
                              NULL,--nMermCabo_E
                              NULL,--nMermCabo
                              NULL,--nMermPico_E
                              NULL,--nMermPico
                              NULL,--nMermTita
                              NULL,--nMermSane
                              NULL,--nCantCons_Bobinas
                              --
                              NULL, --nCONTFSMU_01 
                              NULL, --nCANTFSMU_01 
                              NULL, --nCATOFSMU 
                              NULL, --nCONTFSMU_02 
                              NULL, --nCANTFSMU_02 
                              NULL, --nCONTFSMU_03 
                              NULL, --nCANTFSMU_03 
                              NULL, --nCONTFSMU_04 
                              NULL, --nCANTFSMU_04 
                              NULL, --nCONTFSMU_05 
                              NULL, --nCANTFSMU_05 
                              NULL, --nCONTFSMU_06 
                              NULL, --nCANTFSMU_06 
                              NULL, --nCONTFSMU_07 
                              NULL, --nCANTFSMU_07 
                              NULL, --nCONTFSMU_08 
                              NULL, --nCANTFSMU_08 
                              NULL, --nCONTFSMU_09 
                              NULL, --nCANTFSMU_09 
                              NULL, --nCONTFSMU_10 
                              NULL, --nCANTFSMU_10 
                              NULL, --nANCHO_BUENO_TOTAL_01 
                              NULL, --nANCHO_BUENO_OT_01 
                              NULL, --nANCHO_BUENO_TOTAL_02 
                              NULL, --nANCHO_BUENO_OT_02 
                              NULL, --nANCHO_BUENO_TOTAL_03 
                              NULL, --nANCHO_BUENO_OT_03 
                              NULL, --nANCHO_BUENO_TOTAL_04 
                              NULL, --nANCHO_BUENO_OT_04 
                              NULL, --nANCHO_BUENO_TOTAL_05 
                              NULL, --nANCHO_BUENO_OT_05 
                              NULL, --nANCHO_BUENO_TOTAL_06 
                              NULL, --nANCHO_BUENO_OT_06 
                              NULL, --nANCHO_BUENO_TOTAL_07 
                              NULL, --nANCHO_BUENO_OT_07 
                              NULL, --nANCHO_BUENO_TOTAL_08 
                              NULL, --nANCHO_BUENO_OT_08 
                              NULL, --nANCHO_BUENO_TOTAL_09 
                              NULL, --nANCHO_BUENO_OT_09 
                              NULL, --nANCHO_BUENO_TOTAL_10 
                              NULL, --nANCHO_BUENO_OT_10 
                              NULL, --nANCHO_BUENO_TOTAL 
                              NULL, --nANCHO_BUENO_OT 
                              NULL, --nNUMECORT 
                              NULL, --nMM_MERMPRCO_01 
                              NULL, --nMM_MERMPLAN_EXESO_01 
                              NULL, --nMM_MERMPLAN_01 
                              NULL, --nMM_MERMPRCO_02 
                              NULL, --nMM_MERMPLAN_EXESO_02 
                              NULL, --nMM_MERMPLAN_02 
                              NULL, --nMM_MERMPRCO_03 
                              NULL, --nMM_MERMPLAN_EXESO_03 
                              NULL, --nMM_MERMPLAN_03 
                              NULL, --nMM_MERMPRCO_04 
                              rMaterial_B.Ancho - rMaterial_B.ANCHO_BUENO_TOTAL_04, --nMM_MERMPLAN_EXESO_04 
                              0, --nMM_MERMPLAN_04 
                              NULL, --nMM_MERMPRCO_05 
                              NULL, --nMM_MERMPLAN_EXESO_05 
                              NULL, --nMM_MERMPLAN_05 
                              NULL, --nMM_MERMPRCO_06 
                              NULL, --nMM_MERMPLAN_EXESO_06 
                              NULL, --nMM_MERMPLAN_06 
                              NULL, --nMM_MERMPRCO_07 
                              NULL, --nMM_MERMPLAN_EXESO_07 
                              NULL, --nMM_MERMPLAN_07 
                              NULL, --nMM_MERMPRCO_08 
                              NULL, --nMM_MERMPLAN_EXESO_08 
                              NULL, --nMM_MERMPLAN_08 
                              NULL, --nMM_MERMPRCO_09 
                              NULL, --nMM_MERMPLAN_EXESO_09 
                              NULL, --nMM_MERMPLAN_09 
                              NULL, --nMM_MERMPRCO_10 
                              NULL, --nMM_MERMPLAN_EXESO_10 
                              NULL, --nMM_MERMPLAN_10 
                              NULL, --nMM_MERMPRCO 
                              NULL, --nMM_MERMPLAN_EXESO 
                              NULL); --nMM_MERMPLAN
               END IF;
               --
               --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_04 := 0;
            END IF;
         END IF;
         ------------------------------------------------------------
         --FIN BUSQUEDA DE MM DE MERMAS DE PLANIFICACION Y EXESOS 4--
         ------------------------------------------------------------
         --------------------------------------------------------
         --BUSQUEDA DE MM DE MERMAS DE PLANIFICACION Y EXESOS 5--
         --------------------------------------------------------
         --IF t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_05 IS NOT NULL AND rMATERIAL_B.Tip_Arti != vTIARREST THEN 
         IF rMaterial_B.ANCHO_BUENO_TOTAL_05 IS NOT NULL AND rMATERIAL_B.Tip_Arti != vTIARREST THEN 
            --Busqueda de Exceso de Merma de Planificación
            IF rMATERIAL_B.MM_MERMPLAN_05 IS NOT NULL THEN 
               --IF t_MATERIAL(rMaterial_B.IDENTIFICADOR).Ancho - t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_05 > rMATERIAL_B.MM_MERMPLAN_05 THEN
               IF rMaterial_B.Ancho - rMaterial_B.ANCHO_BUENO_TOTAL_05 > rMATERIAL_B.MM_MERMPLAN_05 THEN
                  IF rMaterial_B.PRE_CORTE = 'S' THEN
                     --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPRCO_05 := t_MATERIAL(rMaterial_B.IDENTIFICADOR).Ancho - t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_05 - rMATERIAL_B.MM_MERMPLAN_05;
                     --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_EXESO_05 := 0;
                     --
                     P_MATERIAL(rMaterial_B,'U',
                                 NULL,--nCantProd
                                 NULL,--nCantCons_E
                                 NULL,--nCantCons
                                 NULL,--nCantAjus
                                 NULL,--nAncho
                                 NULL,--nFACTOR_CONVERSION_M2_KG
                                 NULL,--nPrecio_ML_E
                                 NULL,--vLog_Precio
                                 NULL,--nMermEnhe_E
                                 NULL,--nMermEnhe
                                 NULL,--nMermAjus_E
                                 NULL,--nMermAjus
                                 NULL,--nMermCabo_E
                                 NULL,--nMermCabo
                                 NULL,--nMermPico_E
                                 NULL,--nMermPico
                                 NULL,--nMermTita
                                 NULL,--nMermSane
                                 NULL,--nCantCons_Bobinas
                                 --
                                 NULL, --nCONTFSMU_01 
                                 NULL, --nCANTFSMU_01 
                                 NULL, --nCATOFSMU 
                                 NULL, --nCONTFSMU_02 
                                 NULL, --nCANTFSMU_02 
                                 NULL, --nCONTFSMU_03 
                                 NULL, --nCANTFSMU_03 
                                 NULL, --nCONTFSMU_04 
                                 NULL, --nCANTFSMU_04 
                                 NULL, --nCONTFSMU_05 
                                 NULL, --nCANTFSMU_05 
                                 NULL, --nCONTFSMU_06 
                                 NULL, --nCANTFSMU_06 
                                 NULL, --nCONTFSMU_07 
                                 NULL, --nCANTFSMU_07 
                                 NULL, --nCONTFSMU_08 
                                 NULL, --nCANTFSMU_08 
                                 NULL, --nCONTFSMU_09 
                                 NULL, --nCANTFSMU_09 
                                 NULL, --nCONTFSMU_10 
                                 NULL, --nCANTFSMU_10 
                                 NULL, --nANCHO_BUENO_TOTAL_01 
                                 NULL, --nANCHO_BUENO_OT_01 
                                 NULL, --nANCHO_BUENO_TOTAL_02 
                                 NULL, --nANCHO_BUENO_OT_02 
                                 NULL, --nANCHO_BUENO_TOTAL_03 
                                 NULL, --nANCHO_BUENO_OT_03 
                                 NULL, --nANCHO_BUENO_TOTAL_04 
                                 NULL, --nANCHO_BUENO_OT_04 
                                 NULL, --nANCHO_BUENO_TOTAL_05 
                                 NULL, --nANCHO_BUENO_OT_05 
                                 NULL, --nANCHO_BUENO_TOTAL_06 
                                 NULL, --nANCHO_BUENO_OT_06 
                                 NULL, --nANCHO_BUENO_TOTAL_07 
                                 NULL, --nANCHO_BUENO_OT_07 
                                 NULL, --nANCHO_BUENO_TOTAL_08 
                                 NULL, --nANCHO_BUENO_OT_08 
                                 NULL, --nANCHO_BUENO_TOTAL_09 
                                 NULL, --nANCHO_BUENO_OT_09 
                                 NULL, --nANCHO_BUENO_TOTAL_10 
                                 NULL, --nANCHO_BUENO_OT_10 
                                 NULL, --nANCHO_BUENO_TOTAL 
                                 NULL, --nANCHO_BUENO_OT 
                                 NULL, --nNUMECORT 
                                 NULL, --nMM_MERMPRCO_01 
                                 NULL, --nMM_MERMPLAN_EXESO_01 
                                 NULL, --nMM_MERMPLAN_01 
                                 NULL, --nMM_MERMPRCO_02 
                                 NULL, --nMM_MERMPLAN_EXESO_02 
                                 NULL, --nMM_MERMPLAN_02 
                                 NULL, --nMM_MERMPRCO_03 
                                 NULL, --nMM_MERMPLAN_EXESO_03 
                                 NULL, --nMM_MERMPLAN_03 
                                 NULL, --nMM_MERMPRCO_04 
                                 NULL, --nMM_MERMPLAN_EXESO_04 
                                 NULL, --nMM_MERMPLAN_04 
                                 rMaterial_B.Ancho - rMaterial_B.ANCHO_BUENO_TOTAL_05 - rMATERIAL_B.MM_MERMPLAN_05, --nMM_MERMPRCO_05 
                                 0, --nMM_MERMPLAN_EXESO_05 
                                 NULL, --nMM_MERMPLAN_05 
                                 NULL, --nMM_MERMPRCO_06 
                                 NULL, --nMM_MERMPLAN_EXESO_06 
                                 NULL, --nMM_MERMPLAN_06 
                                 NULL, --nMM_MERMPRCO_07 
                                 NULL, --nMM_MERMPLAN_EXESO_07 
                                 NULL, --nMM_MERMPLAN_07 
                                 NULL, --nMM_MERMPRCO_08 
                                 NULL, --nMM_MERMPLAN_EXESO_08 
                                 NULL, --nMM_MERMPLAN_08 
                                 NULL, --nMM_MERMPRCO_09 
                                 NULL, --nMM_MERMPLAN_EXESO_09 
                                 NULL, --nMM_MERMPLAN_09 
                                 NULL, --nMM_MERMPRCO_10 
                                 NULL, --nMM_MERMPLAN_EXESO_10 
                                 NULL, --nMM_MERMPLAN_10 
                                 NULL, --nMM_MERMPRCO 
                                 NULL, --nMM_MERMPLAN_EXESO 
                                 NULL); --nMM_MERMPLAN
                  ELSE
                     --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_EXESO_05 := t_MATERIAL(rMaterial_B.IDENTIFICADOR).Ancho - t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_05 - rMATERIAL_B.MM_MERMPLAN_05;
                     --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPRCO_05 := 0;
                     --
                     P_MATERIAL(rMaterial_B,'U',
                                 NULL,--nCantProd
                                 NULL,--nCantCons_E
                                 NULL,--nCantCons
                                 NULL,--nCantAjus
                                 NULL,--nAncho
                                 NULL,--nFACTOR_CONVERSION_M2_KG
                                 NULL,--nPrecio_ML_E
                                 NULL,--vLog_Precio
                                 NULL,--nMermEnhe_E
                                 NULL,--nMermEnhe
                                 NULL,--nMermAjus_E
                                 NULL,--nMermAjus
                                 NULL,--nMermCabo_E
                                 NULL,--nMermCabo
                                 NULL,--nMermPico_E
                                 NULL,--nMermPico
                                 NULL,--nMermTita
                                 NULL,--nMermSane
                                 NULL,--nCantCons_Bobinas
                                 --
                                 NULL, --nCONTFSMU_01 
                                 NULL, --nCANTFSMU_01 
                                 NULL, --nCATOFSMU 
                                 NULL, --nCONTFSMU_02 
                                 NULL, --nCANTFSMU_02 
                                 NULL, --nCONTFSMU_03 
                                 NULL, --nCANTFSMU_03 
                                 NULL, --nCONTFSMU_04 
                                 NULL, --nCANTFSMU_04 
                                 NULL, --nCONTFSMU_05 
                                 NULL, --nCANTFSMU_05 
                                 NULL, --nCONTFSMU_06 
                                 NULL, --nCANTFSMU_06 
                                 NULL, --nCONTFSMU_07 
                                 NULL, --nCANTFSMU_07 
                                 NULL, --nCONTFSMU_08 
                                 NULL, --nCANTFSMU_08 
                                 NULL, --nCONTFSMU_09 
                                 NULL, --nCANTFSMU_09 
                                 NULL, --nCONTFSMU_10 
                                 NULL, --nCANTFSMU_10 
                                 NULL, --nANCHO_BUENO_TOTAL_01 
                                 NULL, --nANCHO_BUENO_OT_01 
                                 NULL, --nANCHO_BUENO_TOTAL_02 
                                 NULL, --nANCHO_BUENO_OT_02 
                                 NULL, --nANCHO_BUENO_TOTAL_03 
                                 NULL, --nANCHO_BUENO_OT_03 
                                 NULL, --nANCHO_BUENO_TOTAL_04 
                                 NULL, --nANCHO_BUENO_OT_04 
                                 NULL, --nANCHO_BUENO_TOTAL_05 
                                 NULL, --nANCHO_BUENO_OT_05 
                                 NULL, --nANCHO_BUENO_TOTAL_06 
                                 NULL, --nANCHO_BUENO_OT_06 
                                 NULL, --nANCHO_BUENO_TOTAL_07 
                                 NULL, --nANCHO_BUENO_OT_07 
                                 NULL, --nANCHO_BUENO_TOTAL_08 
                                 NULL, --nANCHO_BUENO_OT_08 
                                 NULL, --nANCHO_BUENO_TOTAL_09 
                                 NULL, --nANCHO_BUENO_OT_09 
                                 NULL, --nANCHO_BUENO_TOTAL_10 
                                 NULL, --nANCHO_BUENO_OT_10 
                                 NULL, --nANCHO_BUENO_TOTAL 
                                 NULL, --nANCHO_BUENO_OT 
                                 NULL, --nNUMECORT 
                                 NULL, --nMM_MERMPRCO_01 
                                 NULL, --nMM_MERMPLAN_EXESO_01 
                                 NULL, --nMM_MERMPLAN_01 
                                 NULL, --nMM_MERMPRCO_02 
                                 NULL, --nMM_MERMPLAN_EXESO_02 
                                 NULL, --nMM_MERMPLAN_02 
                                 NULL, --nMM_MERMPRCO_03 
                                 NULL, --nMM_MERMPLAN_EXESO_03 
                                 NULL, --nMM_MERMPLAN_03 
                                 NULL, --nMM_MERMPRCO_04 
                                 NULL, --nMM_MERMPLAN_EXESO_04 
                                 NULL, --nMM_MERMPLAN_04 
                                 0, --nMM_MERMPRCO_05 
                                 rMaterial_B.Ancho - rMaterial_B.ANCHO_BUENO_TOTAL_05 - rMATERIAL_B.MM_MERMPLAN_05, --nMM_MERMPLAN_EXESO_05 
                                 NULL, --nMM_MERMPLAN_05 
                                 NULL, --nMM_MERMPRCO_06 
                                 NULL, --nMM_MERMPLAN_EXESO_06 
                                 NULL, --nMM_MERMPLAN_06 
                                 NULL, --nMM_MERMPRCO_07 
                                 NULL, --nMM_MERMPLAN_EXESO_07 
                                 NULL, --nMM_MERMPLAN_07 
                                 NULL, --nMM_MERMPRCO_08 
                                 NULL, --nMM_MERMPLAN_EXESO_08 
                                 NULL, --nMM_MERMPLAN_08 
                                 NULL, --nMM_MERMPRCO_09 
                                 NULL, --nMM_MERMPLAN_EXESO_09 
                                 NULL, --nMM_MERMPLAN_09 
                                 NULL, --nMM_MERMPRCO_10 
                                 NULL, --nMM_MERMPLAN_EXESO_10 
                                 NULL, --nMM_MERMPLAN_10 
                                 NULL, --nMM_MERMPRCO 
                                 NULL, --nMM_MERMPLAN_EXESO 
                                 NULL); --nMM_MERMPLAN
                  END IF;
               ELSE
                  --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_EXESO_05 := 0;
                  --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPRCO_05 := 0;
                  --La Merma de Planificación fue menor a lo Estandar / Real (SE ACTUALIZA: YA NO SE BASA EN LA CONFIGURACION)
                  --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_05 := t_MATERIAL(rMaterial_B.IDENTIFICADOR).Ancho - t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_05;
                  P_MATERIAL(rMaterial_B,'U',
                              NULL,--nCantProd
                              NULL,--nCantCons_E
                              NULL,--nCantCons
                              NULL,--nCantAjus
                              NULL,--nAncho
                              NULL,--nFACTOR_CONVERSION_M2_KG
                              NULL,--nPrecio_ML_E
                              NULL,--vLog_Precio
                              NULL,--nMermEnhe_E
                              NULL,--nMermEnhe
                              NULL,--nMermAjus_E
                              NULL,--nMermAjus
                              NULL,--nMermCabo_E
                              NULL,--nMermCabo
                              NULL,--nMermPico_E
                              NULL,--nMermPico
                              NULL,--nMermTita
                              NULL,--nMermSane
                              NULL,--nCantCons_Bobinas
                              --
                              NULL, --nCONTFSMU_01 
                              NULL, --nCANTFSMU_01 
                              NULL, --nCATOFSMU 
                              NULL, --nCONTFSMU_02 
                              NULL, --nCANTFSMU_02 
                              NULL, --nCONTFSMU_03 
                              NULL, --nCANTFSMU_03 
                              NULL, --nCONTFSMU_04 
                              NULL, --nCANTFSMU_04 
                              NULL, --nCONTFSMU_05 
                              NULL, --nCANTFSMU_05 
                              NULL, --nCONTFSMU_06 
                              NULL, --nCANTFSMU_06 
                              NULL, --nCONTFSMU_07 
                              NULL, --nCANTFSMU_07 
                              NULL, --nCONTFSMU_08 
                              NULL, --nCANTFSMU_08 
                              NULL, --nCONTFSMU_09 
                              NULL, --nCANTFSMU_09 
                              NULL, --nCONTFSMU_10 
                              NULL, --nCANTFSMU_10 
                              NULL, --nANCHO_BUENO_TOTAL_01 
                              NULL, --nANCHO_BUENO_OT_01 
                              NULL, --nANCHO_BUENO_TOTAL_02 
                              NULL, --nANCHO_BUENO_OT_02 
                              NULL, --nANCHO_BUENO_TOTAL_03 
                              NULL, --nANCHO_BUENO_OT_03 
                              NULL, --nANCHO_BUENO_TOTAL_04 
                              NULL, --nANCHO_BUENO_OT_04 
                              NULL, --nANCHO_BUENO_TOTAL_05 
                              NULL, --nANCHO_BUENO_OT_05 
                              NULL, --nANCHO_BUENO_TOTAL_06 
                              NULL, --nANCHO_BUENO_OT_06 
                              NULL, --nANCHO_BUENO_TOTAL_07 
                              NULL, --nANCHO_BUENO_OT_07 
                              NULL, --nANCHO_BUENO_TOTAL_08 
                              NULL, --nANCHO_BUENO_OT_08 
                              NULL, --nANCHO_BUENO_TOTAL_09 
                              NULL, --nANCHO_BUENO_OT_09 
                              NULL, --nANCHO_BUENO_TOTAL_10 
                              NULL, --nANCHO_BUENO_OT_10 
                              NULL, --nANCHO_BUENO_TOTAL 
                              NULL, --nANCHO_BUENO_OT 
                              NULL, --nNUMECORT 
                              NULL, --nMM_MERMPRCO_01 
                              NULL, --nMM_MERMPLAN_EXESO_01 
                              NULL, --nMM_MERMPLAN_01 
                              NULL, --nMM_MERMPRCO_02 
                              NULL, --nMM_MERMPLAN_EXESO_02 
                              NULL, --nMM_MERMPLAN_02 
                              NULL, --nMM_MERMPRCO_03 
                              NULL, --nMM_MERMPLAN_EXESO_03 
                              NULL, --nMM_MERMPLAN_03 
                              NULL, --nMM_MERMPRCO_04 
                              NULL, --nMM_MERMPLAN_EXESO_04 
                              NULL, --nMM_MERMPLAN_04 
                              0, --nMM_MERMPRCO_05 
                              0, --nMM_MERMPLAN_EXESO_05 
                              rMaterial_B.Ancho - rMaterial_B.ANCHO_BUENO_TOTAL_05, --nMM_MERMPLAN_05 
                              NULL, --nMM_MERMPRCO_06 
                              NULL, --nMM_MERMPLAN_EXESO_06 
                              NULL, --nMM_MERMPLAN_06 
                              NULL, --nMM_MERMPRCO_07 
                              NULL, --nMM_MERMPLAN_EXESO_07 
                              NULL, --nMM_MERMPLAN_07 
                              NULL, --nMM_MERMPRCO_08 
                              NULL, --nMM_MERMPLAN_EXESO_08 
                              NULL, --nMM_MERMPLAN_08 
                              NULL, --nMM_MERMPRCO_09 
                              NULL, --nMM_MERMPLAN_EXESO_09 
                              NULL, --nMM_MERMPLAN_09 
                              NULL, --nMM_MERMPRCO_10 
                              NULL, --nMM_MERMPLAN_EXESO_10 
                              NULL, --nMM_MERMPLAN_10 
                              NULL, --nMM_MERMPRCO 
                              NULL, --nMM_MERMPLAN_EXESO 
                              NULL); --nMM_MERMPLAN
               END IF;
            ELSE--Si no existe la Merma Planificada Estandar / Real
               --Se asigna la merma encontrada a Excesos o Pre_Corte ya que no fue Planificada como Estandar
               IF rMaterial_B.PRE_CORTE = 'S' THEN
                  --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPRCO_05 := t_MATERIAL(rMaterial_B.IDENTIFICADOR).Ancho - t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_05;
                  P_MATERIAL(rMaterial_B,'U',
                              NULL,--nCantProd
                              NULL,--nCantCons_E
                              NULL,--nCantCons
                              NULL,--nCantAjus
                              NULL,--nAncho
                              NULL,--nFACTOR_CONVERSION_M2_KG
                              NULL,--nPrecio_ML_E
                              NULL,--vLog_Precio
                              NULL,--nMermEnhe_E
                              NULL,--nMermEnhe
                              NULL,--nMermAjus_E
                              NULL,--nMermAjus
                              NULL,--nMermCabo_E
                              NULL,--nMermCabo
                              NULL,--nMermPico_E
                              NULL,--nMermPico
                              NULL,--nMermTita
                              NULL,--nMermSane
                              NULL,--nCantCons_Bobinas
                              --
                              NULL, --nCONTFSMU_01 
                              NULL, --nCANTFSMU_01 
                              NULL, --nCATOFSMU 
                              NULL, --nCONTFSMU_02 
                              NULL, --nCANTFSMU_02 
                              NULL, --nCONTFSMU_03 
                              NULL, --nCANTFSMU_03 
                              NULL, --nCONTFSMU_04 
                              NULL, --nCANTFSMU_04 
                              NULL, --nCONTFSMU_05 
                              NULL, --nCANTFSMU_05 
                              NULL, --nCONTFSMU_06 
                              NULL, --nCANTFSMU_06 
                              NULL, --nCONTFSMU_07 
                              NULL, --nCANTFSMU_07 
                              NULL, --nCONTFSMU_08 
                              NULL, --nCANTFSMU_08 
                              NULL, --nCONTFSMU_09 
                              NULL, --nCANTFSMU_09 
                              NULL, --nCONTFSMU_10 
                              NULL, --nCANTFSMU_10 
                              NULL, --nANCHO_BUENO_TOTAL_01 
                              NULL, --nANCHO_BUENO_OT_01 
                              NULL, --nANCHO_BUENO_TOTAL_02 
                              NULL, --nANCHO_BUENO_OT_02 
                              NULL, --nANCHO_BUENO_TOTAL_03 
                              NULL, --nANCHO_BUENO_OT_03 
                              NULL, --nANCHO_BUENO_TOTAL_04 
                              NULL, --nANCHO_BUENO_OT_04 
                              NULL, --nANCHO_BUENO_TOTAL_05 
                              NULL, --nANCHO_BUENO_OT_05 
                              NULL, --nANCHO_BUENO_TOTAL_06 
                              NULL, --nANCHO_BUENO_OT_06 
                              NULL, --nANCHO_BUENO_TOTAL_07 
                              NULL, --nANCHO_BUENO_OT_07 
                              NULL, --nANCHO_BUENO_TOTAL_08 
                              NULL, --nANCHO_BUENO_OT_08 
                              NULL, --nANCHO_BUENO_TOTAL_09 
                              NULL, --nANCHO_BUENO_OT_09 
                              NULL, --nANCHO_BUENO_TOTAL_10 
                              NULL, --nANCHO_BUENO_OT_10 
                              NULL, --nANCHO_BUENO_TOTAL 
                              NULL, --nANCHO_BUENO_OT 
                              NULL, --nNUMECORT 
                              NULL, --nMM_MERMPRCO_01 
                              NULL, --nMM_MERMPLAN_EXESO_01 
                              NULL, --nMM_MERMPLAN_01 
                              NULL, --nMM_MERMPRCO_02 
                              NULL, --nMM_MERMPLAN_EXESO_02 
                              NULL, --nMM_MERMPLAN_02 
                              NULL, --nMM_MERMPRCO_03 
                              NULL, --nMM_MERMPLAN_EXESO_03 
                              NULL, --nMM_MERMPLAN_03 
                              NULL, --nMM_MERMPRCO_04 
                              NULL, --nMM_MERMPLAN_EXESO_04 
                              NULL, --nMM_MERMPLAN_04 
                              rMaterial_B.Ancho - rMaterial_B.ANCHO_BUENO_TOTAL_05, --nMM_MERMPRCO_05 
                              NULL, --nMM_MERMPLAN_EXESO_05 
                              0, --nMM_MERMPLAN_05 
                              NULL, --nMM_MERMPRCO_06 
                              NULL, --nMM_MERMPLAN_EXESO_06 
                              NULL, --nMM_MERMPLAN_06 
                              NULL, --nMM_MERMPRCO_07 
                              NULL, --nMM_MERMPLAN_EXESO_07 
                              NULL, --nMM_MERMPLAN_07 
                              NULL, --nMM_MERMPRCO_08 
                              NULL, --nMM_MERMPLAN_EXESO_08 
                              NULL, --nMM_MERMPLAN_08 
                              NULL, --nMM_MERMPRCO_09 
                              NULL, --nMM_MERMPLAN_EXESO_09 
                              NULL, --nMM_MERMPLAN_09 
                              NULL, --nMM_MERMPRCO_10 
                              NULL, --nMM_MERMPLAN_EXESO_10 
                              NULL, --nMM_MERMPLAN_10 
                              NULL, --nMM_MERMPRCO 
                              NULL, --nMM_MERMPLAN_EXESO 
                              NULL); --nMM_MERMPLAN
               ELSE
                  --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_EXESO_05 := t_MATERIAL(rMaterial_B.IDENTIFICADOR).Ancho - t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_05;
                  P_MATERIAL(rMaterial_B,'U',
                              NULL,--nCantProd
                              NULL,--nCantCons_E
                              NULL,--nCantCons
                              NULL,--nCantAjus
                              NULL,--nAncho
                              NULL,--nFACTOR_CONVERSION_M2_KG
                              NULL,--nPrecio_ML_E
                              NULL,--vLog_Precio
                              NULL,--nMermEnhe_E
                              NULL,--nMermEnhe
                              NULL,--nMermAjus_E
                              NULL,--nMermAjus
                              NULL,--nMermCabo_E
                              NULL,--nMermCabo
                              NULL,--nMermPico_E
                              NULL,--nMermPico
                              NULL,--nMermTita
                              NULL,--nMermSane
                              NULL,--nCantCons_Bobinas
                              --
                              NULL, --nCONTFSMU_01 
                              NULL, --nCANTFSMU_01 
                              NULL, --nCATOFSMU 
                              NULL, --nCONTFSMU_02 
                              NULL, --nCANTFSMU_02 
                              NULL, --nCONTFSMU_03 
                              NULL, --nCANTFSMU_03 
                              NULL, --nCONTFSMU_04 
                              NULL, --nCANTFSMU_04 
                              NULL, --nCONTFSMU_05 
                              NULL, --nCANTFSMU_05 
                              NULL, --nCONTFSMU_06 
                              NULL, --nCANTFSMU_06 
                              NULL, --nCONTFSMU_07 
                              NULL, --nCANTFSMU_07 
                              NULL, --nCONTFSMU_08 
                              NULL, --nCANTFSMU_08 
                              NULL, --nCONTFSMU_09 
                              NULL, --nCANTFSMU_09 
                              NULL, --nCONTFSMU_10 
                              NULL, --nCANTFSMU_10 
                              NULL, --nANCHO_BUENO_TOTAL_01 
                              NULL, --nANCHO_BUENO_OT_01 
                              NULL, --nANCHO_BUENO_TOTAL_02 
                              NULL, --nANCHO_BUENO_OT_02 
                              NULL, --nANCHO_BUENO_TOTAL_03 
                              NULL, --nANCHO_BUENO_OT_03 
                              NULL, --nANCHO_BUENO_TOTAL_04 
                              NULL, --nANCHO_BUENO_OT_04 
                              NULL, --nANCHO_BUENO_TOTAL_05 
                              NULL, --nANCHO_BUENO_OT_05 
                              NULL, --nANCHO_BUENO_TOTAL_06 
                              NULL, --nANCHO_BUENO_OT_06 
                              NULL, --nANCHO_BUENO_TOTAL_07 
                              NULL, --nANCHO_BUENO_OT_07 
                              NULL, --nANCHO_BUENO_TOTAL_08 
                              NULL, --nANCHO_BUENO_OT_08 
                              NULL, --nANCHO_BUENO_TOTAL_09 
                              NULL, --nANCHO_BUENO_OT_09 
                              NULL, --nANCHO_BUENO_TOTAL_10 
                              NULL, --nANCHO_BUENO_OT_10 
                              NULL, --nANCHO_BUENO_TOTAL 
                              NULL, --nANCHO_BUENO_OT 
                              NULL, --nNUMECORT 
                              NULL, --nMM_MERMPRCO_01 
                              NULL, --nMM_MERMPLAN_EXESO_01 
                              NULL, --nMM_MERMPLAN_01 
                              NULL, --nMM_MERMPRCO_02 
                              NULL, --nMM_MERMPLAN_EXESO_02 
                              NULL, --nMM_MERMPLAN_02 
                              NULL, --nMM_MERMPRCO_03 
                              NULL, --nMM_MERMPLAN_EXESO_03 
                              NULL, --nMM_MERMPLAN_03 
                              NULL, --nMM_MERMPRCO_04 
                              NULL, --nMM_MERMPLAN_EXESO_04 
                              NULL, --nMM_MERMPLAN_04 
                              NULL, --nMM_MERMPRCO_05 
                              rMaterial_B.Ancho - rMaterial_B.ANCHO_BUENO_TOTAL_05, --nMM_MERMPLAN_EXESO_05 
                              0, --nMM_MERMPLAN_05 
                              NULL, --nMM_MERMPRCO_06 
                              NULL, --nMM_MERMPLAN_EXESO_06 
                              NULL, --nMM_MERMPLAN_06 
                              NULL, --nMM_MERMPRCO_07 
                              NULL, --nMM_MERMPLAN_EXESO_07 
                              NULL, --nMM_MERMPLAN_07 
                              NULL, --nMM_MERMPRCO_08 
                              NULL, --nMM_MERMPLAN_EXESO_08 
                              NULL, --nMM_MERMPLAN_08 
                              NULL, --nMM_MERMPRCO_09 
                              NULL, --nMM_MERMPLAN_EXESO_09 
                              NULL, --nMM_MERMPLAN_09 
                              NULL, --nMM_MERMPRCO_10 
                              NULL, --nMM_MERMPLAN_EXESO_10 
                              NULL, --nMM_MERMPLAN_10 
                              NULL, --nMM_MERMPRCO 
                              NULL, --nMM_MERMPLAN_EXESO 
                              NULL); --nMM_MERMPLAN
               END IF;
               --
               --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_05 := 0;
            END IF;
         END IF;
         ------------------------------------------------------------
         --FIN BUSQUEDA DE MM DE MERMAS DE PLANIFICACION Y EXESOS 1--
         ------------------------------------------------------------
         --------------------------------------------------------
         --BUSQUEDA DE MM DE MERMAS DE PLANIFICACION Y EXESOS 6--
         --------------------------------------------------------
         --IF t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_06 IS NOT NULL AND rMATERIAL_B.Tip_Arti != vTIARREST THEN 
         IF rMaterial_B.ANCHO_BUENO_TOTAL_06 IS NOT NULL AND rMATERIAL_B.Tip_Arti != vTIARREST THEN 
            --Busqueda de Exceso de Merma de Planificación
            IF rMATERIAL_B.MM_MERMPLAN_06 IS NOT NULL THEN 
               --IF t_MATERIAL(rMaterial_B.IDENTIFICADOR).Ancho - t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_06 > rMATERIAL_B.MM_MERMPLAN_06 THEN
               IF rMaterial_B.Ancho - rMaterial_B.ANCHO_BUENO_TOTAL_06 > rMATERIAL_B.MM_MERMPLAN_06 THEN
                  IF rMaterial_B.PRE_CORTE = 'S' THEN
                     --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPRCO_06 := t_MATERIAL(rMaterial_B.IDENTIFICADOR).Ancho - t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_06 - rMATERIAL_B.MM_MERMPLAN_06;
                     --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_EXESO_06 := 0;
                     --
                     P_MATERIAL(rMaterial_B,'U',
                                 NULL,--nCantProd
                                 NULL,--nCantCons_E
                                 NULL,--nCantCons
                                 NULL,--nCantAjus
                                 NULL,--nAncho
                                 NULL,--nFACTOR_CONVERSION_M2_KG
                                 NULL,--nPrecio_ML_E
                                 NULL,--vLog_Precio
                                 NULL,--nMermEnhe_E
                                 NULL,--nMermEnhe
                                 NULL,--nMermAjus_E
                                 NULL,--nMermAjus
                                 NULL,--nMermCabo_E
                                 NULL,--nMermCabo
                                 NULL,--nMermPico_E
                                 NULL,--nMermPico
                                 NULL,--nMermTita
                                 NULL,--nMermSane
                                 NULL,--nCantCons_Bobinas
                                 --
                                 NULL, --nCONTFSMU_01 
                                 NULL, --nCANTFSMU_01 
                                 NULL, --nCATOFSMU 
                                 NULL, --nCONTFSMU_02 
                                 NULL, --nCANTFSMU_02 
                                 NULL, --nCONTFSMU_03 
                                 NULL, --nCANTFSMU_03 
                                 NULL, --nCONTFSMU_04 
                                 NULL, --nCANTFSMU_04 
                                 NULL, --nCONTFSMU_05 
                                 NULL, --nCANTFSMU_05 
                                 NULL, --nCONTFSMU_06 
                                 NULL, --nCANTFSMU_06 
                                 NULL, --nCONTFSMU_07 
                                 NULL, --nCANTFSMU_07 
                                 NULL, --nCONTFSMU_08 
                                 NULL, --nCANTFSMU_08 
                                 NULL, --nCONTFSMU_09 
                                 NULL, --nCANTFSMU_09 
                                 NULL, --nCONTFSMU_10 
                                 NULL, --nCANTFSMU_10 
                                 NULL, --nANCHO_BUENO_TOTAL_01 
                                 NULL, --nANCHO_BUENO_OT_01 
                                 NULL, --nANCHO_BUENO_TOTAL_02 
                                 NULL, --nANCHO_BUENO_OT_02 
                                 NULL, --nANCHO_BUENO_TOTAL_03 
                                 NULL, --nANCHO_BUENO_OT_03 
                                 NULL, --nANCHO_BUENO_TOTAL_04 
                                 NULL, --nANCHO_BUENO_OT_04 
                                 NULL, --nANCHO_BUENO_TOTAL_05 
                                 NULL, --nANCHO_BUENO_OT_05 
                                 NULL, --nANCHO_BUENO_TOTAL_06 
                                 NULL, --nANCHO_BUENO_OT_06 
                                 NULL, --nANCHO_BUENO_TOTAL_07 
                                 NULL, --nANCHO_BUENO_OT_07 
                                 NULL, --nANCHO_BUENO_TOTAL_08 
                                 NULL, --nANCHO_BUENO_OT_08 
                                 NULL, --nANCHO_BUENO_TOTAL_09 
                                 NULL, --nANCHO_BUENO_OT_09 
                                 NULL, --nANCHO_BUENO_TOTAL_10 
                                 NULL, --nANCHO_BUENO_OT_10 
                                 NULL, --nANCHO_BUENO_TOTAL 
                                 NULL, --nANCHO_BUENO_OT 
                                 NULL, --nNUMECORT 
                                 NULL, --nMM_MERMPRCO_01 
                                 NULL, --nMM_MERMPLAN_EXESO_01 
                                 NULL, --nMM_MERMPLAN_01 
                                 NULL, --nMM_MERMPRCO_02 
                                 NULL, --nMM_MERMPLAN_EXESO_02 
                                 NULL, --nMM_MERMPLAN_02 
                                 NULL, --nMM_MERMPRCO_03 
                                 NULL, --nMM_MERMPLAN_EXESO_03 
                                 NULL, --nMM_MERMPLAN_03 
                                 NULL, --nMM_MERMPRCO_04 
                                 NULL, --nMM_MERMPLAN_EXESO_04 
                                 NULL, --nMM_MERMPLAN_04 
                                 NULL, --nMM_MERMPRCO_05 
                                 NULL, --nMM_MERMPLAN_EXESO_05 
                                 NULL, --nMM_MERMPLAN_05 
                                 rMaterial_B.Ancho - rMaterial_B.ANCHO_BUENO_TOTAL_06 - rMATERIAL_B.MM_MERMPLAN_06, --nMM_MERMPRCO_06 
                                 0, --nMM_MERMPLAN_EXESO_06 
                                 NULL, --nMM_MERMPLAN_06 
                                 NULL, --nMM_MERMPRCO_07 
                                 NULL, --nMM_MERMPLAN_EXESO_07 
                                 NULL, --nMM_MERMPLAN_07 
                                 NULL, --nMM_MERMPRCO_08 
                                 NULL, --nMM_MERMPLAN_EXESO_08 
                                 NULL, --nMM_MERMPLAN_08 
                                 NULL, --nMM_MERMPRCO_09 
                                 NULL, --nMM_MERMPLAN_EXESO_09 
                                 NULL, --nMM_MERMPLAN_09 
                                 NULL, --nMM_MERMPRCO_10 
                                 NULL, --nMM_MERMPLAN_EXESO_10 
                                 NULL, --nMM_MERMPLAN_10 
                                 NULL, --nMM_MERMPRCO 
                                 NULL, --nMM_MERMPLAN_EXESO 
                                 NULL); --nMM_MERMPLAN
                  ELSE
                     --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_EXESO_06 := t_MATERIAL(rMaterial_B.IDENTIFICADOR).Ancho - t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_06 - rMATERIAL_B.MM_MERMPLAN_06;
                     --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPRCO_06 := 0;
                     --
                     P_MATERIAL(rMaterial_B,'U',
                                 NULL,--nCantProd
                                 NULL,--nCantCons_E
                                 NULL,--nCantCons
                                 NULL,--nCantAjus
                                 NULL,--nAncho
                                 NULL,--nFACTOR_CONVERSION_M2_KG
                                 NULL,--nPrecio_ML_E
                                 NULL,--vLog_Precio
                                 NULL,--nMermEnhe_E
                                 NULL,--nMermEnhe
                                 NULL,--nMermAjus_E
                                 NULL,--nMermAjus
                                 NULL,--nMermCabo_E
                                 NULL,--nMermCabo
                                 NULL,--nMermPico_E
                                 NULL,--nMermPico
                                 NULL,--nMermTita
                                 NULL,--nMermSane
                                 NULL,--nCantCons_Bobinas
                                 --
                                 NULL, --nCONTFSMU_01 
                                 NULL, --nCANTFSMU_01 
                                 NULL, --nCATOFSMU 
                                 NULL, --nCONTFSMU_02 
                                 NULL, --nCANTFSMU_02 
                                 NULL, --nCONTFSMU_03 
                                 NULL, --nCANTFSMU_03 
                                 NULL, --nCONTFSMU_04 
                                 NULL, --nCANTFSMU_04 
                                 NULL, --nCONTFSMU_05 
                                 NULL, --nCANTFSMU_05 
                                 NULL, --nCONTFSMU_06 
                                 NULL, --nCANTFSMU_06 
                                 NULL, --nCONTFSMU_07 
                                 NULL, --nCANTFSMU_07 
                                 NULL, --nCONTFSMU_08 
                                 NULL, --nCANTFSMU_08 
                                 NULL, --nCONTFSMU_09 
                                 NULL, --nCANTFSMU_09 
                                 NULL, --nCONTFSMU_10 
                                 NULL, --nCANTFSMU_10 
                                 NULL, --nANCHO_BUENO_TOTAL_01 
                                 NULL, --nANCHO_BUENO_OT_01 
                                 NULL, --nANCHO_BUENO_TOTAL_02 
                                 NULL, --nANCHO_BUENO_OT_02 
                                 NULL, --nANCHO_BUENO_TOTAL_03 
                                 NULL, --nANCHO_BUENO_OT_03 
                                 NULL, --nANCHO_BUENO_TOTAL_04 
                                 NULL, --nANCHO_BUENO_OT_04 
                                 NULL, --nANCHO_BUENO_TOTAL_05 
                                 NULL, --nANCHO_BUENO_OT_05 
                                 NULL, --nANCHO_BUENO_TOTAL_06 
                                 NULL, --nANCHO_BUENO_OT_06 
                                 NULL, --nANCHO_BUENO_TOTAL_07 
                                 NULL, --nANCHO_BUENO_OT_07 
                                 NULL, --nANCHO_BUENO_TOTAL_08 
                                 NULL, --nANCHO_BUENO_OT_08 
                                 NULL, --nANCHO_BUENO_TOTAL_09 
                                 NULL, --nANCHO_BUENO_OT_09 
                                 NULL, --nANCHO_BUENO_TOTAL_10 
                                 NULL, --nANCHO_BUENO_OT_10 
                                 NULL, --nANCHO_BUENO_TOTAL 
                                 NULL, --nANCHO_BUENO_OT 
                                 NULL, --nNUMECORT 
                                 NULL, --nMM_MERMPRCO_01 
                                 NULL, --nMM_MERMPLAN_EXESO_01 
                                 NULL, --nMM_MERMPLAN_01 
                                 NULL, --nMM_MERMPRCO_02 
                                 NULL, --nMM_MERMPLAN_EXESO_02 
                                 NULL, --nMM_MERMPLAN_02 
                                 NULL, --nMM_MERMPRCO_03 
                                 NULL, --nMM_MERMPLAN_EXESO_03 
                                 NULL, --nMM_MERMPLAN_03 
                                 NULL, --nMM_MERMPRCO_04 
                                 NULL, --nMM_MERMPLAN_EXESO_04 
                                 NULL, --nMM_MERMPLAN_04 
                                 NULL, --nMM_MERMPRCO_05 
                                 NULL, --nMM_MERMPLAN_EXESO_05 
                                 NULL, --nMM_MERMPLAN_05 
                                 0, --nMM_MERMPRCO_06 
                                 rMaterial_B.Ancho - rMaterial_B.ANCHO_BUENO_TOTAL_06 - rMATERIAL_B.MM_MERMPLAN_06, --nMM_MERMPLAN_EXESO_06 
                                 NULL, --nMM_MERMPLAN_06 
                                 NULL, --nMM_MERMPRCO_07 
                                 NULL, --nMM_MERMPLAN_EXESO_07 
                                 NULL, --nMM_MERMPLAN_07 
                                 NULL, --nMM_MERMPRCO_08 
                                 NULL, --nMM_MERMPLAN_EXESO_08 
                                 NULL, --nMM_MERMPLAN_08 
                                 NULL, --nMM_MERMPRCO_09 
                                 NULL, --nMM_MERMPLAN_EXESO_09 
                                 NULL, --nMM_MERMPLAN_09 
                                 NULL, --nMM_MERMPRCO_10 
                                 NULL, --nMM_MERMPLAN_EXESO_10 
                                 NULL, --nMM_MERMPLAN_10 
                                 NULL, --nMM_MERMPRCO 
                                 NULL, --nMM_MERMPLAN_EXESO 
                                 NULL); --nMM_MERMPLAN
                  END IF;
               ELSE
                  --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_EXESO_06 := 0;
                  --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPRCO_06 := 0;
                  --La Merma de Planificación fue menor a lo Estandar / Real (SE ACTUALIZA: YA NO SE BASA EN LA CONFIGURACION)
                  --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_06 := t_MATERIAL(rMaterial_B.IDENTIFICADOR).Ancho - t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_06;
                  P_MATERIAL(rMaterial_B,'U',
                              NULL,--nCantProd
                              NULL,--nCantCons_E
                              NULL,--nCantCons
                              NULL,--nCantAjus
                              NULL,--nAncho
                              NULL,--nFACTOR_CONVERSION_M2_KG
                              NULL,--nPrecio_ML_E
                              NULL,--vLog_Precio
                              NULL,--nMermEnhe_E
                              NULL,--nMermEnhe
                              NULL,--nMermAjus_E
                              NULL,--nMermAjus
                              NULL,--nMermCabo_E
                              NULL,--nMermCabo
                              NULL,--nMermPico_E
                              NULL,--nMermPico
                              NULL,--nMermTita
                              NULL,--nMermSane
                              NULL,--nCantCons_Bobinas
                              --
                              NULL, --nCONTFSMU_01 
                              NULL, --nCANTFSMU_01 
                              NULL, --nCATOFSMU 
                              NULL, --nCONTFSMU_02 
                              NULL, --nCANTFSMU_02 
                              NULL, --nCONTFSMU_03 
                              NULL, --nCANTFSMU_03 
                              NULL, --nCONTFSMU_04 
                              NULL, --nCANTFSMU_04 
                              NULL, --nCONTFSMU_05 
                              NULL, --nCANTFSMU_05 
                              NULL, --nCONTFSMU_06 
                              NULL, --nCANTFSMU_06 
                              NULL, --nCONTFSMU_07 
                              NULL, --nCANTFSMU_07 
                              NULL, --nCONTFSMU_08 
                              NULL, --nCANTFSMU_08 
                              NULL, --nCONTFSMU_09 
                              NULL, --nCANTFSMU_09 
                              NULL, --nCONTFSMU_10 
                              NULL, --nCANTFSMU_10 
                              NULL, --nANCHO_BUENO_TOTAL_01 
                              NULL, --nANCHO_BUENO_OT_01 
                              NULL, --nANCHO_BUENO_TOTAL_02 
                              NULL, --nANCHO_BUENO_OT_02 
                              NULL, --nANCHO_BUENO_TOTAL_03 
                              NULL, --nANCHO_BUENO_OT_03 
                              NULL, --nANCHO_BUENO_TOTAL_04 
                              NULL, --nANCHO_BUENO_OT_04 
                              NULL, --nANCHO_BUENO_TOTAL_05 
                              NULL, --nANCHO_BUENO_OT_05 
                              NULL, --nANCHO_BUENO_TOTAL_06 
                              NULL, --nANCHO_BUENO_OT_06 
                              NULL, --nANCHO_BUENO_TOTAL_07 
                              NULL, --nANCHO_BUENO_OT_07 
                              NULL, --nANCHO_BUENO_TOTAL_08 
                              NULL, --nANCHO_BUENO_OT_08 
                              NULL, --nANCHO_BUENO_TOTAL_09 
                              NULL, --nANCHO_BUENO_OT_09 
                              NULL, --nANCHO_BUENO_TOTAL_10 
                              NULL, --nANCHO_BUENO_OT_10 
                              NULL, --nANCHO_BUENO_TOTAL 
                              NULL, --nANCHO_BUENO_OT 
                              NULL, --nNUMECORT 
                              NULL, --nMM_MERMPRCO_01 
                              NULL, --nMM_MERMPLAN_EXESO_01 
                              NULL, --nMM_MERMPLAN_01 
                              NULL, --nMM_MERMPRCO_02 
                              NULL, --nMM_MERMPLAN_EXESO_02 
                              NULL, --nMM_MERMPLAN_02 
                              NULL, --nMM_MERMPRCO_03 
                              NULL, --nMM_MERMPLAN_EXESO_03 
                              NULL, --nMM_MERMPLAN_03 
                              NULL, --nMM_MERMPRCO_04 
                              NULL, --nMM_MERMPLAN_EXESO_04 
                              NULL, --nMM_MERMPLAN_04 
                              NULL, --nMM_MERMPRCO_05 
                              NULL, --nMM_MERMPLAN_EXESO_05 
                              NULL, --nMM_MERMPLAN_05 
                              0, --nMM_MERMPRCO_06 
                              0, --nMM_MERMPLAN_EXESO_06 
                              rMaterial_B.Ancho - rMaterial_B.ANCHO_BUENO_TOTAL_06, --nMM_MERMPLAN_06 
                              NULL, --nMM_MERMPRCO_07 
                              NULL, --nMM_MERMPLAN_EXESO_07 
                              NULL, --nMM_MERMPLAN_07 
                              NULL, --nMM_MERMPRCO_08 
                              NULL, --nMM_MERMPLAN_EXESO_08 
                              NULL, --nMM_MERMPLAN_08 
                              NULL, --nMM_MERMPRCO_09 
                              NULL, --nMM_MERMPLAN_EXESO_09 
                              NULL, --nMM_MERMPLAN_09 
                              NULL, --nMM_MERMPRCO_10 
                              NULL, --nMM_MERMPLAN_EXESO_10 
                              NULL, --nMM_MERMPLAN_10 
                              NULL, --nMM_MERMPRCO 
                              NULL, --nMM_MERMPLAN_EXESO 
                              NULL); --nMM_MERMPLAN
               END IF;
            ELSE--Si no existe la Merma Planificada Estandar / Real
               --Se asigna la merma encontrada a Excesos o Pre_Corte ya que no fue Planificada como Estandar
               IF rMaterial_B.PRE_CORTE = 'S' THEN
                  --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPRCO_06 := t_MATERIAL(rMaterial_B.IDENTIFICADOR).Ancho - t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_06;
                  P_MATERIAL(rMaterial_B,'U',
                              NULL,--nCantProd
                              NULL,--nCantCons_E
                              NULL,--nCantCons
                              NULL,--nCantAjus
                              NULL,--nAncho
                              NULL,--nFACTOR_CONVERSION_M2_KG
                              NULL,--nPrecio_ML_E
                              NULL,--vLog_Precio
                              NULL,--nMermEnhe_E
                              NULL,--nMermEnhe
                              NULL,--nMermAjus_E
                              NULL,--nMermAjus
                              NULL,--nMermCabo_E
                              NULL,--nMermCabo
                              NULL,--nMermPico_E
                              NULL,--nMermPico
                              NULL,--nMermTita
                              NULL,--nMermSane
                              NULL,--nCantCons_Bobinas
                              --
                              NULL, --nCONTFSMU_01 
                              NULL, --nCANTFSMU_01 
                              NULL, --nCATOFSMU 
                              NULL, --nCONTFSMU_02 
                              NULL, --nCANTFSMU_02 
                              NULL, --nCONTFSMU_03 
                              NULL, --nCANTFSMU_03 
                              NULL, --nCONTFSMU_04 
                              NULL, --nCANTFSMU_04 
                              NULL, --nCONTFSMU_05 
                              NULL, --nCANTFSMU_05 
                              NULL, --nCONTFSMU_06 
                              NULL, --nCANTFSMU_06 
                              NULL, --nCONTFSMU_07 
                              NULL, --nCANTFSMU_07 
                              NULL, --nCONTFSMU_08 
                              NULL, --nCANTFSMU_08 
                              NULL, --nCONTFSMU_09 
                              NULL, --nCANTFSMU_09 
                              NULL, --nCONTFSMU_10 
                              NULL, --nCANTFSMU_10 
                              NULL, --nANCHO_BUENO_TOTAL_01 
                              NULL, --nANCHO_BUENO_OT_01 
                              NULL, --nANCHO_BUENO_TOTAL_02 
                              NULL, --nANCHO_BUENO_OT_02 
                              NULL, --nANCHO_BUENO_TOTAL_03 
                              NULL, --nANCHO_BUENO_OT_03 
                              NULL, --nANCHO_BUENO_TOTAL_04 
                              NULL, --nANCHO_BUENO_OT_04 
                              NULL, --nANCHO_BUENO_TOTAL_05 
                              NULL, --nANCHO_BUENO_OT_05 
                              NULL, --nANCHO_BUENO_TOTAL_06 
                              NULL, --nANCHO_BUENO_OT_06 
                              NULL, --nANCHO_BUENO_TOTAL_07 
                              NULL, --nANCHO_BUENO_OT_07 
                              NULL, --nANCHO_BUENO_TOTAL_08 
                              NULL, --nANCHO_BUENO_OT_08 
                              NULL, --nANCHO_BUENO_TOTAL_09 
                              NULL, --nANCHO_BUENO_OT_09 
                              NULL, --nANCHO_BUENO_TOTAL_10 
                              NULL, --nANCHO_BUENO_OT_10 
                              NULL, --nANCHO_BUENO_TOTAL 
                              NULL, --nANCHO_BUENO_OT 
                              NULL, --nNUMECORT 
                              NULL, --nMM_MERMPRCO_01 
                              NULL, --nMM_MERMPLAN_EXESO_01 
                              NULL, --nMM_MERMPLAN_01 
                              NULL, --nMM_MERMPRCO_02 
                              NULL, --nMM_MERMPLAN_EXESO_02 
                              NULL, --nMM_MERMPLAN_02 
                              NULL, --nMM_MERMPRCO_03 
                              NULL, --nMM_MERMPLAN_EXESO_03 
                              NULL, --nMM_MERMPLAN_03 
                              NULL, --nMM_MERMPRCO_04 
                              NULL, --nMM_MERMPLAN_EXESO_04 
                              NULL, --nMM_MERMPLAN_04 
                              NULL, --nMM_MERMPRCO_05 
                              NULL, --nMM_MERMPLAN_EXESO_05 
                              NULL, --nMM_MERMPLAN_05 
                              rMaterial_B.Ancho - rMaterial_B.ANCHO_BUENO_TOTAL_06, --nMM_MERMPRCO_06 
                              NULL, --nMM_MERMPLAN_EXESO_06 
                              0, --nMM_MERMPLAN_06 
                              NULL, --nMM_MERMPRCO_07 
                              NULL, --nMM_MERMPLAN_EXESO_07 
                              NULL, --nMM_MERMPLAN_07 
                              NULL, --nMM_MERMPRCO_08 
                              NULL, --nMM_MERMPLAN_EXESO_08 
                              NULL, --nMM_MERMPLAN_08 
                              NULL, --nMM_MERMPRCO_09 
                              NULL, --nMM_MERMPLAN_EXESO_09 
                              NULL, --nMM_MERMPLAN_09 
                              NULL, --nMM_MERMPRCO_10 
                              NULL, --nMM_MERMPLAN_EXESO_10 
                              NULL, --nMM_MERMPLAN_10 
                              NULL, --nMM_MERMPRCO 
                              NULL, --nMM_MERMPLAN_EXESO 
                              NULL); --nMM_MERMPLAN
               ELSE
                  --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_EXESO_06 := t_MATERIAL(rMaterial_B.IDENTIFICADOR).Ancho - t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_06;
                  P_MATERIAL(rMaterial_B,'U',
                              NULL,--nCantProd
                              NULL,--nCantCons_E
                              NULL,--nCantCons
                              NULL,--nCantAjus
                              NULL,--nAncho
                              NULL,--nFACTOR_CONVERSION_M2_KG
                              NULL,--nPrecio_ML_E
                              NULL,--vLog_Precio
                              NULL,--nMermEnhe_E
                              NULL,--nMermEnhe
                              NULL,--nMermAjus_E
                              NULL,--nMermAjus
                              NULL,--nMermCabo_E
                              NULL,--nMermCabo
                              NULL,--nMermPico_E
                              NULL,--nMermPico
                              NULL,--nMermTita
                              NULL,--nMermSane
                              NULL,--nCantCons_Bobinas
                              --
                              NULL, --nCONTFSMU_01 
                              NULL, --nCANTFSMU_01 
                              NULL, --nCATOFSMU 
                              NULL, --nCONTFSMU_02 
                              NULL, --nCANTFSMU_02 
                              NULL, --nCONTFSMU_03 
                              NULL, --nCANTFSMU_03 
                              NULL, --nCONTFSMU_04 
                              NULL, --nCANTFSMU_04 
                              NULL, --nCONTFSMU_05 
                              NULL, --nCANTFSMU_05 
                              NULL, --nCONTFSMU_06 
                              NULL, --nCANTFSMU_06 
                              NULL, --nCONTFSMU_07 
                              NULL, --nCANTFSMU_07 
                              NULL, --nCONTFSMU_08 
                              NULL, --nCANTFSMU_08 
                              NULL, --nCONTFSMU_09 
                              NULL, --nCANTFSMU_09 
                              NULL, --nCONTFSMU_10 
                              NULL, --nCANTFSMU_10 
                              NULL, --nANCHO_BUENO_TOTAL_01 
                              NULL, --nANCHO_BUENO_OT_01 
                              NULL, --nANCHO_BUENO_TOTAL_02 
                              NULL, --nANCHO_BUENO_OT_02 
                              NULL, --nANCHO_BUENO_TOTAL_03 
                              NULL, --nANCHO_BUENO_OT_03 
                              NULL, --nANCHO_BUENO_TOTAL_04 
                              NULL, --nANCHO_BUENO_OT_04 
                              NULL, --nANCHO_BUENO_TOTAL_05 
                              NULL, --nANCHO_BUENO_OT_05 
                              NULL, --nANCHO_BUENO_TOTAL_06 
                              NULL, --nANCHO_BUENO_OT_06 
                              NULL, --nANCHO_BUENO_TOTAL_07 
                              NULL, --nANCHO_BUENO_OT_07 
                              NULL, --nANCHO_BUENO_TOTAL_08 
                              NULL, --nANCHO_BUENO_OT_08 
                              NULL, --nANCHO_BUENO_TOTAL_09 
                              NULL, --nANCHO_BUENO_OT_09 
                              NULL, --nANCHO_BUENO_TOTAL_10 
                              NULL, --nANCHO_BUENO_OT_10 
                              NULL, --nANCHO_BUENO_TOTAL 
                              NULL, --nANCHO_BUENO_OT 
                              NULL, --nNUMECORT 
                              NULL, --nMM_MERMPRCO_01 
                              NULL, --nMM_MERMPLAN_EXESO_01 
                              NULL, --nMM_MERMPLAN_01 
                              NULL, --nMM_MERMPRCO_02 
                              NULL, --nMM_MERMPLAN_EXESO_02 
                              NULL, --nMM_MERMPLAN_02 
                              NULL, --nMM_MERMPRCO_03 
                              NULL, --nMM_MERMPLAN_EXESO_03 
                              NULL, --nMM_MERMPLAN_03 
                              NULL, --nMM_MERMPRCO_04 
                              NULL, --nMM_MERMPLAN_EXESO_04 
                              NULL, --nMM_MERMPLAN_04 
                              NULL, --nMM_MERMPRCO_05 
                              NULL, --nMM_MERMPLAN_EXESO_05 
                              NULL, --nMM_MERMPLAN_05 
                              NULL, --nMM_MERMPRCO_06 
                              rMaterial_B.Ancho - rMaterial_B.ANCHO_BUENO_TOTAL_06, --nMM_MERMPLAN_EXESO_06 
                              0, --nMM_MERMPLAN_06 
                              NULL, --nMM_MERMPRCO_07 
                              NULL, --nMM_MERMPLAN_EXESO_07 
                              NULL, --nMM_MERMPLAN_07 
                              NULL, --nMM_MERMPRCO_08 
                              NULL, --nMM_MERMPLAN_EXESO_08 
                              NULL, --nMM_MERMPLAN_08 
                              NULL, --nMM_MERMPRCO_09 
                              NULL, --nMM_MERMPLAN_EXESO_09 
                              NULL, --nMM_MERMPLAN_09 
                              NULL, --nMM_MERMPRCO_10 
                              NULL, --nMM_MERMPLAN_EXESO_10 
                              NULL, --nMM_MERMPLAN_10 
                              NULL, --nMM_MERMPRCO 
                              NULL, --nMM_MERMPLAN_EXESO 
                              NULL); --nMM_MERMPLAN
               END IF;
               --
               --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_06 := 0;
            END IF;
         END IF;
         ------------------------------------------------------------
         --FIN BUSQUEDA DE MM DE MERMAS DE PLANIFICACION Y EXESOS 6--
         ------------------------------------------------------------
         --------------------------------------------------------
         --BUSQUEDA DE MM DE MERMAS DE PLANIFICACION Y EXESOS 7--
         --------------------------------------------------------
         --IF t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_07 IS NOT NULL AND rMATERIAL_B.Tip_Arti != vTIARREST THEN 
         IF rMaterial_B.ANCHO_BUENO_TOTAL_07 IS NOT NULL AND rMATERIAL_B.Tip_Arti != vTIARREST THEN 
            --Busqueda de Exceso de Merma de Planificación
            IF rMATERIAL_B.MM_MERMPLAN_07 IS NOT NULL THEN 
               --IF t_MATERIAL(rMaterial_B.IDENTIFICADOR).Ancho - t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_07 > rMATERIAL_B.MM_MERMPLAN_07 THEN
               IF rMaterial_B.Ancho - rMaterial_B.ANCHO_BUENO_TOTAL_07 > rMATERIAL_B.MM_MERMPLAN_07 THEN
                  IF rMaterial_B.PRE_CORTE = 'S' THEN
                     --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPRCO_07 := t_MATERIAL(rMaterial_B.IDENTIFICADOR).Ancho - t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_07 - rMATERIAL_B.MM_MERMPLAN_07;
                     --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_EXESO_07 := 0;
                     --
                     P_MATERIAL(rMaterial_B,'U',
                                 NULL,--nCantProd
                                 NULL,--nCantCons_E
                                 NULL,--nCantCons
                                 NULL,--nCantAjus
                                 NULL,--nAncho
                                 NULL,--nFACTOR_CONVERSION_M2_KG
                                 NULL,--nPrecio_ML_E
                                 NULL,--vLog_Precio
                                 NULL,--nMermEnhe_E
                                 NULL,--nMermEnhe
                                 NULL,--nMermAjus_E
                                 NULL,--nMermAjus
                                 NULL,--nMermCabo_E
                                 NULL,--nMermCabo
                                 NULL,--nMermPico_E
                                 NULL,--nMermPico
                                 NULL,--nMermTita
                                 NULL,--nMermSane
                                 NULL,--nCantCons_Bobinas
                                 --
                                 NULL, --nCONTFSMU_01 
                                 NULL, --nCANTFSMU_01 
                                 NULL, --nCATOFSMU 
                                 NULL, --nCONTFSMU_02 
                                 NULL, --nCANTFSMU_02 
                                 NULL, --nCONTFSMU_03 
                                 NULL, --nCANTFSMU_03 
                                 NULL, --nCONTFSMU_04 
                                 NULL, --nCANTFSMU_04 
                                 NULL, --nCONTFSMU_05 
                                 NULL, --nCANTFSMU_05 
                                 NULL, --nCONTFSMU_06 
                                 NULL, --nCANTFSMU_06 
                                 NULL, --nCONTFSMU_07 
                                 NULL, --nCANTFSMU_07 
                                 NULL, --nCONTFSMU_08 
                                 NULL, --nCANTFSMU_08 
                                 NULL, --nCONTFSMU_09 
                                 NULL, --nCANTFSMU_09 
                                 NULL, --nCONTFSMU_10 
                                 NULL, --nCANTFSMU_10 
                                 NULL, --nANCHO_BUENO_TOTAL_01 
                                 NULL, --nANCHO_BUENO_OT_01 
                                 NULL, --nANCHO_BUENO_TOTAL_02 
                                 NULL, --nANCHO_BUENO_OT_02 
                                 NULL, --nANCHO_BUENO_TOTAL_03 
                                 NULL, --nANCHO_BUENO_OT_03 
                                 NULL, --nANCHO_BUENO_TOTAL_04 
                                 NULL, --nANCHO_BUENO_OT_04 
                                 NULL, --nANCHO_BUENO_TOTAL_05 
                                 NULL, --nANCHO_BUENO_OT_05 
                                 NULL, --nANCHO_BUENO_TOTAL_06 
                                 NULL, --nANCHO_BUENO_OT_06 
                                 NULL, --nANCHO_BUENO_TOTAL_07 
                                 NULL, --nANCHO_BUENO_OT_07 
                                 NULL, --nANCHO_BUENO_TOTAL_08 
                                 NULL, --nANCHO_BUENO_OT_08 
                                 NULL, --nANCHO_BUENO_TOTAL_09 
                                 NULL, --nANCHO_BUENO_OT_09 
                                 NULL, --nANCHO_BUENO_TOTAL_10 
                                 NULL, --nANCHO_BUENO_OT_10 
                                 NULL, --nANCHO_BUENO_TOTAL 
                                 NULL, --nANCHO_BUENO_OT 
                                 NULL, --nNUMECORT 
                                 NULL, --nMM_MERMPRCO_01 
                                 NULL, --nMM_MERMPLAN_EXESO_01 
                                 NULL, --nMM_MERMPLAN_01 
                                 NULL, --nMM_MERMPRCO_02 
                                 NULL, --nMM_MERMPLAN_EXESO_02 
                                 NULL, --nMM_MERMPLAN_02 
                                 NULL, --nMM_MERMPRCO_03 
                                 NULL, --nMM_MERMPLAN_EXESO_03 
                                 NULL, --nMM_MERMPLAN_03 
                                 NULL, --nMM_MERMPRCO_04 
                                 NULL, --nMM_MERMPLAN_EXESO_04 
                                 NULL, --nMM_MERMPLAN_04 
                                 NULL, --nMM_MERMPRCO_05 
                                 NULL, --nMM_MERMPLAN_EXESO_05 
                                 NULL, --nMM_MERMPLAN_05 
                                 NULL, --nMM_MERMPRCO_06 
                                 NULL, --nMM_MERMPLAN_EXESO_06 
                                 NULL, --nMM_MERMPLAN_06 
                                 rMaterial_B.Ancho - rMaterial_B.ANCHO_BUENO_TOTAL_07 - rMATERIAL_B.MM_MERMPLAN_07, --nMM_MERMPRCO_07 
                                 0, --nMM_MERMPLAN_EXESO_07 
                                 NULL, --nMM_MERMPLAN_07 
                                 NULL, --nMM_MERMPRCO_08 
                                 NULL, --nMM_MERMPLAN_EXESO_08 
                                 NULL, --nMM_MERMPLAN_08 
                                 NULL, --nMM_MERMPRCO_09 
                                 NULL, --nMM_MERMPLAN_EXESO_09 
                                 NULL, --nMM_MERMPLAN_09 
                                 NULL, --nMM_MERMPRCO_10 
                                 NULL, --nMM_MERMPLAN_EXESO_10 
                                 NULL, --nMM_MERMPLAN_10 
                                 NULL, --nMM_MERMPRCO 
                                 NULL, --nMM_MERMPLAN_EXESO 
                                 NULL); --nMM_MERMPLAN
                  ELSE
                     --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_EXESO_07 := t_MATERIAL(rMaterial_B.IDENTIFICADOR).Ancho - t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_07 - rMATERIAL_B.MM_MERMPLAN_07;
                     --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPRCO_07 := 0;
                     --
                     P_MATERIAL(rMaterial_B,'U',
                                 NULL,--nCantProd
                                 NULL,--nCantCons_E
                                 NULL,--nCantCons
                                 NULL,--nCantAjus
                                 NULL,--nAncho
                                 NULL,--nFACTOR_CONVERSION_M2_KG
                                 NULL,--nPrecio_ML_E
                                 NULL,--vLog_Precio
                                 NULL,--nMermEnhe_E
                                 NULL,--nMermEnhe
                                 NULL,--nMermAjus_E
                                 NULL,--nMermAjus
                                 NULL,--nMermCabo_E
                                 NULL,--nMermCabo
                                 NULL,--nMermPico_E
                                 NULL,--nMermPico
                                 NULL,--nMermTita
                                 NULL,--nMermSane
                                 NULL,--nCantCons_Bobinas
                                 --
                                 NULL, --nCONTFSMU_01 
                                 NULL, --nCANTFSMU_01 
                                 NULL, --nCATOFSMU 
                                 NULL, --nCONTFSMU_02 
                                 NULL, --nCANTFSMU_02 
                                 NULL, --nCONTFSMU_03 
                                 NULL, --nCANTFSMU_03 
                                 NULL, --nCONTFSMU_04 
                                 NULL, --nCANTFSMU_04 
                                 NULL, --nCONTFSMU_05 
                                 NULL, --nCANTFSMU_05 
                                 NULL, --nCONTFSMU_06 
                                 NULL, --nCANTFSMU_06 
                                 NULL, --nCONTFSMU_07 
                                 NULL, --nCANTFSMU_07 
                                 NULL, --nCONTFSMU_08 
                                 NULL, --nCANTFSMU_08 
                                 NULL, --nCONTFSMU_09 
                                 NULL, --nCANTFSMU_09 
                                 NULL, --nCONTFSMU_10 
                                 NULL, --nCANTFSMU_10 
                                 NULL, --nANCHO_BUENO_TOTAL_01 
                                 NULL, --nANCHO_BUENO_OT_01 
                                 NULL, --nANCHO_BUENO_TOTAL_02 
                                 NULL, --nANCHO_BUENO_OT_02 
                                 NULL, --nANCHO_BUENO_TOTAL_03 
                                 NULL, --nANCHO_BUENO_OT_03 
                                 NULL, --nANCHO_BUENO_TOTAL_04 
                                 NULL, --nANCHO_BUENO_OT_04 
                                 NULL, --nANCHO_BUENO_TOTAL_05 
                                 NULL, --nANCHO_BUENO_OT_05 
                                 NULL, --nANCHO_BUENO_TOTAL_06 
                                 NULL, --nANCHO_BUENO_OT_06 
                                 NULL, --nANCHO_BUENO_TOTAL_07 
                                 NULL, --nANCHO_BUENO_OT_07 
                                 NULL, --nANCHO_BUENO_TOTAL_08 
                                 NULL, --nANCHO_BUENO_OT_08 
                                 NULL, --nANCHO_BUENO_TOTAL_09 
                                 NULL, --nANCHO_BUENO_OT_09 
                                 NULL, --nANCHO_BUENO_TOTAL_10 
                                 NULL, --nANCHO_BUENO_OT_10 
                                 NULL, --nANCHO_BUENO_TOTAL 
                                 NULL, --nANCHO_BUENO_OT 
                                 NULL, --nNUMECORT 
                                 NULL, --nMM_MERMPRCO_01 
                                 NULL, --nMM_MERMPLAN_EXESO_01 
                                 NULL, --nMM_MERMPLAN_01 
                                 NULL, --nMM_MERMPRCO_02 
                                 NULL, --nMM_MERMPLAN_EXESO_02 
                                 NULL, --nMM_MERMPLAN_02 
                                 NULL, --nMM_MERMPRCO_03 
                                 NULL, --nMM_MERMPLAN_EXESO_03 
                                 NULL, --nMM_MERMPLAN_03 
                                 NULL, --nMM_MERMPRCO_04 
                                 NULL, --nMM_MERMPLAN_EXESO_04 
                                 NULL, --nMM_MERMPLAN_04 
                                 NULL, --nMM_MERMPRCO_05 
                                 NULL, --nMM_MERMPLAN_EXESO_05 
                                 NULL, --nMM_MERMPLAN_05 
                                 NULL, --nMM_MERMPRCO_06 
                                 NULL, --nMM_MERMPLAN_EXESO_06 
                                 NULL, --nMM_MERMPLAN_06 
                                 0, --nMM_MERMPRCO_07 
                                 rMaterial_B.Ancho - rMaterial_B.ANCHO_BUENO_TOTAL_07 - rMATERIAL_B.MM_MERMPLAN_07, --nMM_MERMPLAN_EXESO_07 
                                 NULL, --nMM_MERMPLAN_07 
                                 NULL, --nMM_MERMPRCO_08 
                                 NULL, --nMM_MERMPLAN_EXESO_08 
                                 NULL, --nMM_MERMPLAN_08 
                                 NULL, --nMM_MERMPRCO_09 
                                 NULL, --nMM_MERMPLAN_EXESO_09 
                                 NULL, --nMM_MERMPLAN_09 
                                 NULL, --nMM_MERMPRCO_10 
                                 NULL, --nMM_MERMPLAN_EXESO_10 
                                 NULL, --nMM_MERMPLAN_10 
                                 NULL, --nMM_MERMPRCO 
                                 NULL, --nMM_MERMPLAN_EXESO 
                                 NULL); --nMM_MERMPLAN
                  END IF;
               ELSE
                  --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_EXESO_07 := 0;
                  --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPRCO_07 := 0;
                  --La Merma de Planificación fue menor a lo Estandar / Real (SE ACTUALIZA: YA NO SE BASA EN LA CONFIGURACION)
                  --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_07 := t_MATERIAL(rMaterial_B.IDENTIFICADOR).Ancho - t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_07;
                  P_MATERIAL(rMaterial_B,'U',
                              NULL,--nCantProd
                              NULL,--nCantCons_E
                              NULL,--nCantCons
                              NULL,--nCantAjus
                              NULL,--nAncho
                              NULL,--nFACTOR_CONVERSION_M2_KG
                              NULL,--nPrecio_ML_E
                              NULL,--vLog_Precio
                              NULL,--nMermEnhe_E
                              NULL,--nMermEnhe
                              NULL,--nMermAjus_E
                              NULL,--nMermAjus
                              NULL,--nMermCabo_E
                              NULL,--nMermCabo
                              NULL,--nMermPico_E
                              NULL,--nMermPico
                              NULL,--nMermTita
                              NULL,--nMermSane
                              NULL,--nCantCons_Bobinas
                              --
                              NULL, --nCONTFSMU_01 
                              NULL, --nCANTFSMU_01 
                              NULL, --nCATOFSMU 
                              NULL, --nCONTFSMU_02 
                              NULL, --nCANTFSMU_02 
                              NULL, --nCONTFSMU_03 
                              NULL, --nCANTFSMU_03 
                              NULL, --nCONTFSMU_04 
                              NULL, --nCANTFSMU_04 
                              NULL, --nCONTFSMU_05 
                              NULL, --nCANTFSMU_05 
                              NULL, --nCONTFSMU_06 
                              NULL, --nCANTFSMU_06 
                              NULL, --nCONTFSMU_07 
                              NULL, --nCANTFSMU_07 
                              NULL, --nCONTFSMU_08 
                              NULL, --nCANTFSMU_08 
                              NULL, --nCONTFSMU_09 
                              NULL, --nCANTFSMU_09 
                              NULL, --nCONTFSMU_10 
                              NULL, --nCANTFSMU_10 
                              NULL, --nANCHO_BUENO_TOTAL_01 
                              NULL, --nANCHO_BUENO_OT_01 
                              NULL, --nANCHO_BUENO_TOTAL_02 
                              NULL, --nANCHO_BUENO_OT_02 
                              NULL, --nANCHO_BUENO_TOTAL_03 
                              NULL, --nANCHO_BUENO_OT_03 
                              NULL, --nANCHO_BUENO_TOTAL_04 
                              NULL, --nANCHO_BUENO_OT_04 
                              NULL, --nANCHO_BUENO_TOTAL_05 
                              NULL, --nANCHO_BUENO_OT_05 
                              NULL, --nANCHO_BUENO_TOTAL_06 
                              NULL, --nANCHO_BUENO_OT_06 
                              NULL, --nANCHO_BUENO_TOTAL_07 
                              NULL, --nANCHO_BUENO_OT_07 
                              NULL, --nANCHO_BUENO_TOTAL_08 
                              NULL, --nANCHO_BUENO_OT_08 
                              NULL, --nANCHO_BUENO_TOTAL_09 
                              NULL, --nANCHO_BUENO_OT_09 
                              NULL, --nANCHO_BUENO_TOTAL_10 
                              NULL, --nANCHO_BUENO_OT_10 
                              NULL, --nANCHO_BUENO_TOTAL 
                              NULL, --nANCHO_BUENO_OT 
                              NULL, --nNUMECORT 
                              NULL, --nMM_MERMPRCO_01 
                              NULL, --nMM_MERMPLAN_EXESO_01 
                              NULL, --nMM_MERMPLAN_01 
                              NULL, --nMM_MERMPRCO_02 
                              NULL, --nMM_MERMPLAN_EXESO_02 
                              NULL, --nMM_MERMPLAN_02 
                              NULL, --nMM_MERMPRCO_03 
                              NULL, --nMM_MERMPLAN_EXESO_03 
                              NULL, --nMM_MERMPLAN_03 
                              NULL, --nMM_MERMPRCO_04 
                              NULL, --nMM_MERMPLAN_EXESO_04 
                              NULL, --nMM_MERMPLAN_04 
                              NULL, --nMM_MERMPRCO_05 
                              NULL, --nMM_MERMPLAN_EXESO_05 
                              NULL, --nMM_MERMPLAN_05 
                              NULL, --nMM_MERMPRCO_06 
                              NULL, --nMM_MERMPLAN_EXESO_06 
                              NULL, --nMM_MERMPLAN_06 
                              0, --nMM_MERMPRCO_07 
                              0, --nMM_MERMPLAN_EXESO_07 
                              rMaterial_B.Ancho - rMaterial_B.ANCHO_BUENO_TOTAL_07, --nMM_MERMPLAN_07 
                              NULL, --nMM_MERMPRCO_08 
                              NULL, --nMM_MERMPLAN_EXESO_08 
                              NULL, --nMM_MERMPLAN_08 
                              NULL, --nMM_MERMPRCO_09 
                              NULL, --nMM_MERMPLAN_EXESO_09 
                              NULL, --nMM_MERMPLAN_09 
                              NULL, --nMM_MERMPRCO_10 
                              NULL, --nMM_MERMPLAN_EXESO_10 
                              NULL, --nMM_MERMPLAN_10 
                              NULL, --nMM_MERMPRCO 
                              NULL, --nMM_MERMPLAN_EXESO 
                              NULL); --nMM_MERMPLAN
               END IF;
            ELSE--Si no existe la Merma Planificada Estandar / Real
               --Se asigna la merma encontrada a Excesos o Pre_Corte ya que no fue Planificada como Estandar
               IF rMaterial_B.PRE_CORTE = 'S' THEN
                  --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPRCO_07 := t_MATERIAL(rMaterial_B.IDENTIFICADOR).Ancho - t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_07;
                  P_MATERIAL(rMaterial_B,'U',
                              NULL,--nCantProd
                              NULL,--nCantCons_E
                              NULL,--nCantCons
                              NULL,--nCantAjus
                              NULL,--nAncho
                              NULL,--nFACTOR_CONVERSION_M2_KG
                              NULL,--nPrecio_ML_E
                              NULL,--vLog_Precio
                              NULL,--nMermEnhe_E
                              NULL,--nMermEnhe
                              NULL,--nMermAjus_E
                              NULL,--nMermAjus
                              NULL,--nMermCabo_E
                              NULL,--nMermCabo
                              NULL,--nMermPico_E
                              NULL,--nMermPico
                              NULL,--nMermTita
                              NULL,--nMermSane
                              NULL,--nCantCons_Bobinas
                              --
                              NULL, --nCONTFSMU_01 
                              NULL, --nCANTFSMU_01 
                              NULL, --nCATOFSMU 
                              NULL, --nCONTFSMU_02 
                              NULL, --nCANTFSMU_02 
                              NULL, --nCONTFSMU_03 
                              NULL, --nCANTFSMU_03 
                              NULL, --nCONTFSMU_04 
                              NULL, --nCANTFSMU_04 
                              NULL, --nCONTFSMU_05 
                              NULL, --nCANTFSMU_05 
                              NULL, --nCONTFSMU_06 
                              NULL, --nCANTFSMU_06 
                              NULL, --nCONTFSMU_07 
                              NULL, --nCANTFSMU_07 
                              NULL, --nCONTFSMU_08 
                              NULL, --nCANTFSMU_08 
                              NULL, --nCONTFSMU_09 
                              NULL, --nCANTFSMU_09 
                              NULL, --nCONTFSMU_10 
                              NULL, --nCANTFSMU_10 
                              NULL, --nANCHO_BUENO_TOTAL_01 
                              NULL, --nANCHO_BUENO_OT_01 
                              NULL, --nANCHO_BUENO_TOTAL_02 
                              NULL, --nANCHO_BUENO_OT_02 
                              NULL, --nANCHO_BUENO_TOTAL_03 
                              NULL, --nANCHO_BUENO_OT_03 
                              NULL, --nANCHO_BUENO_TOTAL_04 
                              NULL, --nANCHO_BUENO_OT_04 
                              NULL, --nANCHO_BUENO_TOTAL_05 
                              NULL, --nANCHO_BUENO_OT_05 
                              NULL, --nANCHO_BUENO_TOTAL_06 
                              NULL, --nANCHO_BUENO_OT_06 
                              NULL, --nANCHO_BUENO_TOTAL_07 
                              NULL, --nANCHO_BUENO_OT_07 
                              NULL, --nANCHO_BUENO_TOTAL_08 
                              NULL, --nANCHO_BUENO_OT_08 
                              NULL, --nANCHO_BUENO_TOTAL_09 
                              NULL, --nANCHO_BUENO_OT_09 
                              NULL, --nANCHO_BUENO_TOTAL_10 
                              NULL, --nANCHO_BUENO_OT_10 
                              NULL, --nANCHO_BUENO_TOTAL 
                              NULL, --nANCHO_BUENO_OT 
                              NULL, --nNUMECORT 
                              NULL, --nMM_MERMPRCO_01 
                              NULL, --nMM_MERMPLAN_EXESO_01 
                              NULL, --nMM_MERMPLAN_01 
                              NULL, --nMM_MERMPRCO_02 
                              NULL, --nMM_MERMPLAN_EXESO_02 
                              NULL, --nMM_MERMPLAN_02 
                              NULL, --nMM_MERMPRCO_03 
                              NULL, --nMM_MERMPLAN_EXESO_03 
                              NULL, --nMM_MERMPLAN_03 
                              NULL, --nMM_MERMPRCO_04 
                              NULL, --nMM_MERMPLAN_EXESO_04 
                              NULL, --nMM_MERMPLAN_04 
                              NULL, --nMM_MERMPRCO_05 
                              NULL, --nMM_MERMPLAN_EXESO_05 
                              NULL, --nMM_MERMPLAN_05 
                              NULL, --nMM_MERMPRCO_06 
                              NULL, --nMM_MERMPLAN_EXESO_06 
                              NULL, --nMM_MERMPLAN_06 
                              rMaterial_B.Ancho - rMaterial_B.ANCHO_BUENO_TOTAL_07, --nMM_MERMPRCO_07 
                              NULL, --nMM_MERMPLAN_EXESO_07 
                              0, --nMM_MERMPLAN_07 
                              NULL, --nMM_MERMPRCO_08 
                              NULL, --nMM_MERMPLAN_EXESO_08 
                              NULL, --nMM_MERMPLAN_08 
                              NULL, --nMM_MERMPRCO_09 
                              NULL, --nMM_MERMPLAN_EXESO_09 
                              NULL, --nMM_MERMPLAN_09 
                              NULL, --nMM_MERMPRCO_10 
                              NULL, --nMM_MERMPLAN_EXESO_10 
                              NULL, --nMM_MERMPLAN_10 
                              NULL, --nMM_MERMPRCO 
                              NULL, --nMM_MERMPLAN_EXESO 
                              NULL); --nMM_MERMPLAN
               ELSE
                  --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_EXESO_07 := t_MATERIAL(rMaterial_B.IDENTIFICADOR).Ancho - t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_07;
                  P_MATERIAL(rMaterial_B,'U',
                              NULL,--nCantProd
                              NULL,--nCantCons_E
                              NULL,--nCantCons
                              NULL,--nCantAjus
                              NULL,--nAncho
                              NULL,--nFACTOR_CONVERSION_M2_KG
                              NULL,--nPrecio_ML_E
                              NULL,--vLog_Precio
                              NULL,--nMermEnhe_E
                              NULL,--nMermEnhe
                              NULL,--nMermAjus_E
                              NULL,--nMermAjus
                              NULL,--nMermCabo_E
                              NULL,--nMermCabo
                              NULL,--nMermPico_E
                              NULL,--nMermPico
                              NULL,--nMermTita
                              NULL,--nMermSane
                              NULL,--nCantCons_Bobinas
                              --
                              NULL, --nCONTFSMU_01 
                              NULL, --nCANTFSMU_01 
                              NULL, --nCATOFSMU 
                              NULL, --nCONTFSMU_02 
                              NULL, --nCANTFSMU_02 
                              NULL, --nCONTFSMU_03 
                              NULL, --nCANTFSMU_03 
                              NULL, --nCONTFSMU_04 
                              NULL, --nCANTFSMU_04 
                              NULL, --nCONTFSMU_05 
                              NULL, --nCANTFSMU_05 
                              NULL, --nCONTFSMU_06 
                              NULL, --nCANTFSMU_06 
                              NULL, --nCONTFSMU_07 
                              NULL, --nCANTFSMU_07 
                              NULL, --nCONTFSMU_08 
                              NULL, --nCANTFSMU_08 
                              NULL, --nCONTFSMU_09 
                              NULL, --nCANTFSMU_09 
                              NULL, --nCONTFSMU_10 
                              NULL, --nCANTFSMU_10 
                              NULL, --nANCHO_BUENO_TOTAL_01 
                              NULL, --nANCHO_BUENO_OT_01 
                              NULL, --nANCHO_BUENO_TOTAL_02 
                              NULL, --nANCHO_BUENO_OT_02 
                              NULL, --nANCHO_BUENO_TOTAL_03 
                              NULL, --nANCHO_BUENO_OT_03 
                              NULL, --nANCHO_BUENO_TOTAL_04 
                              NULL, --nANCHO_BUENO_OT_04 
                              NULL, --nANCHO_BUENO_TOTAL_05 
                              NULL, --nANCHO_BUENO_OT_05 
                              NULL, --nANCHO_BUENO_TOTAL_06 
                              NULL, --nANCHO_BUENO_OT_06 
                              NULL, --nANCHO_BUENO_TOTAL_07 
                              NULL, --nANCHO_BUENO_OT_07 
                              NULL, --nANCHO_BUENO_TOTAL_08 
                              NULL, --nANCHO_BUENO_OT_08 
                              NULL, --nANCHO_BUENO_TOTAL_09 
                              NULL, --nANCHO_BUENO_OT_09 
                              NULL, --nANCHO_BUENO_TOTAL_10 
                              NULL, --nANCHO_BUENO_OT_10 
                              NULL, --nANCHO_BUENO_TOTAL 
                              NULL, --nANCHO_BUENO_OT 
                              NULL, --nNUMECORT 
                              NULL, --nMM_MERMPRCO_01 
                              NULL, --nMM_MERMPLAN_EXESO_01 
                              NULL, --nMM_MERMPLAN_01 
                              NULL, --nMM_MERMPRCO_02 
                              NULL, --nMM_MERMPLAN_EXESO_02 
                              NULL, --nMM_MERMPLAN_02 
                              NULL, --nMM_MERMPRCO_03 
                              NULL, --nMM_MERMPLAN_EXESO_03 
                              NULL, --nMM_MERMPLAN_03 
                              NULL, --nMM_MERMPRCO_04 
                              NULL, --nMM_MERMPLAN_EXESO_04 
                              NULL, --nMM_MERMPLAN_04 
                              NULL, --nMM_MERMPRCO_05 
                              NULL, --nMM_MERMPLAN_EXESO_05 
                              NULL, --nMM_MERMPLAN_05 
                              NULL, --nMM_MERMPRCO_06 
                              NULL, --nMM_MERMPLAN_EXESO_06 
                              NULL, --nMM_MERMPLAN_06 
                              NULL, --nMM_MERMPRCO_07 
                              rMaterial_B.Ancho - rMaterial_B.ANCHO_BUENO_TOTAL_07, --nMM_MERMPLAN_EXESO_07 
                              0, --nMM_MERMPLAN_07 
                              NULL, --nMM_MERMPRCO_08 
                              NULL, --nMM_MERMPLAN_EXESO_08 
                              NULL, --nMM_MERMPLAN_08 
                              NULL, --nMM_MERMPRCO_09 
                              NULL, --nMM_MERMPLAN_EXESO_09 
                              NULL, --nMM_MERMPLAN_09 
                              NULL, --nMM_MERMPRCO_10 
                              NULL, --nMM_MERMPLAN_EXESO_10 
                              NULL, --nMM_MERMPLAN_10 
                              NULL, --nMM_MERMPRCO 
                              NULL, --nMM_MERMPLAN_EXESO 
                              NULL); --nMM_MERMPLAN
               END IF;
               --
               --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_07 := 0;
            END IF;
         END IF;
         ------------------------------------------------------------
         --FIN BUSQUEDA DE MM DE MERMAS DE PLANIFICACION Y EXESOS 7--
         ------------------------------------------------------------
         --------------------------------------------------------
         --BUSQUEDA DE MM DE MERMAS DE PLANIFICACION Y EXESOS 8--
         --------------------------------------------------------
         --IF t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_08 IS NOT NULL AND rMATERIAL_B.Tip_Arti != vTIARREST THEN 
         IF rMaterial_B.ANCHO_BUENO_TOTAL_08 IS NOT NULL AND rMATERIAL_B.Tip_Arti != vTIARREST THEN 
            --Busqueda de Exceso de Merma de Planificación
            IF rMATERIAL_B.MM_MERMPLAN_08 IS NOT NULL THEN 
               --IF t_MATERIAL(rMaterial_B.IDENTIFICADOR).Ancho - t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_08 > rMATERIAL_B.MM_MERMPLAN_08 THEN
               IF rMaterial_B.Ancho - rMaterial_B.ANCHO_BUENO_TOTAL_08 > rMATERIAL_B.MM_MERMPLAN_08 THEN
                  IF rMaterial_B.PRE_CORTE = 'S' THEN
                     --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPRCO_08 := t_MATERIAL(rMaterial_B.IDENTIFICADOR).Ancho - t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_08 - rMATERIAL_B.MM_MERMPLAN_08;
                     --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_EXESO_08 := 0;
                     --
                     P_MATERIAL(rMaterial_B,'U',
                                 NULL,--nCantProd
                                 NULL,--nCantCons_E
                                 NULL,--nCantCons
                                 NULL,--nCantAjus
                                 NULL,--nAncho
                                 NULL,--nFACTOR_CONVERSION_M2_KG
                                 NULL,--nPrecio_ML_E
                                 NULL,--vLog_Precio
                                 NULL,--nMermEnhe_E
                                 NULL,--nMermEnhe
                                 NULL,--nMermAjus_E
                                 NULL,--nMermAjus
                                 NULL,--nMermCabo_E
                                 NULL,--nMermCabo
                                 NULL,--nMermPico_E
                                 NULL,--nMermPico
                                 NULL,--nMermTita
                                 NULL,--nMermSane
                                 NULL,--nCantCons_Bobinas
                                 --
                                 NULL, --nCONTFSMU_01 
                                 NULL, --nCANTFSMU_01 
                                 NULL, --nCATOFSMU 
                                 NULL, --nCONTFSMU_02 
                                 NULL, --nCANTFSMU_02 
                                 NULL, --nCONTFSMU_03 
                                 NULL, --nCANTFSMU_03 
                                 NULL, --nCONTFSMU_04 
                                 NULL, --nCANTFSMU_04 
                                 NULL, --nCONTFSMU_05 
                                 NULL, --nCANTFSMU_05 
                                 NULL, --nCONTFSMU_06 
                                 NULL, --nCANTFSMU_06 
                                 NULL, --nCONTFSMU_07 
                                 NULL, --nCANTFSMU_07 
                                 NULL, --nCONTFSMU_08 
                                 NULL, --nCANTFSMU_08 
                                 NULL, --nCONTFSMU_09 
                                 NULL, --nCANTFSMU_09 
                                 NULL, --nCONTFSMU_10 
                                 NULL, --nCANTFSMU_10 
                                 NULL, --nANCHO_BUENO_TOTAL_01 
                                 NULL, --nANCHO_BUENO_OT_01 
                                 NULL, --nANCHO_BUENO_TOTAL_02 
                                 NULL, --nANCHO_BUENO_OT_02 
                                 NULL, --nANCHO_BUENO_TOTAL_03 
                                 NULL, --nANCHO_BUENO_OT_03 
                                 NULL, --nANCHO_BUENO_TOTAL_04 
                                 NULL, --nANCHO_BUENO_OT_04 
                                 NULL, --nANCHO_BUENO_TOTAL_05 
                                 NULL, --nANCHO_BUENO_OT_05 
                                 NULL, --nANCHO_BUENO_TOTAL_06 
                                 NULL, --nANCHO_BUENO_OT_06 
                                 NULL, --nANCHO_BUENO_TOTAL_07 
                                 NULL, --nANCHO_BUENO_OT_07 
                                 NULL, --nANCHO_BUENO_TOTAL_08 
                                 NULL, --nANCHO_BUENO_OT_08 
                                 NULL, --nANCHO_BUENO_TOTAL_09 
                                 NULL, --nANCHO_BUENO_OT_09 
                                 NULL, --nANCHO_BUENO_TOTAL_10 
                                 NULL, --nANCHO_BUENO_OT_10 
                                 NULL, --nANCHO_BUENO_TOTAL 
                                 NULL, --nANCHO_BUENO_OT 
                                 NULL, --nNUMECORT 
                                 NULL, --nMM_MERMPRCO_01 
                                 NULL, --nMM_MERMPLAN_EXESO_01 
                                 NULL, --nMM_MERMPLAN_01 
                                 NULL, --nMM_MERMPRCO_02 
                                 NULL, --nMM_MERMPLAN_EXESO_02 
                                 NULL, --nMM_MERMPLAN_02 
                                 NULL, --nMM_MERMPRCO_03 
                                 NULL, --nMM_MERMPLAN_EXESO_03 
                                 NULL, --nMM_MERMPLAN_03 
                                 NULL, --nMM_MERMPRCO_04 
                                 NULL, --nMM_MERMPLAN_EXESO_04 
                                 NULL, --nMM_MERMPLAN_04 
                                 NULL, --nMM_MERMPRCO_05 
                                 NULL, --nMM_MERMPLAN_EXESO_05 
                                 NULL, --nMM_MERMPLAN_05 
                                 NULL, --nMM_MERMPRCO_06 
                                 NULL, --nMM_MERMPLAN_EXESO_06 
                                 NULL, --nMM_MERMPLAN_06 
                                 NULL, --nMM_MERMPRCO_07 
                                 NULL, --nMM_MERMPLAN_EXESO_07 
                                 NULL, --nMM_MERMPLAN_07 
                                 rMaterial_B.Ancho - rMaterial_B.ANCHO_BUENO_TOTAL_08 - rMATERIAL_B.MM_MERMPLAN_08, --nMM_MERMPRCO_08 
                                 0, --nMM_MERMPLAN_EXESO_08 
                                 NULL, --nMM_MERMPLAN_08 
                                 NULL, --nMM_MERMPRCO_09 
                                 NULL, --nMM_MERMPLAN_EXESO_09 
                                 NULL, --nMM_MERMPLAN_09 
                                 NULL, --nMM_MERMPRCO_10 
                                 NULL, --nMM_MERMPLAN_EXESO_10 
                                 NULL, --nMM_MERMPLAN_10 
                                 NULL, --nMM_MERMPRCO 
                                 NULL, --nMM_MERMPLAN_EXESO 
                                 NULL); --nMM_MERMPLAN
                  ELSE
                     --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_EXESO_08 := t_MATERIAL(rMaterial_B.IDENTIFICADOR).Ancho - t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_08 - rMATERIAL_B.MM_MERMPLAN_08;
                     --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPRCO_08 := 0;
                     --
                     P_MATERIAL(rMaterial_B,'U',
                                 NULL,--nCantProd
                                 NULL,--nCantCons_E
                                 NULL,--nCantCons
                                 NULL,--nCantAjus
                                 NULL,--nAncho
                                 NULL,--nFACTOR_CONVERSION_M2_KG
                                 NULL,--nPrecio_ML_E
                                 NULL,--vLog_Precio
                                 NULL,--nMermEnhe_E
                                 NULL,--nMermEnhe
                                 NULL,--nMermAjus_E
                                 NULL,--nMermAjus
                                 NULL,--nMermCabo_E
                                 NULL,--nMermCabo
                                 NULL,--nMermPico_E
                                 NULL,--nMermPico
                                 NULL,--nMermTita
                                 NULL,--nMermSane
                                 NULL,--nCantCons_Bobinas
                                 --
                                 NULL, --nCONTFSMU_01 
                                 NULL, --nCANTFSMU_01 
                                 NULL, --nCATOFSMU 
                                 NULL, --nCONTFSMU_02 
                                 NULL, --nCANTFSMU_02 
                                 NULL, --nCONTFSMU_03 
                                 NULL, --nCANTFSMU_03 
                                 NULL, --nCONTFSMU_04 
                                 NULL, --nCANTFSMU_04 
                                 NULL, --nCONTFSMU_05 
                                 NULL, --nCANTFSMU_05 
                                 NULL, --nCONTFSMU_06 
                                 NULL, --nCANTFSMU_06 
                                 NULL, --nCONTFSMU_07 
                                 NULL, --nCANTFSMU_07 
                                 NULL, --nCONTFSMU_08 
                                 NULL, --nCANTFSMU_08 
                                 NULL, --nCONTFSMU_09 
                                 NULL, --nCANTFSMU_09 
                                 NULL, --nCONTFSMU_10 
                                 NULL, --nCANTFSMU_10 
                                 NULL, --nANCHO_BUENO_TOTAL_01 
                                 NULL, --nANCHO_BUENO_OT_01 
                                 NULL, --nANCHO_BUENO_TOTAL_02 
                                 NULL, --nANCHO_BUENO_OT_02 
                                 NULL, --nANCHO_BUENO_TOTAL_03 
                                 NULL, --nANCHO_BUENO_OT_03 
                                 NULL, --nANCHO_BUENO_TOTAL_04 
                                 NULL, --nANCHO_BUENO_OT_04 
                                 NULL, --nANCHO_BUENO_TOTAL_05 
                                 NULL, --nANCHO_BUENO_OT_05 
                                 NULL, --nANCHO_BUENO_TOTAL_06 
                                 NULL, --nANCHO_BUENO_OT_06 
                                 NULL, --nANCHO_BUENO_TOTAL_07 
                                 NULL, --nANCHO_BUENO_OT_07 
                                 NULL, --nANCHO_BUENO_TOTAL_08 
                                 NULL, --nANCHO_BUENO_OT_08 
                                 NULL, --nANCHO_BUENO_TOTAL_09 
                                 NULL, --nANCHO_BUENO_OT_09 
                                 NULL, --nANCHO_BUENO_TOTAL_10 
                                 NULL, --nANCHO_BUENO_OT_10 
                                 NULL, --nANCHO_BUENO_TOTAL 
                                 NULL, --nANCHO_BUENO_OT 
                                 NULL, --nNUMECORT 
                                 NULL, --nMM_MERMPRCO_01 
                                 NULL, --nMM_MERMPLAN_EXESO_01 
                                 NULL, --nMM_MERMPLAN_01 
                                 NULL, --nMM_MERMPRCO_02 
                                 NULL, --nMM_MERMPLAN_EXESO_02 
                                 NULL, --nMM_MERMPLAN_02 
                                 NULL, --nMM_MERMPRCO_03 
                                 NULL, --nMM_MERMPLAN_EXESO_03 
                                 NULL, --nMM_MERMPLAN_03 
                                 NULL, --nMM_MERMPRCO_04 
                                 NULL, --nMM_MERMPLAN_EXESO_04 
                                 NULL, --nMM_MERMPLAN_04 
                                 NULL, --nMM_MERMPRCO_05 
                                 NULL, --nMM_MERMPLAN_EXESO_05 
                                 NULL, --nMM_MERMPLAN_05 
                                 NULL, --nMM_MERMPRCO_06 
                                 NULL, --nMM_MERMPLAN_EXESO_06 
                                 NULL, --nMM_MERMPLAN_06 
                                 NULL, --nMM_MERMPRCO_07 
                                 NULL, --nMM_MERMPLAN_EXESO_07 
                                 NULL, --nMM_MERMPLAN_07 
                                 0, --nMM_MERMPRCO_08 
                                 rMaterial_B.Ancho - rMaterial_B.ANCHO_BUENO_TOTAL_08 - rMATERIAL_B.MM_MERMPLAN_08, --nMM_MERMPLAN_EXESO_08 
                                 NULL, --nMM_MERMPLAN_08 
                                 NULL, --nMM_MERMPRCO_09 
                                 NULL, --nMM_MERMPLAN_EXESO_09 
                                 NULL, --nMM_MERMPLAN_09 
                                 NULL, --nMM_MERMPRCO_10 
                                 NULL, --nMM_MERMPLAN_EXESO_10 
                                 NULL, --nMM_MERMPLAN_10 
                                 NULL, --nMM_MERMPRCO 
                                 NULL, --nMM_MERMPLAN_EXESO 
                                 NULL); --nMM_MERMPLAN
                  END IF;
               ELSE
                  --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_EXESO_08 := 0;
                  --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPRCO_08 := 0;
                  --La Merma de Planificación fue menor a lo Estandar / Real (SE ACTUALIZA: YA NO SE BASA EN LA CONFIGURACION)
                  --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_08 := t_MATERIAL(rMaterial_B.IDENTIFICADOR).Ancho - t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_08;
                  P_MATERIAL(rMaterial_B,'U',
                              NULL,--nCantProd
                              NULL,--nCantCons_E
                              NULL,--nCantCons
                              NULL,--nCantAjus
                              NULL,--nAncho
                              NULL,--nFACTOR_CONVERSION_M2_KG
                              NULL,--nPrecio_ML_E
                              NULL,--vLog_Precio
                              NULL,--nMermEnhe_E
                              NULL,--nMermEnhe
                              NULL,--nMermAjus_E
                              NULL,--nMermAjus
                              NULL,--nMermCabo_E
                              NULL,--nMermCabo
                              NULL,--nMermPico_E
                              NULL,--nMermPico
                              NULL,--nMermTita
                              NULL,--nMermSane
                              NULL,--nCantCons_Bobinas
                              --
                              NULL, --nCONTFSMU_01 
                              NULL, --nCANTFSMU_01 
                              NULL, --nCATOFSMU 
                              NULL, --nCONTFSMU_02 
                              NULL, --nCANTFSMU_02 
                              NULL, --nCONTFSMU_03 
                              NULL, --nCANTFSMU_03 
                              NULL, --nCONTFSMU_04 
                              NULL, --nCANTFSMU_04 
                              NULL, --nCONTFSMU_05 
                              NULL, --nCANTFSMU_05 
                              NULL, --nCONTFSMU_06 
                              NULL, --nCANTFSMU_06 
                              NULL, --nCONTFSMU_07 
                              NULL, --nCANTFSMU_07 
                              NULL, --nCONTFSMU_08 
                              NULL, --nCANTFSMU_08 
                              NULL, --nCONTFSMU_09 
                              NULL, --nCANTFSMU_09 
                              NULL, --nCONTFSMU_10 
                              NULL, --nCANTFSMU_10 
                              NULL, --nANCHO_BUENO_TOTAL_01 
                              NULL, --nANCHO_BUENO_OT_01 
                              NULL, --nANCHO_BUENO_TOTAL_02 
                              NULL, --nANCHO_BUENO_OT_02 
                              NULL, --nANCHO_BUENO_TOTAL_03 
                              NULL, --nANCHO_BUENO_OT_03 
                              NULL, --nANCHO_BUENO_TOTAL_04 
                              NULL, --nANCHO_BUENO_OT_04 
                              NULL, --nANCHO_BUENO_TOTAL_05 
                              NULL, --nANCHO_BUENO_OT_05 
                              NULL, --nANCHO_BUENO_TOTAL_06 
                              NULL, --nANCHO_BUENO_OT_06 
                              NULL, --nANCHO_BUENO_TOTAL_07 
                              NULL, --nANCHO_BUENO_OT_07 
                              NULL, --nANCHO_BUENO_TOTAL_08 
                              NULL, --nANCHO_BUENO_OT_08 
                              NULL, --nANCHO_BUENO_TOTAL_09 
                              NULL, --nANCHO_BUENO_OT_09 
                              NULL, --nANCHO_BUENO_TOTAL_10 
                              NULL, --nANCHO_BUENO_OT_10 
                              NULL, --nANCHO_BUENO_TOTAL 
                              NULL, --nANCHO_BUENO_OT 
                              NULL, --nNUMECORT 
                              NULL, --nMM_MERMPRCO_01 
                              NULL, --nMM_MERMPLAN_EXESO_01 
                              NULL, --nMM_MERMPLAN_01 
                              NULL, --nMM_MERMPRCO_02 
                              NULL, --nMM_MERMPLAN_EXESO_02 
                              NULL, --nMM_MERMPLAN_02 
                              NULL, --nMM_MERMPRCO_03 
                              NULL, --nMM_MERMPLAN_EXESO_03 
                              NULL, --nMM_MERMPLAN_03 
                              NULL, --nMM_MERMPRCO_04 
                              NULL, --nMM_MERMPLAN_EXESO_04 
                              NULL, --nMM_MERMPLAN_04 
                              NULL, --nMM_MERMPRCO_05 
                              NULL, --nMM_MERMPLAN_EXESO_05 
                              NULL, --nMM_MERMPLAN_05 
                              NULL, --nMM_MERMPRCO_06 
                              NULL, --nMM_MERMPLAN_EXESO_06 
                              NULL, --nMM_MERMPLAN_06 
                              NULL, --nMM_MERMPRCO_07 
                              NULL, --nMM_MERMPLAN_EXESO_07 
                              NULL, --nMM_MERMPLAN_07 
                              0, --nMM_MERMPRCO_08 
                              0, --nMM_MERMPLAN_EXESO_08 
                              rMaterial_B.Ancho - rMaterial_B.ANCHO_BUENO_TOTAL_08, --nMM_MERMPLAN_08 
                              NULL, --nMM_MERMPRCO_09 
                              NULL, --nMM_MERMPLAN_EXESO_09 
                              NULL, --nMM_MERMPLAN_09 
                              NULL, --nMM_MERMPRCO_10 
                              NULL, --nMM_MERMPLAN_EXESO_10 
                              NULL, --nMM_MERMPLAN_10 
                              NULL, --nMM_MERMPRCO 
                              NULL, --nMM_MERMPLAN_EXESO 
                              NULL); --nMM_MERMPLAN
               END IF;
            ELSE--Si no existe la Merma Planificada Estandar / Real
               --Se asigna la merma encontrada a Excesos o Pre_Corte ya que no fue Planificada como Estandar
               IF rMaterial_B.PRE_CORTE = 'S' THEN
                  --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPRCO_08 := t_MATERIAL(rMaterial_B.IDENTIFICADOR).Ancho - t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_08;
                  P_MATERIAL(rMaterial_B,'U',
                              NULL,--nCantProd
                              NULL,--nCantCons_E
                              NULL,--nCantCons
                              NULL,--nCantAjus
                              NULL,--nAncho
                              NULL,--nFACTOR_CONVERSION_M2_KG
                              NULL,--nPrecio_ML_E
                              NULL,--vLog_Precio
                              NULL,--nMermEnhe_E
                              NULL,--nMermEnhe
                              NULL,--nMermAjus_E
                              NULL,--nMermAjus
                              NULL,--nMermCabo_E
                              NULL,--nMermCabo
                              NULL,--nMermPico_E
                              NULL,--nMermPico
                              NULL,--nMermTita
                              NULL,--nMermSane
                              NULL,--nCantCons_Bobinas
                              --
                              NULL, --nCONTFSMU_01 
                              NULL, --nCANTFSMU_01 
                              NULL, --nCATOFSMU 
                              NULL, --nCONTFSMU_02 
                              NULL, --nCANTFSMU_02 
                              NULL, --nCONTFSMU_03 
                              NULL, --nCANTFSMU_03 
                              NULL, --nCONTFSMU_04 
                              NULL, --nCANTFSMU_04 
                              NULL, --nCONTFSMU_05 
                              NULL, --nCANTFSMU_05 
                              NULL, --nCONTFSMU_06 
                              NULL, --nCANTFSMU_06 
                              NULL, --nCONTFSMU_07 
                              NULL, --nCANTFSMU_07 
                              NULL, --nCONTFSMU_08 
                              NULL, --nCANTFSMU_08 
                              NULL, --nCONTFSMU_09 
                              NULL, --nCANTFSMU_09 
                              NULL, --nCONTFSMU_10 
                              NULL, --nCANTFSMU_10 
                              NULL, --nANCHO_BUENO_TOTAL_01 
                              NULL, --nANCHO_BUENO_OT_01 
                              NULL, --nANCHO_BUENO_TOTAL_02 
                              NULL, --nANCHO_BUENO_OT_02 
                              NULL, --nANCHO_BUENO_TOTAL_03 
                              NULL, --nANCHO_BUENO_OT_03 
                              NULL, --nANCHO_BUENO_TOTAL_04 
                              NULL, --nANCHO_BUENO_OT_04 
                              NULL, --nANCHO_BUENO_TOTAL_05 
                              NULL, --nANCHO_BUENO_OT_05 
                              NULL, --nANCHO_BUENO_TOTAL_06 
                              NULL, --nANCHO_BUENO_OT_06 
                              NULL, --nANCHO_BUENO_TOTAL_07 
                              NULL, --nANCHO_BUENO_OT_07 
                              NULL, --nANCHO_BUENO_TOTAL_08 
                              NULL, --nANCHO_BUENO_OT_08 
                              NULL, --nANCHO_BUENO_TOTAL_09 
                              NULL, --nANCHO_BUENO_OT_09 
                              NULL, --nANCHO_BUENO_TOTAL_10 
                              NULL, --nANCHO_BUENO_OT_10 
                              NULL, --nANCHO_BUENO_TOTAL 
                              NULL, --nANCHO_BUENO_OT 
                              NULL, --nNUMECORT 
                              NULL, --nMM_MERMPRCO_01 
                              NULL, --nMM_MERMPLAN_EXESO_01 
                              NULL, --nMM_MERMPLAN_01 
                              NULL, --nMM_MERMPRCO_02 
                              NULL, --nMM_MERMPLAN_EXESO_02 
                              NULL, --nMM_MERMPLAN_02 
                              NULL, --nMM_MERMPRCO_03 
                              NULL, --nMM_MERMPLAN_EXESO_03 
                              NULL, --nMM_MERMPLAN_03 
                              NULL, --nMM_MERMPRCO_04 
                              NULL, --nMM_MERMPLAN_EXESO_04 
                              NULL, --nMM_MERMPLAN_04 
                              NULL, --nMM_MERMPRCO_05 
                              NULL, --nMM_MERMPLAN_EXESO_05 
                              NULL, --nMM_MERMPLAN_05 
                              NULL, --nMM_MERMPRCO_06 
                              NULL, --nMM_MERMPLAN_EXESO_06 
                              NULL, --nMM_MERMPLAN_06 
                              NULL, --nMM_MERMPRCO_07 
                              NULL, --nMM_MERMPLAN_EXESO_07 
                              NULL, --nMM_MERMPLAN_07 
                              rMaterial_B.Ancho - rMaterial_B.ANCHO_BUENO_TOTAL_08, --nMM_MERMPRCO_08 
                              NULL, --nMM_MERMPLAN_EXESO_08 
                              0, --nMM_MERMPLAN_08 
                              NULL, --nMM_MERMPRCO_09 
                              NULL, --nMM_MERMPLAN_EXESO_09 
                              NULL, --nMM_MERMPLAN_09 
                              NULL, --nMM_MERMPRCO_10 
                              NULL, --nMM_MERMPLAN_EXESO_10 
                              NULL, --nMM_MERMPLAN_10 
                              NULL, --nMM_MERMPRCO 
                              NULL, --nMM_MERMPLAN_EXESO 
                              NULL); --nMM_MERMPLAN
               ELSE
                  --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_EXESO_08 := t_MATERIAL(rMaterial_B.IDENTIFICADOR).Ancho - t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_08;
                  P_MATERIAL(rMaterial_B,'U',
                              NULL,--nCantProd
                              NULL,--nCantCons_E
                              NULL,--nCantCons
                              NULL,--nCantAjus
                              NULL,--nAncho
                              NULL,--nFACTOR_CONVERSION_M2_KG
                              NULL,--nPrecio_ML_E
                              NULL,--vLog_Precio
                              NULL,--nMermEnhe_E
                              NULL,--nMermEnhe
                              NULL,--nMermAjus_E
                              NULL,--nMermAjus
                              NULL,--nMermCabo_E
                              NULL,--nMermCabo
                              NULL,--nMermPico_E
                              NULL,--nMermPico
                              NULL,--nMermTita
                              NULL,--nMermSane
                              NULL,--nCantCons_Bobinas
                              --
                              NULL, --nCONTFSMU_01 
                              NULL, --nCANTFSMU_01 
                              NULL, --nCATOFSMU 
                              NULL, --nCONTFSMU_02 
                              NULL, --nCANTFSMU_02 
                              NULL, --nCONTFSMU_03 
                              NULL, --nCANTFSMU_03 
                              NULL, --nCONTFSMU_04 
                              NULL, --nCANTFSMU_04 
                              NULL, --nCONTFSMU_05 
                              NULL, --nCANTFSMU_05 
                              NULL, --nCONTFSMU_06 
                              NULL, --nCANTFSMU_06 
                              NULL, --nCONTFSMU_07 
                              NULL, --nCANTFSMU_07 
                              NULL, --nCONTFSMU_08 
                              NULL, --nCANTFSMU_08 
                              NULL, --nCONTFSMU_09 
                              NULL, --nCANTFSMU_09 
                              NULL, --nCONTFSMU_10 
                              NULL, --nCANTFSMU_10 
                              NULL, --nANCHO_BUENO_TOTAL_01 
                              NULL, --nANCHO_BUENO_OT_01 
                              NULL, --nANCHO_BUENO_TOTAL_02 
                              NULL, --nANCHO_BUENO_OT_02 
                              NULL, --nANCHO_BUENO_TOTAL_03 
                              NULL, --nANCHO_BUENO_OT_03 
                              NULL, --nANCHO_BUENO_TOTAL_04 
                              NULL, --nANCHO_BUENO_OT_04 
                              NULL, --nANCHO_BUENO_TOTAL_05 
                              NULL, --nANCHO_BUENO_OT_05 
                              NULL, --nANCHO_BUENO_TOTAL_06 
                              NULL, --nANCHO_BUENO_OT_06 
                              NULL, --nANCHO_BUENO_TOTAL_07 
                              NULL, --nANCHO_BUENO_OT_07 
                              NULL, --nANCHO_BUENO_TOTAL_08 
                              NULL, --nANCHO_BUENO_OT_08 
                              NULL, --nANCHO_BUENO_TOTAL_09 
                              NULL, --nANCHO_BUENO_OT_09 
                              NULL, --nANCHO_BUENO_TOTAL_10 
                              NULL, --nANCHO_BUENO_OT_10 
                              NULL, --nANCHO_BUENO_TOTAL 
                              NULL, --nANCHO_BUENO_OT 
                              NULL, --nNUMECORT 
                              NULL, --nMM_MERMPRCO_01 
                              NULL, --nMM_MERMPLAN_EXESO_01 
                              NULL, --nMM_MERMPLAN_01 
                              NULL, --nMM_MERMPRCO_02 
                              NULL, --nMM_MERMPLAN_EXESO_02 
                              NULL, --nMM_MERMPLAN_02 
                              NULL, --nMM_MERMPRCO_03 
                              NULL, --nMM_MERMPLAN_EXESO_03 
                              NULL, --nMM_MERMPLAN_03 
                              NULL, --nMM_MERMPRCO_04 
                              NULL, --nMM_MERMPLAN_EXESO_04 
                              NULL, --nMM_MERMPLAN_04 
                              NULL, --nMM_MERMPRCO_05 
                              NULL, --nMM_MERMPLAN_EXESO_05 
                              NULL, --nMM_MERMPLAN_05 
                              NULL, --nMM_MERMPRCO_06 
                              NULL, --nMM_MERMPLAN_EXESO_06 
                              NULL, --nMM_MERMPLAN_06 
                              NULL, --nMM_MERMPRCO_07 
                              NULL, --nMM_MERMPLAN_EXESO_07 
                              NULL, --nMM_MERMPLAN_07 
                              NULL, --nMM_MERMPRCO_08 
                              rMaterial_B.Ancho - rMaterial_B.ANCHO_BUENO_TOTAL_08, --nMM_MERMPLAN_EXESO_08 
                              0, --nMM_MERMPLAN_08 
                              NULL, --nMM_MERMPRCO_09 
                              NULL, --nMM_MERMPLAN_EXESO_09 
                              NULL, --nMM_MERMPLAN_09 
                              NULL, --nMM_MERMPRCO_10 
                              NULL, --nMM_MERMPLAN_EXESO_10 
                              NULL, --nMM_MERMPLAN_10 
                              NULL, --nMM_MERMPRCO 
                              NULL, --nMM_MERMPLAN_EXESO 
                              NULL); --nMM_MERMPLAN
               END IF;
               --
               --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_08 := 0;
            END IF;
         END IF;
         ------------------------------------------------------------
         --FIN BUSQUEDA DE MM DE MERMAS DE PLANIFICACION Y EXESOS 8--
         ------------------------------------------------------------
         --------------------------------------------------------
         --BUSQUEDA DE MM DE MERMAS DE PLANIFICACION Y EXESOS 9--
         --------------------------------------------------------
         --IF t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_09 IS NOT NULL AND rMATERIAL_B.Tip_Arti != vTIARREST THEN 
         IF rMaterial_B.ANCHO_BUENO_TOTAL_09 IS NOT NULL AND rMATERIAL_B.Tip_Arti != vTIARREST THEN 
            --Busqueda de Exceso de Merma de Planificación
            IF rMATERIAL_B.MM_MERMPLAN_09 IS NOT NULL THEN 
               --IF t_MATERIAL(rMaterial_B.IDENTIFICADOR).Ancho - t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_09 > rMATERIAL_B.MM_MERMPLAN_09 THEN
               IF rMaterial_B.Ancho - rMaterial_B.ANCHO_BUENO_TOTAL_09 > rMATERIAL_B.MM_MERMPLAN_09 THEN
                  IF rMaterial_B.PRE_CORTE = 'S' THEN
                     --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPRCO_09 := t_MATERIAL(rMaterial_B.IDENTIFICADOR).Ancho - t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_09 - rMATERIAL_B.MM_MERMPLAN_09;
                     --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_EXESO_09 := 0;
                     --
                     P_MATERIAL(rMaterial_B,'U',
                                 NULL,--nCantProd
                                 NULL,--nCantCons_E
                                 NULL,--nCantCons
                                 NULL,--nCantAjus
                                 NULL,--nAncho
                                 NULL,--nFACTOR_CONVERSION_M2_KG
                                 NULL,--nPrecio_ML_E
                                 NULL,--vLog_Precio
                                 NULL,--nMermEnhe_E
                                 NULL,--nMermEnhe
                                 NULL,--nMermAjus_E
                                 NULL,--nMermAjus
                                 NULL,--nMermCabo_E
                                 NULL,--nMermCabo
                                 NULL,--nMermPico_E
                                 NULL,--nMermPico
                                 NULL,--nMermTita
                                 NULL,--nMermSane
                                 NULL,--nCantCons_Bobinas
                                 --
                                 NULL, --nCONTFSMU_01 
                                 NULL, --nCANTFSMU_01 
                                 NULL, --nCATOFSMU 
                                 NULL, --nCONTFSMU_02 
                                 NULL, --nCANTFSMU_02 
                                 NULL, --nCONTFSMU_03 
                                 NULL, --nCANTFSMU_03 
                                 NULL, --nCONTFSMU_04 
                                 NULL, --nCANTFSMU_04 
                                 NULL, --nCONTFSMU_05 
                                 NULL, --nCANTFSMU_05 
                                 NULL, --nCONTFSMU_06 
                                 NULL, --nCANTFSMU_06 
                                 NULL, --nCONTFSMU_07 
                                 NULL, --nCANTFSMU_07 
                                 NULL, --nCONTFSMU_08 
                                 NULL, --nCANTFSMU_08 
                                 NULL, --nCONTFSMU_09 
                                 NULL, --nCANTFSMU_09 
                                 NULL, --nCONTFSMU_10 
                                 NULL, --nCANTFSMU_10 
                                 NULL, --nANCHO_BUENO_TOTAL_01 
                                 NULL, --nANCHO_BUENO_OT_01 
                                 NULL, --nANCHO_BUENO_TOTAL_02 
                                 NULL, --nANCHO_BUENO_OT_02 
                                 NULL, --nANCHO_BUENO_TOTAL_03 
                                 NULL, --nANCHO_BUENO_OT_03 
                                 NULL, --nANCHO_BUENO_TOTAL_04 
                                 NULL, --nANCHO_BUENO_OT_04 
                                 NULL, --nANCHO_BUENO_TOTAL_05 
                                 NULL, --nANCHO_BUENO_OT_05 
                                 NULL, --nANCHO_BUENO_TOTAL_06 
                                 NULL, --nANCHO_BUENO_OT_06 
                                 NULL, --nANCHO_BUENO_TOTAL_07 
                                 NULL, --nANCHO_BUENO_OT_07 
                                 NULL, --nANCHO_BUENO_TOTAL_08 
                                 NULL, --nANCHO_BUENO_OT_08 
                                 NULL, --nANCHO_BUENO_TOTAL_09 
                                 NULL, --nANCHO_BUENO_OT_09 
                                 NULL, --nANCHO_BUENO_TOTAL_10 
                                 NULL, --nANCHO_BUENO_OT_10 
                                 NULL, --nANCHO_BUENO_TOTAL 
                                 NULL, --nANCHO_BUENO_OT 
                                 NULL, --nNUMECORT 
                                 NULL, --nMM_MERMPRCO_01 
                                 NULL, --nMM_MERMPLAN_EXESO_01 
                                 NULL, --nMM_MERMPLAN_01 
                                 NULL, --nMM_MERMPRCO_02 
                                 NULL, --nMM_MERMPLAN_EXESO_02 
                                 NULL, --nMM_MERMPLAN_02 
                                 NULL, --nMM_MERMPRCO_03 
                                 NULL, --nMM_MERMPLAN_EXESO_03 
                                 NULL, --nMM_MERMPLAN_03 
                                 NULL, --nMM_MERMPRCO_04 
                                 NULL, --nMM_MERMPLAN_EXESO_04 
                                 NULL, --nMM_MERMPLAN_04 
                                 NULL, --nMM_MERMPRCO_05 
                                 NULL, --nMM_MERMPLAN_EXESO_05 
                                 NULL, --nMM_MERMPLAN_05 
                                 NULL, --nMM_MERMPRCO_06 
                                 NULL, --nMM_MERMPLAN_EXESO_06 
                                 NULL, --nMM_MERMPLAN_06 
                                 NULL, --nMM_MERMPRCO_07 
                                 NULL, --nMM_MERMPLAN_EXESO_07 
                                 NULL, --nMM_MERMPLAN_07 
                                 NULL, --nMM_MERMPRCO_08 
                                 NULL, --nMM_MERMPLAN_EXESO_08 
                                 NULL, --nMM_MERMPLAN_08 
                                 rMaterial_B.Ancho - rMaterial_B.ANCHO_BUENO_TOTAL_09 - rMATERIAL_B.MM_MERMPLAN_09, --nMM_MERMPRCO_09 
                                 0, --nMM_MERMPLAN_EXESO_09 
                                 NULL, --nMM_MERMPLAN_09 
                                 NULL, --nMM_MERMPRCO_10 
                                 NULL, --nMM_MERMPLAN_EXESO_10 
                                 NULL, --nMM_MERMPLAN_10 
                                 NULL, --nMM_MERMPRCO 
                                 NULL, --nMM_MERMPLAN_EXESO 
                                 NULL); --nMM_MERMPLAN
                  ELSE
                     --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_EXESO_09 := t_MATERIAL(rMaterial_B.IDENTIFICADOR).Ancho - t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_09 - rMATERIAL_B.MM_MERMPLAN_09;
                     --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPRCO_09 := 0;
                     --
                     P_MATERIAL(rMaterial_B,'U',
                                 NULL,--nCantProd
                                 NULL,--nCantCons_E
                                 NULL,--nCantCons
                                 NULL,--nCantAjus
                                 NULL,--nAncho
                                 NULL,--nFACTOR_CONVERSION_M2_KG
                                 NULL,--nPrecio_ML_E
                                 NULL,--vLog_Precio
                                 NULL,--nMermEnhe_E
                                 NULL,--nMermEnhe
                                 NULL,--nMermAjus_E
                                 NULL,--nMermAjus
                                 NULL,--nMermCabo_E
                                 NULL,--nMermCabo
                                 NULL,--nMermPico_E
                                 NULL,--nMermPico
                                 NULL,--nMermTita
                                 NULL,--nMermSane
                                 NULL,--nCantCons_Bobinas
                                 --
                                 NULL, --nCONTFSMU_01 
                                 NULL, --nCANTFSMU_01 
                                 NULL, --nCATOFSMU 
                                 NULL, --nCONTFSMU_02 
                                 NULL, --nCANTFSMU_02 
                                 NULL, --nCONTFSMU_03 
                                 NULL, --nCANTFSMU_03 
                                 NULL, --nCONTFSMU_04 
                                 NULL, --nCANTFSMU_04 
                                 NULL, --nCONTFSMU_05 
                                 NULL, --nCANTFSMU_05 
                                 NULL, --nCONTFSMU_06 
                                 NULL, --nCANTFSMU_06 
                                 NULL, --nCONTFSMU_07 
                                 NULL, --nCANTFSMU_07 
                                 NULL, --nCONTFSMU_08 
                                 NULL, --nCANTFSMU_08 
                                 NULL, --nCONTFSMU_09 
                                 NULL, --nCANTFSMU_09 
                                 NULL, --nCONTFSMU_10 
                                 NULL, --nCANTFSMU_10 
                                 NULL, --nANCHO_BUENO_TOTAL_01 
                                 NULL, --nANCHO_BUENO_OT_01 
                                 NULL, --nANCHO_BUENO_TOTAL_02 
                                 NULL, --nANCHO_BUENO_OT_02 
                                 NULL, --nANCHO_BUENO_TOTAL_03 
                                 NULL, --nANCHO_BUENO_OT_03 
                                 NULL, --nANCHO_BUENO_TOTAL_04 
                                 NULL, --nANCHO_BUENO_OT_04 
                                 NULL, --nANCHO_BUENO_TOTAL_05 
                                 NULL, --nANCHO_BUENO_OT_05 
                                 NULL, --nANCHO_BUENO_TOTAL_06 
                                 NULL, --nANCHO_BUENO_OT_06 
                                 NULL, --nANCHO_BUENO_TOTAL_07 
                                 NULL, --nANCHO_BUENO_OT_07 
                                 NULL, --nANCHO_BUENO_TOTAL_08 
                                 NULL, --nANCHO_BUENO_OT_08 
                                 NULL, --nANCHO_BUENO_TOTAL_09 
                                 NULL, --nANCHO_BUENO_OT_09 
                                 NULL, --nANCHO_BUENO_TOTAL_10 
                                 NULL, --nANCHO_BUENO_OT_10 
                                 NULL, --nANCHO_BUENO_TOTAL 
                                 NULL, --nANCHO_BUENO_OT 
                                 NULL, --nNUMECORT 
                                 NULL, --nMM_MERMPRCO_01 
                                 NULL, --nMM_MERMPLAN_EXESO_01 
                                 NULL, --nMM_MERMPLAN_01 
                                 NULL, --nMM_MERMPRCO_02 
                                 NULL, --nMM_MERMPLAN_EXESO_02 
                                 NULL, --nMM_MERMPLAN_02 
                                 NULL, --nMM_MERMPRCO_03 
                                 NULL, --nMM_MERMPLAN_EXESO_03 
                                 NULL, --nMM_MERMPLAN_03 
                                 NULL, --nMM_MERMPRCO_04 
                                 NULL, --nMM_MERMPLAN_EXESO_04 
                                 NULL, --nMM_MERMPLAN_04 
                                 NULL, --nMM_MERMPRCO_05 
                                 NULL, --nMM_MERMPLAN_EXESO_05 
                                 NULL, --nMM_MERMPLAN_05 
                                 NULL, --nMM_MERMPRCO_06 
                                 NULL, --nMM_MERMPLAN_EXESO_06 
                                 NULL, --nMM_MERMPLAN_06 
                                 NULL, --nMM_MERMPRCO_07 
                                 NULL, --nMM_MERMPLAN_EXESO_07 
                                 NULL, --nMM_MERMPLAN_07 
                                 NULL, --nMM_MERMPRCO_08 
                                 NULL, --nMM_MERMPLAN_EXESO_08 
                                 NULL, --nMM_MERMPLAN_08 
                                 0, --nMM_MERMPRCO_09 
                                 rMaterial_B.Ancho - rMaterial_B.ANCHO_BUENO_TOTAL_09 - rMATERIAL_B.MM_MERMPLAN_09, --nMM_MERMPLAN_EXESO_09 
                                 NULL, --nMM_MERMPLAN_09 
                                 NULL, --nMM_MERMPRCO_10 
                                 NULL, --nMM_MERMPLAN_EXESO_10 
                                 NULL, --nMM_MERMPLAN_10 
                                 NULL, --nMM_MERMPRCO 
                                 NULL, --nMM_MERMPLAN_EXESO 
                                 NULL); --nMM_MERMPLAN
                  END IF;
               ELSE
                  --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_EXESO_09 := 0;
                  --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPRCO_09 := 0;
                  --La Merma de Planificación fue menor a lo Estandar / Real (SE ACTUALIZA: YA NO SE BASA EN LA CONFIGURACION)
                  --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_09 := t_MATERIAL(rMaterial_B.IDENTIFICADOR).Ancho - t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_09;
                  P_MATERIAL(rMaterial_B,'U',
                              NULL,--nCantProd
                              NULL,--nCantCons_E
                              NULL,--nCantCons
                              NULL,--nCantAjus
                              NULL,--nAncho
                              NULL,--nFACTOR_CONVERSION_M2_KG
                              NULL,--nPrecio_ML_E
                              NULL,--vLog_Precio
                              NULL,--nMermEnhe_E
                              NULL,--nMermEnhe
                              NULL,--nMermAjus_E
                              NULL,--nMermAjus
                              NULL,--nMermCabo_E
                              NULL,--nMermCabo
                              NULL,--nMermPico_E
                              NULL,--nMermPico
                              NULL,--nMermTita
                              NULL,--nMermSane
                              NULL,--nCantCons_Bobinas
                              --
                              NULL, --nCONTFSMU_01 
                              NULL, --nCANTFSMU_01 
                              NULL, --nCATOFSMU 
                              NULL, --nCONTFSMU_02 
                              NULL, --nCANTFSMU_02 
                              NULL, --nCONTFSMU_03 
                              NULL, --nCANTFSMU_03 
                              NULL, --nCONTFSMU_04 
                              NULL, --nCANTFSMU_04 
                              NULL, --nCONTFSMU_05 
                              NULL, --nCANTFSMU_05 
                              NULL, --nCONTFSMU_06 
                              NULL, --nCANTFSMU_06 
                              NULL, --nCONTFSMU_07 
                              NULL, --nCANTFSMU_07 
                              NULL, --nCONTFSMU_08 
                              NULL, --nCANTFSMU_08 
                              NULL, --nCONTFSMU_09 
                              NULL, --nCANTFSMU_09 
                              NULL, --nCONTFSMU_10 
                              NULL, --nCANTFSMU_10 
                              NULL, --nANCHO_BUENO_TOTAL_01 
                              NULL, --nANCHO_BUENO_OT_01 
                              NULL, --nANCHO_BUENO_TOTAL_02 
                              NULL, --nANCHO_BUENO_OT_02 
                              NULL, --nANCHO_BUENO_TOTAL_03 
                              NULL, --nANCHO_BUENO_OT_03 
                              NULL, --nANCHO_BUENO_TOTAL_04 
                              NULL, --nANCHO_BUENO_OT_04 
                              NULL, --nANCHO_BUENO_TOTAL_05 
                              NULL, --nANCHO_BUENO_OT_05 
                              NULL, --nANCHO_BUENO_TOTAL_06 
                              NULL, --nANCHO_BUENO_OT_06 
                              NULL, --nANCHO_BUENO_TOTAL_07 
                              NULL, --nANCHO_BUENO_OT_07 
                              NULL, --nANCHO_BUENO_TOTAL_08 
                              NULL, --nANCHO_BUENO_OT_08 
                              NULL, --nANCHO_BUENO_TOTAL_09 
                              NULL, --nANCHO_BUENO_OT_09 
                              NULL, --nANCHO_BUENO_TOTAL_10 
                              NULL, --nANCHO_BUENO_OT_10 
                              NULL, --nANCHO_BUENO_TOTAL 
                              NULL, --nANCHO_BUENO_OT 
                              NULL, --nNUMECORT 
                              NULL, --nMM_MERMPRCO_01 
                              NULL, --nMM_MERMPLAN_EXESO_01 
                              NULL, --nMM_MERMPLAN_01 
                              NULL, --nMM_MERMPRCO_02 
                              NULL, --nMM_MERMPLAN_EXESO_02 
                              NULL, --nMM_MERMPLAN_02 
                              NULL, --nMM_MERMPRCO_03 
                              NULL, --nMM_MERMPLAN_EXESO_03 
                              NULL, --nMM_MERMPLAN_03 
                              NULL, --nMM_MERMPRCO_04 
                              NULL, --nMM_MERMPLAN_EXESO_04 
                              NULL, --nMM_MERMPLAN_04 
                              NULL, --nMM_MERMPRCO_05 
                              NULL, --nMM_MERMPLAN_EXESO_05 
                              NULL, --nMM_MERMPLAN_05 
                              NULL, --nMM_MERMPRCO_06 
                              NULL, --nMM_MERMPLAN_EXESO_06 
                              NULL, --nMM_MERMPLAN_06 
                              NULL, --nMM_MERMPRCO_07 
                              NULL, --nMM_MERMPLAN_EXESO_07 
                              NULL, --nMM_MERMPLAN_07 
                              NULL, --nMM_MERMPRCO_08 
                              NULL, --nMM_MERMPLAN_EXESO_08 
                              NULL, --nMM_MERMPLAN_08 
                              0, --nMM_MERMPRCO_09 
                              0, --nMM_MERMPLAN_EXESO_09 
                              rMaterial_B.Ancho - rMaterial_B.ANCHO_BUENO_TOTAL_09, --nMM_MERMPLAN_09 
                              NULL, --nMM_MERMPRCO_10 
                              NULL, --nMM_MERMPLAN_EXESO_10 
                              NULL, --nMM_MERMPLAN_10 
                              NULL, --nMM_MERMPRCO 
                              NULL, --nMM_MERMPLAN_EXESO 
                              NULL); --nMM_MERMPLAN
               END IF;
            ELSE--Si no existe la Merma Planificada Estandar / Real
               --Se asigna la merma encontrada a Excesos o Pre_Corte ya que no fue Planificada como Estandar
               IF rMaterial_B.PRE_CORTE = 'S' THEN
                  --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPRCO_09 := t_MATERIAL(rMaterial_B.IDENTIFICADOR).Ancho - t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_09;
                  P_MATERIAL(rMaterial_B,'U',
                              NULL,--nCantProd
                              NULL,--nCantCons_E
                              NULL,--nCantCons
                              NULL,--nCantAjus
                              NULL,--nAncho
                              NULL,--nFACTOR_CONVERSION_M2_KG
                              NULL,--nPrecio_ML_E
                              NULL,--vLog_Precio
                              NULL,--nMermEnhe_E
                              NULL,--nMermEnhe
                              NULL,--nMermAjus_E
                              NULL,--nMermAjus
                              NULL,--nMermCabo_E
                              NULL,--nMermCabo
                              NULL,--nMermPico_E
                              NULL,--nMermPico
                              NULL,--nMermTita
                              NULL,--nMermSane
                              NULL,--nCantCons_Bobinas
                              --
                              NULL, --nCONTFSMU_01 
                              NULL, --nCANTFSMU_01 
                              NULL, --nCATOFSMU 
                              NULL, --nCONTFSMU_02 
                              NULL, --nCANTFSMU_02 
                              NULL, --nCONTFSMU_03 
                              NULL, --nCANTFSMU_03 
                              NULL, --nCONTFSMU_04 
                              NULL, --nCANTFSMU_04 
                              NULL, --nCONTFSMU_05 
                              NULL, --nCANTFSMU_05 
                              NULL, --nCONTFSMU_06 
                              NULL, --nCANTFSMU_06 
                              NULL, --nCONTFSMU_07 
                              NULL, --nCANTFSMU_07 
                              NULL, --nCONTFSMU_08 
                              NULL, --nCANTFSMU_08 
                              NULL, --nCONTFSMU_09 
                              NULL, --nCANTFSMU_09 
                              NULL, --nCONTFSMU_10 
                              NULL, --nCANTFSMU_10 
                              NULL, --nANCHO_BUENO_TOTAL_01 
                              NULL, --nANCHO_BUENO_OT_01 
                              NULL, --nANCHO_BUENO_TOTAL_02 
                              NULL, --nANCHO_BUENO_OT_02 
                              NULL, --nANCHO_BUENO_TOTAL_03 
                              NULL, --nANCHO_BUENO_OT_03 
                              NULL, --nANCHO_BUENO_TOTAL_04 
                              NULL, --nANCHO_BUENO_OT_04 
                              NULL, --nANCHO_BUENO_TOTAL_05 
                              NULL, --nANCHO_BUENO_OT_05 
                              NULL, --nANCHO_BUENO_TOTAL_06 
                              NULL, --nANCHO_BUENO_OT_06 
                              NULL, --nANCHO_BUENO_TOTAL_07 
                              NULL, --nANCHO_BUENO_OT_07 
                              NULL, --nANCHO_BUENO_TOTAL_08 
                              NULL, --nANCHO_BUENO_OT_08 
                              NULL, --nANCHO_BUENO_TOTAL_09 
                              NULL, --nANCHO_BUENO_OT_09 
                              NULL, --nANCHO_BUENO_TOTAL_10 
                              NULL, --nANCHO_BUENO_OT_10 
                              NULL, --nANCHO_BUENO_TOTAL 
                              NULL, --nANCHO_BUENO_OT 
                              NULL, --nNUMECORT 
                              NULL, --nMM_MERMPRCO_01 
                              NULL, --nMM_MERMPLAN_EXESO_01 
                              NULL, --nMM_MERMPLAN_01 
                              NULL, --nMM_MERMPRCO_02 
                              NULL, --nMM_MERMPLAN_EXESO_02 
                              NULL, --nMM_MERMPLAN_02 
                              NULL, --nMM_MERMPRCO_03 
                              NULL, --nMM_MERMPLAN_EXESO_03 
                              NULL, --nMM_MERMPLAN_03 
                              NULL, --nMM_MERMPRCO_04 
                              NULL, --nMM_MERMPLAN_EXESO_04 
                              NULL, --nMM_MERMPLAN_04 
                              NULL, --nMM_MERMPRCO_05 
                              NULL, --nMM_MERMPLAN_EXESO_05 
                              NULL, --nMM_MERMPLAN_05 
                              NULL, --nMM_MERMPRCO_06 
                              NULL, --nMM_MERMPLAN_EXESO_06 
                              NULL, --nMM_MERMPLAN_06 
                              NULL, --nMM_MERMPRCO_07 
                              NULL, --nMM_MERMPLAN_EXESO_07 
                              NULL, --nMM_MERMPLAN_07 
                              NULL, --nMM_MERMPRCO_08 
                              NULL, --nMM_MERMPLAN_EXESO_08 
                              NULL, --nMM_MERMPLAN_08 
                              rMaterial_B.Ancho - rMaterial_B.ANCHO_BUENO_TOTAL_09, --nMM_MERMPRCO_09 
                              NULL, --nMM_MERMPLAN_EXESO_09 
                              0, --nMM_MERMPLAN_09 
                              NULL, --nMM_MERMPRCO_10 
                              NULL, --nMM_MERMPLAN_EXESO_10 
                              NULL, --nMM_MERMPLAN_10 
                              NULL, --nMM_MERMPRCO 
                              NULL, --nMM_MERMPLAN_EXESO 
                              NULL); --nMM_MERMPLAN
               ELSE
                  --(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_EXESO_09 := t_MATERIAL(rMaterial_B.IDENTIFICADOR).Ancho - t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_09;
                  P_MATERIAL(rMaterial_B,'U',
                              NULL,--nCantProd
                              NULL,--nCantCons_E
                              NULL,--nCantCons
                              NULL,--nCantAjus
                              NULL,--nAncho
                              NULL,--nFACTOR_CONVERSION_M2_KG
                              NULL,--nPrecio_ML_E
                              NULL,--vLog_Precio
                              NULL,--nMermEnhe_E
                              NULL,--nMermEnhe
                              NULL,--nMermAjus_E
                              NULL,--nMermAjus
                              NULL,--nMermCabo_E
                              NULL,--nMermCabo
                              NULL,--nMermPico_E
                              NULL,--nMermPico
                              NULL,--nMermTita
                              NULL,--nMermSane
                              NULL,--nCantCons_Bobinas
                              --
                              NULL, --nCONTFSMU_01 
                              NULL, --nCANTFSMU_01 
                              NULL, --nCATOFSMU 
                              NULL, --nCONTFSMU_02 
                              NULL, --nCANTFSMU_02 
                              NULL, --nCONTFSMU_03 
                              NULL, --nCANTFSMU_03 
                              NULL, --nCONTFSMU_04 
                              NULL, --nCANTFSMU_04 
                              NULL, --nCONTFSMU_05 
                              NULL, --nCANTFSMU_05 
                              NULL, --nCONTFSMU_06 
                              NULL, --nCANTFSMU_06 
                              NULL, --nCONTFSMU_07 
                              NULL, --nCANTFSMU_07 
                              NULL, --nCONTFSMU_08 
                              NULL, --nCANTFSMU_08 
                              NULL, --nCONTFSMU_09 
                              NULL, --nCANTFSMU_09 
                              NULL, --nCONTFSMU_10 
                              NULL, --nCANTFSMU_10 
                              NULL, --nANCHO_BUENO_TOTAL_01 
                              NULL, --nANCHO_BUENO_OT_01 
                              NULL, --nANCHO_BUENO_TOTAL_02 
                              NULL, --nANCHO_BUENO_OT_02 
                              NULL, --nANCHO_BUENO_TOTAL_03 
                              NULL, --nANCHO_BUENO_OT_03 
                              NULL, --nANCHO_BUENO_TOTAL_04 
                              NULL, --nANCHO_BUENO_OT_04 
                              NULL, --nANCHO_BUENO_TOTAL_05 
                              NULL, --nANCHO_BUENO_OT_05 
                              NULL, --nANCHO_BUENO_TOTAL_06 
                              NULL, --nANCHO_BUENO_OT_06 
                              NULL, --nANCHO_BUENO_TOTAL_07 
                              NULL, --nANCHO_BUENO_OT_07 
                              NULL, --nANCHO_BUENO_TOTAL_08 
                              NULL, --nANCHO_BUENO_OT_08 
                              NULL, --nANCHO_BUENO_TOTAL_09 
                              NULL, --nANCHO_BUENO_OT_09 
                              NULL, --nANCHO_BUENO_TOTAL_10 
                              NULL, --nANCHO_BUENO_OT_10 
                              NULL, --nANCHO_BUENO_TOTAL 
                              NULL, --nANCHO_BUENO_OT 
                              NULL, --nNUMECORT 
                              NULL, --nMM_MERMPRCO_01 
                              NULL, --nMM_MERMPLAN_EXESO_01 
                              NULL, --nMM_MERMPLAN_01 
                              NULL, --nMM_MERMPRCO_02 
                              NULL, --nMM_MERMPLAN_EXESO_02 
                              NULL, --nMM_MERMPLAN_02 
                              NULL, --nMM_MERMPRCO_03 
                              NULL, --nMM_MERMPLAN_EXESO_03 
                              NULL, --nMM_MERMPLAN_03 
                              NULL, --nMM_MERMPRCO_04 
                              NULL, --nMM_MERMPLAN_EXESO_04 
                              NULL, --nMM_MERMPLAN_04 
                              NULL, --nMM_MERMPRCO_05 
                              NULL, --nMM_MERMPLAN_EXESO_05 
                              NULL, --nMM_MERMPLAN_05 
                              NULL, --nMM_MERMPRCO_06 
                              NULL, --nMM_MERMPLAN_EXESO_06 
                              NULL, --nMM_MERMPLAN_06 
                              NULL, --nMM_MERMPRCO_07 
                              NULL, --nMM_MERMPLAN_EXESO_07 
                              NULL, --nMM_MERMPLAN_07 
                              NULL, --nMM_MERMPRCO_08 
                              NULL, --nMM_MERMPLAN_EXESO_08 
                              NULL, --nMM_MERMPLAN_08 
                              NULL, --nMM_MERMPRCO_09 
                              rMaterial_B.Ancho - rMaterial_B.ANCHO_BUENO_TOTAL_09, --nMM_MERMPLAN_EXESO_09 
                              0, --nMM_MERMPLAN_09 
                              NULL, --nMM_MERMPRCO_10 
                              NULL, --nMM_MERMPLAN_EXESO_10 
                              NULL, --nMM_MERMPLAN_10 
                              NULL, --nMM_MERMPRCO 
                              NULL, --nMM_MERMPLAN_EXESO 
                              NULL); --nMM_MERMPLAN
               END IF;
               --
               --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_09 := 0;
            END IF;
         END IF;
         ------------------------------------------------------------
         --FIN BUSQUEDA DE MM DE MERMAS DE PLANIFICACION Y EXESOS 1--
         ------------------------------------------------------------
         --------------------------------------------------------
         --BUSQUEDA DE MM DE MERMAS DE PLANIFICACION Y EXESOS 10--
         --------------------------------------------------------
         --IF t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_10 IS NOT NULL AND rMATERIAL_B.Tip_Arti != vTIARREST THEN 
         IF rMaterial_B.ANCHO_BUENO_TOTAL_10 IS NOT NULL AND rMATERIAL_B.Tip_Arti != vTIARREST THEN 
            --Busqueda de Exceso de Merma de Planificación
            IF rMATERIAL_B.MM_MERMPLAN_10 IS NOT NULL THEN 
               --IF t_MATERIAL(rMaterial_B.IDENTIFICADOR).Ancho - t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_10 > rMATERIAL_B.MM_MERMPLAN_10 THEN
               IF rMaterial_B.Ancho - rMaterial_B.ANCHO_BUENO_TOTAL_10 > rMATERIAL_B.MM_MERMPLAN_10 THEN
                  IF rMaterial_B.PRE_CORTE = 'S' THEN
                     --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPRCO_10 := t_MATERIAL(rMaterial_B.IDENTIFICADOR).Ancho - t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_10 - rMATERIAL_B.MM_MERMPLAN_10;
                     --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_EXESO_10 := 0;
                     --
                     P_MATERIAL(rMaterial_B,'U',
                                 NULL,--nCantProd
                                 NULL,--nCantCons_E
                                 NULL,--nCantCons
                                 NULL,--nCantAjus
                                 NULL,--nAncho
                                 NULL,--nFACTOR_CONVERSION_M2_KG
                                 NULL,--nPrecio_ML_E
                                 NULL,--vLog_Precio
                                 NULL,--nMermEnhe_E
                                 NULL,--nMermEnhe
                                 NULL,--nMermAjus_E
                                 NULL,--nMermAjus
                                 NULL,--nMermCabo_E
                                 NULL,--nMermCabo
                                 NULL,--nMermPico_E
                                 NULL,--nMermPico
                                 NULL,--nMermTita
                                 NULL,--nMermSane
                                 NULL,--nCantCons_Bobinas
                                 --
                                 NULL, --nCONTFSMU_01 
                                 NULL, --nCANTFSMU_01 
                                 NULL, --nCATOFSMU 
                                 NULL, --nCONTFSMU_02 
                                 NULL, --nCANTFSMU_02 
                                 NULL, --nCONTFSMU_03 
                                 NULL, --nCANTFSMU_03 
                                 NULL, --nCONTFSMU_04 
                                 NULL, --nCANTFSMU_04 
                                 NULL, --nCONTFSMU_05 
                                 NULL, --nCANTFSMU_05 
                                 NULL, --nCONTFSMU_06 
                                 NULL, --nCANTFSMU_06 
                                 NULL, --nCONTFSMU_07 
                                 NULL, --nCANTFSMU_07 
                                 NULL, --nCONTFSMU_08 
                                 NULL, --nCANTFSMU_08 
                                 NULL, --nCONTFSMU_09 
                                 NULL, --nCANTFSMU_09 
                                 NULL, --nCONTFSMU_10 
                                 NULL, --nCANTFSMU_10 
                                 NULL, --nANCHO_BUENO_TOTAL_01 
                                 NULL, --nANCHO_BUENO_OT_01 
                                 NULL, --nANCHO_BUENO_TOTAL_02 
                                 NULL, --nANCHO_BUENO_OT_02 
                                 NULL, --nANCHO_BUENO_TOTAL_03 
                                 NULL, --nANCHO_BUENO_OT_03 
                                 NULL, --nANCHO_BUENO_TOTAL_04 
                                 NULL, --nANCHO_BUENO_OT_04 
                                 NULL, --nANCHO_BUENO_TOTAL_05 
                                 NULL, --nANCHO_BUENO_OT_05 
                                 NULL, --nANCHO_BUENO_TOTAL_06 
                                 NULL, --nANCHO_BUENO_OT_06 
                                 NULL, --nANCHO_BUENO_TOTAL_07 
                                 NULL, --nANCHO_BUENO_OT_07 
                                 NULL, --nANCHO_BUENO_TOTAL_08 
                                 NULL, --nANCHO_BUENO_OT_08 
                                 NULL, --nANCHO_BUENO_TOTAL_09 
                                 NULL, --nANCHO_BUENO_OT_09 
                                 NULL, --nANCHO_BUENO_TOTAL_10 
                                 NULL, --nANCHO_BUENO_OT_10 
                                 NULL, --nANCHO_BUENO_TOTAL 
                                 NULL, --nANCHO_BUENO_OT 
                                 NULL, --nNUMECORT 
                                 NULL, --nMM_MERMPRCO_01 
                                 NULL, --nMM_MERMPLAN_EXESO_01 
                                 NULL, --nMM_MERMPLAN_01 
                                 NULL, --nMM_MERMPRCO_02 
                                 NULL, --nMM_MERMPLAN_EXESO_02 
                                 NULL, --nMM_MERMPLAN_02 
                                 NULL, --nMM_MERMPRCO_03 
                                 NULL, --nMM_MERMPLAN_EXESO_03 
                                 NULL, --nMM_MERMPLAN_03 
                                 NULL, --nMM_MERMPRCO_04 
                                 NULL, --nMM_MERMPLAN_EXESO_04 
                                 NULL, --nMM_MERMPLAN_04 
                                 NULL, --nMM_MERMPRCO_05 
                                 NULL, --nMM_MERMPLAN_EXESO_05 
                                 NULL, --nMM_MERMPLAN_05 
                                 NULL, --nMM_MERMPRCO_06 
                                 NULL, --nMM_MERMPLAN_EXESO_06 
                                 NULL, --nMM_MERMPLAN_06 
                                 NULL, --nMM_MERMPRCO_07 
                                 NULL, --nMM_MERMPLAN_EXESO_07 
                                 NULL, --nMM_MERMPLAN_07 
                                 NULL, --nMM_MERMPRCO_08 
                                 NULL, --nMM_MERMPLAN_EXESO_08 
                                 NULL, --nMM_MERMPLAN_08 
                                 NULL, --nMM_MERMPRCO_09 
                                 NULL, --nMM_MERMPLAN_EXESO_09 
                                 NULL, --nMM_MERMPLAN_09 
                                 rMaterial_B.Ancho - rMaterial_B.ANCHO_BUENO_TOTAL_10 - rMATERIAL_B.MM_MERMPLAN_10, --nMM_MERMPRCO_10 
                                 0, --nMM_MERMPLAN_EXESO_10 
                                 NULL, --nMM_MERMPLAN_10 
                                 NULL, --nMM_MERMPRCO 
                                 NULL, --nMM_MERMPLAN_EXESO 
                                 NULL); --nMM_MERMPLAN
                  ELSE
                     --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_EXESO_10 := t_MATERIAL(rMaterial_B.IDENTIFICADOR).Ancho - t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_10 - rMATERIAL_B.MM_MERMPLAN_10;
                     --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPRCO_10 := 0;
                     --
                     P_MATERIAL(rMaterial_B,'U',
                                 NULL,--nCantProd
                                 NULL,--nCantCons_E
                                 NULL,--nCantCons
                                 NULL,--nCantAjus
                                 NULL,--nAncho
                                 NULL,--nFACTOR_CONVERSION_M2_KG
                                 NULL,--nPrecio_ML_E
                                 NULL,--vLog_Precio
                                 NULL,--nMermEnhe_E
                                 NULL,--nMermEnhe
                                 NULL,--nMermAjus_E
                                 NULL,--nMermAjus
                                 NULL,--nMermCabo_E
                                 NULL,--nMermCabo
                                 NULL,--nMermPico_E
                                 NULL,--nMermPico
                                 NULL,--nMermTita
                                 NULL,--nMermSane
                                 NULL,--nCantCons_Bobinas
                                 --
                                 NULL, --nCONTFSMU_01 
                                 NULL, --nCANTFSMU_01 
                                 NULL, --nCATOFSMU 
                                 NULL, --nCONTFSMU_02 
                                 NULL, --nCANTFSMU_02 
                                 NULL, --nCONTFSMU_03 
                                 NULL, --nCANTFSMU_03 
                                 NULL, --nCONTFSMU_04 
                                 NULL, --nCANTFSMU_04 
                                 NULL, --nCONTFSMU_05 
                                 NULL, --nCANTFSMU_05 
                                 NULL, --nCONTFSMU_06 
                                 NULL, --nCANTFSMU_06 
                                 NULL, --nCONTFSMU_07 
                                 NULL, --nCANTFSMU_07 
                                 NULL, --nCONTFSMU_08 
                                 NULL, --nCANTFSMU_08 
                                 NULL, --nCONTFSMU_09 
                                 NULL, --nCANTFSMU_09 
                                 NULL, --nCONTFSMU_10 
                                 NULL, --nCANTFSMU_10 
                                 NULL, --nANCHO_BUENO_TOTAL_01 
                                 NULL, --nANCHO_BUENO_OT_01 
                                 NULL, --nANCHO_BUENO_TOTAL_02 
                                 NULL, --nANCHO_BUENO_OT_02 
                                 NULL, --nANCHO_BUENO_TOTAL_03 
                                 NULL, --nANCHO_BUENO_OT_03 
                                 NULL, --nANCHO_BUENO_TOTAL_04 
                                 NULL, --nANCHO_BUENO_OT_04 
                                 NULL, --nANCHO_BUENO_TOTAL_05 
                                 NULL, --nANCHO_BUENO_OT_05 
                                 NULL, --nANCHO_BUENO_TOTAL_06 
                                 NULL, --nANCHO_BUENO_OT_06 
                                 NULL, --nANCHO_BUENO_TOTAL_07 
                                 NULL, --nANCHO_BUENO_OT_07 
                                 NULL, --nANCHO_BUENO_TOTAL_08 
                                 NULL, --nANCHO_BUENO_OT_08 
                                 NULL, --nANCHO_BUENO_TOTAL_09 
                                 NULL, --nANCHO_BUENO_OT_09 
                                 NULL, --nANCHO_BUENO_TOTAL_10 
                                 NULL, --nANCHO_BUENO_OT_10 
                                 NULL, --nANCHO_BUENO_TOTAL 
                                 NULL, --nANCHO_BUENO_OT 
                                 NULL, --nNUMECORT 
                                 NULL, --nMM_MERMPRCO_01 
                                 NULL, --nMM_MERMPLAN_EXESO_01 
                                 NULL, --nMM_MERMPLAN_01 
                                 NULL, --nMM_MERMPRCO_02 
                                 NULL, --nMM_MERMPLAN_EXESO_02 
                                 NULL, --nMM_MERMPLAN_02 
                                 NULL, --nMM_MERMPRCO_03 
                                 NULL, --nMM_MERMPLAN_EXESO_03 
                                 NULL, --nMM_MERMPLAN_03 
                                 NULL, --nMM_MERMPRCO_04 
                                 NULL, --nMM_MERMPLAN_EXESO_04 
                                 NULL, --nMM_MERMPLAN_04 
                                 NULL, --nMM_MERMPRCO_05 
                                 NULL, --nMM_MERMPLAN_EXESO_05 
                                 NULL, --nMM_MERMPLAN_05 
                                 NULL, --nMM_MERMPRCO_06 
                                 NULL, --nMM_MERMPLAN_EXESO_06 
                                 NULL, --nMM_MERMPLAN_06 
                                 NULL, --nMM_MERMPRCO_07 
                                 NULL, --nMM_MERMPLAN_EXESO_07 
                                 NULL, --nMM_MERMPLAN_07 
                                 NULL, --nMM_MERMPRCO_08 
                                 NULL, --nMM_MERMPLAN_EXESO_08 
                                 NULL, --nMM_MERMPLAN_08 
                                 NULL, --nMM_MERMPRCO_09 
                                 NULL, --nMM_MERMPLAN_EXESO_09 
                                 NULL, --nMM_MERMPLAN_09 
                                 0, --nMM_MERMPRCO_10 
                                 rMaterial_B.Ancho - rMaterial_B.ANCHO_BUENO_TOTAL_10 - rMATERIAL_B.MM_MERMPLAN_10, --nMM_MERMPLAN_EXESO_10 
                                 NULL, --nMM_MERMPLAN_10 
                                 NULL, --nMM_MERMPRCO 
                                 NULL, --nMM_MERMPLAN_EXESO 
                                 NULL); --nMM_MERMPLAN
                  END IF;
               ELSE
                  --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_EXESO_10 := 0;
                  --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPRCO_10 := 0;
                  --La Merma de Planificación fue menor a lo Estandar / Real (SE ACTUALIZA: YA NO SE BASA EN LA CONFIGURACION)
                  --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_10 := t_MATERIAL(rMaterial_B.IDENTIFICADOR).Ancho - t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_10;
                  P_MATERIAL(rMaterial_B,'U',
                              NULL,--nCantProd
                              NULL,--nCantCons_E
                              NULL,--nCantCons
                              NULL,--nCantAjus
                              NULL,--nAncho
                              NULL,--nFACTOR_CONVERSION_M2_KG
                              NULL,--nPrecio_ML_E
                              NULL,--vLog_Precio
                              NULL,--nMermEnhe_E
                              NULL,--nMermEnhe
                              NULL,--nMermAjus_E
                              NULL,--nMermAjus
                              NULL,--nMermCabo_E
                              NULL,--nMermCabo
                              NULL,--nMermPico_E
                              NULL,--nMermPico
                              NULL,--nMermTita
                              NULL,--nMermSane
                              NULL,--nCantCons_Bobinas
                              --
                              NULL, --nCONTFSMU_01 
                              NULL, --nCANTFSMU_01 
                              NULL, --nCATOFSMU 
                              NULL, --nCONTFSMU_02 
                              NULL, --nCANTFSMU_02 
                              NULL, --nCONTFSMU_03 
                              NULL, --nCANTFSMU_03 
                              NULL, --nCONTFSMU_04 
                              NULL, --nCANTFSMU_04 
                              NULL, --nCONTFSMU_05 
                              NULL, --nCANTFSMU_05 
                              NULL, --nCONTFSMU_06 
                              NULL, --nCANTFSMU_06 
                              NULL, --nCONTFSMU_07 
                              NULL, --nCANTFSMU_07 
                              NULL, --nCONTFSMU_08 
                              NULL, --nCANTFSMU_08 
                              NULL, --nCONTFSMU_09 
                              NULL, --nCANTFSMU_09 
                              NULL, --nCONTFSMU_10 
                              NULL, --nCANTFSMU_10 
                              NULL, --nANCHO_BUENO_TOTAL_01 
                              NULL, --nANCHO_BUENO_OT_01 
                              NULL, --nANCHO_BUENO_TOTAL_02 
                              NULL, --nANCHO_BUENO_OT_02 
                              NULL, --nANCHO_BUENO_TOTAL_03 
                              NULL, --nANCHO_BUENO_OT_03 
                              NULL, --nANCHO_BUENO_TOTAL_04 
                              NULL, --nANCHO_BUENO_OT_04 
                              NULL, --nANCHO_BUENO_TOTAL_05 
                              NULL, --nANCHO_BUENO_OT_05 
                              NULL, --nANCHO_BUENO_TOTAL_06 
                              NULL, --nANCHO_BUENO_OT_06 
                              NULL, --nANCHO_BUENO_TOTAL_07 
                              NULL, --nANCHO_BUENO_OT_07 
                              NULL, --nANCHO_BUENO_TOTAL_08 
                              NULL, --nANCHO_BUENO_OT_08 
                              NULL, --nANCHO_BUENO_TOTAL_09 
                              NULL, --nANCHO_BUENO_OT_09 
                              NULL, --nANCHO_BUENO_TOTAL_10 
                              NULL, --nANCHO_BUENO_OT_10 
                              NULL, --nANCHO_BUENO_TOTAL 
                              NULL, --nANCHO_BUENO_OT 
                              NULL, --nNUMECORT 
                              NULL, --nMM_MERMPRCO_01 
                              NULL, --nMM_MERMPLAN_EXESO_01 
                              NULL, --nMM_MERMPLAN_01 
                              NULL, --nMM_MERMPRCO_02 
                              NULL, --nMM_MERMPLAN_EXESO_02 
                              NULL, --nMM_MERMPLAN_02 
                              NULL, --nMM_MERMPRCO_03 
                              NULL, --nMM_MERMPLAN_EXESO_03 
                              NULL, --nMM_MERMPLAN_03 
                              NULL, --nMM_MERMPRCO_04 
                              NULL, --nMM_MERMPLAN_EXESO_04 
                              NULL, --nMM_MERMPLAN_04 
                              NULL, --nMM_MERMPRCO_05 
                              NULL, --nMM_MERMPLAN_EXESO_05 
                              NULL, --nMM_MERMPLAN_05 
                              NULL, --nMM_MERMPRCO_06 
                              NULL, --nMM_MERMPLAN_EXESO_06 
                              NULL, --nMM_MERMPLAN_06 
                              NULL, --nMM_MERMPRCO_07 
                              NULL, --nMM_MERMPLAN_EXESO_07 
                              NULL, --nMM_MERMPLAN_07 
                              NULL, --nMM_MERMPRCO_08 
                              NULL, --nMM_MERMPLAN_EXESO_08 
                              NULL, --nMM_MERMPLAN_08 
                              NULL, --nMM_MERMPRCO_09 
                              NULL, --nMM_MERMPLAN_EXESO_09 
                              NULL, --nMM_MERMPLAN_09 
                              0, --nMM_MERMPRCO_10 
                              0, --nMM_MERMPLAN_EXESO_10 
                              rMaterial_B.Ancho - rMaterial_B.ANCHO_BUENO_TOTAL_10, --nMM_MERMPLAN_10 
                              NULL, --nMM_MERMPRCO 
                              NULL, --nMM_MERMPLAN_EXESO 
                              NULL); --nMM_MERMPLAN
               END IF;
            ELSE--Si no existe la Merma Planificada Estandar / Real
               --Se asigna la merma encontrada a Excesos o Pre_Corte ya que no fue Planificada como Estandar
               IF rMaterial_B.PRE_CORTE = 'S' THEN
                  --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPRCO_10 := t_MATERIAL(rMaterial_B.IDENTIFICADOR).Ancho - t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_10;
                  P_MATERIAL(rMaterial_B,'U',
                              NULL,--nCantProd
                              NULL,--nCantCons_E
                              NULL,--nCantCons
                              NULL,--nCantAjus
                              NULL,--nAncho
                              NULL,--nFACTOR_CONVERSION_M2_KG
                              NULL,--nPrecio_ML_E
                              NULL,--vLog_Precio
                              NULL,--nMermEnhe_E
                              NULL,--nMermEnhe
                              NULL,--nMermAjus_E
                              NULL,--nMermAjus
                              NULL,--nMermCabo_E
                              NULL,--nMermCabo
                              NULL,--nMermPico_E
                              NULL,--nMermPico
                              NULL,--nMermTita
                              NULL,--nMermSane
                              NULL,--nCantCons_Bobinas
                              --
                              NULL, --nCONTFSMU_01 
                              NULL, --nCANTFSMU_01 
                              NULL, --nCATOFSMU 
                              NULL, --nCONTFSMU_02 
                              NULL, --nCANTFSMU_02 
                              NULL, --nCONTFSMU_03 
                              NULL, --nCANTFSMU_03 
                              NULL, --nCONTFSMU_04 
                              NULL, --nCANTFSMU_04 
                              NULL, --nCONTFSMU_05 
                              NULL, --nCANTFSMU_05 
                              NULL, --nCONTFSMU_06 
                              NULL, --nCANTFSMU_06 
                              NULL, --nCONTFSMU_07 
                              NULL, --nCANTFSMU_07 
                              NULL, --nCONTFSMU_08 
                              NULL, --nCANTFSMU_08 
                              NULL, --nCONTFSMU_09 
                              NULL, --nCANTFSMU_09 
                              NULL, --nCONTFSMU_10 
                              NULL, --nCANTFSMU_10 
                              NULL, --nANCHO_BUENO_TOTAL_01 
                              NULL, --nANCHO_BUENO_OT_01 
                              NULL, --nANCHO_BUENO_TOTAL_02 
                              NULL, --nANCHO_BUENO_OT_02 
                              NULL, --nANCHO_BUENO_TOTAL_03 
                              NULL, --nANCHO_BUENO_OT_03 
                              NULL, --nANCHO_BUENO_TOTAL_04 
                              NULL, --nANCHO_BUENO_OT_04 
                              NULL, --nANCHO_BUENO_TOTAL_05 
                              NULL, --nANCHO_BUENO_OT_05 
                              NULL, --nANCHO_BUENO_TOTAL_06 
                              NULL, --nANCHO_BUENO_OT_06 
                              NULL, --nANCHO_BUENO_TOTAL_07 
                              NULL, --nANCHO_BUENO_OT_07 
                              NULL, --nANCHO_BUENO_TOTAL_08 
                              NULL, --nANCHO_BUENO_OT_08 
                              NULL, --nANCHO_BUENO_TOTAL_09 
                              NULL, --nANCHO_BUENO_OT_09 
                              NULL, --nANCHO_BUENO_TOTAL_10 
                              NULL, --nANCHO_BUENO_OT_10 
                              NULL, --nANCHO_BUENO_TOTAL 
                              NULL, --nANCHO_BUENO_OT 
                              NULL, --nNUMECORT 
                              NULL, --nMM_MERMPRCO_01 
                              NULL, --nMM_MERMPLAN_EXESO_01 
                              NULL, --nMM_MERMPLAN_01 
                              NULL, --nMM_MERMPRCO_02 
                              NULL, --nMM_MERMPLAN_EXESO_02 
                              NULL, --nMM_MERMPLAN_02 
                              NULL, --nMM_MERMPRCO_03 
                              NULL, --nMM_MERMPLAN_EXESO_03 
                              NULL, --nMM_MERMPLAN_03 
                              NULL, --nMM_MERMPRCO_04 
                              NULL, --nMM_MERMPLAN_EXESO_04 
                              NULL, --nMM_MERMPLAN_04 
                              NULL, --nMM_MERMPRCO_05 
                              NULL, --nMM_MERMPLAN_EXESO_05 
                              NULL, --nMM_MERMPLAN_05 
                              NULL, --nMM_MERMPRCO_06 
                              NULL, --nMM_MERMPLAN_EXESO_06 
                              NULL, --nMM_MERMPLAN_06 
                              NULL, --nMM_MERMPRCO_07 
                              NULL, --nMM_MERMPLAN_EXESO_07 
                              NULL, --nMM_MERMPLAN_07 
                              NULL, --nMM_MERMPRCO_08 
                              NULL, --nMM_MERMPLAN_EXESO_08 
                              NULL, --nMM_MERMPLAN_08 
                              NULL, --nMM_MERMPRCO_09 
                              NULL, --nMM_MERMPLAN_EXESO_09 
                              NULL, --nMM_MERMPLAN_09 
                              rMaterial_B.Ancho - rMaterial_B.ANCHO_BUENO_TOTAL_10, --nMM_MERMPRCO_10 
                              NULL, --nMM_MERMPLAN_EXESO_10 
                              0, --nMM_MERMPLAN_10 
                              NULL, --nMM_MERMPRCO 
                              NULL, --nMM_MERMPLAN_EXESO 
                              NULL); --nMM_MERMPLAN
               ELSE
                  --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_EXESO_10 := t_MATERIAL(rMaterial_B.IDENTIFICADOR).Ancho - t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_10;
                  P_MATERIAL(rMaterial_B,'U',
                              NULL,--nCantProd
                              NULL,--nCantCons_E
                              NULL,--nCantCons
                              NULL,--nCantAjus
                              NULL,--nAncho
                              NULL,--nFACTOR_CONVERSION_M2_KG
                              NULL,--nPrecio_ML_E
                              NULL,--vLog_Precio
                              NULL,--nMermEnhe_E
                              NULL,--nMermEnhe
                              NULL,--nMermAjus_E
                              NULL,--nMermAjus
                              NULL,--nMermCabo_E
                              NULL,--nMermCabo
                              NULL,--nMermPico_E
                              NULL,--nMermPico
                              NULL,--nMermTita
                              NULL,--nMermSane
                              NULL,--nCantCons_Bobinas
                              --
                              NULL, --nCONTFSMU_01 
                              NULL, --nCANTFSMU_01 
                              NULL, --nCATOFSMU 
                              NULL, --nCONTFSMU_02 
                              NULL, --nCANTFSMU_02 
                              NULL, --nCONTFSMU_03 
                              NULL, --nCANTFSMU_03 
                              NULL, --nCONTFSMU_04 
                              NULL, --nCANTFSMU_04 
                              NULL, --nCONTFSMU_05 
                              NULL, --nCANTFSMU_05 
                              NULL, --nCONTFSMU_06 
                              NULL, --nCANTFSMU_06 
                              NULL, --nCONTFSMU_07 
                              NULL, --nCANTFSMU_07 
                              NULL, --nCONTFSMU_08 
                              NULL, --nCANTFSMU_08 
                              NULL, --nCONTFSMU_09 
                              NULL, --nCANTFSMU_09 
                              NULL, --nCONTFSMU_10 
                              NULL, --nCANTFSMU_10 
                              NULL, --nANCHO_BUENO_TOTAL_01 
                              NULL, --nANCHO_BUENO_OT_01 
                              NULL, --nANCHO_BUENO_TOTAL_02 
                              NULL, --nANCHO_BUENO_OT_02 
                              NULL, --nANCHO_BUENO_TOTAL_03 
                              NULL, --nANCHO_BUENO_OT_03 
                              NULL, --nANCHO_BUENO_TOTAL_04 
                              NULL, --nANCHO_BUENO_OT_04 
                              NULL, --nANCHO_BUENO_TOTAL_05 
                              NULL, --nANCHO_BUENO_OT_05 
                              NULL, --nANCHO_BUENO_TOTAL_06 
                              NULL, --nANCHO_BUENO_OT_06 
                              NULL, --nANCHO_BUENO_TOTAL_07 
                              NULL, --nANCHO_BUENO_OT_07 
                              NULL, --nANCHO_BUENO_TOTAL_08 
                              NULL, --nANCHO_BUENO_OT_08 
                              NULL, --nANCHO_BUENO_TOTAL_09 
                              NULL, --nANCHO_BUENO_OT_09 
                              NULL, --nANCHO_BUENO_TOTAL_10 
                              NULL, --nANCHO_BUENO_OT_10 
                              NULL, --nANCHO_BUENO_TOTAL 
                              NULL, --nANCHO_BUENO_OT 
                              NULL, --nNUMECORT 
                              NULL, --nMM_MERMPRCO_01 
                              NULL, --nMM_MERMPLAN_EXESO_01 
                              NULL, --nMM_MERMPLAN_01 
                              NULL, --nMM_MERMPRCO_02 
                              NULL, --nMM_MERMPLAN_EXESO_02 
                              NULL, --nMM_MERMPLAN_02 
                              NULL, --nMM_MERMPRCO_03 
                              NULL, --nMM_MERMPLAN_EXESO_03 
                              NULL, --nMM_MERMPLAN_03 
                              NULL, --nMM_MERMPRCO_04 
                              NULL, --nMM_MERMPLAN_EXESO_04 
                              NULL, --nMM_MERMPLAN_04 
                              NULL, --nMM_MERMPRCO_05 
                              NULL, --nMM_MERMPLAN_EXESO_05 
                              NULL, --nMM_MERMPLAN_05 
                              NULL, --nMM_MERMPRCO_06 
                              NULL, --nMM_MERMPLAN_EXESO_06 
                              NULL, --nMM_MERMPLAN_06 
                              NULL, --nMM_MERMPRCO_07 
                              NULL, --nMM_MERMPLAN_EXESO_07 
                              NULL, --nMM_MERMPLAN_07 
                              NULL, --nMM_MERMPRCO_08 
                              NULL, --nMM_MERMPLAN_EXESO_08 
                              NULL, --nMM_MERMPLAN_08 
                              NULL, --nMM_MERMPRCO_09 
                              NULL, --nMM_MERMPLAN_EXESO_09 
                              NULL, --nMM_MERMPLAN_09 
                              NULL, --nMM_MERMPRCO_10 
                              rMaterial_B.Ancho - rMaterial_B.ANCHO_BUENO_TOTAL_10, --nMM_MERMPLAN_EXESO_10 
                              0, --nMM_MERMPLAN_10 
                              NULL, --nMM_MERMPRCO 
                              NULL, --nMM_MERMPLAN_EXESO 
                              NULL); --nMM_MERMPLAN
               END IF;
               --
               --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_10 := 0;
            END IF;
         END IF;
         ------------------------------------------------------------
         --FIN BUSQUEDA DE MM DE MERMAS DE PLANIFICACION Y EXESOS 10--
         ------------------------------------------------------------
         ---------------------------------------
         --Tratamiento de Merma Negativa
         ---------------------------------------
         --IF t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPRCO < 0 THEN
         IF rMaterial_B.MM_MERMPRCO < 0 THEN
            --IF ABS(t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPRCO) <= (vTolemmMP * t_MATERIAL(rMaterial_B.IDENTIFICADOR).NUMECORT) THEN
            IF ABS(rMaterial_B.MM_MERMPRCO) <= (vTolemmMP * rMaterial_B.NUMECORT) THEN
               --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPRCO := 0;
               P_MATERIAL(rMaterial_B,'U',
                           NULL,--nCantProd
                           NULL,--nCantCons_E
                           NULL,--nCantCons
                           NULL,--nCantAjus
                           NULL,--nAncho
                           NULL,--nFACTOR_CONVERSION_M2_KG
                           NULL,--nPrecio_ML_E
                           NULL,--vLog_Precio
                           NULL,--nMermEnhe_E
                           NULL,--nMermEnhe
                           NULL,--nMermAjus_E
                           NULL,--nMermAjus
                           NULL,--nMermCabo_E
                           NULL,--nMermCabo
                           NULL,--nMermPico_E
                           NULL,--nMermPico
                           NULL,--nMermTita
                           NULL,--nMermSane
                           NULL,--nCantCons_Bobinas
                           --
                           NULL, --nCONTFSMU_01 
                           NULL, --nCANTFSMU_01 
                           NULL, --nCATOFSMU 
                           NULL, --nCONTFSMU_02 
                           NULL, --nCANTFSMU_02 
                           NULL, --nCONTFSMU_03 
                           NULL, --nCANTFSMU_03 
                           NULL, --nCONTFSMU_04 
                           NULL, --nCANTFSMU_04 
                           NULL, --nCONTFSMU_05 
                           NULL, --nCANTFSMU_05 
                           NULL, --nCONTFSMU_06 
                           NULL, --nCANTFSMU_06 
                           NULL, --nCONTFSMU_07 
                           NULL, --nCANTFSMU_07 
                           NULL, --nCONTFSMU_08 
                           NULL, --nCANTFSMU_08 
                           NULL, --nCONTFSMU_09 
                           NULL, --nCANTFSMU_09 
                           NULL, --nCONTFSMU_10 
                           NULL, --nCANTFSMU_10 
                           NULL, --nANCHO_BUENO_TOTAL_01 
                           NULL, --nANCHO_BUENO_OT_01 
                           NULL, --nANCHO_BUENO_TOTAL_02 
                           NULL, --nANCHO_BUENO_OT_02 
                           NULL, --nANCHO_BUENO_TOTAL_03 
                           NULL, --nANCHO_BUENO_OT_03 
                           NULL, --nANCHO_BUENO_TOTAL_04 
                           NULL, --nANCHO_BUENO_OT_04 
                           NULL, --nANCHO_BUENO_TOTAL_05 
                           NULL, --nANCHO_BUENO_OT_05 
                           NULL, --nANCHO_BUENO_TOTAL_06 
                           NULL, --nANCHO_BUENO_OT_06 
                           NULL, --nANCHO_BUENO_TOTAL_07 
                           NULL, --nANCHO_BUENO_OT_07 
                           NULL, --nANCHO_BUENO_TOTAL_08 
                           NULL, --nANCHO_BUENO_OT_08 
                           NULL, --nANCHO_BUENO_TOTAL_09 
                           NULL, --nANCHO_BUENO_OT_09 
                           NULL, --nANCHO_BUENO_TOTAL_10 
                           NULL, --nANCHO_BUENO_OT_10 
                           NULL, --nANCHO_BUENO_TOTAL 
                           NULL, --nANCHO_BUENO_OT 
                           NULL, --nNUMECORT 
                           NULL, --nMM_MERMPRCO_01 
                           NULL, --nMM_MERMPLAN_EXESO_01 
                           NULL, --nMM_MERMPLAN_01 
                           NULL, --nMM_MERMPRCO_02 
                           NULL, --nMM_MERMPLAN_EXESO_02 
                           NULL, --nMM_MERMPLAN_02 
                           NULL, --nMM_MERMPRCO_03 
                           NULL, --nMM_MERMPLAN_EXESO_03 
                           NULL, --nMM_MERMPLAN_03 
                           NULL, --nMM_MERMPRCO_04 
                           NULL, --nMM_MERMPLAN_EXESO_04 
                           NULL, --nMM_MERMPLAN_04 
                           NULL, --nMM_MERMPRCO_05 
                           NULL, --nMM_MERMPLAN_EXESO_05 
                           NULL, --nMM_MERMPLAN_05 
                           NULL, --nMM_MERMPRCO_06 
                           NULL, --nMM_MERMPLAN_EXESO_06 
                           NULL, --nMM_MERMPLAN_06 
                           NULL, --nMM_MERMPRCO_07 
                           NULL, --nMM_MERMPLAN_EXESO_07 
                           NULL, --nMM_MERMPLAN_07 
                           NULL, --nMM_MERMPRCO_08 
                           NULL, --nMM_MERMPLAN_EXESO_08 
                           NULL, --nMM_MERMPLAN_08 
                           NULL, --nMM_MERMPRCO_09 
                           NULL, --nMM_MERMPLAN_EXESO_09 
                           NULL, --nMM_MERMPLAN_09 
                           NULL, --nMM_MERMPRCO_10 
                           NULL, --nMM_MERMPLAN_EXESO_10 
                           NULL, --nMM_MERMPLAN_10 
                           0, --nMM_MERMPRCO 
                           NULL, --nMM_MERMPLAN_EXESO 
                           NULL); --nMM_MERMPLAN
            ELSE
               P_ERRORES(vEmpresa, nNumeOtre, '647','la Merma de Pre-Corte para el Material: '||rMATERIAL_B.Tip_Arti||'-'||rMATERIAL_B.Cod_Arti||' Ancho: '||rMATERIAL_B.ANCHO||' Ancho Bueno: '||rMATERIAL_B.ANCHO_BUENO_TOTAL||', Merma Negativa: '||rMATERIAL_B.MM_MERMPRCO||' Tolerancia: '||vTolemmMP||' Numero Cortes: '||rMATERIAL_B.NUMECORT||'|62.1.1','R','E');
            END IF;
         END IF;
         --
         --IF t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_EXESO < 0 THEN
         IF rMaterial_B.MM_MERMPLAN_EXESO < 0 THEN
            --IF ABS(t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_EXESO) <= (vTolemmMP * t_MATERIAL(rMaterial_B.IDENTIFICADOR).NUMECORT) THEN
            IF ABS(rMaterial_B.MM_MERMPLAN_EXESO) <= (vTolemmMP * rMaterial_B.NUMECORT) THEN
               --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_EXESO := 0;
               P_MATERIAL(rMaterial_B,'U',
                           NULL,--nCantProd
                           NULL,--nCantCons_E
                           NULL,--nCantCons
                           NULL,--nCantAjus
                           NULL,--nAncho
                           NULL,--nFACTOR_CONVERSION_M2_KG
                           NULL,--nPrecio_ML_E
                           NULL,--vLog_Precio
                           NULL,--nMermEnhe_E
                           NULL,--nMermEnhe
                           NULL,--nMermAjus_E
                           NULL,--nMermAjus
                           NULL,--nMermCabo_E
                           NULL,--nMermCabo
                           NULL,--nMermPico_E
                           NULL,--nMermPico
                           NULL,--nMermTita
                           NULL,--nMermSane
                           NULL,--nCantCons_Bobinas
                           --
                           NULL, --nCONTFSMU_01 
                           NULL, --nCANTFSMU_01 
                           NULL, --nCATOFSMU 
                           NULL, --nCONTFSMU_02 
                           NULL, --nCANTFSMU_02 
                           NULL, --nCONTFSMU_03 
                           NULL, --nCANTFSMU_03 
                           NULL, --nCONTFSMU_04 
                           NULL, --nCANTFSMU_04 
                           NULL, --nCONTFSMU_05 
                           NULL, --nCANTFSMU_05 
                           NULL, --nCONTFSMU_06 
                           NULL, --nCANTFSMU_06 
                           NULL, --nCONTFSMU_07 
                           NULL, --nCANTFSMU_07 
                           NULL, --nCONTFSMU_08 
                           NULL, --nCANTFSMU_08 
                           NULL, --nCONTFSMU_09 
                           NULL, --nCANTFSMU_09 
                           NULL, --nCONTFSMU_10 
                           NULL, --nCANTFSMU_10 
                           NULL, --nANCHO_BUENO_TOTAL_01 
                           NULL, --nANCHO_BUENO_OT_01 
                           NULL, --nANCHO_BUENO_TOTAL_02 
                           NULL, --nANCHO_BUENO_OT_02 
                           NULL, --nANCHO_BUENO_TOTAL_03 
                           NULL, --nANCHO_BUENO_OT_03 
                           NULL, --nANCHO_BUENO_TOTAL_04 
                           NULL, --nANCHO_BUENO_OT_04 
                           NULL, --nANCHO_BUENO_TOTAL_05 
                           NULL, --nANCHO_BUENO_OT_05 
                           NULL, --nANCHO_BUENO_TOTAL_06 
                           NULL, --nANCHO_BUENO_OT_06 
                           NULL, --nANCHO_BUENO_TOTAL_07 
                           NULL, --nANCHO_BUENO_OT_07 
                           NULL, --nANCHO_BUENO_TOTAL_08 
                           NULL, --nANCHO_BUENO_OT_08 
                           NULL, --nANCHO_BUENO_TOTAL_09 
                           NULL, --nANCHO_BUENO_OT_09 
                           NULL, --nANCHO_BUENO_TOTAL_10 
                           NULL, --nANCHO_BUENO_OT_10 
                           NULL, --nANCHO_BUENO_TOTAL 
                           NULL, --nANCHO_BUENO_OT 
                           NULL, --nNUMECORT 
                           NULL, --nMM_MERMPRCO_01 
                           NULL, --nMM_MERMPLAN_EXESO_01 
                           NULL, --nMM_MERMPLAN_01 
                           NULL, --nMM_MERMPRCO_02 
                           NULL, --nMM_MERMPLAN_EXESO_02 
                           NULL, --nMM_MERMPLAN_02 
                           NULL, --nMM_MERMPRCO_03 
                           NULL, --nMM_MERMPLAN_EXESO_03 
                           NULL, --nMM_MERMPLAN_03 
                           NULL, --nMM_MERMPRCO_04 
                           NULL, --nMM_MERMPLAN_EXESO_04 
                           NULL, --nMM_MERMPLAN_04 
                           NULL, --nMM_MERMPRCO_05 
                           NULL, --nMM_MERMPLAN_EXESO_05 
                           NULL, --nMM_MERMPLAN_05 
                           NULL, --nMM_MERMPRCO_06 
                           NULL, --nMM_MERMPLAN_EXESO_06 
                           NULL, --nMM_MERMPLAN_06 
                           NULL, --nMM_MERMPRCO_07 
                           NULL, --nMM_MERMPLAN_EXESO_07 
                           NULL, --nMM_MERMPLAN_07 
                           NULL, --nMM_MERMPRCO_08 
                           NULL, --nMM_MERMPLAN_EXESO_08 
                           NULL, --nMM_MERMPLAN_08 
                           NULL, --nMM_MERMPRCO_09 
                           NULL, --nMM_MERMPLAN_EXESO_09 
                           NULL, --nMM_MERMPLAN_09 
                           NULL, --nMM_MERMPRCO_10 
                           NULL, --nMM_MERMPLAN_EXESO_10 
                           NULL, --nMM_MERMPLAN_10 
                           NULL, --nMM_MERMPRCO 
                           0, --nMM_MERMPLAN_EXESO 
                           NULL); --nMM_MERMPLAN
            ELSE
               P_ERRORES(vEmpresa, nNumeOtre, '647','la Merma de Planificación Exeso para el Material: '||rMATERIAL_B.Tip_Arti||'-'||rMATERIAL_B.Cod_Arti||' Ancho: '||rMATERIAL_B.ANCHO||' Ancho Bueno: '||rMATERIAL_B.ANCHO_BUENO_TOTAL||', Merma Negativa: '||rMATERIAL_B.MM_MERMPLAN_EXESO||' Tolerancia: '||vTolemmMP||' Numero Cortes: '||rMATERIAL_B.NUMECORT||'|62.1.2','R','E');
            END IF;
         END IF;
         --
         --IF t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN < 0 THEN
         IF rMaterial_B.MM_MERMPLAN < 0 THEN
            --IF ABS(t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN) <= (vTolemmMP * t_MATERIAL(rMaterial_B.IDENTIFICADOR).NUMECORT) THEN
            IF ABS(rMaterial_B.MM_MERMPLAN) <= (vTolemmMP * rMaterial_B.NUMECORT) THEN
               --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN := 0;
               P_MATERIAL(rMaterial_B,'U',
                           NULL,--nCantProd
                           NULL,--nCantCons_E
                           NULL,--nCantCons
                           NULL,--nCantAjus
                           NULL,--nAncho
                           NULL,--nFACTOR_CONVERSION_M2_KG
                           NULL,--nPrecio_ML_E
                           NULL,--vLog_Precio
                           NULL,--nMermEnhe_E
                           NULL,--nMermEnhe
                           NULL,--nMermAjus_E
                           NULL,--nMermAjus
                           NULL,--nMermCabo_E
                           NULL,--nMermCabo
                           NULL,--nMermPico_E
                           NULL,--nMermPico
                           NULL,--nMermTita
                           NULL,--nMermSane
                           NULL,--nCantCons_Bobinas
                           --
                           NULL, --nCONTFSMU_01 
                           NULL, --nCANTFSMU_01 
                           NULL, --nCATOFSMU 
                           NULL, --nCONTFSMU_02 
                           NULL, --nCANTFSMU_02 
                           NULL, --nCONTFSMU_03 
                           NULL, --nCANTFSMU_03 
                           NULL, --nCONTFSMU_04 
                           NULL, --nCANTFSMU_04 
                           NULL, --nCONTFSMU_05 
                           NULL, --nCANTFSMU_05 
                           NULL, --nCONTFSMU_06 
                           NULL, --nCANTFSMU_06 
                           NULL, --nCONTFSMU_07 
                           NULL, --nCANTFSMU_07 
                           NULL, --nCONTFSMU_08 
                           NULL, --nCANTFSMU_08 
                           NULL, --nCONTFSMU_09 
                           NULL, --nCANTFSMU_09 
                           NULL, --nCONTFSMU_10 
                           NULL, --nCANTFSMU_10 
                           NULL, --nANCHO_BUENO_TOTAL_01 
                           NULL, --nANCHO_BUENO_OT_01 
                           NULL, --nANCHO_BUENO_TOTAL_02 
                           NULL, --nANCHO_BUENO_OT_02 
                           NULL, --nANCHO_BUENO_TOTAL_03 
                           NULL, --nANCHO_BUENO_OT_03 
                           NULL, --nANCHO_BUENO_TOTAL_04 
                           NULL, --nANCHO_BUENO_OT_04 
                           NULL, --nANCHO_BUENO_TOTAL_05 
                           NULL, --nANCHO_BUENO_OT_05 
                           NULL, --nANCHO_BUENO_TOTAL_06 
                           NULL, --nANCHO_BUENO_OT_06 
                           NULL, --nANCHO_BUENO_TOTAL_07 
                           NULL, --nANCHO_BUENO_OT_07 
                           NULL, --nANCHO_BUENO_TOTAL_08 
                           NULL, --nANCHO_BUENO_OT_08 
                           NULL, --nANCHO_BUENO_TOTAL_09 
                           NULL, --nANCHO_BUENO_OT_09 
                           NULL, --nANCHO_BUENO_TOTAL_10 
                           NULL, --nANCHO_BUENO_OT_10 
                           NULL, --nANCHO_BUENO_TOTAL 
                           NULL, --nANCHO_BUENO_OT 
                           NULL, --nNUMECORT 
                           NULL, --nMM_MERMPRCO_01 
                           NULL, --nMM_MERMPLAN_EXESO_01 
                           NULL, --nMM_MERMPLAN_01 
                           NULL, --nMM_MERMPRCO_02 
                           NULL, --nMM_MERMPLAN_EXESO_02 
                           NULL, --nMM_MERMPLAN_02 
                           NULL, --nMM_MERMPRCO_03 
                           NULL, --nMM_MERMPLAN_EXESO_03 
                           NULL, --nMM_MERMPLAN_03 
                           NULL, --nMM_MERMPRCO_04 
                           NULL, --nMM_MERMPLAN_EXESO_04 
                           NULL, --nMM_MERMPLAN_04 
                           NULL, --nMM_MERMPRCO_05 
                           NULL, --nMM_MERMPLAN_EXESO_05 
                           NULL, --nMM_MERMPLAN_05 
                           NULL, --nMM_MERMPRCO_06 
                           NULL, --nMM_MERMPLAN_EXESO_06 
                           NULL, --nMM_MERMPLAN_06 
                           NULL, --nMM_MERMPRCO_07 
                           NULL, --nMM_MERMPLAN_EXESO_07 
                           NULL, --nMM_MERMPLAN_07 
                           NULL, --nMM_MERMPRCO_08 
                           NULL, --nMM_MERMPLAN_EXESO_08 
                           NULL, --nMM_MERMPLAN_08 
                           NULL, --nMM_MERMPRCO_09 
                           NULL, --nMM_MERMPLAN_EXESO_09 
                           NULL, --nMM_MERMPLAN_09 
                           NULL, --nMM_MERMPRCO_10 
                           NULL, --nMM_MERMPLAN_EXESO_10 
                           NULL, --nMM_MERMPLAN_10 
                           NULL, --nMM_MERMPRCO 
                           NULL, --nMM_MERMPLAN_EXESO 
                           0); --nMM_MERMPLAN
            ELSE
               P_ERRORES(vEmpresa, nNumeOtre, '647','la Merma de Planificación para el Material: '||rMATERIAL_B.Tip_Arti||'-'||rMATERIAL_B.Cod_Arti||' Ancho: '||rMATERIAL_B.ANCHO||' Ancho Bueno: '||rMATERIAL_B.ANCHO_BUENO_TOTAL||', Merma Negativa: '||rMATERIAL_B.MM_MERMPLAN||' Tolerancia: '||vTolemmMP||' Numero Cortes: '||rMATERIAL_B.NUMECORT||'|62.1.3','R','E');
            END IF;
         END IF;
         ----------------------------------------------
         --Fin de Tratamiento de Merma Negativa
         ----------------------------------------------
         ---------------------------------------
         --Tratamiento de Merma Negativa para 01
         ---------------------------------------
         --IF t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPRCO_01 < 0 THEN
         IF rMaterial_B.MM_MERMPRCO_01 < 0 THEN
            --IF ABS(t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPRCO_01) <= (vTolemmMP * t_MATERIAL(rMaterial_B.IDENTIFICADOR).NUMECORT_01) THEN
            IF ABS(rMaterial_B.MM_MERMPRCO_01) <= (vTolemmMP * rMaterial_B.NUMECORT_01) THEN
               --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPRCO_01 := 0;
               P_MATERIAL(rMaterial_B,'U',
                           NULL,--nCantProd
                           NULL,--nCantCons_E
                           NULL,--nCantCons
                           NULL,--nCantAjus
                           NULL,--nAncho
                           NULL,--nFACTOR_CONVERSION_M2_KG
                           NULL,--nPrecio_ML_E
                           NULL,--vLog_Precio
                           NULL,--nMermEnhe_E
                           NULL,--nMermEnhe
                           NULL,--nMermAjus_E
                           NULL,--nMermAjus
                           NULL,--nMermCabo_E
                           NULL,--nMermCabo
                           NULL,--nMermPico_E
                           NULL,--nMermPico
                           NULL,--nMermTita
                           NULL,--nMermSane
                           NULL,--nCantCons_Bobinas
                           --
                           NULL, --nCONTFSMU_01 
                           NULL, --nCANTFSMU_01 
                           NULL, --nCATOFSMU 
                           NULL, --nCONTFSMU_02 
                           NULL, --nCANTFSMU_02 
                           NULL, --nCONTFSMU_03 
                           NULL, --nCANTFSMU_03 
                           NULL, --nCONTFSMU_04 
                           NULL, --nCANTFSMU_04 
                           NULL, --nCONTFSMU_05 
                           NULL, --nCANTFSMU_05 
                           NULL, --nCONTFSMU_06 
                           NULL, --nCANTFSMU_06 
                           NULL, --nCONTFSMU_07 
                           NULL, --nCANTFSMU_07 
                           NULL, --nCONTFSMU_08 
                           NULL, --nCANTFSMU_08 
                           NULL, --nCONTFSMU_09 
                           NULL, --nCANTFSMU_09 
                           NULL, --nCONTFSMU_10 
                           NULL, --nCANTFSMU_10 
                           NULL, --nANCHO_BUENO_TOTAL_01 
                           NULL, --nANCHO_BUENO_OT_01 
                           NULL, --nANCHO_BUENO_TOTAL_02 
                           NULL, --nANCHO_BUENO_OT_02 
                           NULL, --nANCHO_BUENO_TOTAL_03 
                           NULL, --nANCHO_BUENO_OT_03 
                           NULL, --nANCHO_BUENO_TOTAL_04 
                           NULL, --nANCHO_BUENO_OT_04 
                           NULL, --nANCHO_BUENO_TOTAL_05 
                           NULL, --nANCHO_BUENO_OT_05 
                           NULL, --nANCHO_BUENO_TOTAL_06 
                           NULL, --nANCHO_BUENO_OT_06 
                           NULL, --nANCHO_BUENO_TOTAL_07 
                           NULL, --nANCHO_BUENO_OT_07 
                           NULL, --nANCHO_BUENO_TOTAL_08 
                           NULL, --nANCHO_BUENO_OT_08 
                           NULL, --nANCHO_BUENO_TOTAL_09 
                           NULL, --nANCHO_BUENO_OT_09 
                           NULL, --nANCHO_BUENO_TOTAL_10 
                           NULL, --nANCHO_BUENO_OT_10 
                           NULL, --nANCHO_BUENO_TOTAL 
                           NULL, --nANCHO_BUENO_OT 
                           NULL, --nNUMECORT 
                           0, --nMM_MERMPRCO_01 
                           NULL, --nMM_MERMPLAN_EXESO_01 
                           NULL, --nMM_MERMPLAN_01 
                           NULL, --nMM_MERMPRCO_02 
                           NULL, --nMM_MERMPLAN_EXESO_02 
                           NULL, --nMM_MERMPLAN_02 
                           NULL, --nMM_MERMPRCO_03 
                           NULL, --nMM_MERMPLAN_EXESO_03 
                           NULL, --nMM_MERMPLAN_03 
                           NULL, --nMM_MERMPRCO_04 
                           NULL, --nMM_MERMPLAN_EXESO_04 
                           NULL, --nMM_MERMPLAN_04 
                           NULL, --nMM_MERMPRCO_05 
                           NULL, --nMM_MERMPLAN_EXESO_05 
                           NULL, --nMM_MERMPLAN_05 
                           NULL, --nMM_MERMPRCO_06 
                           NULL, --nMM_MERMPLAN_EXESO_06 
                           NULL, --nMM_MERMPLAN_06 
                           NULL, --nMM_MERMPRCO_07 
                           NULL, --nMM_MERMPLAN_EXESO_07 
                           NULL, --nMM_MERMPLAN_07 
                           NULL, --nMM_MERMPRCO_08 
                           NULL, --nMM_MERMPLAN_EXESO_08 
                           NULL, --nMM_MERMPLAN_08 
                           NULL, --nMM_MERMPRCO_09 
                           NULL, --nMM_MERMPLAN_EXESO_09 
                           NULL, --nMM_MERMPLAN_09 
                           NULL, --nMM_MERMPRCO_10 
                           NULL, --nMM_MERMPLAN_EXESO_10 
                           NULL, --nMM_MERMPLAN_10 
                           NULL, --nMM_MERMPRCO 
                           NULL, --nMM_MERMPLAN_EXESO 
                           NULL); --nMM_MERMPLAN
            ELSE
               P_ERRORES(vEmpresa, nNumeOtre, '647','la Merma de Pre-Corte para el Material: '||rMATERIAL_B.Tip_Arti||'-'||rMATERIAL_B.Cod_Arti||' Ancho: '||rMATERIAL_B.ANCHO||' Ancho Bueno: '||rMATERIAL_B.ANCHO_BUENO_TOTAL_01||', Merma Negativa: '||rMATERIAL_B.MM_MERMPRCO_01||' Tolerancia: '||vTolemmMP||' Numero Cortes: '||rMATERIAL_B.NUMECORT||'|62.1.4','R','A');
            END IF;
         END IF;
         --
         --IF t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_EXESO_01 < 0 THEN
         IF rMaterial_B.MM_MERMPLAN_EXESO_01 < 0 THEN
            --IF ABS(t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_EXESO_01) <= (vTolemmMP * t_MATERIAL(rMaterial_B.IDENTIFICADOR).NUMECORT_01) THEN
            IF ABS(rMaterial_B.MM_MERMPLAN_EXESO_01) <= (vTolemmMP * rMaterial_B.NUMECORT_01) THEN
               --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_EXESO_01 := 0;
               P_MATERIAL(rMaterial_B,'U',
                           NULL,--nCantProd
                           NULL,--nCantCons_E
                           NULL,--nCantCons
                           NULL,--nCantAjus
                           NULL,--nAncho
                           NULL,--nFACTOR_CONVERSION_M2_KG
                           NULL,--nPrecio_ML_E
                           NULL,--vLog_Precio
                           NULL,--nMermEnhe_E
                           NULL,--nMermEnhe
                           NULL,--nMermAjus_E
                           NULL,--nMermAjus
                           NULL,--nMermCabo_E
                           NULL,--nMermCabo
                           NULL,--nMermPico_E
                           NULL,--nMermPico
                           NULL,--nMermTita
                           NULL,--nMermSane
                           NULL,--nCantCons_Bobinas
                           --
                           NULL, --nCONTFSMU_01 
                           NULL, --nCANTFSMU_01 
                           NULL, --nCATOFSMU 
                           NULL, --nCONTFSMU_02 
                           NULL, --nCANTFSMU_02 
                           NULL, --nCONTFSMU_03 
                           NULL, --nCANTFSMU_03 
                           NULL, --nCONTFSMU_04 
                           NULL, --nCANTFSMU_04 
                           NULL, --nCONTFSMU_05 
                           NULL, --nCANTFSMU_05 
                           NULL, --nCONTFSMU_06 
                           NULL, --nCANTFSMU_06 
                           NULL, --nCONTFSMU_07 
                           NULL, --nCANTFSMU_07 
                           NULL, --nCONTFSMU_08 
                           NULL, --nCANTFSMU_08 
                           NULL, --nCONTFSMU_09 
                           NULL, --nCANTFSMU_09 
                           NULL, --nCONTFSMU_10 
                           NULL, --nCANTFSMU_10 
                           NULL, --nANCHO_BUENO_TOTAL_01 
                           NULL, --nANCHO_BUENO_OT_01 
                           NULL, --nANCHO_BUENO_TOTAL_02 
                           NULL, --nANCHO_BUENO_OT_02 
                           NULL, --nANCHO_BUENO_TOTAL_03 
                           NULL, --nANCHO_BUENO_OT_03 
                           NULL, --nANCHO_BUENO_TOTAL_04 
                           NULL, --nANCHO_BUENO_OT_04 
                           NULL, --nANCHO_BUENO_TOTAL_05 
                           NULL, --nANCHO_BUENO_OT_05 
                           NULL, --nANCHO_BUENO_TOTAL_06 
                           NULL, --nANCHO_BUENO_OT_06 
                           NULL, --nANCHO_BUENO_TOTAL_07 
                           NULL, --nANCHO_BUENO_OT_07 
                           NULL, --nANCHO_BUENO_TOTAL_08 
                           NULL, --nANCHO_BUENO_OT_08 
                           NULL, --nANCHO_BUENO_TOTAL_09 
                           NULL, --nANCHO_BUENO_OT_09 
                           NULL, --nANCHO_BUENO_TOTAL_10 
                           NULL, --nANCHO_BUENO_OT_10 
                           NULL, --nANCHO_BUENO_TOTAL 
                           NULL, --nANCHO_BUENO_OT 
                           NULL, --nNUMECORT 
                           NULL, --nMM_MERMPRCO_01 
                           0, --nMM_MERMPLAN_EXESO_01 
                           NULL, --nMM_MERMPLAN_01 
                           NULL, --nMM_MERMPRCO_02 
                           NULL, --nMM_MERMPLAN_EXESO_02 
                           NULL, --nMM_MERMPLAN_02 
                           NULL, --nMM_MERMPRCO_03 
                           NULL, --nMM_MERMPLAN_EXESO_03 
                           NULL, --nMM_MERMPLAN_03 
                           NULL, --nMM_MERMPRCO_04 
                           NULL, --nMM_MERMPLAN_EXESO_04 
                           NULL, --nMM_MERMPLAN_04 
                           NULL, --nMM_MERMPRCO_05 
                           NULL, --nMM_MERMPLAN_EXESO_05 
                           NULL, --nMM_MERMPLAN_05 
                           NULL, --nMM_MERMPRCO_06 
                           NULL, --nMM_MERMPLAN_EXESO_06 
                           NULL, --nMM_MERMPLAN_06 
                           NULL, --nMM_MERMPRCO_07 
                           NULL, --nMM_MERMPLAN_EXESO_07 
                           NULL, --nMM_MERMPLAN_07 
                           NULL, --nMM_MERMPRCO_08 
                           NULL, --nMM_MERMPLAN_EXESO_08 
                           NULL, --nMM_MERMPLAN_08 
                           NULL, --nMM_MERMPRCO_09 
                           NULL, --nMM_MERMPLAN_EXESO_09 
                           NULL, --nMM_MERMPLAN_09 
                           NULL, --nMM_MERMPRCO_10 
                           NULL, --nMM_MERMPLAN_EXESO_10 
                           NULL, --nMM_MERMPLAN_10 
                           NULL, --nMM_MERMPRCO 
                           NULL, --nMM_MERMPLAN_EXESO 
                           NULL); --nMM_MERMPLAN
            ELSE
               P_ERRORES(vEmpresa, nNumeOtre, '647','la Merma de Planificación para el Material: '||rMATERIAL_B.Tip_Arti||'-'||rMATERIAL_B.Cod_Arti||' Ancho: '||rMATERIAL_B.ANCHO||' Ancho Bueno: '||rMATERIAL_B.ANCHO_BUENO_TOTAL_01||', Merma Negativa: '||rMATERIAL_B.MM_MERMPLAN_EXESO_02||' Tolerancia: '||vTolemmMP||' Numero Cortes: '||rMATERIAL_B.NUMECORT||'|62.1.5','R','A');
            END IF;
         END IF;
         ----------------------------------------------
         --Fin de Tratamiento de Merma Negativa para 01
         ----------------------------------------------
         ---------------------------------------
         --Tratamiento de Merma Negativa para 02
         ---------------------------------------
         --IF t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPRCO_02 < 0 THEN
         IF rMaterial_B.MM_MERMPRCO_02 < 0 THEN
            --IF ABS(t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPRCO_02) <= (vTolemmMP * t_MATERIAL(rMaterial_B.IDENTIFICADOR).NUMECORT_02) THEN
            IF ABS(rMaterial_B.MM_MERMPRCO_02) <= (vTolemmMP * rMaterial_B.NUMECORT_02) THEN
               --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPRCO_02 := 0;
               P_MATERIAL(rMaterial_B,'U',
                           NULL,--nCantProd
                           NULL,--nCantCons_E
                           NULL,--nCantCons
                           NULL,--nCantAjus
                           NULL,--nAncho
                           NULL,--nFACTOR_CONVERSION_M2_KG
                           NULL,--nPrecio_ML_E
                           NULL,--vLog_Precio
                           NULL,--nMermEnhe_E
                           NULL,--nMermEnhe
                           NULL,--nMermAjus_E
                           NULL,--nMermAjus
                           NULL,--nMermCabo_E
                           NULL,--nMermCabo
                           NULL,--nMermPico_E
                           NULL,--nMermPico
                           NULL,--nMermTita
                           NULL,--nMermSane
                           NULL,--nCantCons_Bobinas
                           --
                           NULL, --nCONTFSMU_01 
                           NULL, --nCANTFSMU_01 
                           NULL, --nCATOFSMU 
                           NULL, --nCONTFSMU_02 
                           NULL, --nCANTFSMU_02 
                           NULL, --nCONTFSMU_03 
                           NULL, --nCANTFSMU_03 
                           NULL, --nCONTFSMU_04 
                           NULL, --nCANTFSMU_04 
                           NULL, --nCONTFSMU_05 
                           NULL, --nCANTFSMU_05 
                           NULL, --nCONTFSMU_06 
                           NULL, --nCANTFSMU_06 
                           NULL, --nCONTFSMU_07 
                           NULL, --nCANTFSMU_07 
                           NULL, --nCONTFSMU_08 
                           NULL, --nCANTFSMU_08 
                           NULL, --nCONTFSMU_09 
                           NULL, --nCANTFSMU_09 
                           NULL, --nCONTFSMU_10 
                           NULL, --nCANTFSMU_10 
                           NULL, --nANCHO_BUENO_TOTAL_01 
                           NULL, --nANCHO_BUENO_OT_01 
                           NULL, --nANCHO_BUENO_TOTAL_02 
                           NULL, --nANCHO_BUENO_OT_02 
                           NULL, --nANCHO_BUENO_TOTAL_03 
                           NULL, --nANCHO_BUENO_OT_03 
                           NULL, --nANCHO_BUENO_TOTAL_04 
                           NULL, --nANCHO_BUENO_OT_04 
                           NULL, --nANCHO_BUENO_TOTAL_05 
                           NULL, --nANCHO_BUENO_OT_05 
                           NULL, --nANCHO_BUENO_TOTAL_06 
                           NULL, --nANCHO_BUENO_OT_06 
                           NULL, --nANCHO_BUENO_TOTAL_07 
                           NULL, --nANCHO_BUENO_OT_07 
                           NULL, --nANCHO_BUENO_TOTAL_08 
                           NULL, --nANCHO_BUENO_OT_08 
                           NULL, --nANCHO_BUENO_TOTAL_09 
                           NULL, --nANCHO_BUENO_OT_09 
                           NULL, --nANCHO_BUENO_TOTAL_10 
                           NULL, --nANCHO_BUENO_OT_10 
                           NULL, --nANCHO_BUENO_TOTAL 
                           NULL, --nANCHO_BUENO_OT 
                           NULL, --nNUMECORT 
                           NULL, --nMM_MERMPRCO_01 
                           NULL, --nMM_MERMPLAN_EXESO_01 
                           NULL, --nMM_MERMPLAN_01 
                           0, --nMM_MERMPRCO_02 
                           NULL, --nMM_MERMPLAN_EXESO_02 
                           NULL, --nMM_MERMPLAN_02 
                           NULL, --nMM_MERMPRCO_03 
                           NULL, --nMM_MERMPLAN_EXESO_03 
                           NULL, --nMM_MERMPLAN_03 
                           NULL, --nMM_MERMPRCO_04 
                           NULL, --nMM_MERMPLAN_EXESO_04 
                           NULL, --nMM_MERMPLAN_04 
                           NULL, --nMM_MERMPRCO_05 
                           NULL, --nMM_MERMPLAN_EXESO_05 
                           NULL, --nMM_MERMPLAN_05 
                           NULL, --nMM_MERMPRCO_06 
                           NULL, --nMM_MERMPLAN_EXESO_06 
                           NULL, --nMM_MERMPLAN_06 
                           NULL, --nMM_MERMPRCO_07 
                           NULL, --nMM_MERMPLAN_EXESO_07 
                           NULL, --nMM_MERMPLAN_07 
                           NULL, --nMM_MERMPRCO_08 
                           NULL, --nMM_MERMPLAN_EXESO_08 
                           NULL, --nMM_MERMPLAN_08 
                           NULL, --nMM_MERMPRCO_09 
                           NULL, --nMM_MERMPLAN_EXESO_09 
                           NULL, --nMM_MERMPLAN_09 
                           NULL, --nMM_MERMPRCO_10 
                           NULL, --nMM_MERMPLAN_EXESO_10 
                           NULL, --nMM_MERMPLAN_10 
                           NULL, --nMM_MERMPRCO 
                           NULL, --nMM_MERMPLAN_EXESO 
                           NULL); --nMM_MERMPLAN
            ELSE
               P_ERRORES(vEmpresa, nNumeOtre, '647','la Merma de Pre-Corte para el Material: '||rMATERIAL_B.Tip_Arti||'-'||rMATERIAL_B.Cod_Arti||' Ancho: '||rMATERIAL_B.ANCHO||' Ancho Bueno: '||rMATERIAL_B.ANCHO_BUENO_TOTAL_02||', Merma Negativa: '||rMATERIAL_B.MM_MERMPRCO_02||' Tolerancia: '||vTolemmMP||' Numero Cortes: '||rMATERIAL_B.NUMECORT||'|62.1.6','R','A');
            END IF;
         END IF;
         --
         --IF t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_EXESO_02 < 0 THEN
         IF rMaterial_B.MM_MERMPLAN_EXESO_02 < 0 THEN
            --IF ABS(t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_EXESO_02) <= (vTolemmMP * t_MATERIAL(rMaterial_B.IDENTIFICADOR).NUMECORT_02) THEN
            IF ABS(rMaterial_B.MM_MERMPLAN_EXESO_02) <= (vTolemmMP * rMaterial_B.NUMECORT_02) THEN
               --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_EXESO_02 := 0;
               P_MATERIAL(rMaterial_B,'U',
                           NULL,--nCantProd
                           NULL,--nCantCons_E
                           NULL,--nCantCons
                           NULL,--nCantAjus
                           NULL,--nAncho
                           NULL,--nFACTOR_CONVERSION_M2_KG
                           NULL,--nPrecio_ML_E
                           NULL,--vLog_Precio
                           NULL,--nMermEnhe_E
                           NULL,--nMermEnhe
                           NULL,--nMermAjus_E
                           NULL,--nMermAjus
                           NULL,--nMermCabo_E
                           NULL,--nMermCabo
                           NULL,--nMermPico_E
                           NULL,--nMermPico
                           NULL,--nMermTita
                           NULL,--nMermSane
                           NULL,--nCantCons_Bobinas
                           --
                           NULL, --nCONTFSMU_01 
                           NULL, --nCANTFSMU_01 
                           NULL, --nCATOFSMU 
                           NULL, --nCONTFSMU_02 
                           NULL, --nCANTFSMU_02 
                           NULL, --nCONTFSMU_03 
                           NULL, --nCANTFSMU_03 
                           NULL, --nCONTFSMU_04 
                           NULL, --nCANTFSMU_04 
                           NULL, --nCONTFSMU_05 
                           NULL, --nCANTFSMU_05 
                           NULL, --nCONTFSMU_06 
                           NULL, --nCANTFSMU_06 
                           NULL, --nCONTFSMU_07 
                           NULL, --nCANTFSMU_07 
                           NULL, --nCONTFSMU_08 
                           NULL, --nCANTFSMU_08 
                           NULL, --nCONTFSMU_09 
                           NULL, --nCANTFSMU_09 
                           NULL, --nCONTFSMU_10 
                           NULL, --nCANTFSMU_10 
                           NULL, --nANCHO_BUENO_TOTAL_01 
                           NULL, --nANCHO_BUENO_OT_01 
                           NULL, --nANCHO_BUENO_TOTAL_02 
                           NULL, --nANCHO_BUENO_OT_02 
                           NULL, --nANCHO_BUENO_TOTAL_03 
                           NULL, --nANCHO_BUENO_OT_03 
                           NULL, --nANCHO_BUENO_TOTAL_04 
                           NULL, --nANCHO_BUENO_OT_04 
                           NULL, --nANCHO_BUENO_TOTAL_05 
                           NULL, --nANCHO_BUENO_OT_05 
                           NULL, --nANCHO_BUENO_TOTAL_06 
                           NULL, --nANCHO_BUENO_OT_06 
                           NULL, --nANCHO_BUENO_TOTAL_07 
                           NULL, --nANCHO_BUENO_OT_07 
                           NULL, --nANCHO_BUENO_TOTAL_08 
                           NULL, --nANCHO_BUENO_OT_08 
                           NULL, --nANCHO_BUENO_TOTAL_09 
                           NULL, --nANCHO_BUENO_OT_09 
                           NULL, --nANCHO_BUENO_TOTAL_10 
                           NULL, --nANCHO_BUENO_OT_10 
                           NULL, --nANCHO_BUENO_TOTAL 
                           NULL, --nANCHO_BUENO_OT 
                           NULL, --nNUMECORT 
                           NULL, --nMM_MERMPRCO_01 
                           NULL, --nMM_MERMPLAN_EXESO_01 
                           NULL, --nMM_MERMPLAN_01 
                           NULL, --nMM_MERMPRCO_02 
                           0, --nMM_MERMPLAN_EXESO_02 
                           NULL, --nMM_MERMPLAN_02 
                           NULL, --nMM_MERMPRCO_03 
                           NULL, --nMM_MERMPLAN_EXESO_03 
                           NULL, --nMM_MERMPLAN_03 
                           NULL, --nMM_MERMPRCO_04 
                           NULL, --nMM_MERMPLAN_EXESO_04 
                           NULL, --nMM_MERMPLAN_04 
                           NULL, --nMM_MERMPRCO_05 
                           NULL, --nMM_MERMPLAN_EXESO_05 
                           NULL, --nMM_MERMPLAN_05 
                           NULL, --nMM_MERMPRCO_06 
                           NULL, --nMM_MERMPLAN_EXESO_06 
                           NULL, --nMM_MERMPLAN_06 
                           NULL, --nMM_MERMPRCO_07 
                           NULL, --nMM_MERMPLAN_EXESO_07 
                           NULL, --nMM_MERMPLAN_07 
                           NULL, --nMM_MERMPRCO_08 
                           NULL, --nMM_MERMPLAN_EXESO_08 
                           NULL, --nMM_MERMPLAN_08 
                           NULL, --nMM_MERMPRCO_09 
                           NULL, --nMM_MERMPLAN_EXESO_09 
                           NULL, --nMM_MERMPLAN_09 
                           NULL, --nMM_MERMPRCO_10 
                           NULL, --nMM_MERMPLAN_EXESO_10 
                           NULL, --nMM_MERMPLAN_10 
                           NULL, --nMM_MERMPRCO 
                           NULL, --nMM_MERMPLAN_EXESO 
                           NULL); --nMM_MERMPLAN
            ELSE
               P_ERRORES(vEmpresa, nNumeOtre, '647','la Merma de Planificación para el Material: '||rMATERIAL_B.Tip_Arti||'-'||rMATERIAL_B.Cod_Arti||' Ancho: '||rMATERIAL_B.ANCHO||' Ancho Bueno: '||rMATERIAL_B.ANCHO_BUENO_TOTAL_02||', Merma Negativa: '||rMATERIAL_B.MM_MERMPLAN_EXESO_02||' Tolerancia: '||vTolemmMP||' Numero Cortes: '||rMATERIAL_B.NUMECORT||'|62.1.7','R','A');
            END IF;
         END IF;
         ----------------------------------------------
         --Fin de Tratamiento de Merma Negativa para 02
         ----------------------------------------------
         ---------------------------------------
         --Tratamiento de Merma Negativa para 03
         ---------------------------------------
         --IF t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPRCO_03 < 0 THEN
         IF rMaterial_B.MM_MERMPRCO_03 < 0 THEN
            --IF ABS(t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPRCO_03) <= (vTolemmMP * t_MATERIAL(rMaterial_B.IDENTIFICADOR).NUMECORT_03) THEN
            IF ABS(rMaterial_B.MM_MERMPRCO_03) <= (vTolemmMP * rMaterial_B.NUMECORT_03) THEN
               --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPRCO_03 := 0;
               P_MATERIAL(rMaterial_B,'U',
                           NULL,--nCantProd
                           NULL,--nCantCons_E
                           NULL,--nCantCons
                           NULL,--nCantAjus
                           NULL,--nAncho
                           NULL,--nFACTOR_CONVERSION_M2_KG
                           NULL,--nPrecio_ML_E
                           NULL,--vLog_Precio
                           NULL,--nMermEnhe_E
                           NULL,--nMermEnhe
                           NULL,--nMermAjus_E
                           NULL,--nMermAjus
                           NULL,--nMermCabo_E
                           NULL,--nMermCabo
                           NULL,--nMermPico_E
                           NULL,--nMermPico
                           NULL,--nMermTita
                           NULL,--nMermSane
                           NULL,--nCantCons_Bobinas
                           --
                           NULL, --nCONTFSMU_01 
                           NULL, --nCANTFSMU_01 
                           NULL, --nCATOFSMU 
                           NULL, --nCONTFSMU_02 
                           NULL, --nCANTFSMU_02 
                           NULL, --nCONTFSMU_03 
                           NULL, --nCANTFSMU_03 
                           NULL, --nCONTFSMU_04 
                           NULL, --nCANTFSMU_04 
                           NULL, --nCONTFSMU_05 
                           NULL, --nCANTFSMU_05 
                           NULL, --nCONTFSMU_06 
                           NULL, --nCANTFSMU_06 
                           NULL, --nCONTFSMU_07 
                           NULL, --nCANTFSMU_07 
                           NULL, --nCONTFSMU_08 
                           NULL, --nCANTFSMU_08 
                           NULL, --nCONTFSMU_09 
                           NULL, --nCANTFSMU_09 
                           NULL, --nCONTFSMU_10 
                           NULL, --nCANTFSMU_10 
                           NULL, --nANCHO_BUENO_TOTAL_01 
                           NULL, --nANCHO_BUENO_OT_01 
                           NULL, --nANCHO_BUENO_TOTAL_02 
                           NULL, --nANCHO_BUENO_OT_02 
                           NULL, --nANCHO_BUENO_TOTAL_03 
                           NULL, --nANCHO_BUENO_OT_03 
                           NULL, --nANCHO_BUENO_TOTAL_04 
                           NULL, --nANCHO_BUENO_OT_04 
                           NULL, --nANCHO_BUENO_TOTAL_05 
                           NULL, --nANCHO_BUENO_OT_05 
                           NULL, --nANCHO_BUENO_TOTAL_06 
                           NULL, --nANCHO_BUENO_OT_06 
                           NULL, --nANCHO_BUENO_TOTAL_07 
                           NULL, --nANCHO_BUENO_OT_07 
                           NULL, --nANCHO_BUENO_TOTAL_08 
                           NULL, --nANCHO_BUENO_OT_08 
                           NULL, --nANCHO_BUENO_TOTAL_09 
                           NULL, --nANCHO_BUENO_OT_09 
                           NULL, --nANCHO_BUENO_TOTAL_10 
                           NULL, --nANCHO_BUENO_OT_10 
                           NULL, --nANCHO_BUENO_TOTAL 
                           NULL, --nANCHO_BUENO_OT 
                           NULL, --nNUMECORT 
                           NULL, --nMM_MERMPRCO_01 
                           NULL, --nMM_MERMPLAN_EXESO_01 
                           NULL, --nMM_MERMPLAN_01 
                           NULL, --nMM_MERMPRCO_02 
                           NULL, --nMM_MERMPLAN_EXESO_02 
                           NULL, --nMM_MERMPLAN_02 
                           0, --nMM_MERMPRCO_03 
                           NULL, --nMM_MERMPLAN_EXESO_03 
                           NULL, --nMM_MERMPLAN_03 
                           NULL, --nMM_MERMPRCO_04 
                           NULL, --nMM_MERMPLAN_EXESO_04 
                           NULL, --nMM_MERMPLAN_04 
                           NULL, --nMM_MERMPRCO_05 
                           NULL, --nMM_MERMPLAN_EXESO_05 
                           NULL, --nMM_MERMPLAN_05 
                           NULL, --nMM_MERMPRCO_06 
                           NULL, --nMM_MERMPLAN_EXESO_06 
                           NULL, --nMM_MERMPLAN_06 
                           NULL, --nMM_MERMPRCO_07 
                           NULL, --nMM_MERMPLAN_EXESO_07 
                           NULL, --nMM_MERMPLAN_07 
                           NULL, --nMM_MERMPRCO_08 
                           NULL, --nMM_MERMPLAN_EXESO_08 
                           NULL, --nMM_MERMPLAN_08 
                           NULL, --nMM_MERMPRCO_09 
                           NULL, --nMM_MERMPLAN_EXESO_09 
                           NULL, --nMM_MERMPLAN_09 
                           NULL, --nMM_MERMPRCO_10 
                           NULL, --nMM_MERMPLAN_EXESO_10 
                           NULL, --nMM_MERMPLAN_10 
                           NULL, --nMM_MERMPRCO 
                           NULL, --nMM_MERMPLAN_EXESO 
                           NULL); --nMM_MERMPLAN
            ELSE
               P_ERRORES(vEmpresa, nNumeOtre, '647','la Merma de Pre-Corte para el Material: '||rMATERIAL_B.Tip_Arti||'-'||rMATERIAL_B.Cod_Arti||' Ancho: '||rMATERIAL_B.ANCHO||' Ancho Bueno: '||rMATERIAL_B.ANCHO_BUENO_TOTAL_03||', Merma Negativa: '||rMATERIAL_B.MM_MERMPRCO_03||' Tolerancia: '||vTolemmMP||' Numero Cortes: '||rMATERIAL_B.NUMECORT||'|62.1.8','R','A');
            END IF;
         END IF;
         --
         --IF t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_EXESO_03 < 0 THEN
         IF rMaterial_B.MM_MERMPLAN_EXESO_03 < 0 THEN
            --IF ABS(t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_EXESO_03) <= (vTolemmMP * t_MATERIAL(rMaterial_B.IDENTIFICADOR).NUMECORT_03) THEN
            IF ABS(rMaterial_B.MM_MERMPLAN_EXESO_03) <= (vTolemmMP * rMaterial_B.NUMECORT_03) THEN
               --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_EXESO_03 := 0;
               P_MATERIAL(rMaterial_B,'U',
                           NULL,--nCantProd
                           NULL,--nCantCons_E
                           NULL,--nCantCons
                           NULL,--nCantAjus
                           NULL,--nAncho
                           NULL,--nFACTOR_CONVERSION_M2_KG
                           NULL,--nPrecio_ML_E
                           NULL,--vLog_Precio
                           NULL,--nMermEnhe_E
                           NULL,--nMermEnhe
                           NULL,--nMermAjus_E
                           NULL,--nMermAjus
                           NULL,--nMermCabo_E
                           NULL,--nMermCabo
                           NULL,--nMermPico_E
                           NULL,--nMermPico
                           NULL,--nMermTita
                           NULL,--nMermSane
                           NULL,--nCantCons_Bobinas
                           --
                           NULL, --nCONTFSMU_01 
                           NULL, --nCANTFSMU_01 
                           NULL, --nCATOFSMU 
                           NULL, --nCONTFSMU_02 
                           NULL, --nCANTFSMU_02 
                           NULL, --nCONTFSMU_03 
                           NULL, --nCANTFSMU_03 
                           NULL, --nCONTFSMU_04 
                           NULL, --nCANTFSMU_04 
                           NULL, --nCONTFSMU_05 
                           NULL, --nCANTFSMU_05 
                           NULL, --nCONTFSMU_06 
                           NULL, --nCANTFSMU_06 
                           NULL, --nCONTFSMU_07 
                           NULL, --nCANTFSMU_07 
                           NULL, --nCONTFSMU_08 
                           NULL, --nCANTFSMU_08 
                           NULL, --nCONTFSMU_09 
                           NULL, --nCANTFSMU_09 
                           NULL, --nCONTFSMU_10 
                           NULL, --nCANTFSMU_10 
                           NULL, --nANCHO_BUENO_TOTAL_01 
                           NULL, --nANCHO_BUENO_OT_01 
                           NULL, --nANCHO_BUENO_TOTAL_02 
                           NULL, --nANCHO_BUENO_OT_02 
                           NULL, --nANCHO_BUENO_TOTAL_03 
                           NULL, --nANCHO_BUENO_OT_03 
                           NULL, --nANCHO_BUENO_TOTAL_04 
                           NULL, --nANCHO_BUENO_OT_04 
                           NULL, --nANCHO_BUENO_TOTAL_05 
                           NULL, --nANCHO_BUENO_OT_05 
                           NULL, --nANCHO_BUENO_TOTAL_06 
                           NULL, --nANCHO_BUENO_OT_06 
                           NULL, --nANCHO_BUENO_TOTAL_07 
                           NULL, --nANCHO_BUENO_OT_07 
                           NULL, --nANCHO_BUENO_TOTAL_08 
                           NULL, --nANCHO_BUENO_OT_08 
                           NULL, --nANCHO_BUENO_TOTAL_09 
                           NULL, --nANCHO_BUENO_OT_09 
                           NULL, --nANCHO_BUENO_TOTAL_10 
                           NULL, --nANCHO_BUENO_OT_10 
                           NULL, --nANCHO_BUENO_TOTAL 
                           NULL, --nANCHO_BUENO_OT 
                           NULL, --nNUMECORT 
                           NULL, --nMM_MERMPRCO_01 
                           NULL, --nMM_MERMPLAN_EXESO_01 
                           NULL, --nMM_MERMPLAN_01 
                           NULL, --nMM_MERMPRCO_02 
                           NULL, --nMM_MERMPLAN_EXESO_02 
                           NULL, --nMM_MERMPLAN_02 
                           NULL, --nMM_MERMPRCO_03 
                           0, --nMM_MERMPLAN_EXESO_03 
                           NULL, --nMM_MERMPLAN_03 
                           NULL, --nMM_MERMPRCO_04 
                           NULL, --nMM_MERMPLAN_EXESO_04 
                           NULL, --nMM_MERMPLAN_04 
                           NULL, --nMM_MERMPRCO_05 
                           NULL, --nMM_MERMPLAN_EXESO_05 
                           NULL, --nMM_MERMPLAN_05 
                           NULL, --nMM_MERMPRCO_06 
                           NULL, --nMM_MERMPLAN_EXESO_06 
                           NULL, --nMM_MERMPLAN_06 
                           NULL, --nMM_MERMPRCO_07 
                           NULL, --nMM_MERMPLAN_EXESO_07 
                           NULL, --nMM_MERMPLAN_07 
                           NULL, --nMM_MERMPRCO_08 
                           NULL, --nMM_MERMPLAN_EXESO_08 
                           NULL, --nMM_MERMPLAN_08 
                           NULL, --nMM_MERMPRCO_09 
                           NULL, --nMM_MERMPLAN_EXESO_09 
                           NULL, --nMM_MERMPLAN_09 
                           NULL, --nMM_MERMPRCO_10 
                           NULL, --nMM_MERMPLAN_EXESO_10 
                           NULL, --nMM_MERMPLAN_10 
                           NULL, --nMM_MERMPRCO 
                           NULL, --nMM_MERMPLAN_EXESO 
                           NULL); --nMM_MERMPLAN
            ELSE
               P_ERRORES(vEmpresa, nNumeOtre, '647','la Merma de Planificación para el Material: '||rMATERIAL_B.Tip_Arti||'-'||rMATERIAL_B.Cod_Arti||' Ancho: '||rMATERIAL_B.ANCHO||' Ancho Bueno: '||rMATERIAL_B.ANCHO_BUENO_TOTAL_03||', Merma Negativa: '||rMATERIAL_B.MM_MERMPLAN_EXESO_03||' Tolerancia: '||vTolemmMP||' Numero Cortes: '||rMATERIAL_B.NUMECORT||'|62.1.9','R','A');
            END IF;
         END IF;
         ----------------------------------------------
         --Fin de Tratamiento de Merma Negativa para 03
         ----------------------------------------------
         ---------------------------------------
         --Tratamiento de Merma Negativa para 04
         ---------------------------------------
         --IF t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPRCO_04 < 0 THEN
         IF rMaterial_B.MM_MERMPRCO_04 < 0 THEN
            --IF ABS(t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPRCO_04) <= (vTolemmMP * t_MATERIAL(rMaterial_B.IDENTIFICADOR).NUMECORT_04) THEN
            IF ABS(rMaterial_B.MM_MERMPRCO_04) <= (vTolemmMP * rMaterial_B.NUMECORT_04) THEN
               --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPRCO_04 := 0;
               P_MATERIAL(rMaterial_B,'U',
                           NULL,--nCantProd
                           NULL,--nCantCons_E
                           NULL,--nCantCons
                           NULL,--nCantAjus
                           NULL,--nAncho
                           NULL,--nFACTOR_CONVERSION_M2_KG
                           NULL,--nPrecio_ML_E
                           NULL,--vLog_Precio
                           NULL,--nMermEnhe_E
                           NULL,--nMermEnhe
                           NULL,--nMermAjus_E
                           NULL,--nMermAjus
                           NULL,--nMermCabo_E
                           NULL,--nMermCabo
                           NULL,--nMermPico_E
                           NULL,--nMermPico
                           NULL,--nMermTita
                           NULL,--nMermSane
                           NULL,--nCantCons_Bobinas
                           --
                           NULL, --nCONTFSMU_01 
                           NULL, --nCANTFSMU_01 
                           NULL, --nCATOFSMU 
                           NULL, --nCONTFSMU_02 
                           NULL, --nCANTFSMU_02 
                           NULL, --nCONTFSMU_03 
                           NULL, --nCANTFSMU_03 
                           NULL, --nCONTFSMU_04 
                           NULL, --nCANTFSMU_04 
                           NULL, --nCONTFSMU_05 
                           NULL, --nCANTFSMU_05 
                           NULL, --nCONTFSMU_06 
                           NULL, --nCANTFSMU_06 
                           NULL, --nCONTFSMU_07 
                           NULL, --nCANTFSMU_07 
                           NULL, --nCONTFSMU_08 
                           NULL, --nCANTFSMU_08 
                           NULL, --nCONTFSMU_09 
                           NULL, --nCANTFSMU_09 
                           NULL, --nCONTFSMU_10 
                           NULL, --nCANTFSMU_10 
                           NULL, --nANCHO_BUENO_TOTAL_01 
                           NULL, --nANCHO_BUENO_OT_01 
                           NULL, --nANCHO_BUENO_TOTAL_02 
                           NULL, --nANCHO_BUENO_OT_02 
                           NULL, --nANCHO_BUENO_TOTAL_03 
                           NULL, --nANCHO_BUENO_OT_03 
                           NULL, --nANCHO_BUENO_TOTAL_04 
                           NULL, --nANCHO_BUENO_OT_04 
                           NULL, --nANCHO_BUENO_TOTAL_05 
                           NULL, --nANCHO_BUENO_OT_05 
                           NULL, --nANCHO_BUENO_TOTAL_06 
                           NULL, --nANCHO_BUENO_OT_06 
                           NULL, --nANCHO_BUENO_TOTAL_07 
                           NULL, --nANCHO_BUENO_OT_07 
                           NULL, --nANCHO_BUENO_TOTAL_08 
                           NULL, --nANCHO_BUENO_OT_08 
                           NULL, --nANCHO_BUENO_TOTAL_09 
                           NULL, --nANCHO_BUENO_OT_09 
                           NULL, --nANCHO_BUENO_TOTAL_10 
                           NULL, --nANCHO_BUENO_OT_10 
                           NULL, --nANCHO_BUENO_TOTAL 
                           NULL, --nANCHO_BUENO_OT 
                           NULL, --nNUMECORT 
                           NULL, --nMM_MERMPRCO_01 
                           NULL, --nMM_MERMPLAN_EXESO_01 
                           NULL, --nMM_MERMPLAN_01 
                           NULL, --nMM_MERMPRCO_02 
                           NULL, --nMM_MERMPLAN_EXESO_02 
                           NULL, --nMM_MERMPLAN_02 
                           NULL, --nMM_MERMPRCO_03 
                           NULL, --nMM_MERMPLAN_EXESO_03 
                           NULL, --nMM_MERMPLAN_03 
                           0, --nMM_MERMPRCO_04 
                           NULL, --nMM_MERMPLAN_EXESO_04 
                           NULL, --nMM_MERMPLAN_04 
                           NULL, --nMM_MERMPRCO_05 
                           NULL, --nMM_MERMPLAN_EXESO_05 
                           NULL, --nMM_MERMPLAN_05 
                           NULL, --nMM_MERMPRCO_06 
                           NULL, --nMM_MERMPLAN_EXESO_06 
                           NULL, --nMM_MERMPLAN_06 
                           NULL, --nMM_MERMPRCO_07 
                           NULL, --nMM_MERMPLAN_EXESO_07 
                           NULL, --nMM_MERMPLAN_07 
                           NULL, --nMM_MERMPRCO_08 
                           NULL, --nMM_MERMPLAN_EXESO_08 
                           NULL, --nMM_MERMPLAN_08 
                           NULL, --nMM_MERMPRCO_09 
                           NULL, --nMM_MERMPLAN_EXESO_09 
                           NULL, --nMM_MERMPLAN_09 
                           NULL, --nMM_MERMPRCO_10 
                           NULL, --nMM_MERMPLAN_EXESO_10 
                           NULL, --nMM_MERMPLAN_10 
                           NULL, --nMM_MERMPRCO 
                           NULL, --nMM_MERMPLAN_EXESO 
                           NULL); --nMM_MERMPLAN
            ELSE
               P_ERRORES(vEmpresa, nNumeOtre, '647','la Merma de Pre-Corte para el Material: '||rMATERIAL_B.Tip_Arti||'-'||rMATERIAL_B.Cod_Arti||' Ancho: '||rMATERIAL_B.ANCHO||' Ancho Bueno: '||rMaterial_B.ANCHO_BUENO_TOTAL_04||', Merma Negativa: '||rMaterial_B.MM_MERMPRCO_04||' Tolerancia: '||vTolemmMP||' Numero Cortes: '||rMaterial_B.NUMECORT||'|62.1.10','R','A');
            END IF;
         END IF;
         --
         --IF t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_EXESO_04 < 0 THEN
         IF rMaterial_B.MM_MERMPLAN_EXESO_04 < 0 THEN
            --IF ABS(t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_EXESO_04) <= (vTolemmMP * t_MATERIAL(rMaterial_B.IDENTIFICADOR).NUMECORT_04) THEN
            IF ABS(rMaterial_B.MM_MERMPLAN_EXESO_04) <= (vTolemmMP * rMaterial_B.NUMECORT_04) THEN
               --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_EXESO_04 := 0;
               P_MATERIAL(rMaterial_B,'U',
                           NULL,--nCantProd
                           NULL,--nCantCons_E
                           NULL,--nCantCons
                           NULL,--nCantAjus
                           NULL,--nAncho
                           NULL,--nFACTOR_CONVERSION_M2_KG
                           NULL,--nPrecio_ML_E
                           NULL,--vLog_Precio
                           NULL,--nMermEnhe_E
                           NULL,--nMermEnhe
                           NULL,--nMermAjus_E
                           NULL,--nMermAjus
                           NULL,--nMermCabo_E
                           NULL,--nMermCabo
                           NULL,--nMermPico_E
                           NULL,--nMermPico
                           NULL,--nMermTita
                           NULL,--nMermSane
                           NULL,--nCantCons_Bobinas
                           --
                           NULL, --nCONTFSMU_01 
                           NULL, --nCANTFSMU_01 
                           NULL, --nCATOFSMU 
                           NULL, --nCONTFSMU_02 
                           NULL, --nCANTFSMU_02 
                           NULL, --nCONTFSMU_03 
                           NULL, --nCANTFSMU_03 
                           NULL, --nCONTFSMU_04 
                           NULL, --nCANTFSMU_04 
                           NULL, --nCONTFSMU_05 
                           NULL, --nCANTFSMU_05 
                           NULL, --nCONTFSMU_06 
                           NULL, --nCANTFSMU_06 
                           NULL, --nCONTFSMU_07 
                           NULL, --nCANTFSMU_07 
                           NULL, --nCONTFSMU_08 
                           NULL, --nCANTFSMU_08 
                           NULL, --nCONTFSMU_09 
                           NULL, --nCANTFSMU_09 
                           NULL, --nCONTFSMU_10 
                           NULL, --nCANTFSMU_10 
                           NULL, --nANCHO_BUENO_TOTAL_01 
                           NULL, --nANCHO_BUENO_OT_01 
                           NULL, --nANCHO_BUENO_TOTAL_02 
                           NULL, --nANCHO_BUENO_OT_02 
                           NULL, --nANCHO_BUENO_TOTAL_03 
                           NULL, --nANCHO_BUENO_OT_03 
                           NULL, --nANCHO_BUENO_TOTAL_04 
                           NULL, --nANCHO_BUENO_OT_04 
                           NULL, --nANCHO_BUENO_TOTAL_05 
                           NULL, --nANCHO_BUENO_OT_05 
                           NULL, --nANCHO_BUENO_TOTAL_06 
                           NULL, --nANCHO_BUENO_OT_06 
                           NULL, --nANCHO_BUENO_TOTAL_07 
                           NULL, --nANCHO_BUENO_OT_07 
                           NULL, --nANCHO_BUENO_TOTAL_08 
                           NULL, --nANCHO_BUENO_OT_08 
                           NULL, --nANCHO_BUENO_TOTAL_09 
                           NULL, --nANCHO_BUENO_OT_09 
                           NULL, --nANCHO_BUENO_TOTAL_10 
                           NULL, --nANCHO_BUENO_OT_10 
                           NULL, --nANCHO_BUENO_TOTAL 
                           NULL, --nANCHO_BUENO_OT 
                           NULL, --nNUMECORT 
                           NULL, --nMM_MERMPRCO_01 
                           NULL, --nMM_MERMPLAN_EXESO_01 
                           NULL, --nMM_MERMPLAN_01 
                           NULL, --nMM_MERMPRCO_02 
                           NULL, --nMM_MERMPLAN_EXESO_02 
                           NULL, --nMM_MERMPLAN_02 
                           NULL, --nMM_MERMPRCO_03 
                           NULL, --nMM_MERMPLAN_EXESO_03 
                           NULL, --nMM_MERMPLAN_03 
                           NULL, --nMM_MERMPRCO_04 
                           0, --nMM_MERMPLAN_EXESO_04 
                           NULL, --nMM_MERMPLAN_04 
                           NULL, --nMM_MERMPRCO_05 
                           NULL, --nMM_MERMPLAN_EXESO_05 
                           NULL, --nMM_MERMPLAN_05 
                           NULL, --nMM_MERMPRCO_06 
                           NULL, --nMM_MERMPLAN_EXESO_06 
                           NULL, --nMM_MERMPLAN_06 
                           NULL, --nMM_MERMPRCO_07 
                           NULL, --nMM_MERMPLAN_EXESO_07 
                           NULL, --nMM_MERMPLAN_07 
                           NULL, --nMM_MERMPRCO_08 
                           NULL, --nMM_MERMPLAN_EXESO_08 
                           NULL, --nMM_MERMPLAN_08 
                           NULL, --nMM_MERMPRCO_09 
                           NULL, --nMM_MERMPLAN_EXESO_09 
                           NULL, --nMM_MERMPLAN_09 
                           NULL, --nMM_MERMPRCO_10 
                           NULL, --nMM_MERMPLAN_EXESO_10 
                           NULL, --nMM_MERMPLAN_10 
                           NULL, --nMM_MERMPRCO 
                           NULL, --nMM_MERMPLAN_EXESO 
                           NULL); --nMM_MERMPLAN
            ELSE
               P_ERRORES(vEmpresa, nNumeOtre, '647','la Merma de Planificación para el Material: '||rMATERIAL_B.Tip_Arti||'-'||rMATERIAL_B.Cod_Arti||' Ancho: '||rMATERIAL_B.ANCHO||' Ancho Bueno: '||rMaterial_B.ANCHO_BUENO_TOTAL_04||', Merma Negativa: '||rMaterial_B.MM_MERMPLAN_EXESO_04||' Tolerancia: '||vTolemmMP||' Numero Cortes: '||rMaterial_B.NUMECORT||'|62.1.11','R','A');
            END IF;
         END IF;
         ----------------------------------------------
         --Fin de Tratamiento de Merma Negativa para 04
         ----------------------------------------------
         ---------------------------------------
         --Tratamiento de Merma Negativa para 05
         ---------------------------------------
         --IF t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPRCO_05 < 0 THEN
         IF rMaterial_B.MM_MERMPRCO_05 < 0 THEN
            --IF ABS(t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPRCO_05) <= (vTolemmMP * t_MATERIAL(rMaterial_B.IDENTIFICADOR).NUMECORT_05) THEN
            IF ABS(rMaterial_B.MM_MERMPRCO_05) <= (vTolemmMP * rMaterial_B.NUMECORT_05) THEN
               --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPRCO_05 := 0;
               P_MATERIAL(rMaterial_B,'U',
                           NULL,--nCantProd
                           NULL,--nCantCons_E
                           NULL,--nCantCons
                           NULL,--nCantAjus
                           NULL,--nAncho
                           NULL,--nFACTOR_CONVERSION_M2_KG
                           NULL,--nPrecio_ML_E
                           NULL,--vLog_Precio
                           NULL,--nMermEnhe_E
                           NULL,--nMermEnhe
                           NULL,--nMermAjus_E
                           NULL,--nMermAjus
                           NULL,--nMermCabo_E
                           NULL,--nMermCabo
                           NULL,--nMermPico_E
                           NULL,--nMermPico
                           NULL,--nMermTita
                           NULL,--nMermSane
                           NULL,--nCantCons_Bobinas
                           --
                           NULL, --nCONTFSMU_01 
                           NULL, --nCANTFSMU_01 
                           NULL, --nCATOFSMU 
                           NULL, --nCONTFSMU_02 
                           NULL, --nCANTFSMU_02 
                           NULL, --nCONTFSMU_03 
                           NULL, --nCANTFSMU_03 
                           NULL, --nCONTFSMU_04 
                           NULL, --nCANTFSMU_04 
                           NULL, --nCONTFSMU_05 
                           NULL, --nCANTFSMU_05 
                           NULL, --nCONTFSMU_06 
                           NULL, --nCANTFSMU_06 
                           NULL, --nCONTFSMU_07 
                           NULL, --nCANTFSMU_07 
                           NULL, --nCONTFSMU_08 
                           NULL, --nCANTFSMU_08 
                           NULL, --nCONTFSMU_09 
                           NULL, --nCANTFSMU_09 
                           NULL, --nCONTFSMU_10 
                           NULL, --nCANTFSMU_10 
                           NULL, --nANCHO_BUENO_TOTAL_01 
                           NULL, --nANCHO_BUENO_OT_01 
                           NULL, --nANCHO_BUENO_TOTAL_02 
                           NULL, --nANCHO_BUENO_OT_02 
                           NULL, --nANCHO_BUENO_TOTAL_03 
                           NULL, --nANCHO_BUENO_OT_03 
                           NULL, --nANCHO_BUENO_TOTAL_04 
                           NULL, --nANCHO_BUENO_OT_04 
                           NULL, --nANCHO_BUENO_TOTAL_05 
                           NULL, --nANCHO_BUENO_OT_05 
                           NULL, --nANCHO_BUENO_TOTAL_06 
                           NULL, --nANCHO_BUENO_OT_06 
                           NULL, --nANCHO_BUENO_TOTAL_07 
                           NULL, --nANCHO_BUENO_OT_07 
                           NULL, --nANCHO_BUENO_TOTAL_08 
                           NULL, --nANCHO_BUENO_OT_08 
                           NULL, --nANCHO_BUENO_TOTAL_09 
                           NULL, --nANCHO_BUENO_OT_09 
                           NULL, --nANCHO_BUENO_TOTAL_10 
                           NULL, --nANCHO_BUENO_OT_10 
                           NULL, --nANCHO_BUENO_TOTAL 
                           NULL, --nANCHO_BUENO_OT 
                           NULL, --nNUMECORT 
                           NULL, --nMM_MERMPRCO_01 
                           NULL, --nMM_MERMPLAN_EXESO_01 
                           NULL, --nMM_MERMPLAN_01 
                           NULL, --nMM_MERMPRCO_02 
                           NULL, --nMM_MERMPLAN_EXESO_02 
                           NULL, --nMM_MERMPLAN_02 
                           NULL, --nMM_MERMPRCO_03 
                           NULL, --nMM_MERMPLAN_EXESO_03 
                           NULL, --nMM_MERMPLAN_03 
                           NULL, --nMM_MERMPRCO_04 
                           NULL, --nMM_MERMPLAN_EXESO_04 
                           NULL, --nMM_MERMPLAN_04 
                           0, --nMM_MERMPRCO_05 
                           NULL, --nMM_MERMPLAN_EXESO_05 
                           NULL, --nMM_MERMPLAN_05 
                           NULL, --nMM_MERMPRCO_06 
                           NULL, --nMM_MERMPLAN_EXESO_06 
                           NULL, --nMM_MERMPLAN_06 
                           NULL, --nMM_MERMPRCO_07 
                           NULL, --nMM_MERMPLAN_EXESO_07 
                           NULL, --nMM_MERMPLAN_07 
                           NULL, --nMM_MERMPRCO_08 
                           NULL, --nMM_MERMPLAN_EXESO_08 
                           NULL, --nMM_MERMPLAN_08 
                           NULL, --nMM_MERMPRCO_09 
                           NULL, --nMM_MERMPLAN_EXESO_09 
                           NULL, --nMM_MERMPLAN_09 
                           NULL, --nMM_MERMPRCO_10 
                           NULL, --nMM_MERMPLAN_EXESO_10 
                           NULL, --nMM_MERMPLAN_10 
                           NULL, --nMM_MERMPRCO 
                           NULL, --nMM_MERMPLAN_EXESO 
                           NULL); --nMM_MERMPLAN
            ELSE
               P_ERRORES(vEmpresa, nNumeOtre, '647','la Merma de Pre-Corte para el Material: '||rMATERIAL_B.Tip_Arti||'-'||rMATERIAL_B.Cod_Arti||' Ancho: '||rMATERIAL_B.ANCHO||' Ancho Bueno: '||rMaterial_B.ANCHO_BUENO_TOTAL_05||', Merma Negativa: '||rMaterial_B.MM_MERMPRCO_05||' Tolerancia: '||vTolemmMP||' Numero Cortes: '||rMaterial_B.NUMECORT||'|62.1.12','R','A');
            END IF;
         END IF;
         --
         --IF t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_EXESO_05 < 0 THEN
         IF rMaterial_B.MM_MERMPLAN_EXESO_05 < 0 THEN
            --IF ABS(t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_EXESO_05) <= (vTolemmMP * t_MATERIAL(rMaterial_B.IDENTIFICADOR).NUMECORT_05) THEN
            IF ABS(rMaterial_B.MM_MERMPLAN_EXESO_05) <= (vTolemmMP * rMaterial_B.NUMECORT_05) THEN
               --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_EXESO_05 := 0;
               P_MATERIAL(rMaterial_B,'U',
                           NULL,--nCantProd
                           NULL,--nCantCons_E
                           NULL,--nCantCons
                           NULL,--nCantAjus
                           NULL,--nAncho
                           NULL,--nFACTOR_CONVERSION_M2_KG
                           NULL,--nPrecio_ML_E
                           NULL,--vLog_Precio
                           NULL,--nMermEnhe_E
                           NULL,--nMermEnhe
                           NULL,--nMermAjus_E
                           NULL,--nMermAjus
                           NULL,--nMermCabo_E
                           NULL,--nMermCabo
                           NULL,--nMermPico_E
                           NULL,--nMermPico
                           NULL,--nMermTita
                           NULL,--nMermSane
                           NULL,--nCantCons_Bobinas
                           --
                           NULL, --nCONTFSMU_01 
                           NULL, --nCANTFSMU_01 
                           NULL, --nCATOFSMU 
                           NULL, --nCONTFSMU_02 
                           NULL, --nCANTFSMU_02 
                           NULL, --nCONTFSMU_03 
                           NULL, --nCANTFSMU_03 
                           NULL, --nCONTFSMU_04 
                           NULL, --nCANTFSMU_04 
                           NULL, --nCONTFSMU_05 
                           NULL, --nCANTFSMU_05 
                           NULL, --nCONTFSMU_06 
                           NULL, --nCANTFSMU_06 
                           NULL, --nCONTFSMU_07 
                           NULL, --nCANTFSMU_07 
                           NULL, --nCONTFSMU_08 
                           NULL, --nCANTFSMU_08 
                           NULL, --nCONTFSMU_09 
                           NULL, --nCANTFSMU_09 
                           NULL, --nCONTFSMU_10 
                           NULL, --nCANTFSMU_10 
                           NULL, --nANCHO_BUENO_TOTAL_01 
                           NULL, --nANCHO_BUENO_OT_01 
                           NULL, --nANCHO_BUENO_TOTAL_02 
                           NULL, --nANCHO_BUENO_OT_02 
                           NULL, --nANCHO_BUENO_TOTAL_03 
                           NULL, --nANCHO_BUENO_OT_03 
                           NULL, --nANCHO_BUENO_TOTAL_04 
                           NULL, --nANCHO_BUENO_OT_04 
                           NULL, --nANCHO_BUENO_TOTAL_05 
                           NULL, --nANCHO_BUENO_OT_05 
                           NULL, --nANCHO_BUENO_TOTAL_06 
                           NULL, --nANCHO_BUENO_OT_06 
                           NULL, --nANCHO_BUENO_TOTAL_07 
                           NULL, --nANCHO_BUENO_OT_07 
                           NULL, --nANCHO_BUENO_TOTAL_08 
                           NULL, --nANCHO_BUENO_OT_08 
                           NULL, --nANCHO_BUENO_TOTAL_09 
                           NULL, --nANCHO_BUENO_OT_09 
                           NULL, --nANCHO_BUENO_TOTAL_10 
                           NULL, --nANCHO_BUENO_OT_10 
                           NULL, --nANCHO_BUENO_TOTAL 
                           NULL, --nANCHO_BUENO_OT 
                           NULL, --nNUMECORT 
                           NULL, --nMM_MERMPRCO_01 
                           NULL, --nMM_MERMPLAN_EXESO_01 
                           NULL, --nMM_MERMPLAN_01 
                           NULL, --nMM_MERMPRCO_02 
                           NULL, --nMM_MERMPLAN_EXESO_02 
                           NULL, --nMM_MERMPLAN_02 
                           NULL, --nMM_MERMPRCO_03 
                           NULL, --nMM_MERMPLAN_EXESO_03 
                           NULL, --nMM_MERMPLAN_03 
                           NULL, --nMM_MERMPRCO_04 
                           NULL, --nMM_MERMPLAN_EXESO_04 
                           NULL, --nMM_MERMPLAN_04 
                           NULL, --nMM_MERMPRCO_05 
                           0, --nMM_MERMPLAN_EXESO_05 
                           NULL, --nMM_MERMPLAN_05 
                           NULL, --nMM_MERMPRCO_06 
                           NULL, --nMM_MERMPLAN_EXESO_06 
                           NULL, --nMM_MERMPLAN_06 
                           NULL, --nMM_MERMPRCO_07 
                           NULL, --nMM_MERMPLAN_EXESO_07 
                           NULL, --nMM_MERMPLAN_07 
                           NULL, --nMM_MERMPRCO_08 
                           NULL, --nMM_MERMPLAN_EXESO_08 
                           NULL, --nMM_MERMPLAN_08 
                           NULL, --nMM_MERMPRCO_09 
                           NULL, --nMM_MERMPLAN_EXESO_09 
                           NULL, --nMM_MERMPLAN_09 
                           NULL, --nMM_MERMPRCO_10 
                           NULL, --nMM_MERMPLAN_EXESO_10 
                           NULL, --nMM_MERMPLAN_10 
                           NULL, --nMM_MERMPRCO 
                           NULL, --nMM_MERMPLAN_EXESO 
                           NULL); --nMM_MERMPLAN
            ELSE
               P_ERRORES(vEmpresa, nNumeOtre, '647','la Merma de Planificación para el Material: '||rMATERIAL_B.Tip_Arti||'-'||rMATERIAL_B.Cod_Arti||' Ancho: '||rMATERIAL_B.ANCHO||' Ancho Bueno: '||rMaterial_B.ANCHO_BUENO_TOTAL_05||', Merma Negativa: '||rMaterial_B.MM_MERMPLAN_EXESO_05||' Tolerancia: '||vTolemmMP||' Numero Cortes: '||rMaterial_B.NUMECORT||'|62.1.13','R','A');
            END IF;
         END IF;
         ----------------------------------------------
         --Fin de Tratamiento de Merma Negativa para 05
         ----------------------------------------------
         ---------------------------------------
         --Tratamiento de Merma Negativa para 06
         ---------------------------------------
         --IF t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPRCO_06 < 0 THEN
         IF rMaterial_B.MM_MERMPRCO_06 < 0 THEN
            --IF ABS(t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPRCO_06) <= (vTolemmMP * t_MATERIAL(rMaterial_B.IDENTIFICADOR).NUMECORT_06) THEN
            IF ABS(rMaterial_B.MM_MERMPRCO_06) <= (vTolemmMP * rMaterial_B.NUMECORT_06) THEN
               --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPRCO_06 := 0;
               P_MATERIAL(rMaterial_B,'U',
                           NULL,--nCantProd
                           NULL,--nCantCons_E
                           NULL,--nCantCons
                           NULL,--nCantAjus
                           NULL,--nAncho
                           NULL,--nFACTOR_CONVERSION_M2_KG
                           NULL,--nPrecio_ML_E
                           NULL,--vLog_Precio
                           NULL,--nMermEnhe_E
                           NULL,--nMermEnhe
                           NULL,--nMermAjus_E
                           NULL,--nMermAjus
                           NULL,--nMermCabo_E
                           NULL,--nMermCabo
                           NULL,--nMermPico_E
                           NULL,--nMermPico
                           NULL,--nMermTita
                           NULL,--nMermSane
                           NULL,--nCantCons_Bobinas
                           --
                           NULL, --nCONTFSMU_01 
                           NULL, --nCANTFSMU_01 
                           NULL, --nCATOFSMU 
                           NULL, --nCONTFSMU_02 
                           NULL, --nCANTFSMU_02 
                           NULL, --nCONTFSMU_03 
                           NULL, --nCANTFSMU_03 
                           NULL, --nCONTFSMU_04 
                           NULL, --nCANTFSMU_04 
                           NULL, --nCONTFSMU_05 
                           NULL, --nCANTFSMU_05 
                           NULL, --nCONTFSMU_06 
                           NULL, --nCANTFSMU_06 
                           NULL, --nCONTFSMU_07 
                           NULL, --nCANTFSMU_07 
                           NULL, --nCONTFSMU_08 
                           NULL, --nCANTFSMU_08 
                           NULL, --nCONTFSMU_09 
                           NULL, --nCANTFSMU_09 
                           NULL, --nCONTFSMU_10 
                           NULL, --nCANTFSMU_10 
                           NULL, --nANCHO_BUENO_TOTAL_01 
                           NULL, --nANCHO_BUENO_OT_01 
                           NULL, --nANCHO_BUENO_TOTAL_02 
                           NULL, --nANCHO_BUENO_OT_02 
                           NULL, --nANCHO_BUENO_TOTAL_03 
                           NULL, --nANCHO_BUENO_OT_03 
                           NULL, --nANCHO_BUENO_TOTAL_04 
                           NULL, --nANCHO_BUENO_OT_04 
                           NULL, --nANCHO_BUENO_TOTAL_05 
                           NULL, --nANCHO_BUENO_OT_05 
                           NULL, --nANCHO_BUENO_TOTAL_06 
                           NULL, --nANCHO_BUENO_OT_06 
                           NULL, --nANCHO_BUENO_TOTAL_07 
                           NULL, --nANCHO_BUENO_OT_07 
                           NULL, --nANCHO_BUENO_TOTAL_08 
                           NULL, --nANCHO_BUENO_OT_08 
                           NULL, --nANCHO_BUENO_TOTAL_09 
                           NULL, --nANCHO_BUENO_OT_09 
                           NULL, --nANCHO_BUENO_TOTAL_10 
                           NULL, --nANCHO_BUENO_OT_10 
                           NULL, --nANCHO_BUENO_TOTAL 
                           NULL, --nANCHO_BUENO_OT 
                           NULL, --nNUMECORT 
                           NULL, --nMM_MERMPRCO_01 
                           NULL, --nMM_MERMPLAN_EXESO_01 
                           NULL, --nMM_MERMPLAN_01 
                           NULL, --nMM_MERMPRCO_02 
                           NULL, --nMM_MERMPLAN_EXESO_02 
                           NULL, --nMM_MERMPLAN_02 
                           NULL, --nMM_MERMPRCO_03 
                           NULL, --nMM_MERMPLAN_EXESO_03 
                           NULL, --nMM_MERMPLAN_03 
                           NULL, --nMM_MERMPRCO_04 
                           NULL, --nMM_MERMPLAN_EXESO_04 
                           NULL, --nMM_MERMPLAN_04 
                           NULL, --nMM_MERMPRCO_05 
                           NULL, --nMM_MERMPLAN_EXESO_05 
                           NULL, --nMM_MERMPLAN_05 
                           0, --nMM_MERMPRCO_06 
                           NULL, --nMM_MERMPLAN_EXESO_06 
                           NULL, --nMM_MERMPLAN_06 
                           NULL, --nMM_MERMPRCO_07 
                           NULL, --nMM_MERMPLAN_EXESO_07 
                           NULL, --nMM_MERMPLAN_07 
                           NULL, --nMM_MERMPRCO_08 
                           NULL, --nMM_MERMPLAN_EXESO_08 
                           NULL, --nMM_MERMPLAN_08 
                           NULL, --nMM_MERMPRCO_09 
                           NULL, --nMM_MERMPLAN_EXESO_09 
                           NULL, --nMM_MERMPLAN_09 
                           NULL, --nMM_MERMPRCO_10 
                           NULL, --nMM_MERMPLAN_EXESO_10 
                           NULL, --nMM_MERMPLAN_10 
                           NULL, --nMM_MERMPRCO 
                           NULL, --nMM_MERMPLAN_EXESO 
                           NULL); --nMM_MERMPLAN
            ELSE
               P_ERRORES(vEmpresa, nNumeOtre, '647','la Merma de Pre-Corte para el Material: '||rMATERIAL_B.Tip_Arti||'-'||rMATERIAL_B.Cod_Arti||' Ancho: '||rMATERIAL_B.ANCHO||' Ancho Bueno: '||rMaterial_B.ANCHO_BUENO_TOTAL_06||', Merma Negativa: '||rMaterial_B.MM_MERMPRCO_06||' Tolerancia: '||vTolemmMP||' Numero Cortes: '||rMaterial_B.NUMECORT||'|62.1.14','R','A');
            END IF;
         END IF;
         --
         --IF t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_EXESO_06 < 0 THEN
         IF rMaterial_B.MM_MERMPLAN_EXESO_06 < 0 THEN
            --IF ABS(t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_EXESO_06) <= (vTolemmMP * t_MATERIAL(rMaterial_B.IDENTIFICADOR).NUMECORT_06) THEN
            IF ABS(rMaterial_B.MM_MERMPLAN_EXESO_06) <= (vTolemmMP * rMaterial_B.NUMECORT_06) THEN
               --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_EXESO_06 := 0;
               P_MATERIAL(rMaterial_B,'U',
                           NULL,--nCantProd
                           NULL,--nCantCons_E
                           NULL,--nCantCons
                           NULL,--nCantAjus
                           NULL,--nAncho
                           NULL,--nFACTOR_CONVERSION_M2_KG
                           NULL,--nPrecio_ML_E
                           NULL,--vLog_Precio
                           NULL,--nMermEnhe_E
                           NULL,--nMermEnhe
                           NULL,--nMermAjus_E
                           NULL,--nMermAjus
                           NULL,--nMermCabo_E
                           NULL,--nMermCabo
                           NULL,--nMermPico_E
                           NULL,--nMermPico
                           NULL,--nMermTita
                           NULL,--nMermSane
                           NULL,--nCantCons_Bobinas
                           --
                           NULL, --nCONTFSMU_01 
                           NULL, --nCANTFSMU_01 
                           NULL, --nCATOFSMU 
                           NULL, --nCONTFSMU_02 
                           NULL, --nCANTFSMU_02 
                           NULL, --nCONTFSMU_03 
                           NULL, --nCANTFSMU_03 
                           NULL, --nCONTFSMU_04 
                           NULL, --nCANTFSMU_04 
                           NULL, --nCONTFSMU_05 
                           NULL, --nCANTFSMU_05 
                           NULL, --nCONTFSMU_06 
                           NULL, --nCANTFSMU_06 
                           NULL, --nCONTFSMU_07 
                           NULL, --nCANTFSMU_07 
                           NULL, --nCONTFSMU_08 
                           NULL, --nCANTFSMU_08 
                           NULL, --nCONTFSMU_09 
                           NULL, --nCANTFSMU_09 
                           NULL, --nCONTFSMU_10 
                           NULL, --nCANTFSMU_10 
                           NULL, --nANCHO_BUENO_TOTAL_01 
                           NULL, --nANCHO_BUENO_OT_01 
                           NULL, --nANCHO_BUENO_TOTAL_02 
                           NULL, --nANCHO_BUENO_OT_02 
                           NULL, --nANCHO_BUENO_TOTAL_03 
                           NULL, --nANCHO_BUENO_OT_03 
                           NULL, --nANCHO_BUENO_TOTAL_04 
                           NULL, --nANCHO_BUENO_OT_04 
                           NULL, --nANCHO_BUENO_TOTAL_05 
                           NULL, --nANCHO_BUENO_OT_05 
                           NULL, --nANCHO_BUENO_TOTAL_06 
                           NULL, --nANCHO_BUENO_OT_06 
                           NULL, --nANCHO_BUENO_TOTAL_07 
                           NULL, --nANCHO_BUENO_OT_07 
                           NULL, --nANCHO_BUENO_TOTAL_08 
                           NULL, --nANCHO_BUENO_OT_08 
                           NULL, --nANCHO_BUENO_TOTAL_09 
                           NULL, --nANCHO_BUENO_OT_09 
                           NULL, --nANCHO_BUENO_TOTAL_10 
                           NULL, --nANCHO_BUENO_OT_10 
                           NULL, --nANCHO_BUENO_TOTAL 
                           NULL, --nANCHO_BUENO_OT 
                           NULL, --nNUMECORT 
                           NULL, --nMM_MERMPRCO_01 
                           NULL, --nMM_MERMPLAN_EXESO_01 
                           NULL, --nMM_MERMPLAN_01 
                           NULL, --nMM_MERMPRCO_02 
                           NULL, --nMM_MERMPLAN_EXESO_02 
                           NULL, --nMM_MERMPLAN_02 
                           NULL, --nMM_MERMPRCO_03 
                           NULL, --nMM_MERMPLAN_EXESO_03 
                           NULL, --nMM_MERMPLAN_03 
                           NULL, --nMM_MERMPRCO_04 
                           NULL, --nMM_MERMPLAN_EXESO_04 
                           NULL, --nMM_MERMPLAN_04 
                           NULL, --nMM_MERMPRCO_05 
                           NULL, --nMM_MERMPLAN_EXESO_05 
                           NULL, --nMM_MERMPLAN_05 
                           NULL, --nMM_MERMPRCO_06 
                           0, --nMM_MERMPLAN_EXESO_06 
                           NULL, --nMM_MERMPLAN_06 
                           NULL, --nMM_MERMPRCO_07 
                           NULL, --nMM_MERMPLAN_EXESO_07 
                           NULL, --nMM_MERMPLAN_07 
                           NULL, --nMM_MERMPRCO_08 
                           NULL, --nMM_MERMPLAN_EXESO_08 
                           NULL, --nMM_MERMPLAN_08 
                           NULL, --nMM_MERMPRCO_09 
                           NULL, --nMM_MERMPLAN_EXESO_09 
                           NULL, --nMM_MERMPLAN_09 
                           NULL, --nMM_MERMPRCO_10 
                           NULL, --nMM_MERMPLAN_EXESO_10 
                           NULL, --nMM_MERMPLAN_10 
                           NULL, --nMM_MERMPRCO 
                           NULL, --nMM_MERMPLAN_EXESO 
                           NULL); --nMM_MERMPLAN
            ELSE
               P_ERRORES(vEmpresa, nNumeOtre, '647','la Merma de Planificación para el Material: '||rMATERIAL_B.Tip_Arti||'-'||rMATERIAL_B.Cod_Arti||' Ancho: '||rMATERIAL_B.ANCHO||' Ancho Bueno: '||rMaterial_B.ANCHO_BUENO_TOTAL_06||', Merma Negativa: '||rMaterial_B.MM_MERMPLAN_EXESO_06||' Tolerancia: '||vTolemmMP||' Numero Cortes: '||rMaterial_B.NUMECORT||'|62.1.15','R','A');
            END IF;
         END IF;
         ----------------------------------------------
         --Fin de Tratamiento de Merma Negativa para 06
         ----------------------------------------------
         ---------------------------------------
         --Tratamiento de Merma Negativa para 07
         ---------------------------------------
         --IF t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPRCO_07 < 0 THEN
         IF rMaterial_B.MM_MERMPRCO_07 < 0 THEN
            --IF ABS(t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPRCO_07) <= (vTolemmMP * t_MATERIAL(rMaterial_B.IDENTIFICADOR).NUMECORT_07) THEN
            IF ABS(rMaterial_B.MM_MERMPRCO_07) <= (vTolemmMP * rMaterial_B.NUMECORT_07) THEN
               --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPRCO_07 := 0;
               P_MATERIAL(rMaterial_B,'U',
                           NULL,--nCantProd
                           NULL,--nCantCons_E
                           NULL,--nCantCons
                           NULL,--nCantAjus
                           NULL,--nAncho
                           NULL,--nFACTOR_CONVERSION_M2_KG
                           NULL,--nPrecio_ML_E
                           NULL,--vLog_Precio
                           NULL,--nMermEnhe_E
                           NULL,--nMermEnhe
                           NULL,--nMermAjus_E
                           NULL,--nMermAjus
                           NULL,--nMermCabo_E
                           NULL,--nMermCabo
                           NULL,--nMermPico_E
                           NULL,--nMermPico
                           NULL,--nMermTita
                           NULL,--nMermSane
                           NULL,--nCantCons_Bobinas
                           --
                           NULL, --nCONTFSMU_01 
                           NULL, --nCANTFSMU_01 
                           NULL, --nCATOFSMU 
                           NULL, --nCONTFSMU_02 
                           NULL, --nCANTFSMU_02 
                           NULL, --nCONTFSMU_03 
                           NULL, --nCANTFSMU_03 
                           NULL, --nCONTFSMU_04 
                           NULL, --nCANTFSMU_04 
                           NULL, --nCONTFSMU_05 
                           NULL, --nCANTFSMU_05 
                           NULL, --nCONTFSMU_06 
                           NULL, --nCANTFSMU_06 
                           NULL, --nCONTFSMU_07 
                           NULL, --nCANTFSMU_07 
                           NULL, --nCONTFSMU_08 
                           NULL, --nCANTFSMU_08 
                           NULL, --nCONTFSMU_09 
                           NULL, --nCANTFSMU_09 
                           NULL, --nCONTFSMU_10 
                           NULL, --nCANTFSMU_10 
                           NULL, --nANCHO_BUENO_TOTAL_01 
                           NULL, --nANCHO_BUENO_OT_01 
                           NULL, --nANCHO_BUENO_TOTAL_02 
                           NULL, --nANCHO_BUENO_OT_02 
                           NULL, --nANCHO_BUENO_TOTAL_03 
                           NULL, --nANCHO_BUENO_OT_03 
                           NULL, --nANCHO_BUENO_TOTAL_04 
                           NULL, --nANCHO_BUENO_OT_04 
                           NULL, --nANCHO_BUENO_TOTAL_05 
                           NULL, --nANCHO_BUENO_OT_05 
                           NULL, --nANCHO_BUENO_TOTAL_06 
                           NULL, --nANCHO_BUENO_OT_06 
                           NULL, --nANCHO_BUENO_TOTAL_07 
                           NULL, --nANCHO_BUENO_OT_07 
                           NULL, --nANCHO_BUENO_TOTAL_08 
                           NULL, --nANCHO_BUENO_OT_08 
                           NULL, --nANCHO_BUENO_TOTAL_09 
                           NULL, --nANCHO_BUENO_OT_09 
                           NULL, --nANCHO_BUENO_TOTAL_10 
                           NULL, --nANCHO_BUENO_OT_10 
                           NULL, --nANCHO_BUENO_TOTAL 
                           NULL, --nANCHO_BUENO_OT 
                           NULL, --nNUMECORT 
                           NULL, --nMM_MERMPRCO_01 
                           NULL, --nMM_MERMPLAN_EXESO_01 
                           NULL, --nMM_MERMPLAN_01 
                           NULL, --nMM_MERMPRCO_02 
                           NULL, --nMM_MERMPLAN_EXESO_02 
                           NULL, --nMM_MERMPLAN_02 
                           NULL, --nMM_MERMPRCO_03 
                           NULL, --nMM_MERMPLAN_EXESO_03 
                           NULL, --nMM_MERMPLAN_03 
                           NULL, --nMM_MERMPRCO_04 
                           NULL, --nMM_MERMPLAN_EXESO_04 
                           NULL, --nMM_MERMPLAN_04 
                           NULL, --nMM_MERMPRCO_05 
                           NULL, --nMM_MERMPLAN_EXESO_05 
                           NULL, --nMM_MERMPLAN_05 
                           NULL, --nMM_MERMPRCO_06 
                           NULL, --nMM_MERMPLAN_EXESO_06 
                           NULL, --nMM_MERMPLAN_06 
                           0, --nMM_MERMPRCO_07 
                           NULL, --nMM_MERMPLAN_EXESO_07 
                           NULL, --nMM_MERMPLAN_07 
                           NULL, --nMM_MERMPRCO_08 
                           NULL, --nMM_MERMPLAN_EXESO_08 
                           NULL, --nMM_MERMPLAN_08 
                           NULL, --nMM_MERMPRCO_09 
                           NULL, --nMM_MERMPLAN_EXESO_09 
                           NULL, --nMM_MERMPLAN_09 
                           NULL, --nMM_MERMPRCO_10 
                           NULL, --nMM_MERMPLAN_EXESO_10 
                           NULL, --nMM_MERMPLAN_10 
                           NULL, --nMM_MERMPRCO 
                           NULL, --nMM_MERMPLAN_EXESO 
                           NULL); --nMM_MERMPLAN
            ELSE
               P_ERRORES(vEmpresa, nNumeOtre, '647','la Merma de Pre-Corte para el Material: '||rMATERIAL_B.Tip_Arti||'-'||rMATERIAL_B.Cod_Arti||' Ancho: '||rMATERIAL_B.ANCHO||' Ancho Bueno: '||rMaterial_B.ANCHO_BUENO_TOTAL_07||', Merma Negativa: '||rMaterial_B.MM_MERMPRCO_07||' Tolerancia: '||vTolemmMP||' Numero Cortes: '||rMaterial_B.NUMECORT||'|62.1.16','R','A');
            END IF;
         END IF;
         --
         --IF t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_EXESO_07 < 0 THEN
         IF rMaterial_B.MM_MERMPLAN_EXESO_07 < 0 THEN
            --IF ABS(t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_EXESO_07) <= (vTolemmMP * t_MATERIAL(rMaterial_B.IDENTIFICADOR).NUMECORT_07) THEN
            IF ABS(rMaterial_B.MM_MERMPLAN_EXESO_07) <= (vTolemmMP * rMaterial_B.NUMECORT_07) THEN
               --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_EXESO_07 := 0;
               P_MATERIAL(rMaterial_B,'U',
                           NULL,--nCantProd
                           NULL,--nCantCons_E
                           NULL,--nCantCons
                           NULL,--nCantAjus
                           NULL,--nAncho
                           NULL,--nFACTOR_CONVERSION_M2_KG
                           NULL,--nPrecio_ML_E
                           NULL,--vLog_Precio
                           NULL,--nMermEnhe_E
                           NULL,--nMermEnhe
                           NULL,--nMermAjus_E
                           NULL,--nMermAjus
                           NULL,--nMermCabo_E
                           NULL,--nMermCabo
                           NULL,--nMermPico_E
                           NULL,--nMermPico
                           NULL,--nMermTita
                           NULL,--nMermSane
                           NULL,--nCantCons_Bobinas
                           --
                           NULL, --nCONTFSMU_01 
                           NULL, --nCANTFSMU_01 
                           NULL, --nCATOFSMU 
                           NULL, --nCONTFSMU_02 
                           NULL, --nCANTFSMU_02 
                           NULL, --nCONTFSMU_03 
                           NULL, --nCANTFSMU_03 
                           NULL, --nCONTFSMU_04 
                           NULL, --nCANTFSMU_04 
                           NULL, --nCONTFSMU_05 
                           NULL, --nCANTFSMU_05 
                           NULL, --nCONTFSMU_06 
                           NULL, --nCANTFSMU_06 
                           NULL, --nCONTFSMU_07 
                           NULL, --nCANTFSMU_07 
                           NULL, --nCONTFSMU_08 
                           NULL, --nCANTFSMU_08 
                           NULL, --nCONTFSMU_09 
                           NULL, --nCANTFSMU_09 
                           NULL, --nCONTFSMU_10 
                           NULL, --nCANTFSMU_10 
                           NULL, --nANCHO_BUENO_TOTAL_01 
                           NULL, --nANCHO_BUENO_OT_01 
                           NULL, --nANCHO_BUENO_TOTAL_02 
                           NULL, --nANCHO_BUENO_OT_02 
                           NULL, --nANCHO_BUENO_TOTAL_03 
                           NULL, --nANCHO_BUENO_OT_03 
                           NULL, --nANCHO_BUENO_TOTAL_04 
                           NULL, --nANCHO_BUENO_OT_04 
                           NULL, --nANCHO_BUENO_TOTAL_05 
                           NULL, --nANCHO_BUENO_OT_05 
                           NULL, --nANCHO_BUENO_TOTAL_06 
                           NULL, --nANCHO_BUENO_OT_06 
                           NULL, --nANCHO_BUENO_TOTAL_07 
                           NULL, --nANCHO_BUENO_OT_07 
                           NULL, --nANCHO_BUENO_TOTAL_08 
                           NULL, --nANCHO_BUENO_OT_08 
                           NULL, --nANCHO_BUENO_TOTAL_09 
                           NULL, --nANCHO_BUENO_OT_09 
                           NULL, --nANCHO_BUENO_TOTAL_10 
                           NULL, --nANCHO_BUENO_OT_10 
                           NULL, --nANCHO_BUENO_TOTAL 
                           NULL, --nANCHO_BUENO_OT 
                           NULL, --nNUMECORT 
                           NULL, --nMM_MERMPRCO_01 
                           NULL, --nMM_MERMPLAN_EXESO_01 
                           NULL, --nMM_MERMPLAN_01 
                           NULL, --nMM_MERMPRCO_02 
                           NULL, --nMM_MERMPLAN_EXESO_02 
                           NULL, --nMM_MERMPLAN_02 
                           NULL, --nMM_MERMPRCO_03 
                           NULL, --nMM_MERMPLAN_EXESO_03 
                           NULL, --nMM_MERMPLAN_03 
                           NULL, --nMM_MERMPRCO_04 
                           NULL, --nMM_MERMPLAN_EXESO_04 
                           NULL, --nMM_MERMPLAN_04 
                           NULL, --nMM_MERMPRCO_05 
                           NULL, --nMM_MERMPLAN_EXESO_05 
                           NULL, --nMM_MERMPLAN_05 
                           NULL, --nMM_MERMPRCO_06 
                           NULL, --nMM_MERMPLAN_EXESO_06 
                           NULL, --nMM_MERMPLAN_06 
                           NULL, --nMM_MERMPRCO_07 
                           0, --nMM_MERMPLAN_EXESO_07 
                           NULL, --nMM_MERMPLAN_07 
                           NULL, --nMM_MERMPRCO_08 
                           NULL, --nMM_MERMPLAN_EXESO_08 
                           NULL, --nMM_MERMPLAN_08 
                           NULL, --nMM_MERMPRCO_09 
                           NULL, --nMM_MERMPLAN_EXESO_09 
                           NULL, --nMM_MERMPLAN_09 
                           NULL, --nMM_MERMPRCO_10 
                           NULL, --nMM_MERMPLAN_EXESO_10 
                           NULL, --nMM_MERMPLAN_10 
                           NULL, --nMM_MERMPRCO 
                           NULL, --nMM_MERMPLAN_EXESO 
                           NULL); --nMM_MERMPLAN
            ELSE
               P_ERRORES(vEmpresa, nNumeOtre, '647','la Merma de Planificación para el Material: '||rMATERIAL_B.Tip_Arti||'-'||rMATERIAL_B.Cod_Arti||' Ancho: '||rMATERIAL_B.ANCHO||' Ancho Bueno: '||rMaterial_B.ANCHO_BUENO_TOTAL_07||', Merma Negativa: '||rMaterial_B.MM_MERMPLAN_EXESO_07||' Tolerancia: '||vTolemmMP||' Numero Cortes: '||rMaterial_B.NUMECORT||'|62.1.17','R','A');
            END IF;
         END IF;
         ----------------------------------------------
         --Fin de Tratamiento de Merma Negativa para 07
         ----------------------------------------------
         ---------------------------------------
         --Tratamiento de Merma Negativa para 08
         ---------------------------------------
         --IF t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPRCO_08 < 0 THEN
         IF rMaterial_B.MM_MERMPRCO_08 < 0 THEN
            --IF ABS(t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPRCO_08) <= (vTolemmMP * t_MATERIAL(rMaterial_B.IDENTIFICADOR).NUMECORT_08) THEN
            IF ABS(rMaterial_B.MM_MERMPRCO_08) <= (vTolemmMP * rMaterial_B.NUMECORT_08) THEN
               --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPRCO_08 := 0;
               P_MATERIAL(rMaterial_B,'U',
                           NULL,--nCantProd
                           NULL,--nCantCons_E
                           NULL,--nCantCons
                           NULL,--nCantAjus
                           NULL,--nAncho
                           NULL,--nFACTOR_CONVERSION_M2_KG
                           NULL,--nPrecio_ML_E
                           NULL,--vLog_Precio
                           NULL,--nMermEnhe_E
                           NULL,--nMermEnhe
                           NULL,--nMermAjus_E
                           NULL,--nMermAjus
                           NULL,--nMermCabo_E
                           NULL,--nMermCabo
                           NULL,--nMermPico_E
                           NULL,--nMermPico
                           NULL,--nMermTita
                           NULL,--nMermSane
                           NULL,--nCantCons_Bobinas
                           --
                           NULL, --nCONTFSMU_01 
                           NULL, --nCANTFSMU_01 
                           NULL, --nCATOFSMU 
                           NULL, --nCONTFSMU_02 
                           NULL, --nCANTFSMU_02 
                           NULL, --nCONTFSMU_03 
                           NULL, --nCANTFSMU_03 
                           NULL, --nCONTFSMU_04 
                           NULL, --nCANTFSMU_04 
                           NULL, --nCONTFSMU_05 
                           NULL, --nCANTFSMU_05 
                           NULL, --nCONTFSMU_06 
                           NULL, --nCANTFSMU_06 
                           NULL, --nCONTFSMU_07 
                           NULL, --nCANTFSMU_07 
                           NULL, --nCONTFSMU_08 
                           NULL, --nCANTFSMU_08 
                           NULL, --nCONTFSMU_09 
                           NULL, --nCANTFSMU_09 
                           NULL, --nCONTFSMU_10 
                           NULL, --nCANTFSMU_10 
                           NULL, --nANCHO_BUENO_TOTAL_01 
                           NULL, --nANCHO_BUENO_OT_01 
                           NULL, --nANCHO_BUENO_TOTAL_02 
                           NULL, --nANCHO_BUENO_OT_02 
                           NULL, --nANCHO_BUENO_TOTAL_03 
                           NULL, --nANCHO_BUENO_OT_03 
                           NULL, --nANCHO_BUENO_TOTAL_04 
                           NULL, --nANCHO_BUENO_OT_04 
                           NULL, --nANCHO_BUENO_TOTAL_05 
                           NULL, --nANCHO_BUENO_OT_05 
                           NULL, --nANCHO_BUENO_TOTAL_06 
                           NULL, --nANCHO_BUENO_OT_06 
                           NULL, --nANCHO_BUENO_TOTAL_07 
                           NULL, --nANCHO_BUENO_OT_07 
                           NULL, --nANCHO_BUENO_TOTAL_08 
                           NULL, --nANCHO_BUENO_OT_08 
                           NULL, --nANCHO_BUENO_TOTAL_09 
                           NULL, --nANCHO_BUENO_OT_09 
                           NULL, --nANCHO_BUENO_TOTAL_10 
                           NULL, --nANCHO_BUENO_OT_10 
                           NULL, --nANCHO_BUENO_TOTAL 
                           NULL, --nANCHO_BUENO_OT 
                           NULL, --nNUMECORT 
                           NULL, --nMM_MERMPRCO_01 
                           NULL, --nMM_MERMPLAN_EXESO_01 
                           NULL, --nMM_MERMPLAN_01 
                           NULL, --nMM_MERMPRCO_02 
                           NULL, --nMM_MERMPLAN_EXESO_02 
                           NULL, --nMM_MERMPLAN_02 
                           NULL, --nMM_MERMPRCO_03 
                           NULL, --nMM_MERMPLAN_EXESO_03 
                           NULL, --nMM_MERMPLAN_03 
                           NULL, --nMM_MERMPRCO_04 
                           NULL, --nMM_MERMPLAN_EXESO_04 
                           NULL, --nMM_MERMPLAN_04 
                           NULL, --nMM_MERMPRCO_05 
                           NULL, --nMM_MERMPLAN_EXESO_05 
                           NULL, --nMM_MERMPLAN_05 
                           NULL, --nMM_MERMPRCO_06 
                           NULL, --nMM_MERMPLAN_EXESO_06 
                           NULL, --nMM_MERMPLAN_06 
                           NULL, --nMM_MERMPRCO_07 
                           NULL, --nMM_MERMPLAN_EXESO_07 
                           NULL, --nMM_MERMPLAN_07 
                           0, --nMM_MERMPRCO_08 
                           NULL, --nMM_MERMPLAN_EXESO_08 
                           NULL, --nMM_MERMPLAN_08 
                           NULL, --nMM_MERMPRCO_09 
                           NULL, --nMM_MERMPLAN_EXESO_09 
                           NULL, --nMM_MERMPLAN_09 
                           NULL, --nMM_MERMPRCO_10 
                           NULL, --nMM_MERMPLAN_EXESO_10 
                           NULL, --nMM_MERMPLAN_10 
                           NULL, --nMM_MERMPRCO 
                           NULL, --nMM_MERMPLAN_EXESO 
                           NULL); --nMM_MERMPLAN
            ELSE
               P_ERRORES(vEmpresa, nNumeOtre, '647','la Merma de Pre-Corte para el Material: '||rMATERIAL_B.Tip_Arti||'-'||rMATERIAL_B.Cod_Arti||' Ancho: '||rMATERIAL_B.ANCHO||' Ancho Bueno: '||rMaterial_B.ANCHO_BUENO_TOTAL_08||', Merma Negativa: '||rMaterial_B.MM_MERMPRCO_08||' Tolerancia: '||vTolemmMP||' Numero Cortes: '||rMaterial_B.NUMECORT||'|62.1.18','R','A');
            END IF;
         END IF;
         --
         --IF t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_EXESO_08 < 0 THEN
         IF rMaterial_B.MM_MERMPLAN_EXESO_08 < 0 THEN
            --IF ABS(t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_EXESO_08) <= (vTolemmMP * t_MATERIAL(rMaterial_B.IDENTIFICADOR).NUMECORT_08) THEN
            IF ABS(rMaterial_B.MM_MERMPLAN_EXESO_08) <= (vTolemmMP * rMaterial_B.NUMECORT_08) THEN
               --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_EXESO_08 := 0;
               P_MATERIAL(rMaterial_B,'U',
                           NULL,--nCantProd
                           NULL,--nCantCons_E
                           NULL,--nCantCons
                           NULL,--nCantAjus
                           NULL,--nAncho
                           NULL,--nFACTOR_CONVERSION_M2_KG
                           NULL,--nPrecio_ML_E
                           NULL,--vLog_Precio
                           NULL,--nMermEnhe_E
                           NULL,--nMermEnhe
                           NULL,--nMermAjus_E
                           NULL,--nMermAjus
                           NULL,--nMermCabo_E
                           NULL,--nMermCabo
                           NULL,--nMermPico_E
                           NULL,--nMermPico
                           NULL,--nMermTita
                           NULL,--nMermSane
                           NULL,--nCantCons_Bobinas
                           --
                           NULL, --nCONTFSMU_01 
                           NULL, --nCANTFSMU_01 
                           NULL, --nCATOFSMU 
                           NULL, --nCONTFSMU_02 
                           NULL, --nCANTFSMU_02 
                           NULL, --nCONTFSMU_03 
                           NULL, --nCANTFSMU_03 
                           NULL, --nCONTFSMU_04 
                           NULL, --nCANTFSMU_04 
                           NULL, --nCONTFSMU_05 
                           NULL, --nCANTFSMU_05 
                           NULL, --nCONTFSMU_06 
                           NULL, --nCANTFSMU_06 
                           NULL, --nCONTFSMU_07 
                           NULL, --nCANTFSMU_07 
                           NULL, --nCONTFSMU_08 
                           NULL, --nCANTFSMU_08 
                           NULL, --nCONTFSMU_09 
                           NULL, --nCANTFSMU_09 
                           NULL, --nCONTFSMU_10 
                           NULL, --nCANTFSMU_10 
                           NULL, --nANCHO_BUENO_TOTAL_01 
                           NULL, --nANCHO_BUENO_OT_01 
                           NULL, --nANCHO_BUENO_TOTAL_02 
                           NULL, --nANCHO_BUENO_OT_02 
                           NULL, --nANCHO_BUENO_TOTAL_03 
                           NULL, --nANCHO_BUENO_OT_03 
                           NULL, --nANCHO_BUENO_TOTAL_04 
                           NULL, --nANCHO_BUENO_OT_04 
                           NULL, --nANCHO_BUENO_TOTAL_05 
                           NULL, --nANCHO_BUENO_OT_05 
                           NULL, --nANCHO_BUENO_TOTAL_06 
                           NULL, --nANCHO_BUENO_OT_06 
                           NULL, --nANCHO_BUENO_TOTAL_07 
                           NULL, --nANCHO_BUENO_OT_07 
                           NULL, --nANCHO_BUENO_TOTAL_08 
                           NULL, --nANCHO_BUENO_OT_08 
                           NULL, --nANCHO_BUENO_TOTAL_09 
                           NULL, --nANCHO_BUENO_OT_09 
                           NULL, --nANCHO_BUENO_TOTAL_10 
                           NULL, --nANCHO_BUENO_OT_10 
                           NULL, --nANCHO_BUENO_TOTAL 
                           NULL, --nANCHO_BUENO_OT 
                           NULL, --nNUMECORT 
                           NULL, --nMM_MERMPRCO_01 
                           NULL, --nMM_MERMPLAN_EXESO_01 
                           NULL, --nMM_MERMPLAN_01 
                           NULL, --nMM_MERMPRCO_02 
                           NULL, --nMM_MERMPLAN_EXESO_02 
                           NULL, --nMM_MERMPLAN_02 
                           NULL, --nMM_MERMPRCO_03 
                           NULL, --nMM_MERMPLAN_EXESO_03 
                           NULL, --nMM_MERMPLAN_03 
                           NULL, --nMM_MERMPRCO_04 
                           NULL, --nMM_MERMPLAN_EXESO_04 
                           NULL, --nMM_MERMPLAN_04 
                           NULL, --nMM_MERMPRCO_05 
                           NULL, --nMM_MERMPLAN_EXESO_05 
                           NULL, --nMM_MERMPLAN_05 
                           NULL, --nMM_MERMPRCO_06 
                           NULL, --nMM_MERMPLAN_EXESO_06 
                           NULL, --nMM_MERMPLAN_06 
                           NULL, --nMM_MERMPRCO_07 
                           NULL, --nMM_MERMPLAN_EXESO_07 
                           NULL, --nMM_MERMPLAN_07 
                           NULL, --nMM_MERMPRCO_08 
                           0, --nMM_MERMPLAN_EXESO_08 
                           NULL, --nMM_MERMPLAN_08 
                           NULL, --nMM_MERMPRCO_09 
                           NULL, --nMM_MERMPLAN_EXESO_09 
                           NULL, --nMM_MERMPLAN_09 
                           NULL, --nMM_MERMPRCO_10 
                           NULL, --nMM_MERMPLAN_EXESO_10 
                           NULL, --nMM_MERMPLAN_10 
                           NULL, --nMM_MERMPRCO 
                           NULL, --nMM_MERMPLAN_EXESO 
                           NULL); --nMM_MERMPLAN
            ELSE
               P_ERRORES(vEmpresa, nNumeOtre, '647','la Merma de Planificación para el Material: '||rMATERIAL_B.Tip_Arti||'-'||rMATERIAL_B.Cod_Arti||' Ancho: '||rMATERIAL_B.ANCHO||' Ancho Bueno: '||rMaterial_B.ANCHO_BUENO_TOTAL_08||', Merma Negativa: '||rMaterial_B.MM_MERMPLAN_EXESO_08||' Tolerancia: '||vTolemmMP||' Numero Cortes: '||rMaterial_B.NUMECORT||'|62.1.19','R','A');
            END IF;
         END IF;
         ----------------------------------------------
         --Fin de Tratamiento de Merma Negativa para 08
         ----------------------------------------------
         ---------------------------------------
         --Tratamiento de Merma Negativa para 09
         ---------------------------------------
         --IF t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPRCO_09 < 0 THEN
         IF rMaterial_B.MM_MERMPRCO_09 < 0 THEN
            --IF ABS(t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPRCO_09) <= (vTolemmMP * t_MATERIAL(rMaterial_B.IDENTIFICADOR).NUMECORT_09) THEN
            IF ABS(rMaterial_B.MM_MERMPRCO_09) <= (vTolemmMP * rMaterial_B.NUMECORT_09) THEN
               --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPRCO_09 := 0;
               P_MATERIAL(rMaterial_B,'U',
                           NULL,--nCantProd
                           NULL,--nCantCons_E
                           NULL,--nCantCons
                           NULL,--nCantAjus
                           NULL,--nAncho
                           NULL,--nFACTOR_CONVERSION_M2_KG
                           NULL,--nPrecio_ML_E
                           NULL,--vLog_Precio
                           NULL,--nMermEnhe_E
                           NULL,--nMermEnhe
                           NULL,--nMermAjus_E
                           NULL,--nMermAjus
                           NULL,--nMermCabo_E
                           NULL,--nMermCabo
                           NULL,--nMermPico_E
                           NULL,--nMermPico
                           NULL,--nMermTita
                           NULL,--nMermSane
                           NULL,--nCantCons_Bobinas
                           --
                           NULL, --nCONTFSMU_01 
                           NULL, --nCANTFSMU_01 
                           NULL, --nCATOFSMU 
                           NULL, --nCONTFSMU_02 
                           NULL, --nCANTFSMU_02 
                           NULL, --nCONTFSMU_03 
                           NULL, --nCANTFSMU_03 
                           NULL, --nCONTFSMU_04 
                           NULL, --nCANTFSMU_04 
                           NULL, --nCONTFSMU_05 
                           NULL, --nCANTFSMU_05 
                           NULL, --nCONTFSMU_06 
                           NULL, --nCANTFSMU_06 
                           NULL, --nCONTFSMU_07 
                           NULL, --nCANTFSMU_07 
                           NULL, --nCONTFSMU_08 
                           NULL, --nCANTFSMU_08 
                           NULL, --nCONTFSMU_09 
                           NULL, --nCANTFSMU_09 
                           NULL, --nCONTFSMU_10 
                           NULL, --nCANTFSMU_10 
                           NULL, --nANCHO_BUENO_TOTAL_01 
                           NULL, --nANCHO_BUENO_OT_01 
                           NULL, --nANCHO_BUENO_TOTAL_02 
                           NULL, --nANCHO_BUENO_OT_02 
                           NULL, --nANCHO_BUENO_TOTAL_03 
                           NULL, --nANCHO_BUENO_OT_03 
                           NULL, --nANCHO_BUENO_TOTAL_04 
                           NULL, --nANCHO_BUENO_OT_04 
                           NULL, --nANCHO_BUENO_TOTAL_05 
                           NULL, --nANCHO_BUENO_OT_05 
                           NULL, --nANCHO_BUENO_TOTAL_06 
                           NULL, --nANCHO_BUENO_OT_06 
                           NULL, --nANCHO_BUENO_TOTAL_07 
                           NULL, --nANCHO_BUENO_OT_07 
                           NULL, --nANCHO_BUENO_TOTAL_08 
                           NULL, --nANCHO_BUENO_OT_08 
                           NULL, --nANCHO_BUENO_TOTAL_09 
                           NULL, --nANCHO_BUENO_OT_09 
                           NULL, --nANCHO_BUENO_TOTAL_10 
                           NULL, --nANCHO_BUENO_OT_10 
                           NULL, --nANCHO_BUENO_TOTAL 
                           NULL, --nANCHO_BUENO_OT 
                           NULL, --nNUMECORT 
                           NULL, --nMM_MERMPRCO_01 
                           NULL, --nMM_MERMPLAN_EXESO_01 
                           NULL, --nMM_MERMPLAN_01 
                           NULL, --nMM_MERMPRCO_02 
                           NULL, --nMM_MERMPLAN_EXESO_02 
                           NULL, --nMM_MERMPLAN_02 
                           NULL, --nMM_MERMPRCO_03 
                           NULL, --nMM_MERMPLAN_EXESO_03 
                           NULL, --nMM_MERMPLAN_03 
                           NULL, --nMM_MERMPRCO_04 
                           NULL, --nMM_MERMPLAN_EXESO_04 
                           NULL, --nMM_MERMPLAN_04 
                           NULL, --nMM_MERMPRCO_05 
                           NULL, --nMM_MERMPLAN_EXESO_05 
                           NULL, --nMM_MERMPLAN_05 
                           NULL, --nMM_MERMPRCO_06 
                           NULL, --nMM_MERMPLAN_EXESO_06 
                           NULL, --nMM_MERMPLAN_06 
                           NULL, --nMM_MERMPRCO_07 
                           NULL, --nMM_MERMPLAN_EXESO_07 
                           NULL, --nMM_MERMPLAN_07 
                           NULL, --nMM_MERMPRCO_08 
                           NULL, --nMM_MERMPLAN_EXESO_08 
                           NULL, --nMM_MERMPLAN_08 
                           0, --nMM_MERMPRCO_09 
                           NULL, --nMM_MERMPLAN_EXESO_09 
                           NULL, --nMM_MERMPLAN_09 
                           NULL, --nMM_MERMPRCO_10 
                           NULL, --nMM_MERMPLAN_EXESO_10 
                           NULL, --nMM_MERMPLAN_10 
                           NULL, --nMM_MERMPRCO 
                           NULL, --nMM_MERMPLAN_EXESO 
                           NULL); --nMM_MERMPLAN
            ELSE
               P_ERRORES(vEmpresa, nNumeOtre, '647','la Merma de Pre-Corte para el Material: '||rMATERIAL_B.Tip_Arti||'-'||rMATERIAL_B.Cod_Arti||' Ancho: '||rMATERIAL_B.ANCHO||' Ancho Bueno: '||rMaterial_B.ANCHO_BUENO_TOTAL_09||', Merma Negativa: '||rMaterial_B.MM_MERMPRCO_09||' Tolerancia: '||vTolemmMP||' Numero Cortes: '||rMaterial_B.NUMECORT||'|62.1.20','R','A');
            END IF;
         END IF;
         --
         --IF t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_EXESO_09 < 0 THEN
         IF rMaterial_B.MM_MERMPLAN_EXESO_09 < 0 THEN
            --IF ABS(t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_EXESO_09) <= (vTolemmMP * t_MATERIAL(rMaterial_B.IDENTIFICADOR).NUMECORT_09) THEN
            IF ABS(rMaterial_B.MM_MERMPLAN_EXESO_09) <= (vTolemmMP * rMaterial_B.NUMECORT_09) THEN
               --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_EXESO_09 := 0;
               P_MATERIAL(rMaterial_B,'U',
                           NULL,--nCantProd
                           NULL,--nCantCons_E
                           NULL,--nCantCons
                           NULL,--nCantAjus
                           NULL,--nAncho
                           NULL,--nFACTOR_CONVERSION_M2_KG
                           NULL,--nPrecio_ML_E
                           NULL,--vLog_Precio
                           NULL,--nMermEnhe_E
                           NULL,--nMermEnhe
                           NULL,--nMermAjus_E
                           NULL,--nMermAjus
                           NULL,--nMermCabo_E
                           NULL,--nMermCabo
                           NULL,--nMermPico_E
                           NULL,--nMermPico
                           NULL,--nMermTita
                           NULL,--nMermSane
                           NULL,--nCantCons_Bobinas
                           --
                           NULL, --nCONTFSMU_01 
                           NULL, --nCANTFSMU_01 
                           NULL, --nCATOFSMU 
                           NULL, --nCONTFSMU_02 
                           NULL, --nCANTFSMU_02 
                           NULL, --nCONTFSMU_03 
                           NULL, --nCANTFSMU_03 
                           NULL, --nCONTFSMU_04 
                           NULL, --nCANTFSMU_04 
                           NULL, --nCONTFSMU_05 
                           NULL, --nCANTFSMU_05 
                           NULL, --nCONTFSMU_06 
                           NULL, --nCANTFSMU_06 
                           NULL, --nCONTFSMU_07 
                           NULL, --nCANTFSMU_07 
                           NULL, --nCONTFSMU_08 
                           NULL, --nCANTFSMU_08 
                           NULL, --nCONTFSMU_09 
                           NULL, --nCANTFSMU_09 
                           NULL, --nCONTFSMU_10 
                           NULL, --nCANTFSMU_10 
                           NULL, --nANCHO_BUENO_TOTAL_01 
                           NULL, --nANCHO_BUENO_OT_01 
                           NULL, --nANCHO_BUENO_TOTAL_02 
                           NULL, --nANCHO_BUENO_OT_02 
                           NULL, --nANCHO_BUENO_TOTAL_03 
                           NULL, --nANCHO_BUENO_OT_03 
                           NULL, --nANCHO_BUENO_TOTAL_04 
                           NULL, --nANCHO_BUENO_OT_04 
                           NULL, --nANCHO_BUENO_TOTAL_05 
                           NULL, --nANCHO_BUENO_OT_05 
                           NULL, --nANCHO_BUENO_TOTAL_06 
                           NULL, --nANCHO_BUENO_OT_06 
                           NULL, --nANCHO_BUENO_TOTAL_07 
                           NULL, --nANCHO_BUENO_OT_07 
                           NULL, --nANCHO_BUENO_TOTAL_08 
                           NULL, --nANCHO_BUENO_OT_08 
                           NULL, --nANCHO_BUENO_TOTAL_09 
                           NULL, --nANCHO_BUENO_OT_09 
                           NULL, --nANCHO_BUENO_TOTAL_10 
                           NULL, --nANCHO_BUENO_OT_10 
                           NULL, --nANCHO_BUENO_TOTAL 
                           NULL, --nANCHO_BUENO_OT 
                           NULL, --nNUMECORT 
                           NULL, --nMM_MERMPRCO_01 
                           NULL, --nMM_MERMPLAN_EXESO_01 
                           NULL, --nMM_MERMPLAN_01 
                           NULL, --nMM_MERMPRCO_02 
                           NULL, --nMM_MERMPLAN_EXESO_02 
                           NULL, --nMM_MERMPLAN_02 
                           NULL, --nMM_MERMPRCO_03 
                           NULL, --nMM_MERMPLAN_EXESO_03 
                           NULL, --nMM_MERMPLAN_03 
                           NULL, --nMM_MERMPRCO_04 
                           NULL, --nMM_MERMPLAN_EXESO_04 
                           NULL, --nMM_MERMPLAN_04 
                           NULL, --nMM_MERMPRCO_05 
                           NULL, --nMM_MERMPLAN_EXESO_05 
                           NULL, --nMM_MERMPLAN_05 
                           NULL, --nMM_MERMPRCO_06 
                           NULL, --nMM_MERMPLAN_EXESO_06 
                           NULL, --nMM_MERMPLAN_06 
                           NULL, --nMM_MERMPRCO_07 
                           NULL, --nMM_MERMPLAN_EXESO_07 
                           NULL, --nMM_MERMPLAN_07 
                           NULL, --nMM_MERMPRCO_08 
                           NULL, --nMM_MERMPLAN_EXESO_08 
                           NULL, --nMM_MERMPLAN_08 
                           NULL, --nMM_MERMPRCO_09 
                           0, --nMM_MERMPLAN_EXESO_09 
                           NULL, --nMM_MERMPLAN_09 
                           NULL, --nMM_MERMPRCO_10 
                           NULL, --nMM_MERMPLAN_EXESO_10 
                           NULL, --nMM_MERMPLAN_10 
                           NULL, --nMM_MERMPRCO 
                           NULL, --nMM_MERMPLAN_EXESO 
                           NULL); --nMM_MERMPLAN
            ELSE
               P_ERRORES(vEmpresa, nNumeOtre, '647','la Merma de Planificación para el Material: '||rMATERIAL_B.Tip_Arti||'-'||rMATERIAL_B.Cod_Arti||' Ancho: '||rMATERIAL_B.ANCHO||' Ancho Bueno: '||rMaterial_B.ANCHO_BUENO_TOTAL_09||', Merma Negativa: '||rMaterial_B.MM_MERMPLAN_EXESO_09||' Tolerancia: '||vTolemmMP||' Numero Cortes: '||rMaterial_B.NUMECORT||'|62.1.21','R','A');
            END IF;
         END IF;
         ----------------------------------------------
         --Fin de Tratamiento de Merma Negativa para 09
         ----------------------------------------------
         ---------------------------------------
         --Tratamiento de Merma Negativa para 10
         ---------------------------------------
         --IF t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPRCO_10 < 0 THEN
         IF rMaterial_B.MM_MERMPRCO_10 < 0 THEN
            --IF ABS(t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPRCO_10) <= (vTolemmMP * t_MATERIAL(rMaterial_B.IDENTIFICADOR).NUMECORT_10) THEN
            IF ABS(rMaterial_B.MM_MERMPRCO_10) <= (vTolemmMP * rMaterial_B.NUMECORT_10) THEN
               --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPRCO_10 := 0;
               P_MATERIAL(rMaterial_B,'U',
                           NULL,--nCantProd
                           NULL,--nCantCons_E
                           NULL,--nCantCons
                           NULL,--nCantAjus
                           NULL,--nAncho
                           NULL,--nFACTOR_CONVERSION_M2_KG
                           NULL,--nPrecio_ML_E
                           NULL,--vLog_Precio
                           NULL,--nMermEnhe_E
                           NULL,--nMermEnhe
                           NULL,--nMermAjus_E
                           NULL,--nMermAjus
                           NULL,--nMermCabo_E
                           NULL,--nMermCabo
                           NULL,--nMermPico_E
                           NULL,--nMermPico
                           NULL,--nMermTita
                           NULL,--nMermSane
                           NULL,--nCantCons_Bobinas
                           --
                           NULL, --nCONTFSMU_01 
                           NULL, --nCANTFSMU_01 
                           NULL, --nCATOFSMU 
                           NULL, --nCONTFSMU_02 
                           NULL, --nCANTFSMU_02 
                           NULL, --nCONTFSMU_03 
                           NULL, --nCANTFSMU_03 
                           NULL, --nCONTFSMU_04 
                           NULL, --nCANTFSMU_04 
                           NULL, --nCONTFSMU_05 
                           NULL, --nCANTFSMU_05 
                           NULL, --nCONTFSMU_06 
                           NULL, --nCANTFSMU_06 
                           NULL, --nCONTFSMU_07 
                           NULL, --nCANTFSMU_07 
                           NULL, --nCONTFSMU_08 
                           NULL, --nCANTFSMU_08 
                           NULL, --nCONTFSMU_09 
                           NULL, --nCANTFSMU_09 
                           NULL, --nCONTFSMU_10 
                           NULL, --nCANTFSMU_10 
                           NULL, --nANCHO_BUENO_TOTAL_01 
                           NULL, --nANCHO_BUENO_OT_01 
                           NULL, --nANCHO_BUENO_TOTAL_02 
                           NULL, --nANCHO_BUENO_OT_02 
                           NULL, --nANCHO_BUENO_TOTAL_03 
                           NULL, --nANCHO_BUENO_OT_03 
                           NULL, --nANCHO_BUENO_TOTAL_04 
                           NULL, --nANCHO_BUENO_OT_04 
                           NULL, --nANCHO_BUENO_TOTAL_05 
                           NULL, --nANCHO_BUENO_OT_05 
                           NULL, --nANCHO_BUENO_TOTAL_06 
                           NULL, --nANCHO_BUENO_OT_06 
                           NULL, --nANCHO_BUENO_TOTAL_07 
                           NULL, --nANCHO_BUENO_OT_07 
                           NULL, --nANCHO_BUENO_TOTAL_08 
                           NULL, --nANCHO_BUENO_OT_08 
                           NULL, --nANCHO_BUENO_TOTAL_09 
                           NULL, --nANCHO_BUENO_OT_09 
                           NULL, --nANCHO_BUENO_TOTAL_10 
                           NULL, --nANCHO_BUENO_OT_10 
                           NULL, --nANCHO_BUENO_TOTAL 
                           NULL, --nANCHO_BUENO_OT 
                           NULL, --nNUMECORT 
                           NULL, --nMM_MERMPRCO_01 
                           NULL, --nMM_MERMPLAN_EXESO_01 
                           NULL, --nMM_MERMPLAN_01 
                           NULL, --nMM_MERMPRCO_02 
                           NULL, --nMM_MERMPLAN_EXESO_02 
                           NULL, --nMM_MERMPLAN_02 
                           NULL, --nMM_MERMPRCO_03 
                           NULL, --nMM_MERMPLAN_EXESO_03 
                           NULL, --nMM_MERMPLAN_03 
                           NULL, --nMM_MERMPRCO_04 
                           NULL, --nMM_MERMPLAN_EXESO_04 
                           NULL, --nMM_MERMPLAN_04 
                           NULL, --nMM_MERMPRCO_05 
                           NULL, --nMM_MERMPLAN_EXESO_05 
                           NULL, --nMM_MERMPLAN_05 
                           NULL, --nMM_MERMPRCO_06 
                           NULL, --nMM_MERMPLAN_EXESO_06 
                           NULL, --nMM_MERMPLAN_06 
                           NULL, --nMM_MERMPRCO_07 
                           NULL, --nMM_MERMPLAN_EXESO_07 
                           NULL, --nMM_MERMPLAN_07 
                           NULL, --nMM_MERMPRCO_08 
                           NULL, --nMM_MERMPLAN_EXESO_08 
                           NULL, --nMM_MERMPLAN_08 
                           NULL, --nMM_MERMPRCO_09 
                           NULL, --nMM_MERMPLAN_EXESO_09 
                           NULL, --nMM_MERMPLAN_09 
                           0, --nMM_MERMPRCO_10 
                           NULL, --nMM_MERMPLAN_EXESO_10 
                           NULL, --nMM_MERMPLAN_10 
                           NULL, --nMM_MERMPRCO 
                           NULL, --nMM_MERMPLAN_EXESO 
                           NULL); --nMM_MERMPLAN
            ELSE
               P_ERRORES(vEmpresa, nNumeOtre, '647','la Merma de Pre-Corte para el Material: '||rMATERIAL_B.Tip_Arti||'-'||rMATERIAL_B.Cod_Arti||' Ancho: '||rMATERIAL_B.ANCHO||' Ancho Bueno: '||rMaterial_B.ANCHO_BUENO_TOTAL_10||', Merma Negativa: '||rMaterial_B.MM_MERMPRCO_10||' Tolerancia: '||vTolemmMP||' Numero Cortes: '||rMaterial_B.NUMECORT||'|62.1.22','R','A');
            END IF;
         END IF;
         --
         --IF t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_EXESO_10 < 0 THEN
         IF rMaterial_B.MM_MERMPLAN_EXESO_10 < 0 THEN
            --IF ABS(t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_EXESO_10) <= (vTolemmMP * t_MATERIAL(rMaterial_B.IDENTIFICADOR).NUMECORT_10) THEN
            IF ABS(rMaterial_B.MM_MERMPLAN_EXESO_10) <= (vTolemmMP * rMaterial_B.NUMECORT_10) THEN
               --t_MATERIAL(rMaterial_B.IDENTIFICADOR).MM_MERMPLAN_EXESO_10 := 0;
               P_MATERIAL(rMaterial_B,'U',
                           NULL,--nCantProd
                           NULL,--nCantCons_E
                           NULL,--nCantCons
                           NULL,--nCantAjus
                           NULL,--nAncho
                           NULL,--nFACTOR_CONVERSION_M2_KG
                           NULL,--nPrecio_ML_E
                           NULL,--vLog_Precio
                           NULL,--nMermEnhe_E
                           NULL,--nMermEnhe
                           NULL,--nMermAjus_E
                           NULL,--nMermAjus
                           NULL,--nMermCabo_E
                           NULL,--nMermCabo
                           NULL,--nMermPico_E
                           NULL,--nMermPico
                           NULL,--nMermTita
                           NULL,--nMermSane
                           NULL,--nCantCons_Bobinas
                           --
                           NULL, --nCONTFSMU_01 
                           NULL, --nCANTFSMU_01 
                           NULL, --nCATOFSMU 
                           NULL, --nCONTFSMU_02 
                           NULL, --nCANTFSMU_02 
                           NULL, --nCONTFSMU_03 
                           NULL, --nCANTFSMU_03 
                           NULL, --nCONTFSMU_04 
                           NULL, --nCANTFSMU_04 
                           NULL, --nCONTFSMU_05 
                           NULL, --nCANTFSMU_05 
                           NULL, --nCONTFSMU_06 
                           NULL, --nCANTFSMU_06 
                           NULL, --nCONTFSMU_07 
                           NULL, --nCANTFSMU_07 
                           NULL, --nCONTFSMU_08 
                           NULL, --nCANTFSMU_08 
                           NULL, --nCONTFSMU_09 
                           NULL, --nCANTFSMU_09 
                           NULL, --nCONTFSMU_10 
                           NULL, --nCANTFSMU_10 
                           NULL, --nANCHO_BUENO_TOTAL_01 
                           NULL, --nANCHO_BUENO_OT_01 
                           NULL, --nANCHO_BUENO_TOTAL_02 
                           NULL, --nANCHO_BUENO_OT_02 
                           NULL, --nANCHO_BUENO_TOTAL_03 
                           NULL, --nANCHO_BUENO_OT_03 
                           NULL, --nANCHO_BUENO_TOTAL_04 
                           NULL, --nANCHO_BUENO_OT_04 
                           NULL, --nANCHO_BUENO_TOTAL_05 
                           NULL, --nANCHO_BUENO_OT_05 
                           NULL, --nANCHO_BUENO_TOTAL_06 
                           NULL, --nANCHO_BUENO_OT_06 
                           NULL, --nANCHO_BUENO_TOTAL_07 
                           NULL, --nANCHO_BUENO_OT_07 
                           NULL, --nANCHO_BUENO_TOTAL_08 
                           NULL, --nANCHO_BUENO_OT_08 
                           NULL, --nANCHO_BUENO_TOTAL_09 
                           NULL, --nANCHO_BUENO_OT_09 
                           NULL, --nANCHO_BUENO_TOTAL_10 
                           NULL, --nANCHO_BUENO_OT_10 
                           NULL, --nANCHO_BUENO_TOTAL 
                           NULL, --nANCHO_BUENO_OT 
                           NULL, --nNUMECORT 
                           NULL, --nMM_MERMPRCO_01 
                           NULL, --nMM_MERMPLAN_EXESO_01 
                           NULL, --nMM_MERMPLAN_01 
                           NULL, --nMM_MERMPRCO_02 
                           NULL, --nMM_MERMPLAN_EXESO_02 
                           NULL, --nMM_MERMPLAN_02 
                           NULL, --nMM_MERMPRCO_03 
                           NULL, --nMM_MERMPLAN_EXESO_03 
                           NULL, --nMM_MERMPLAN_03 
                           NULL, --nMM_MERMPRCO_04 
                           NULL, --nMM_MERMPLAN_EXESO_04 
                           NULL, --nMM_MERMPLAN_04 
                           NULL, --nMM_MERMPRCO_05 
                           NULL, --nMM_MERMPLAN_EXESO_05 
                           NULL, --nMM_MERMPLAN_05 
                           NULL, --nMM_MERMPRCO_06 
                           NULL, --nMM_MERMPLAN_EXESO_06 
                           NULL, --nMM_MERMPLAN_06 
                           NULL, --nMM_MERMPRCO_07 
                           NULL, --nMM_MERMPLAN_EXESO_07 
                           NULL, --nMM_MERMPLAN_07 
                           NULL, --nMM_MERMPRCO_08 
                           NULL, --nMM_MERMPLAN_EXESO_08 
                           NULL, --nMM_MERMPLAN_08 
                           NULL, --nMM_MERMPRCO_09 
                           NULL, --nMM_MERMPLAN_EXESO_09 
                           NULL, --nMM_MERMPLAN_09 
                           NULL, --nMM_MERMPRCO_10 
                           0, --nMM_MERMPLAN_EXESO_10 
                           NULL, --nMM_MERMPLAN_10 
                           NULL, --nMM_MERMPRCO 
                           NULL, --nMM_MERMPLAN_EXESO 
                           NULL); --nMM_MERMPLAN
            ELSE
               P_ERRORES(vEmpresa, nNumeOtre, '647','la Merma de Planificación para el Material: '||rMATERIAL_B.Tip_Arti||'-'||rMATERIAL_B.Cod_Arti||' Ancho: '||rMATERIAL_B.ANCHO||' Ancho Bueno: '||rMaterial_B.ANCHO_BUENO_TOTAL_10||', Merma Negativa: '||rMaterial_B.MM_MERMPLAN_EXESO_10||' Tolerancia: '||vTolemmMP||' Numero Cortes: '||rMaterial_B.NUMECORT||'|62.1.23','R','A');
            END IF;
         END IF;
         ----------------------------------------------
         --Fin de Tratamiento de Merma Negativa para 10
         ----------------------------------------------
      END LOOP; --FOR nI In 1..T_MATERIAL.COUNT LOOP
      --Se recorren las Bobinas
      --FOR nI In 1..T_BOBIMAQU.COUNT LOOP
         --biIndice   := nI;
         --
         --rBOBIMAQU := T_BOBIMAQU(biIndice);
      FOR rBOBIMAQU IN cANE_MER_BOBIMAQU_OT LOOP
         --
         IF NVL(rBOBIMAQU.Desbarbe,'N') = 'N' THEN
/*
         --------------------------------
         --CALCULO DE ANCHO_BUENO_TOTAL--
         --------------------------------
         --Bajo este concepto
         --                                                              = CANTFSMU_01
         --Valor calculado Ej:                                  (CANTIDAD_CONSUMIDA_ULTIMA_FASE_01)                                         (CANTIDAD_CONSUMIDA_ULTIMA_FASE_01)
         --                    ( ( (ANCHO_BUENO_TOTAL_01) * -------------------------------------------- ) + ( (ANCHO_BUENO_TOTAL_02) * -------------------------------------------- ) + ....)  --Se encuentran los mm de ANCH_TOTAL patiendo de los ANCHOS encontrados y los Consumos de Material en la Ultima Fase
         --                                                 (TOTAL_DE_CANTIDADES_CONSUMIDAS_ULTIMA_FASE)                                (TOTAL_DE_CANTIDADES_CONSUMIDAS_ULTIMA_FASE)
         --                                                              = CATOFSMU
         --
         IF NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).CATOFSMU,0) != 0 THEN
            t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL := (
                                                                        (NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_01,0) * (NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).CANTFSMU_01,0) / NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).CATOFSMU,0))) +
                                                                        (NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_02,0) * (NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).CANTFSMU_02,0) / NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).CATOFSMU,0))) +
                                                                        (NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_03,0) * (NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).CANTFSMU_03,0) / NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).CATOFSMU,0))) +
                                                                        (NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_04,0) * (NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).CANTFSMU_04,0) / NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).CATOFSMU,0))) +
                                                                        (NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_05,0) * (NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).CANTFSMU_05,0) / NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).CATOFSMU,0))) +
                                                                        (NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_06,0) * (NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).CANTFSMU_06,0) / NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).CATOFSMU,0))) +
                                                                        (NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_07,0) * (NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).CANTFSMU_07,0) / NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).CATOFSMU,0))) +
                                                                        (NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_08,0) * (NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).CANTFSMU_08,0) / NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).CATOFSMU,0))) +
                                                                        (NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_09,0) * (NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).CANTFSMU_09,0) / NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).CATOFSMU,0))) +
                                                                        (NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_10,0) * (NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).CANTFSMU_10,0) / NVL(t_MATERIAL(rMaterial_B.IDENTIFICADOR).CATOFSMU,0)))
                                                                       );
         ELSE
dbms_Output.put_line('MATERIAL NO CALCULADO EL ANCHO TOTAL: '||rMATERIAL_B.COD_ARTI||' LOTE: '||rMATERIAL_B.Lote||' ANCHO: '||t_MATERIAL(rMaterial_B.IDENTIFICADOR).Ancho||' ANCHO BUENO TOTAL: '||t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_01||' CANTIDAD TOTAL EN FASE SIG MUL: '||t_MATERIAL(rMaterial_B.IDENTIFICADOR).CANTFSMU_01||' CANTIDAD TOTAL EN FASE SIG TODAS: '||t_MATERIAL(rMaterial_B.IDENTIFICADOR).CATOFSMU);               
            t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL := t_MATERIAL(rMaterial_B.IDENTIFICADOR).ANCHO_BUENO_TOTAL_01;
         END IF;
         ------------------------------------
         --FIN CALCULO DE ANCHO_BUENO_TOTAL--
         ------------------------------------
*/
            --rANCHO_UTIL_B := F_ANCHO_UTIL(vEmpresa,nNumeOtre,rBOBIMAQU.Contador); --ANTERIOR CONCEPTO
            --Se busca si la Maquina pertenece a Fases Multiples Definidas
            nContador_Busqueda_Anterior := NULL;
            --
            nANCHO_UTILIZADO_UTIL_BOBINA := 0;
            --
            nContador_Busqueda_Anterior := F_MAQUINA_FASESIMU_CONTANTE(vEmpresa, nNumeOtre, rBOBIMAQU.CONTADOR);
            --Si la Maquina pertenece a Fases Multiples Definidas hay que buscar todos los anchos Multiples En Fase 1
            IF nContador_Busqueda_Anterior IS NOT NULL THEN
               nCATOFSMU := 0;
               --Se suman las cantidades Totales de las Maquinas(Por ser Fases Siguientes Multiples la CANTFSMU = CATOFSMU)
               FOR nI In 1..T_MAQUINA_FASESIMU.COUNT LOOP
                  biIndice_M   := nI;
                  rMAQUINA_FASESIMU := T_MAQUINA_FASESIMU(biIndice_M);
                  --
                  IF  rMAQUINA_FASESIMU.EMPRESA = vEmpresa 
                  AND rMAQUINA_FASESIMU.NUMEOTRE = nNumeOtre 
                  AND rMAQUINA_FASESIMU.CONTADOR_ANTERIOR = nContador_Busqueda_Anterior THEN
                     rANCHO_UTIL_B_01 := F_ANCHO_UTIL(vEmpresa,nNumeOtre,rMAQUINA_FASESIMU.CONTADOR,1);
                     --
                     nCATOFSMU := nCATOFSMU + NVL(rANCHO_UTIL_B_01.CATOFSMU,0);
                  END IF;
               END LOOP;
               --Se calcula El Ancho Promedio
               FOR nI In 1..T_MAQUINA_FASESIMU.COUNT LOOP
                  biIndice_M   := nI;
                  rMAQUINA_FASESIMU := T_MAQUINA_FASESIMU(biIndice_M);
                  --
                  IF  rMAQUINA_FASESIMU.EMPRESA = vEmpresa 
                  AND rMAQUINA_FASESIMU.NUMEOTRE = nNumeOtre 
                  AND rMAQUINA_FASESIMU.CONTADOR_ANTERIOR = nContador_Busqueda_Anterior THEN
                     rANCHO_UTIL_B_01 := F_ANCHO_UTIL(vEmpresa,nNumeOtre,rMAQUINA_FASESIMU.CONTADOR,1);
--dbms_Output.put_line('BUSQUEDA POR FASE SIGUIENTE MULTIPLE->'||rBOBIMAQU.CONTADOR||'-'||rBOBIMAQU.COD_ARTI||'-'||rBOBIMAQU.CONTADOR||'-'||rBOBIMAQU.CONTBOBI||' Ancho: '||rBOBIMAQU.ANCHO||' Ancho Util:' ||rANCHO_UTIL_B_01.ANCHO_UTILIZADO_UTIL_BOBINA||' CANTFSMU: '||rANCHO_UTIL_B.CANTFSMU||' nCATOFSMU: '||nCATOFSMU);                        
                     --
                     IF NVL(nCATOFSMU,0) != 0 THEN
--dbms_Output.put_line('nANCHO_UTILIZADO_UTIL_BOBINA := '||nANCHO_UTILIZADO_UTIL_BOBINA||' + ('||NVL(rANCHO_UTIL_B_01.ANCHO_UTILIZADO_UTIL_BOBINA,0)||' * ('||NVL(rANCHO_UTIL_B_01.CANTFSMU,0)||' / '||NVL(nCATOFSMU,0)||'))');
                        nANCHO_UTILIZADO_UTIL_BOBINA := nANCHO_UTILIZADO_UTIL_BOBINA + (NVL(rANCHO_UTIL_B_01.ANCHO_UTILIZADO_UTIL_BOBINA,0) * (NVL(rANCHO_UTIL_B_01.CANTFSMU,0) / NVL(nCATOFSMU,0)));
                     END IF;
                  END IF;
               END LOOP;
            ELSE --Se comporta como Promedio Normal
               rANCHO_UTIL_B_01 := F_ANCHO_UTIL(vEmpresa,nNumeOtre,rBOBIMAQU.Contador,1);
--dbms_Output.put_line('1->'||rBOBIMAQU.CONTADOR||'-'||rBOBIMAQU.COD_ARTI||'-'||rBOBIMAQU.CONTADOR||'-'||rBOBIMAQU.CONTBOBI||' Ancho: '||rBOBIMAQU.ANCHO||' Ancho Util:' ||rANCHO_UTIL_B_01.ANCHO_UTILIZADO_UTIL_BOBINA||' CANTFSMU: '||rANCHO_UTIL_B_01.CANTFSMU||' CATOFSMU: '||rANCHO_UTIL_B.CATOFSMU);                        
               --
               IF NVL(rANCHO_UTIL_B_01.CATOFSMU,0) != 0 THEN
                  nANCHO_UTILIZADO_UTIL_BOBINA := (NVL(rANCHO_UTIL_B_01.ANCHO_UTILIZADO_UTIL_BOBINA,0) * (NVL(rANCHO_UTIL_B_01.CANTFSMU,0) / NVL(rANCHO_UTIL_B_01.CATOFSMU,0)));
               END IF;
               --
               rANCHO_UTIL_B_01 := F_ANCHO_UTIL(vEmpresa,nNumeOtre,rBOBIMAQU.Contador,2);
--dbms_Output.put_line('2->'||rBOBIMAQU.CONTADOR||'-'||rBOBIMAQU.COD_ARTI||'-'||rBOBIMAQU.CONTADOR||'-'||rBOBIMAQU.CONTBOBI||' Ancho: '||rBOBIMAQU.ANCHO||' Ancho Util:' ||rANCHO_UTIL_B_01.ANCHO_UTILIZADO_UTIL_BOBINA||' CANTFSMU: '||rANCHO_UTIL_B_01.CANTFSMU||' CATOFSMU: '||rANCHO_UTIL_B.CATOFSMU);                        
               --
               IF NVL(rANCHO_UTIL_B_01.CATOFSMU,0) != 0 THEN
                  nANCHO_UTILIZADO_UTIL_BOBINA := nANCHO_UTILIZADO_UTIL_BOBINA + (NVL(rANCHO_UTIL_B_01.ANCHO_UTILIZADO_UTIL_BOBINA,0) * (NVL(rANCHO_UTIL_B_01.CANTFSMU,0) / NVL(rANCHO_UTIL_B_01.CATOFSMU,0)));
               END IF;
               --
               rANCHO_UTIL_B_01 := F_ANCHO_UTIL(vEmpresa,nNumeOtre,rBOBIMAQU.Contador,3);
--dbms_Output.put_line('3->'||rBOBIMAQU.CONTADOR||'-'||rBOBIMAQU.COD_ARTI||'-'||rBOBIMAQU.CONTADOR||'-'||rBOBIMAQU.CONTBOBI||' Ancho: '||rBOBIMAQU.ANCHO||' Ancho Util:' ||rANCHO_UTIL_B_01.ANCHO_UTILIZADO_UTIL_BOBINA||' CANTFSMU: '||rANCHO_UTIL_B_01.CANTFSMU||' CATOFSMU: '||rANCHO_UTIL_B.CATOFSMU);                        
               --
               IF NVL(rANCHO_UTIL_B_01.CATOFSMU,0) != 0 THEN
                  nANCHO_UTILIZADO_UTIL_BOBINA := nANCHO_UTILIZADO_UTIL_BOBINA + (NVL(rANCHO_UTIL_B_01.ANCHO_UTILIZADO_UTIL_BOBINA,0) * (NVL(rANCHO_UTIL_B_01.CANTFSMU,0) / NVL(rANCHO_UTIL_B_01.CATOFSMU,0)));
               END IF;
               --
               rANCHO_UTIL_B_01 := F_ANCHO_UTIL(vEmpresa,nNumeOtre,rBOBIMAQU.Contador,4);
--dbms_Output.put_line('4>'||rBOBIMAQU.CONTADOR||'-'||rBOBIMAQU.COD_ARTI||'-'||rBOBIMAQU.CONTADOR||'-'||rBOBIMAQU.CONTBOBI||' Ancho: '||rBOBIMAQU.ANCHO||' Ancho Util:' ||rANCHO_UTIL_B_01.ANCHO_UTILIZADO_UTIL_BOBINA||' CANTFSMU: '||rANCHO_UTIL_B_01.CANTFSMU||' CATOFSMU: '||rANCHO_UTIL_B.CATOFSMU);                        
               --
               IF NVL(rANCHO_UTIL_B_01.CATOFSMU,0) != 0 THEN
                  nANCHO_UTILIZADO_UTIL_BOBINA := nANCHO_UTILIZADO_UTIL_BOBINA + (NVL(rANCHO_UTIL_B_01.ANCHO_UTILIZADO_UTIL_BOBINA,0) * (NVL(rANCHO_UTIL_B_01.CANTFSMU,0) / NVL(rANCHO_UTIL_B_01.CATOFSMU,0)));
               END IF;
               --
               rANCHO_UTIL_B_01 := F_ANCHO_UTIL(vEmpresa,nNumeOtre,rBOBIMAQU.Contador,5);
               --
               IF NVL(rANCHO_UTIL_B_01.CATOFSMU,0) != 0 THEN
                  nANCHO_UTILIZADO_UTIL_BOBINA := nANCHO_UTILIZADO_UTIL_BOBINA + (NVL(rANCHO_UTIL_B_01.ANCHO_UTILIZADO_UTIL_BOBINA,0) * (NVL(rANCHO_UTIL_B_01.CANTFSMU,0) / NVL(rANCHO_UTIL_B_01.CATOFSMU,0)));
               END IF;
               --
               rANCHO_UTIL_B_01 := F_ANCHO_UTIL(vEmpresa,nNumeOtre,rBOBIMAQU.Contador,6);
               --
               IF NVL(rANCHO_UTIL_B_01.CATOFSMU,0) != 0 THEN
                  nANCHO_UTILIZADO_UTIL_BOBINA := nANCHO_UTILIZADO_UTIL_BOBINA + (NVL(rANCHO_UTIL_B_01.ANCHO_UTILIZADO_UTIL_BOBINA,0) * (NVL(rANCHO_UTIL_B_01.CANTFSMU,0) / NVL(rANCHO_UTIL_B_01.CATOFSMU,0)));
               END IF;
               --
               rANCHO_UTIL_B_01 := F_ANCHO_UTIL(vEmpresa,nNumeOtre,rBOBIMAQU.Contador,7);
               --
               IF NVL(rANCHO_UTIL_B_01.CATOFSMU,0) != 0 THEN
                  nANCHO_UTILIZADO_UTIL_BOBINA := nANCHO_UTILIZADO_UTIL_BOBINA + (NVL(rANCHO_UTIL_B_01.ANCHO_UTILIZADO_UTIL_BOBINA,0) * (NVL(rANCHO_UTIL_B_01.CANTFSMU,0) / NVL(rANCHO_UTIL_B_01.CATOFSMU,0)));
               END IF;
               --
               rANCHO_UTIL_B_01 := F_ANCHO_UTIL(vEmpresa,nNumeOtre,rBOBIMAQU.Contador,8);
               --
               IF NVL(rANCHO_UTIL_B_01.CATOFSMU,0) != 0 THEN
                  nANCHO_UTILIZADO_UTIL_BOBINA := nANCHO_UTILIZADO_UTIL_BOBINA + (NVL(rANCHO_UTIL_B_01.ANCHO_UTILIZADO_UTIL_BOBINA,0) * (NVL(rANCHO_UTIL_B_01.CANTFSMU,0) / NVL(rANCHO_UTIL_B_01.CATOFSMU,0)));
               END IF;
               --
               rANCHO_UTIL_B_01 := F_ANCHO_UTIL(vEmpresa,nNumeOtre,rBOBIMAQU.Contador,9);
               --
               IF NVL(rANCHO_UTIL_B_01.CATOFSMU,0) != 0 THEN
                  nANCHO_UTILIZADO_UTIL_BOBINA := nANCHO_UTILIZADO_UTIL_BOBINA + (NVL(rANCHO_UTIL_B_01.ANCHO_UTILIZADO_UTIL_BOBINA,0) * (NVL(rANCHO_UTIL_B_01.CANTFSMU,0) / NVL(rANCHO_UTIL_B_01.CATOFSMU,0)));
               END IF;
               --
               rANCHO_UTIL_B_01 := F_ANCHO_UTIL(vEmpresa,nNumeOtre,rBOBIMAQU.Contador,10);
               --
               IF NVL(rANCHO_UTIL_B_01.CATOFSMU,0) != 0 THEN
                  nANCHO_UTILIZADO_UTIL_BOBINA := nANCHO_UTILIZADO_UTIL_BOBINA + (NVL(rANCHO_UTIL_B_01.ANCHO_UTILIZADO_UTIL_BOBINA,0) * (NVL(rANCHO_UTIL_B_01.CANTFSMU,0) / NVL(rANCHO_UTIL_B_01.CATOFSMU,0)));
               END IF;
            END IF;
            --
            IF nANCHO_UTILIZADO_UTIL_BOBINA IS NOT NULL THEN --rANCHO_UTIL_B_01.ANCHO_UTILIZADO_UTIL_BOBINA IS NOT NULL THEN
--dbms_Output.put_line('1->ASIGNA BOBINA->'||rBOBIMAQU.CONTADOR||'-'||rBOBIMAQU.COD_ARTI||'-'||rBOBIMAQU.CONTADOR||'-'||rBOBIMAQU.CONTBOBI||' nANCHO_UTILIZADO_UTIL_BOBINA: '||nANCHO_UTILIZADO_UTIL_BOBINA);                        
               --T_BOBIMAQU(rBOBIMAQU.IDENTIFICADOR).ANCHO_BUENO := nANCHO_UTILIZADO_UTIL_BOBINA;--rANCHO_UTIL_B_01.ANCHO_UTILIZADO_UTIL_BOBINA;
               P_BOBIMAQU(rBOBIMAQU.IDENTIFICADOR,--nIdentificador
                          NULL,--nAncho 
                          NULL,--nAncho_Total 
                          NULL,--vDesbarbe 
                          NULL,--nNumero_Bobinas_Corte 
                          NULL,--nFACTOR_CONVERSION_M2_KG
                          NULL,--nPRECIO_ML
                          nANCHO_UTILIZADO_UTIL_BOBINA);--nAncho_Bueno
               --
               rBOBIMAQU.ANCHO_BUENO := nANCHO_UTILIZADO_UTIL_BOBINA;
            ELSE
--dbms_Output.put_line('2->ASIGNA BOBINA->'||rBOBIMAQU.CONTADOR||'-'||rBOBIMAQU.COD_ARTI||'-'||rBOBIMAQU.CONTADOR||'-'||rBOBIMAQU.CONTBOBI||' rBOBIMAQU.ANCHO: '||rBOBIMAQU.ANCHO);                        
               --T_BOBIMAQU(rBOBIMAQU.IDENTIFICADOR).ANCHO_BUENO := rBOBIMAQU.ANCHO;
               P_BOBIMAQU(rBOBIMAQU.IDENTIFICADOR,--nIdentificador
                          NULL,--nAncho 
                          NULL,--nAncho_Total 
                          NULL,--vDesbarbe 
                          NULL,--nNumero_Bobinas_Corte 
                          NULL,--nFACTOR_CONVERSION_M2_KG
                          NULL,--nPRECIO_ML
                          rBOBIMAQU.ANCHO);--nAncho_Bueno
               --
               rBOBIMAQU.ANCHO_BUENO := nANCHO_UTILIZADO_UTIL_BOBINA;
            END IF;
         ELSE
            --T_BOBIMAQU(rBOBIMAQU.IDENTIFICADOR).ANCHO_BUENO := rBOBIMAQU.ANCHO;
            P_BOBIMAQU(rBOBIMAQU.IDENTIFICADOR,--nIdentificador
                       NULL,--nAncho 
                       NULL,--nAncho_Total 
                       NULL,--vDesbarbe 
                       NULL,--nNumero_Bobinas_Corte 
                       NULL,--nFACTOR_CONVERSION_M2_KG
                       NULL,--nPRECIO_ML
                       rBOBIMAQU.ANCHO);--nAncho_Bueno
            --
            rBOBIMAQU.ANCHO_BUENO := nANCHO_UTILIZADO_UTIL_BOBINA;
         END IF;
      END LOOP;
   END;--P_Ancho_Bueno
---
   --
   --Actualiza Datos Faltantes de los Materiales Utilizados
   PROCEDURE P_ACTUALIZA_MATERIALES(vEmpresa PRD_BOBIMAQU.EMPRESA%TYPE, nNumeOtre PRD_BOBIMAQU.NUMEOTRE%TYPE) IS
      rMATERIAL_B ST_MATERIAL;
      --
      --rBOBIMAQU_B ST_BOBIMAQU;
      --Factor de Conversion de ML de Ancho de Bobina a Ancho de Material
      nFactor NUMBER;
      --Materiales que intervienen en la Fabricaci¿e la Bobina
      CURSOR cMateBobi(vEmpresa PRD_MAPAMAQU.EMPRESA%TYPE, nNumeOtre PRD_MAPAMAQU.NUMEOTRE%TYPE, nContador PRD_MAPAMAQU.CONTADOR%TYPE, nCoboGene PRD_MAPAMAQU.COBOGENE%TYPE, vTip_Arti PRD_MAPAMAQU.TIP_ARTI%TYPE) IS
         SELECT M.EMPRESA, M.NUMEOTRE, M.CONTADOR, M.EMPRBOBI, M.NUOTBOBI, M.CONTBOBI, DECODE(SIGN(M.COBOBOBI), -1, -1,M.COBOBOBI) COBOBOBI, M.TIP_ARTI, M.COD_ARTI, M.LOTE, SUM(M.CANTCONS) CANTCONS --Se realiza lo del DECODE para no tener que buscar el precio de la MP por cada pasada del mismo tirpo de material M o S ya que cada que se utiliza se asigna un consecutivo negativo
         FROM PRD_MAPAMAQU M
         WHERE M.EMPRESA = vEmpresa
           AND M.NUMEOTRE = nNumeOtre
           AND M.CONTADOR = nContador
           AND (
                (vTip_Arti != vTiarCosc AND M.COBOGENE = nCoboGene) OR
                (vTip_Arti = vTiarCosc AND EXISTS (SELECT 'X' FROM PRD_COMPBOBI C 
                                                    WHERE C.EMPRESA = M.EMPRESA
                                                      AND C.NUMEOTRE = M.NUMEOTRE
                                                      AND C.CONTADOR = M.CONTADOR
                                                      AND C.CONTBOBI = nCoboGene
                                                      AND C.EMPRCOMP = M.EMPRESA
                                                      AND C.NUOTCOMP = M.NUMEOTRE
                                                      AND C.CONTCOMP = M.CONTADOR
                                                      AND C.COBOCOMP = M.COBOGENE
                                                   )
                )
               )
           AND M.MARCPASA = 'N'
         GROUP BY M.EMPRESA, M.NUMEOTRE, M.CONTADOR, M.EMPRBOBI, M.NUOTBOBI, M.CONTBOBI, DECODE(SIGN(M.COBOBOBI), -1, -1,M.COBOBOBI), M.TIP_ARTI, M.COD_ARTI, M.LOTE;
      --
      bExisMaBo BOOLEAN := FALSE;
      --
      nCantTota NUMBER := 0;
      nPrecTota NUMBER := 0;
      nPrecTota_E NUMBER := 0;
      --
      nPrecio NUMBER;
      nPrecio_E NUMBER;
      --
      rMATERIAL ST_MATERIAL;--Registro de Busqueda
      rBOBIMAQU_U ST_BOBIMAQU;--Registro de Utilizacion
      --
      rMATERIAL_A ST_MATERIAL;--Registro de Busqueda de Anchos
      --
      nAncho ARTICULO.ANCHO%TYPE;
      nFCKG LFS.FCKG%TYPE;
      nDesbarbe_PreCorte NUMBER;
      --Mermas por Tirada Estandar (Nos da un % a aplicar por los metros que se han consumido los Materiales de la Maquina)
      CURSOR cPRD_MAQUMETI(vMaquTipo PRD_MAQURUTA.MAQUTIPO%TYPE, vMaquCodi PRD_MAQURUTA.MAQUCODI%TYPE, nCantidad NUMBER) IS
         SELECT UNIDAD, VALOR
         FROM PRD_MAQUMETI
         WHERE EMPRESA = vEmpresa
           AND MAQUTIPO = vMaquTipo
           AND MAQUCODI = vMaquCodi
           AND nCantidad BETWEEN DESDE AND HASTA;
      --
      rPRD_MAQUMETI cPRD_MAQUMETI%ROWTYPE;
		/*
      --Mermas por Saneamiento Estandar (Nos da un % a aplicar por los metros que se han consumido los Materiales de la Maquina)
      CURSOR cPRD_MAQUMESA(vMaquTipo PRD_MAQURUTA.MAQUTIPO%TYPE, vMaquCodi PRD_MAQURUTA.MAQUCODI%TYPE, nCantidad NUMBER) IS
         SELECT UNIDAD, VALOR
         FROM PRD_MAQUMESA
         WHERE EMPRESA = vEmpresa
           AND MAQUTIPO = vMaquTipo
           AND MAQUCODI = vMaquCodi
           AND nCantidad BETWEEN DESDE AND HASTA;
      --
      rPRD_MAQUMESA cPRD_MAQUMESA%ROWTYPE;*/
      --
      --nMM_Merma_Planificacion NUMBER;
      nFACTOR_CONVERSION_M2_KG NUMBER;
      nFACTOR_CONVERSION_AB_A NUMBER;
      nPrecio_Merma_Planificacion NUMBER;
      nPrecio_Merma_Planificacion_E NUMBER;
      --
      nPrecio_Merma_Plan_Exeso NUMBER;
      nPrecio_Merma_Pre_Corte NUMBER;
      --
      nMERMENHE NUMBER;
      nMERMAJUS NUMBER;
      nMERMCABO NUMBER;
      nMERMPICO NUMBER;
      nMERMTIRA NUMBER;
      nMERMSANE NUMBER;
      nMERMPROC NUMBER;
      nMERMTOTA NUMBER;
      --
      nMERMENHE_E NUMBER;
      nMERMAJUS_E NUMBER;
      nMERMCABO_E NUMBER;
      nMERMPICO_E NUMBER;
      nMERMTIRA_E NUMBER;
      nMERMSANE_E NUMBER;
      nMERMPROC_E NUMBER;
      nMERMTOTA_E NUMBER;
      --Materiales que intervienen en la Fabricaci¿e la Bobina
      CURSOR cMateBobi_Merma(vEmpresa PRD_MAPAMAQU.EMPRESA%TYPE, nNumeOtre PRD_MAPAMAQU.NUMEOTRE%TYPE, nContador PRD_MAPAMAQU.CONTADOR%TYPE, nCoboGene PRD_MAPAMAQU.COBOGENE%TYPE, vTip_Arti PRD_MAPAMAQU.TIP_ARTI%TYPE) IS
         SELECT M.EMPRESA, M.NUMEOTRE, M.CONTADOR, M.CONTPASA, M.CONTMATE, M.EMPRBOBI, M.NUOTBOBI, M.CONTBOBI, M.COBOBOBI, M.TIP_ARTI, M.COD_ARTI, M.LOTE, M.CANTCONS 
         FROM PRD_MAPAMAQU M
         WHERE M.EMPRESA = vEmpresa
           AND M.NUMEOTRE = nNumeOtre
           AND M.CONTADOR = nContador
           AND (
                (vTip_Arti != vTiarCosc AND M.COBOGENE = nCoboGene) OR
                (vTip_Arti = vTiarCosc AND EXISTS (SELECT 'X' FROM PRD_COMPBOBI C --SELECT EMPRCOMP,NUOTCOMP,CONTCOMP,COBOCOMP FROM 
                                                    WHERE C.EMPRESA = M.EMPRESA
                                                      AND C.NUMEOTRE = M.NUMEOTRE
                                                      AND C.CONTADOR = M.CONTADOR
                                                      AND C.CONTBOBI = nCoboGene
                                                      AND C.EMPRCOMP = M.EMPRESA
                                                      AND C.NUOTCOMP = M.NUMEOTRE
                                                      AND C.CONTCOMP = M.CONTADOR
                                                      AND C.COBOCOMP = M.COBOGENE
                                                   )
                )
               )
           AND M.MARCPASA = 'N'
         ORDER BY M.CONTPASA, M.CONTMATE, M.COBOBOBI;
      --Cuenta Metros
      nCuenMetr NUMBER;
      nMermaAsignada NUMBER;
      nMermaSuma NUMBER;
      --
      CURSOR cMERMA(vEmpresa PRD_MAPAMAQU.EMPRESA%TYPE, nNumeOtre PRD_MAPAMAQU.NUMEOTRE%TYPE, nContador PRD_MAPAMAQU.CONTADOR%TYPE, nContBobi PRD_COMPBOBI.CONTBOBI%TYPE, vTipoMerm PRD_SEGUBOBI.TIPOMERM%TYPE) IS
         SELECT S.CONTSEGU, NVL(M.CAMPNU06,0) DESDE, NVL(M.CAMPNU07,0) HASTA, NVL(M.CAMPNU08,0) MERMA FROM PRD_SEGUBOBI S, PRD_MEFAEVEN M
         WHERE S.EMPRESA = M.EMPRESA
           AND S.NUMEOTRE = M.NUMEOTRE
           AND M.ORVAREAL = S.TIPOMERM||'-'||S.CONTADOR||'-'||S.CONTBOBI||'-'||S.CONTSEGU
           AND S.EMPRESA = vEmpresa
           AND S.NUMEOTRE = nNumeOtre
           AND S.CONTADOR = nContador
           AND S.CONTBOBI = nContBobi
           AND S.TIPOMERM = vTipoMerm
         ORDER BY S.CONTSEGU;
      --
      nPorcentaje_Acumulado NUMBER;
      --Variables para Insertar Registros Hijos
      vEmpresa_MateHijo PRD_MAPAMAQU.EMPRESA%TYPE;
      nNumeOtre_MateHijo PRD_MAPAMAQU.NUMEOTRE%TYPE;
      vTip_Arti_MateHijo PRD_MAPAMAQU.TIP_ARTI%TYPE;
      vCod_Arti_MateHijo PRD_MAPAMAQU.COD_ARTI%TYPE;
      vLote_MateHijo VARCHAR2(250);
      nContMaqu_MateHijo PRD_MAPAMAQU.CONTADOR%TYPE;
      nPrecio_MateHijo NUMBER;
      nPrecio_MateHijo_E NUMBER;
      --
		CURSOR cANE_MER_BOBIMAQU_OT IS
			SELECT EMPRESA,NUMEOTRE,CONTADOR,CONTBOBI,TIP_ARTI,COD_ARTI,ANCHO_BUENO,MERMTIRA,MERMSANE,LOTE,PRECIO_ML,NUMERO_BOBINAS_CORTE,IDENTIFICADOR
			FROM ANALESTA.ANE_MER_BOBIMAQU_OT
			WHERE EMPRESA = vEmpresa
			  AND NUMEOTRE = nNumeOtre;
      --
      CURSOR cMaterial IS
          SELECT EMPRESA,NUMEOTRE,CONTADOR,CONTMATE,CONTMAEV,
                  IDENTIFICADOR,
                  TIP_ARTI,COD_ARTI,LOTE,CANTCONS,CANTCONS_BOBINAS,CANTPROD,CANTAJUS,MERMENHE,MERMAJUS,MERMCABO,MERMPICO,MERMTIRA,MERMSANE,
                  CONTFSMU_01,CONTFSMU_02,CONTFSMU_03,CONTFSMU_04,CONTFSMU_05,CONTFSMU_06,CONTFSMU_07,CONTFSMU_08,CONTFSMU_09,CONTFSMU_10,
                  CANTFSMU_01,CANTFSMU_02,CANTFSMU_03,CANTFSMU_04,CANTFSMU_05,CANTFSMU_06,CANTFSMU_07,CANTFSMU_08,CANTFSMU_09,CANTFSMU_10,
                  CATOFSMU,MM_MERMPLAN_01,MM_MERMPLAN_02,MM_MERMPLAN_03,MM_MERMPLAN_04,MM_MERMPLAN_05,MM_MERMPLAN_06,MM_MERMPLAN_07,MM_MERMPLAN_08,MM_MERMPLAN_09,MM_MERMPLAN_10,
                  MM_MERMPLAN,MERMPLAN,
                  MM_MERMPLAN_EXESO_01,MM_MERMPLAN_EXESO_02,MM_MERMPLAN_EXESO_03,MM_MERMPLAN_EXESO_04,MM_MERMPLAN_EXESO_05,MM_MERMPLAN_EXESO_06,MM_MERMPLAN_EXESO_07,MM_MERMPLAN_EXESO_08,MM_MERMPLAN_EXESO_09,MM_MERMPLAN_EXESO_10,
                  MM_MERMPLAN_EXESO,MERMPLAN_EXESO,
                  PRE_CORTE,
                  NUMECORT_01,NUMECORT_02,NUMECORT_03,NUMECORT_04,NUMECORT_05,NUMECORT_06,NUMECORT_07,NUMECORT_08,NUMECORT_09,NUMECORT_10,
                  NUMECORT,
                  MM_MERMPRCO_01,MM_MERMPRCO_02,MM_MERMPRCO_03,MM_MERMPRCO_04,MM_MERMPRCO_05,MM_MERMPRCO_06,MM_MERMPRCO_07,MM_MERMPRCO_08,MM_MERMPRCO_09,MM_MERMPRCO_10,
                  MM_MERMPRCO,MERMPRCO,
                  CANTCONS_E,MERMENHE_E,MERMAJUS_E,MERMCABO_E,MERMPICO_E,MERMTIRA_E,MERMSANE_E,MM_MERMPLAN_E,MERMPLAN_E,
                  ANCHO,
                  ANCHO_BUENO_OT_01,ANCHO_BUENO_TOTAL_01,ANCHO_BUENO_OT_02,ANCHO_BUENO_TOTAL_02,ANCHO_BUENO_OT_03,ANCHO_BUENO_TOTAL_03,ANCHO_BUENO_OT_04,ANCHO_BUENO_TOTAL_04,ANCHO_BUENO_OT_05,ANCHO_BUENO_TOTAL_05,
                  ANCHO_BUENO_OT_06,ANCHO_BUENO_TOTAL_06,ANCHO_BUENO_OT_07,ANCHO_BUENO_TOTAL_07,ANCHO_BUENO_OT_08,ANCHO_BUENO_TOTAL_08,ANCHO_BUENO_OT_09,ANCHO_BUENO_TOTAL_09,ANCHO_BUENO_OT_10,ANCHO_BUENO_TOTAL_10,
                  ANCHO_BUENO_TOTAL,ANCHO_BUENO_OT,
                  CANTIDAD_CONSUMIDA_FINAL_01,CANTIDAD_CONSUMIDA_FINAL_02,CANTIDAD_CONSUMIDA_FINAL_03,CANTIDAD_CONSUMIDA_FINAL_04,CANTIDAD_CONSUMIDA_FINAL_05,CANTIDAD_CONSUMIDA_FINAL_06,CANTIDAD_CONSUMIDA_FINAL_07,CANTIDAD_CONSUMIDA_FINAL_08,CANTIDAD_CONSUMIDA_FINAL_09,CANTIDAD_CONSUMIDA_FINAL_10,
                  CANTIDAD_CONSUMIDA_FINAL_TOTAL,
                  PRECIO_ML,PRECIO_ML_E,FACTOR_CONVERSION_M2_KG
             FROM ANALESTA.ANE_MER_MATERIAL_OT
             WHERE EMPRESA = vEmpresa 
               AND NUMEOTRE = nNumeOtre;
   BEGIN --P_ACTUALIZA_MATERIALES
--BMERMA
--dbms_output.put_line('ANTES DE RECORRER BOBINAS PARA ACTIALIZAR MATERIALES');
      --Se recorren las Bobinas para actualizar Mermas de Tirada y Saneamiento en el Material
      --FOR nI In 1..T_BOBIMAQU.COUNT LOOP
      --   biIndice   := nI;
      --   rBOBIMAQU_B := T_BOBIMAQU(biIndice);
		FOR rBOBIMAQU_B IN cANE_MER_BOBIMAQU_OT LOOP
		   /*
			rBOBIMAQU_B.EMPRESA;
			rBOBIMAQU_B.NUMEOTRE;
			rBOBIMAQU_B.CONTADOR;
			rBOBIMAQU_B.CONTBOBI;
			rBOBIMAQU_B.TIP_ARTI;
			rBOBIMAQU_B.COD_ARTI;
			rBOBIMAQU_B.ANCHO_BUENO;
			rBOBIMAQU_B.MERMTIRA;
			rBOBIMAQU_B.MERMSANE;
			rBOBIMAQU_B.LOTE;
			rBOBIMAQU_B.NUMERO_BOBINAS_CORTE;
			rBOBIMAQU_B.PRECIO_ML;*/
         --
-->MERMA DE TIRADA REAL
         IF NVL(rBOBIMAQU_B.MERMTIRA,0) > 0 THEN
            --Se buscan las Mermas Picadas para encontrar a que Material Pertencen apoyandose en el Cuenta Metros
            FOR rMERMA IN cMERMA(rBOBIMAQU_B.EMPRESA, rBOBIMAQU_B.NUMEOTRE, rBOBIMAQU_B.CONTADOR, rBOBIMAQU_B.CONTBOBI, vTimeTira) LOOP
               IF NVL(rMERMA.Merma,0) > 0 THEN
                  nCuenMetr := 0;
                  nMermaAsignada := 0;
                  --Materiales que intervienen en la Fabricaci¿e la Bobina
                  FOR rMateBobi IN cMateBobi_Merma(rBOBIMAQU_B.EMPRESA, rBOBIMAQU_B.NUMEOTRE, rBOBIMAQU_B.CONTADOR, rBOBIMAQU_B.CONTBOBI, rBOBIMAQU_B.TIP_ARTI) LOOP
                     IF rMateBobi.CONTMATE = 1 THEN --Solo se Actualiza el Cuenta Metros en el Material 1 el 2 es que se esta laminando cuando esto aplique
                        nCuenMetr := nCuenMetr + rMateBobi.CantCons;
                        --
                        nMermaSuma := 0;
                        --
                        IF rMERMA.DESDE <= nCuenMetr AND rMERMA.HASTA <= nCuenMetr THEN --Caso 1 Ejemplo: Total Consumida 2500 Merma Dese 2100 Hasta 2300 Total 200
                           nMermaSuma := rMERMA.Merma - nMermaAsignada;
                        --ELSIF rMERMA.DESDE > nCuenMetr THEN --Caso 2 Ejemplo: Total Consumida 2500 Merma Dese 2800 Hasta 2900 Total 100 No se causa en Este Material
                           --NO SE REALIZA NADA PORQUE HAY QUE DAR OTRO CICLO
                        ELSIF rMERMA.DESDE <= nCuenMetr AND rMERMA.HASTA >= nCuenMetr THEN --Caso 2 Ejemplo: Total Consumida 2500 Merma Dese 2400 Hasta 2800 Total 400 Son dos Materiales
                           nMermaSuma := rMERMA.Merma - (nCuenMetr - rMERMA.DESDE);
                        --ELSE --Mal introducidos los cuenta Metros, Se imputa al primer Material
                           --NO SE REALIZA NADA PORQUE SE TRATARA CUANDO SALGA DEL FOR DE MATERIALES Y SE VERIFIQUE QUE TODO FUE ASIGNADO
                        END IF;
                        --
                        nMermaAsignada := nMermaAsignada + nMermaSuma;
                        --
                        IF NVL(nMermaSuma,0) > 0 THEN
                           IF rMateBobi.CoboBobi > 0 THEN --Se trata de una Bobina Generada
                              rMaterial_B1 := F_MATERIAL(rBOBIMAQU_B.EMPRESA, rBOBIMAQU_B.NUMEOTRE, rBOBIMAQU_B.CONTADOR, 
                                                         rMateBobi.TIP_ARTI, rMateBobi.COD_ARTI, '|EMPRBOBI:'||rMateBobi.EmprBobi||'|NUOTBOBI:'||rMateBobi.NuotBobi||'|CONTBOBI:'||rMateBobi.ContBobi||'|COBOBOBI:'||rMateBobi.CoboBobi||'|LOTE:'||rMateBobi.Lote,
                                                         NULL, NULL);
                           ELSE --Es un material de Almacen
                              rMaterial_B1 := F_MATERIAL(rBOBIMAQU_B.EMPRESA, rBOBIMAQU_B.NUMEOTRE, rBOBIMAQU_B.CONTADOR, 
                                                         rMateBobi.TIP_ARTI, rMateBobi.COD_ARTI, '|EMPRBOBI:'||rMateBobi.EmprBobi||'|NUOTBOBI:'||rMateBobi.NuotBobi||'|LOTE:'||rMateBobi.Lote||
																		   '|COBOMATE:'||rMateBobi.ContBobi||'|BOBIMATE:'||rMateBobi.CoboBobi, -- 11-11-2016 Solo para materiales tipo M
                                                         NULL, NULL);
                           END IF;
                           --
                           IF rMaterial_B1.IDENTIFICADOR IS NOT NULL THEN
                              --Se confronta el Ancho de la Bobina contra el Ancho del Material
                              /*NOTA POR ADICION DE ANCHO BUENO TOTAL
                                - SI EL ANCHO DEL MATERIAL ES MAYOR O IGUAL QUE EL DE LA BOBINA Y (NO ES BOBINA DE PRE-CORTE O ES DE PRE-CORTE Y ES DE UN SOLO CORTE)
                                - SI EL ANCHO DEL MATERIAL ES MAYIR AL DE LA BOBUNA SE TRATARA CON EL FACTOR DE EQUIVALENCIA EN ML TOMADO DE LA RELACION DE ML->M2 DE LA BOBINA CONTRA LOS ML->M2 DEL MATERIAL (PERO USANDO EL ANCHO_BUENO_TOTAL DEL MATERIAL)
                              */
                              IF rMaterial_B1.ANCHO_BUENO_TOTAL IS NOT NULL AND rBOBIMAQU_B.ANCHO_BUENO IS NOT NULL THEN
                                 IF rMaterial_B1.ANCHO_BUENO_TOTAL >= rBOBIMAQU_B.ANCHO_BUENO AND (rBOBIMAQU_B.TIP_ARTI != vTiarCosc OR (rBOBIMAQU_B.TIP_ARTI = vTiarCosc AND rBOBIMAQU_B.NUMERO_BOBINAS_CORTE = 1)) THEN--Se imputa todo el ancho si es cualquier bobina diferente de un Corte de Precorte o si es Bobina de Pre-Corte pero el Pre-Corte solo tiene un Corte
                                    --Actualizaci¿e Mermas
                                    P_MATERIAL(rMaterial_B1,'U',
                                               NULL,--nCantProd
                                               NULL,--nCantCons_E
                                               NULL,--nCantCons
                                               NULL,--nCantAjus
                                               NULL,--nAncho
                                               NULL,--nFACTOR_CONVERSION_M2_KG
                                               NULL,--nPrecio_ML_E
                                               NULL,--vLog_Precio
                                               NULL,--nMermEnhe_E
                                               NULL,--nMermEnhe
                                               NULL,--nMermAjus_E
                                               NULL,--nMermAjus
                                               NULL,--nMermCabo_E
                                               NULL,--nMermCabo
                                               NULL,--nMermPico_E
                                               NULL,--nMermPico
                                               NVL(nMermaSuma,0),--nMermTita
                                               NULL,--nMermSane
                                               NULL,--nCantCons_Bobinas
                                               --
                                                NULL, --nCONTFSMU_01 
                                                NULL, --nCANTFSMU_01 
                                                NULL, --nCATOFSMU 
                                                NULL, --nCONTFSMU_02 
                                                NULL, --nCANTFSMU_02 
                                                NULL, --nCONTFSMU_03 
                                                NULL, --nCANTFSMU_03 
                                                NULL, --nCONTFSMU_04 
                                                NULL, --nCANTFSMU_04 
                                                NULL, --nCONTFSMU_05 
                                                NULL, --nCANTFSMU_05 
                                                NULL, --nCONTFSMU_06 
                                                NULL, --nCANTFSMU_06 
                                                NULL, --nCONTFSMU_07 
                                                NULL, --nCANTFSMU_07 
                                                NULL, --nCONTFSMU_08 
                                                NULL, --nCANTFSMU_08 
                                                NULL, --nCONTFSMU_09 
                                                NULL, --nCANTFSMU_09 
                                                NULL, --nCONTFSMU_10 
                                                NULL, --nCANTFSMU_10 
                                                NULL, --nANCHO_BUENO_TOTAL_01 
                                                NULL, --nANCHO_BUENO_OT_01 
                                                NULL, --nANCHO_BUENO_TOTAL_02 
                                                NULL, --nANCHO_BUENO_OT_02 
                                                NULL, --nANCHO_BUENO_TOTAL_03 
                                                NULL, --nANCHO_BUENO_OT_03 
                                                NULL, --nANCHO_BUENO_TOTAL_04 
                                                NULL, --nANCHO_BUENO_OT_04 
                                                NULL, --nANCHO_BUENO_TOTAL_05 
                                                NULL, --nANCHO_BUENO_OT_05 
                                                NULL, --nANCHO_BUENO_TOTAL_06 
                                                NULL, --nANCHO_BUENO_OT_06 
                                                NULL, --nANCHO_BUENO_TOTAL_07 
                                                NULL, --nANCHO_BUENO_OT_07 
                                                NULL, --nANCHO_BUENO_TOTAL_08 
                                                NULL, --nANCHO_BUENO_OT_08 
                                                NULL, --nANCHO_BUENO_TOTAL_09 
                                                NULL, --nANCHO_BUENO_OT_09 
                                                NULL, --nANCHO_BUENO_TOTAL_10 
                                                NULL, --nANCHO_BUENO_OT_10 
                                                NULL, --nANCHO_BUENO_TOTAL 
                                                NULL, --nANCHO_BUENO_OT 
                                                NULL, --nNUMECORT 
                                                NULL, --nMM_MERMPRCO_01 
                                                NULL, --nMM_MERMPLAN_EXESO_01 
                                                NULL, --nMM_MERMPLAN_01 
                                                NULL, --nMM_MERMPRCO_02 
                                                NULL, --nMM_MERMPLAN_EXESO_02 
                                                NULL, --nMM_MERMPLAN_02 
                                                NULL, --nMM_MERMPRCO_03 
                                                NULL, --nMM_MERMPLAN_EXESO_03 
                                                NULL, --nMM_MERMPLAN_03 
                                                NULL, --nMM_MERMPRCO_04 
                                                NULL, --nMM_MERMPLAN_EXESO_04 
                                                NULL, --nMM_MERMPLAN_04 
                                                NULL, --nMM_MERMPRCO_05 
                                                NULL, --nMM_MERMPLAN_EXESO_05 
                                                NULL, --nMM_MERMPLAN_05 
                                                NULL, --nMM_MERMPRCO_06 
                                                NULL, --nMM_MERMPLAN_EXESO_06 
                                                NULL, --nMM_MERMPLAN_06 
                                                NULL, --nMM_MERMPRCO_07 
                                                NULL, --nMM_MERMPLAN_EXESO_07 
                                                NULL, --nMM_MERMPLAN_07 
                                                NULL, --nMM_MERMPRCO_08 
                                                NULL, --nMM_MERMPLAN_EXESO_08 
                                                NULL, --nMM_MERMPLAN_08 
                                                NULL, --nMM_MERMPRCO_09 
                                                NULL, --nMM_MERMPLAN_EXESO_09 
                                                NULL, --nMM_MERMPLAN_09 
                                                NULL, --nMM_MERMPRCO_10 
                                                NULL, --nMM_MERMPLAN_EXESO_10 
                                                NULL, --nMM_MERMPLAN_10 
                                                NULL, --nMM_MERMPRCO 
                                                NULL, --nMM_MERMPLAN_EXESO 
                                                NULL); --nMM_MERMPLAN
                                    --t_MATERIAL(rMaterial_B1.IDENTIFICADOR).MermTira := NVL(rMaterial_B1.MERMTIRA,0) + NVL(nMermaSuma,0);
                                 ELSIF rMaterial_B1.ANCHO_BUENO_TOTAL > rBOBIMAQU_B.ANCHO_BUENO THEN
                                    nFactor := (NVL(rBOBIMAQU_B.ANCHO_BUENO,0) / 1000);--Convierte a M2 de Bobina
                                    --
                                    IF (NVL(rMaterial_B1.ANCHO_BUENO_TOTAL,0) / 1000) > 0 THEN
                                       nFactor := nFactor  / (NVL(rMaterial_B1.ANCHO_BUENO_TOTAL,0) / 1000);--Convierte los M2 de Bobina a ML de Material
                                    ELSE
                                       nFactor := 0;
                                       --
                                       --647 No se encuentra @1. [Contador @2]
                                       P_ERRORES(vEmpresa, nNumeOtre, '647','Factor de Conversi¿or fallo en el Calculo en la Bobina ContBobi Maquina: '||rBOBIMAQU_B.Contador||' ContBobi: '||rBOBIMAQU_B.ContBobi||' Articulo: '||rBOBIMAQU_B.Tip_Arti||'-'||rBOBIMAQU_B.Cod_Arti||' Lote:'||rBOBIMAQU_B.Lote||' Ancho Bueno: '||rBOBIMAQU_B.ANCHO_BUENO||' contra el Material '||rMaterial_B1.Tip_Arti||'-'||rMaterial_B1.Cod_Arti||' Lote: '||rMaterial_B1.Lote||' Ancho Bueno Total: '||rMaterial_B1.ANCHO_BUENO_TOTAL||'|26','R','E');
                                       --dbms_output.put_line('Error: Calculo de Factor de Conversion de la Bobina '||rBOBIMAQU_B.Empresa||'-'||rBOBIMAQU_B.NumeOtre||'-'||rBOBIMAQU_B.Contador||'-'||rBOBIMAQU_B.ContBobi||'-'||rBOBIMAQU_B.Tip_Arti||'-'||rBOBIMAQU_B.Cod_Arti||'-'||rBOBIMAQU_B.Lote||' Ancho: '||rBOBIMAQU_B.Ancho||
                                       --                     ' contra el Material '||rMaterial_B1.Tip_Arti||'-'||rMaterial_B1.Cod_Arti||'-'||rMaterial_B1.Lote||' Ancho: '||rMaterial_B1.ANCHO);
                                    END IF;
                                    --
                                    P_MATERIAL(rMaterial_B1,'U',
                                               NULL,--nCantProd
                                               NULL,--nCantCons_E
                                               NULL,--nCantCons
                                               NULL,--nCantAjus
                                               NULL,--nAncho
                                               NULL,--nFACTOR_CONVERSION_M2_KG
                                               NULL,--nPrecio_ML_E
                                               NULL,--vLog_Precio
                                               NULL,--nMermEnhe_E
                                               NULL,--nMermEnhe
                                               NULL,--nMermAjus_E
                                               NULL,--nMermAjus
                                               NULL,--nMermCabo_E
                                               NULL,--nMermCabo
                                               NULL,--nMermPico_E
                                               NULL,--nMermPico
                                               (NVL(nMermaSuma,0) * nFactor),--nMermTita
                                               NULL,--nMermSane
                                               NULL,--nCantCons_Bobinas
                                               --
                                                NULL, --nCONTFSMU_01 
                                                NULL, --nCANTFSMU_01 
                                                NULL, --nCATOFSMU 
                                                NULL, --nCONTFSMU_02 
                                                NULL, --nCANTFSMU_02 
                                                NULL, --nCONTFSMU_03 
                                                NULL, --nCANTFSMU_03 
                                                NULL, --nCONTFSMU_04 
                                                NULL, --nCANTFSMU_04 
                                                NULL, --nCONTFSMU_05 
                                                NULL, --nCANTFSMU_05 
                                                NULL, --nCONTFSMU_06 
                                                NULL, --nCANTFSMU_06 
                                                NULL, --nCONTFSMU_07 
                                                NULL, --nCANTFSMU_07 
                                                NULL, --nCONTFSMU_08 
                                                NULL, --nCANTFSMU_08 
                                                NULL, --nCONTFSMU_09 
                                                NULL, --nCANTFSMU_09 
                                                NULL, --nCONTFSMU_10 
                                                NULL, --nCANTFSMU_10 
                                                NULL, --nANCHO_BUENO_TOTAL_01 
                                                NULL, --nANCHO_BUENO_OT_01 
                                                NULL, --nANCHO_BUENO_TOTAL_02 
                                                NULL, --nANCHO_BUENO_OT_02 
                                                NULL, --nANCHO_BUENO_TOTAL_03 
                                                NULL, --nANCHO_BUENO_OT_03 
                                                NULL, --nANCHO_BUENO_TOTAL_04 
                                                NULL, --nANCHO_BUENO_OT_04 
                                                NULL, --nANCHO_BUENO_TOTAL_05 
                                                NULL, --nANCHO_BUENO_OT_05 
                                                NULL, --nANCHO_BUENO_TOTAL_06 
                                                NULL, --nANCHO_BUENO_OT_06 
                                                NULL, --nANCHO_BUENO_TOTAL_07 
                                                NULL, --nANCHO_BUENO_OT_07 
                                                NULL, --nANCHO_BUENO_TOTAL_08 
                                                NULL, --nANCHO_BUENO_OT_08 
                                                NULL, --nANCHO_BUENO_TOTAL_09 
                                                NULL, --nANCHO_BUENO_OT_09 
                                                NULL, --nANCHO_BUENO_TOTAL_10 
                                                NULL, --nANCHO_BUENO_OT_10 
                                                NULL, --nANCHO_BUENO_TOTAL 
                                                NULL, --nANCHO_BUENO_OT 
                                                NULL, --nNUMECORT 
                                                NULL, --nMM_MERMPRCO_01 
                                                NULL, --nMM_MERMPLAN_EXESO_01 
                                                NULL, --nMM_MERMPLAN_01 
                                                NULL, --nMM_MERMPRCO_02 
                                                NULL, --nMM_MERMPLAN_EXESO_02 
                                                NULL, --nMM_MERMPLAN_02 
                                                NULL, --nMM_MERMPRCO_03 
                                                NULL, --nMM_MERMPLAN_EXESO_03 
                                                NULL, --nMM_MERMPLAN_03 
                                                NULL, --nMM_MERMPRCO_04 
                                                NULL, --nMM_MERMPLAN_EXESO_04 
                                                NULL, --nMM_MERMPLAN_04 
                                                NULL, --nMM_MERMPRCO_05 
                                                NULL, --nMM_MERMPLAN_EXESO_05 
                                                NULL, --nMM_MERMPLAN_05 
                                                NULL, --nMM_MERMPRCO_06 
                                                NULL, --nMM_MERMPLAN_EXESO_06 
                                                NULL, --nMM_MERMPLAN_06 
                                                NULL, --nMM_MERMPRCO_07 
                                                NULL, --nMM_MERMPLAN_EXESO_07 
                                                NULL, --nMM_MERMPLAN_07 
                                                NULL, --nMM_MERMPRCO_08 
                                                NULL, --nMM_MERMPLAN_EXESO_08 
                                                NULL, --nMM_MERMPLAN_08 
                                                NULL, --nMM_MERMPRCO_09 
                                                NULL, --nMM_MERMPLAN_EXESO_09 
                                                NULL, --nMM_MERMPLAN_09 
                                                NULL, --nMM_MERMPRCO_10 
                                                NULL, --nMM_MERMPLAN_EXESO_10 
                                                NULL, --nMM_MERMPLAN_10 
                                                NULL, --nMM_MERMPRCO 
                                                NULL, --nMM_MERMPLAN_EXESO 
                                                NULL); --nMM_MERMPLAN
                                    --t_MATERIAL(rMaterial_B1.IDENTIFICADOR).MermTira := NVL(rMaterial_B1.MERMTIRA,0) + (NVL(nMermaSuma,0) * nFactor);
                                 ELSE
                                    --647 No se encuentra @1. [Contador @2]
                                    P_ERRORES(vEmpresa, nNumeOtre, '647','2-Calculo de Anchos de Material y Bobina: El Ancho en la Bobina Contador: '||rBOBIMAQU_B.Contador||' ContBobi: '||rBOBIMAQU_B.ContBobi||' Articulo: '||rBOBIMAQU_B.Tip_Arti||'-'||rBOBIMAQU_B.Cod_Arti||' Lote: '||rBOBIMAQU_B.Lote||' Ancho Bueno: '||rBOBIMAQU_B.ANCHO_BUENO||' es mayor al Ancho en el Material '||rMaterial_B1.Tip_Arti||'-'||rMaterial_B1.Cod_Arti||' Lote: '||rMaterial_B1.Lote||' Ancho Bueno Total: '||rMaterial_B1.ANCHO_BUENO_TOTAL||'|27','R','E');
                                    --dbms_output.put_line('Error: El Ancho en la Bobina '||rBOBIMAQU_B.Empresa||'-'||rBOBIMAQU_B.NumeOtre||'-'||rBOBIMAQU_B.Contador||'-'||rBOBIMAQU_B.ContBobi||'-'||rBOBIMAQU_B.Tip_Arti||'-'||rBOBIMAQU_B.Cod_Arti||'-'||rBOBIMAQU_B.Lote||' Ancho: '||rBOBIMAQU_B.Ancho||
                                    --                     ' es mayor al Ancho en el Material '||rMaterial_B1.Tip_Arti||'-'||rMaterial_B1.Cod_Arti||'-'||rMaterial_B1.Lote||' Ancho: '||rMaterial_B1.ANCHO);
                                 END IF;
                              ELSE
                                 --Error
                                 IF rMaterial_B1.ANCHO_BUENO_TOTAL IS NULL THEN
                                    --647 No se encuentra @1. [Contador @2]
                                    P_ERRORES(vEmpresa, nNumeOtre, '647','el Ancho Bueno Total en el Material Contador: '||rMaterial_B1.Contador||' Articulo: '||rMaterial_B1.Tip_Arti||'-'||rMaterial_B1.Cod_Arti||' Lote: '||rMaterial_B1.Lote||'|28','R','E');
                                    --dbms_output.put_line('Error: No se encuentra el Ancho en el Material '||rMaterial_B1.Empresa||'-'||rMaterial_B1.NumeOtre||'-'||rMaterial_B1.Contador||'-'||rMaterial_B1.Tip_Arti||'-'||rMaterial_B1.Cod_Arti||'-'||rMaterial_B1.Lote);
                                 ELSIF rBOBIMAQU_B.ANCHO_BUENO IS NULL THEN
                                    --647 No se encuentra @1. [Contador @2]
                                    P_ERRORES(vEmpresa, nNumeOtre, '647','el Ancho en la Bobina Contador: '||rBOBIMAQU_B.Contador||' ContBobi: '||rBOBIMAQU_B.ContBobi||' Articulo: '||rBOBIMAQU_B.Tip_Arti||'-'||rBOBIMAQU_B.Cod_Arti||' Lote: '||rBOBIMAQU_B.Lote||'|29','R','E');
                                    --dbms_output.put_line('Error: No se encuentra el Ancho en la Bobina '||rBOBIMAQU_B.Empresa||'-'||rBOBIMAQU_B.NumeOtre||'-'||rBOBIMAQU_B.Contador||'-'||rBOBIMAQU_B.ContBobi||'-'||rBOBIMAQU_B.Tip_Arti||'-'||rBOBIMAQU_B.Cod_Arti||'-'||rBOBIMAQU_B.Lote);
                                 END IF;
                              END IF;
                           END IF;
                        END IF;
                     ELSE
                        IF NVL(nMermaSuma,0) > 0 THEN
                           IF rMateBobi.CoboBobi > 0 THEN --Se trata de una Bobina Generada
                              rMaterial_B2 := F_MATERIAL(rBOBIMAQU_B.EMPRESA, rBOBIMAQU_B.NUMEOTRE, rBOBIMAQU_B.CONTADOR, 
                                                         rMateBobi.TIP_ARTI, rMateBobi.COD_ARTI, '|EMPRBOBI:'||rMateBobi.EmprBobi||'|NUOTBOBI:'||rMateBobi.NuotBobi||'|CONTBOBI:'||rMateBobi.ContBobi||'|COBOBOBI:'||rMateBobi.CoboBobi||'|LOTE:'||rMateBobi.Lote,
                                                         NULL, NULL);
                           ELSE --Es un material de Almacen
                              rMaterial_B2 := F_MATERIAL(rBOBIMAQU_B.EMPRESA, rBOBIMAQU_B.NUMEOTRE, rBOBIMAQU_B.CONTADOR, 
                                                         rMateBobi.TIP_ARTI, rMateBobi.COD_ARTI, '|EMPRBOBI:'||rMateBobi.EmprBobi||'|NUOTBOBI:'||rMateBobi.NuotBobi||'|LOTE:'||rMateBobi.Lote||
																		   '|COBOMATE:'||rMateBobi.ContBobi||'|BOBIMATE:'||rMateBobi.CoboBobi, -- 11-11-2016 Solo para materiales tipo M
                                                         NULL, NULL);
                           END IF;
                           --
                           IF rMaterial_B2.IDENTIFICADOR IS NOT NULL THEN
                              --Se confronta el Ancho de la Bobina contra el Ancho del Material
                              /*NOTA POR ADICION DE ANCHO BUENO TOTAL
                                - SI EL ANCHO DEL MATERIAL ES MAYOR O IGUAL QUE EL DE LA BOBINA Y (NO ES BOBINA DE PRE-CORTE O ES DE PRE-CORTE Y ES DE UN SOLO CORTE)
                                - SI EL ANCHO DEL MATERIAL ES MAYIR AL DE LA BOBUNA SE TRATARA CON EL FACTOR DE EQUIVALENCIA EN ML TOMADO DE LA RELACION DE ML->M2 DE LA BOBINA CONTRA LOS ML->M2 DEL MATERIAL (PERO USANDO EL ANCHO_BUENO_TOTAL DEL MATERIAL)
                              */
                              IF rMaterial_B2.ANCHO_BUENO_TOTAL IS NOT NULL AND rBOBIMAQU_B.ANCHO_BUENO IS NOT NULL THEN
                                 IF rMaterial_B2.ANCHO_BUENO_TOTAL >= rBOBIMAQU_B.ANCHO_BUENO AND (rBOBIMAQU_B.TIP_ARTI != vTiarCosc OR (rBOBIMAQU_B.TIP_ARTI = vTiarCosc AND rBOBIMAQU_B.NUMERO_BOBINAS_CORTE = 1)) THEN--Se imputa todo el ancho si es cualquier bobina diferente de un Corte de Precorte o si es Bobina de Pre-Corte pero el Pre-Corte solo tiene un Corte
                                    --Actualizaci¿e Mermas
                                    P_MATERIAL(rMaterial_B2,'U',
                                               NULL,--nCantProd
                                               NULL,--nCantCons_E
                                               NULL,--nCantCons
                                               NULL,--nCantAjus
                                               NULL,--nAncho
                                               NULL,--nFACTOR_CONVERSION_M2_KG
                                               NULL,--nPrecio_ML_E
                                               NULL,--vLog_Precio
                                               NULL,--nMermEnhe_E
                                               NULL,--nMermEnhe
                                               NULL,--nMermAjus_E
                                               NULL,--nMermAjus
                                               NULL,--nMermCabo_E
                                               NULL,--nMermCabo
                                               NULL,--nMermPico_E
                                               NULL,--nMermPico
                                               NVL(nMermaSuma,0),--nMermTita
                                               NULL,--nMermSane
                                               NULL,--nCantCons_Bobinas
                                               --
                                                NULL, --nCONTFSMU_01 
                                                NULL, --nCANTFSMU_01 
                                                NULL, --nCATOFSMU 
                                                NULL, --nCONTFSMU_02 
                                                NULL, --nCANTFSMU_02 
                                                NULL, --nCONTFSMU_03 
                                                NULL, --nCANTFSMU_03 
                                                NULL, --nCONTFSMU_04 
                                                NULL, --nCANTFSMU_04 
                                                NULL, --nCONTFSMU_05 
                                                NULL, --nCANTFSMU_05 
                                                NULL, --nCONTFSMU_06 
                                                NULL, --nCANTFSMU_06 
                                                NULL, --nCONTFSMU_07 
                                                NULL, --nCANTFSMU_07 
                                                NULL, --nCONTFSMU_08 
                                                NULL, --nCANTFSMU_08 
                                                NULL, --nCONTFSMU_09 
                                                NULL, --nCANTFSMU_09 
                                                NULL, --nCONTFSMU_10 
                                                NULL, --nCANTFSMU_10 
                                                NULL, --nANCHO_BUENO_TOTAL_01 
                                                NULL, --nANCHO_BUENO_OT_01 
                                                NULL, --nANCHO_BUENO_TOTAL_02 
                                                NULL, --nANCHO_BUENO_OT_02 
                                                NULL, --nANCHO_BUENO_TOTAL_03 
                                                NULL, --nANCHO_BUENO_OT_03 
                                                NULL, --nANCHO_BUENO_TOTAL_04 
                                                NULL, --nANCHO_BUENO_OT_04 
                                                NULL, --nANCHO_BUENO_TOTAL_05 
                                                NULL, --nANCHO_BUENO_OT_05 
                                                NULL, --nANCHO_BUENO_TOTAL_06 
                                                NULL, --nANCHO_BUENO_OT_06 
                                                NULL, --nANCHO_BUENO_TOTAL_07 
                                                NULL, --nANCHO_BUENO_OT_07 
                                                NULL, --nANCHO_BUENO_TOTAL_08 
                                                NULL, --nANCHO_BUENO_OT_08 
                                                NULL, --nANCHO_BUENO_TOTAL_09 
                                                NULL, --nANCHO_BUENO_OT_09 
                                                NULL, --nANCHO_BUENO_TOTAL_10 
                                                NULL, --nANCHO_BUENO_OT_10 
                                                NULL, --nANCHO_BUENO_TOTAL 
                                                NULL, --nANCHO_BUENO_OT 
                                                NULL, --nNUMECORT 
                                                NULL, --nMM_MERMPRCO_01 
                                                NULL, --nMM_MERMPLAN_EXESO_01 
                                                NULL, --nMM_MERMPLAN_01 
                                                NULL, --nMM_MERMPRCO_02 
                                                NULL, --nMM_MERMPLAN_EXESO_02 
                                                NULL, --nMM_MERMPLAN_02 
                                                NULL, --nMM_MERMPRCO_03 
                                                NULL, --nMM_MERMPLAN_EXESO_03 
                                                NULL, --nMM_MERMPLAN_03 
                                                NULL, --nMM_MERMPRCO_04 
                                                NULL, --nMM_MERMPLAN_EXESO_04 
                                                NULL, --nMM_MERMPLAN_04 
                                                NULL, --nMM_MERMPRCO_05 
                                                NULL, --nMM_MERMPLAN_EXESO_05 
                                                NULL, --nMM_MERMPLAN_05 
                                                NULL, --nMM_MERMPRCO_06 
                                                NULL, --nMM_MERMPLAN_EXESO_06 
                                                NULL, --nMM_MERMPLAN_06 
                                                NULL, --nMM_MERMPRCO_07 
                                                NULL, --nMM_MERMPLAN_EXESO_07 
                                                NULL, --nMM_MERMPLAN_07 
                                                NULL, --nMM_MERMPRCO_08 
                                                NULL, --nMM_MERMPLAN_EXESO_08 
                                                NULL, --nMM_MERMPLAN_08 
                                                NULL, --nMM_MERMPRCO_09 
                                                NULL, --nMM_MERMPLAN_EXESO_09 
                                                NULL, --nMM_MERMPLAN_09 
                                                NULL, --nMM_MERMPRCO_10 
                                                NULL, --nMM_MERMPLAN_EXESO_10 
                                                NULL, --nMM_MERMPLAN_10 
                                                NULL, --nMM_MERMPRCO 
                                                NULL, --nMM_MERMPLAN_EXESO 
                                                NULL); --nMM_MERMPLAN
                                    --t_MATERIAL(rMaterial_B2.IDENTIFICADOR).MermTira := NVL(rMaterial_B2.MERMTIRA,0) + NVL(nMermaSuma,0);
                                 ELSIF rMaterial_B2.ANCHO_BUENO_TOTAL > rBOBIMAQU_B.ANCHO_BUENO THEN
                                    nFactor := (NVL(rBOBIMAQU_B.ANCHO_BUENO,0) / 1000);--Convierte a M2 de Bobina
                                    --
                                    IF (NVL(rMaterial_B2.ANCHO_BUENO_TOTAL,0) / 1000) > 0 THEN
                                       nFactor := nFactor  / (NVL(rMaterial_B2.ANCHO_BUENO_TOTAL,0) / 1000);--Convierte los M2 de Bobina a ML de Material
                                    ELSE
                                       nFactor := 0;
                                       --647 No se encuentra @1. [Contador @2]
                                       P_ERRORES(vEmpresa, nNumeOtre, '647','Factor de Conversion por Error en el Calculo en la Bobina Contador: '||rBOBIMAQU_B.Contador||' ContBobi: '||rBOBIMAQU_B.ContBobi||' Articulo: '||rBOBIMAQU_B.Tip_Arti||'-'||rBOBIMAQU_B.Cod_Arti||' Lote: '||rBOBIMAQU_B.Lote||' Ancho Bueno: '||rBOBIMAQU_B.ANCHO_BUENO||' contra el Material '||rMaterial_B2.Tip_Arti||'-'||rMaterial_B2.Cod_Arti||' Lote: '||rMaterial_B2.Lote||' Ancho Bueno Total: '||rMaterial_B2.ANCHO_BUENO_TOTAL||'|30','R','E');
                                       --dbms_output.put_line('Error: Calculo de Factor de Conversion de la Bobina '||rBOBIMAQU_B.Empresa||'-'||rBOBIMAQU_B.NumeOtre||'-'||rBOBIMAQU_B.Contador||'-'||rBOBIMAQU_B.ContBobi||'-'||rBOBIMAQU_B.Tip_Arti||'-'||rBOBIMAQU_B.Cod_Arti||'-'||rBOBIMAQU_B.Lote||' Ancho: '||rBOBIMAQU_B.Ancho||
                                       --                     ' contra el Material '||rMaterial_B2.Tip_Arti||'-'||rMaterial_B2.Cod_Arti||'-'||rMaterial_B2.Lote||' Ancho: '||rMaterial_B2.ANCHO);
                                    END IF;
                                    --
                                    P_MATERIAL(rMaterial_B2,'U',
                                               NULL,--nCantProd
                                               NULL,--nCantCons_E
                                               NULL,--nCantCons
                                               NULL,--nCantAjus
                                               NULL,--nAncho
                                               NULL,--nFACTOR_CONVERSION_M2_KG
                                               NULL,--nPrecio_ML_E
                                               NULL,--vLog_Precio
                                               NULL,--nMermEnhe_E
                                               NULL,--nMermEnhe
                                               NULL,--nMermAjus_E
                                               NULL,--nMermAjus
                                               NULL,--nMermCabo_E
                                               NULL,--nMermCabo
                                               NULL,--nMermPico_E
                                               NULL,--nMermPico
                                               (NVL(nMermaSuma,0) * nFactor),--nMermTita
                                               NULL,--nMermSane
                                               NULL,--nCantCons_Bobinas
                                               --
                                                NULL, --nCONTFSMU_01 
                                                NULL, --nCANTFSMU_01 
                                                NULL, --nCATOFSMU 
                                                NULL, --nCONTFSMU_02 
                                                NULL, --nCANTFSMU_02 
                                                NULL, --nCONTFSMU_03 
                                                NULL, --nCANTFSMU_03 
                                                NULL, --nCONTFSMU_04 
                                                NULL, --nCANTFSMU_04 
                                                NULL, --nCONTFSMU_05 
                                                NULL, --nCANTFSMU_05 
                                                NULL, --nCONTFSMU_06 
                                                NULL, --nCANTFSMU_06 
                                                NULL, --nCONTFSMU_07 
                                                NULL, --nCANTFSMU_07 
                                                NULL, --nCONTFSMU_08 
                                                NULL, --nCANTFSMU_08 
                                                NULL, --nCONTFSMU_09 
                                                NULL, --nCANTFSMU_09 
                                                NULL, --nCONTFSMU_10 
                                                NULL, --nCANTFSMU_10 
                                                NULL, --nANCHO_BUENO_TOTAL_01 
                                                NULL, --nANCHO_BUENO_OT_01 
                                                NULL, --nANCHO_BUENO_TOTAL_02 
                                                NULL, --nANCHO_BUENO_OT_02 
                                                NULL, --nANCHO_BUENO_TOTAL_03 
                                                NULL, --nANCHO_BUENO_OT_03 
                                                NULL, --nANCHO_BUENO_TOTAL_04 
                                                NULL, --nANCHO_BUENO_OT_04 
                                                NULL, --nANCHO_BUENO_TOTAL_05 
                                                NULL, --nANCHO_BUENO_OT_05 
                                                NULL, --nANCHO_BUENO_TOTAL_06 
                                                NULL, --nANCHO_BUENO_OT_06 
                                                NULL, --nANCHO_BUENO_TOTAL_07 
                                                NULL, --nANCHO_BUENO_OT_07 
                                                NULL, --nANCHO_BUENO_TOTAL_08 
                                                NULL, --nANCHO_BUENO_OT_08 
                                                NULL, --nANCHO_BUENO_TOTAL_09 
                                                NULL, --nANCHO_BUENO_OT_09 
                                                NULL, --nANCHO_BUENO_TOTAL_10 
                                                NULL, --nANCHO_BUENO_OT_10 
                                                NULL, --nANCHO_BUENO_TOTAL 
                                                NULL, --nANCHO_BUENO_OT 
                                                NULL, --nNUMECORT 
                                                NULL, --nMM_MERMPRCO_01 
                                                NULL, --nMM_MERMPLAN_EXESO_01 
                                                NULL, --nMM_MERMPLAN_01 
                                                NULL, --nMM_MERMPRCO_02 
                                                NULL, --nMM_MERMPLAN_EXESO_02 
                                                NULL, --nMM_MERMPLAN_02 
                                                NULL, --nMM_MERMPRCO_03 
                                                NULL, --nMM_MERMPLAN_EXESO_03 
                                                NULL, --nMM_MERMPLAN_03 
                                                NULL, --nMM_MERMPRCO_04 
                                                NULL, --nMM_MERMPLAN_EXESO_04 
                                                NULL, --nMM_MERMPLAN_04 
                                                NULL, --nMM_MERMPRCO_05 
                                                NULL, --nMM_MERMPLAN_EXESO_05 
                                                NULL, --nMM_MERMPLAN_05 
                                                NULL, --nMM_MERMPRCO_06 
                                                NULL, --nMM_MERMPLAN_EXESO_06 
                                                NULL, --nMM_MERMPLAN_06 
                                                NULL, --nMM_MERMPRCO_07 
                                                NULL, --nMM_MERMPLAN_EXESO_07 
                                                NULL, --nMM_MERMPLAN_07 
                                                NULL, --nMM_MERMPRCO_08 
                                                NULL, --nMM_MERMPLAN_EXESO_08 
                                                NULL, --nMM_MERMPLAN_08 
                                                NULL, --nMM_MERMPRCO_09 
                                                NULL, --nMM_MERMPLAN_EXESO_09 
                                                NULL, --nMM_MERMPLAN_09 
                                                NULL, --nMM_MERMPRCO_10 
                                                NULL, --nMM_MERMPLAN_EXESO_10 
                                                NULL, --nMM_MERMPLAN_10 
                                                NULL, --nMM_MERMPRCO 
                                                NULL, --nMM_MERMPLAN_EXESO 
                                                NULL); --nMM_MERMPLAN
                                    --t_MATERIAL(rMaterial_B2.IDENTIFICADOR).MermTira := NVL(rMaterial_B2.MERMTIRA,0) + (NVL(nMermaSuma,0) * nFactor);
                                 ELSE
                                    --647 No se encuentra @1. [Contador @2]
                                    P_ERRORES(vEmpresa, nNumeOtre, '647','3-Calculo de Anchos de Material y Bobina: El Ancho en la Bobina Contador: '||rBOBIMAQU_B.Contador||' ContBobi: '||rBOBIMAQU_B.ContBobi||' Articulo: '||rBOBIMAQU_B.Tip_Arti||'-'||rBOBIMAQU_B.Cod_Arti||' Lote: '||rBOBIMAQU_B.Lote||' Ancho Bueno: '||rBOBIMAQU_B.ANCHO_BUENO||' es mayor al Ancho en el Material '||rMaterial_B2.Tip_Arti||'-'||rMaterial_B2.Cod_Arti||' Lote: '||rMaterial_B2.Lote||' Ancho Bueno Total: '||rMaterial_B2.ANCHO_BUENO_TOTAL||'|31','R','E');
                                    --dbms_output.put_line('Error: El Ancho en la Bobina '||rBOBIMAQU_B.Empresa||'-'||rBOBIMAQU_B.NumeOtre||'-'||rBOBIMAQU_B.Contador||'-'||rBOBIMAQU_B.ContBobi||'-'||rBOBIMAQU_B.Tip_Arti||'-'||rBOBIMAQU_B.Cod_Arti||'-'||rBOBIMAQU_B.Lote||' Ancho: '||rBOBIMAQU_B.Ancho||
                                    --                     ' es mayor al Ancho en el Material '||rMaterial_B2.Tip_Arti||'-'||rMaterial_B2.Cod_Arti||'-'||rMaterial_B2.Lote||' Ancho: '||rMaterial_B2.ANCHO);
                                 END IF;
                              ELSE
                                 --Error
                                 IF rMaterial_B2.ANCHO_BUENO_TOTAL IS NULL THEN
                                    --647 No se encuentra @1. [Contador @2]
                                    P_ERRORES(vEmpresa, nNumeOtre, '647','el Ancho Bueno Total en el Material Contador: '||rMaterial_B2.Contador||' Articulo: '||rMaterial_B2.Tip_Arti||'-'||rMaterial_B2.Cod_Arti||' Lote: '||rMaterial_B2.Lote||'|32','R','E');
                                    --dbms_output.put_line('Error: No se encuentra el Ancho en el Material '||rMaterial_B2.Empresa||'-'||rMaterial_B2.NumeOtre||'-'||rMaterial_B2.Contador||'-'||rMaterial_B2.Tip_Arti||'-'||rMaterial_B2.Cod_Arti||'-'||rMaterial_B2.Lote);
                                 ELSIF rBOBIMAQU_B.ANCHO_BUENO IS NULL THEN
                                    --647 No se encuentra @1. [Contador @2]
                                    P_ERRORES(vEmpresa, nNumeOtre, '647','el Ancho Bueno en la Bobina Contador: '||rBOBIMAQU_B.Contador||'-'||rBOBIMAQU_B.ContBobi||' Articulo: '||rBOBIMAQU_B.Tip_Arti||'-'||rBOBIMAQU_B.Cod_Arti||' Lote: '||rBOBIMAQU_B.Lote||'|33','R','E');
                                    --dbms_output.put_line('Error: No se encuentra el Ancho en la Bobina '||rBOBIMAQU_B.Empresa||'-'||rBOBIMAQU_B.NumeOtre||'-'||rBOBIMAQU_B.Contador||'-'||rBOBIMAQU_B.ContBobi||'-'||rBOBIMAQU_B.Tip_Arti||'-'||rBOBIMAQU_B.Cod_Arti||'-'||rBOBIMAQU_B.Lote);
                                 END IF;
                              END IF;
                           END IF;
                        END IF;
                     END IF;
                  END LOOP;
                  --Si quedo algo por Asignar, se asignara al primer material
                  IF nMermaAsignada < rMERMA.Merma THEN
                     --647 No se encuentra @1. [Contador @2]
                     P_ERRORES(vEmpresa, nNumeOtre, '647','Merma en Materiales donde asignar la Merma en Tirada se asignara al 1er Material Utilizado Contador: '||rBOBIMAQU_B.Contador||' ContBobi: '||rBOBIMAQU_B.ContBobi||' Articulo: '||rBOBIMAQU_B.Tip_Arti||'-'||rBOBIMAQU_B.Cod_Arti||' Lote: '||rBOBIMAQU_B.Lote||', Datos de la Merma DESDE: '||rMERMA.DESDE||' HASTA: '||rMERMA.HASTA||' MERMA: '||rMERMA.MERMA||'|34','R','A');
                     --dbms_output.put_line('Error: No se asigno la Merma de Tirada en los Materiales Utilizados para la Bobina '||rBOBIMAQU_B.Empresa||'-'||rBOBIMAQU_B.NumeOtre||'-'||rBOBIMAQU_B.Contador||'-'||rBOBIMAQU_B.ContBobi||'-'||rBOBIMAQU_B.Tip_Arti||'-'||rBOBIMAQU_B.Cod_Arti||'-'||rBOBIMAQU_B.Lote||', Datos de la Merma DESDE: '||rMERMA.DESDE||' HASTA: '||rMERMA.HASTA||' MERMA: '||rMERMA.MERMA||', Se Asignara al Primer Material Utilizado');
                     --
                     IF NVL(rBOBIMAQU_B.MERMTIRA,0) > 0 THEN
                        --Se busca el 1er Material Consumido en las Pasadas para asignarle valores 
                        rMaterial_B1 := F_MATERIAL(rBOBIMAQU_B.EMPRESA, rBOBIMAQU_B.NUMEOTRE, rBOBIMAQU_B.CONTADOR, 
                                                  NULL, NULL, NULL,
                                                  1, 1);
                        --
                        rMaterial_B2 := F_MATERIAL(rBOBIMAQU_B.EMPRESA, rBOBIMAQU_B.NUMEOTRE, rBOBIMAQU_B.CONTADOR, 
                                                  NULL, NULL, NULL,
                                                  2, 1);
                        --
                        IF rMaterial_B1.IDENTIFICADOR IS NOT NULL THEN
                           --Se confronta el Ancho de la Bobina contra el Ancho del Material
                           /*NOTA POR ADICION DE ANCHO BUENO TOTAL
                                - SI EL ANCHO DEL MATERIAL ES MAYOR O IGUAL QUE EL DE LA BOBINA Y (NO ES BOBINA DE PRE-CORTE O ES DE PRE-CORTE Y ES DE UN SOLO CORTE)
                                - SI EL ANCHO DEL MATERIAL ES MAYIR AL DE LA BOBUNA SE TRATARA CON EL FACTOR DE EQUIVALENCIA EN ML TOMADO DE LA RELACION DE ML->M2 DE LA BOBINA CONTRA LOS ML->M2 DEL MATERIAL (PERO USANDO EL ANCHO_BUENO_TOTAL DEL MATERIAL)
                           */
                           IF rMaterial_B1.ANCHO_BUENO_TOTAL IS NOT NULL AND rBOBIMAQU_B.ANCHO_BUENO IS NOT NULL THEN
                              IF rMaterial_B1.ANCHO_BUENO_TOTAL = rBOBIMAQU_B.ANCHO_BUENO THEN
                                 --Actualizaci¿e Mermas
                                 P_MATERIAL(rMaterial_B1,'U',
                                            NULL,--nCantProd
                                            NULL,--nCantCons_E
                                            NULL,--nCantCons
                                            NULL,--nCantAjus
                                            NULL,--nAncho
                                            NULL,--nFACTOR_CONVERSION_M2_KG
                                            NULL,--nPrecio_ML_E
                                            NULL,--vLog_Precio
                                            NULL,--nMermEnhe_E
                                            NULL,--nMermEnhe
                                            NULL,--nMermAjus_E
                                            NULL,--nMermAjus
                                            NULL,--nMermCabo_E
                                            NULL,--nMermCabo
                                            NULL,--nMermPico_E
                                            NULL,--nMermPico
                                            (NVL(rMERMA.Merma,0) - NVL(nMermaAsignada,0)),--nMermTita
                                            NULL,--nMermSane
                                            NULL,--nCantCons_Bobinas
                                            --
                                             NULL, --nCONTFSMU_01 
                                             NULL, --nCANTFSMU_01 
                                             NULL, --nCATOFSMU 
                                             NULL, --nCONTFSMU_02 
                                             NULL, --nCANTFSMU_02 
                                             NULL, --nCONTFSMU_03 
                                             NULL, --nCANTFSMU_03 
                                             NULL, --nCONTFSMU_04 
                                             NULL, --nCANTFSMU_04 
                                             NULL, --nCONTFSMU_05 
                                             NULL, --nCANTFSMU_05 
                                             NULL, --nCONTFSMU_06 
                                             NULL, --nCANTFSMU_06 
                                             NULL, --nCONTFSMU_07 
                                             NULL, --nCANTFSMU_07 
                                             NULL, --nCONTFSMU_08 
                                             NULL, --nCANTFSMU_08 
                                             NULL, --nCONTFSMU_09 
                                             NULL, --nCANTFSMU_09 
                                             NULL, --nCONTFSMU_10 
                                             NULL, --nCANTFSMU_10 
                                             NULL, --nANCHO_BUENO_TOTAL_01 
                                             NULL, --nANCHO_BUENO_OT_01 
                                             NULL, --nANCHO_BUENO_TOTAL_02 
                                             NULL, --nANCHO_BUENO_OT_02 
                                             NULL, --nANCHO_BUENO_TOTAL_03 
                                             NULL, --nANCHO_BUENO_OT_03 
                                             NULL, --nANCHO_BUENO_TOTAL_04 
                                             NULL, --nANCHO_BUENO_OT_04 
                                             NULL, --nANCHO_BUENO_TOTAL_05 
                                             NULL, --nANCHO_BUENO_OT_05 
                                             NULL, --nANCHO_BUENO_TOTAL_06 
                                             NULL, --nANCHO_BUENO_OT_06 
                                             NULL, --nANCHO_BUENO_TOTAL_07 
                                             NULL, --nANCHO_BUENO_OT_07 
                                             NULL, --nANCHO_BUENO_TOTAL_08 
                                             NULL, --nANCHO_BUENO_OT_08 
                                             NULL, --nANCHO_BUENO_TOTAL_09 
                                             NULL, --nANCHO_BUENO_OT_09 
                                             NULL, --nANCHO_BUENO_TOTAL_10 
                                             NULL, --nANCHO_BUENO_OT_10 
                                             NULL, --nANCHO_BUENO_TOTAL 
                                             NULL, --nANCHO_BUENO_OT 
                                             NULL, --nNUMECORT 
                                             NULL, --nMM_MERMPRCO_01 
                                             NULL, --nMM_MERMPLAN_EXESO_01 
                                             NULL, --nMM_MERMPLAN_01 
                                             NULL, --nMM_MERMPRCO_02 
                                             NULL, --nMM_MERMPLAN_EXESO_02 
                                             NULL, --nMM_MERMPLAN_02 
                                             NULL, --nMM_MERMPRCO_03 
                                             NULL, --nMM_MERMPLAN_EXESO_03 
                                             NULL, --nMM_MERMPLAN_03 
                                             NULL, --nMM_MERMPRCO_04 
                                             NULL, --nMM_MERMPLAN_EXESO_04 
                                             NULL, --nMM_MERMPLAN_04 
                                             NULL, --nMM_MERMPRCO_05 
                                             NULL, --nMM_MERMPLAN_EXESO_05 
                                             NULL, --nMM_MERMPLAN_05 
                                             NULL, --nMM_MERMPRCO_06 
                                             NULL, --nMM_MERMPLAN_EXESO_06 
                                             NULL, --nMM_MERMPLAN_06 
                                             NULL, --nMM_MERMPRCO_07 
                                             NULL, --nMM_MERMPLAN_EXESO_07 
                                             NULL, --nMM_MERMPLAN_07 
                                             NULL, --nMM_MERMPRCO_08 
                                             NULL, --nMM_MERMPLAN_EXESO_08 
                                             NULL, --nMM_MERMPLAN_08 
                                             NULL, --nMM_MERMPRCO_09 
                                             NULL, --nMM_MERMPLAN_EXESO_09 
                                             NULL, --nMM_MERMPLAN_09 
                                             NULL, --nMM_MERMPRCO_10 
                                             NULL, --nMM_MERMPLAN_EXESO_10 
                                             NULL, --nMM_MERMPLAN_10 
                                             NULL, --nMM_MERMPRCO 
                                             NULL, --nMM_MERMPLAN_EXESO 
                                             NULL); --nMM_MERMPLAN
                                 --t_MATERIAL(rMaterial_B1.IDENTIFICADOR).MermTira := NVL(rMaterial_B1.MERMTIRA,0) + (NVL(rMERMA.Merma,0) - NVL(nMermaAsignada,0));
                              ELSIF rMaterial_B1.ANCHO_BUENO_TOTAL > rBOBIMAQU_B.ANCHO_BUENO THEN
                                 nFactor := (NVL(rBOBIMAQU_B.ANCHO_BUENO,0) / 1000);--Convierte a M2 de Bobina
                                 --
                                 IF (NVL(rMaterial_B1.ANCHO_BUENO_TOTAL,0) / 1000) > 0 THEN
                                    nFactor := nFactor  / (NVL(rMaterial_B1.ANCHO_BUENO_TOTAL,0) / 1000);--Convierte los M2 de Bobina a ML de Material
                                 ELSE
                                    nFactor := 0;
                                    --606 No existe FC: @1. [Contador @2]
                                    P_ERRORES(vEmpresa, nNumeOtre, '606','Calculo de Factor de Conversion de la Bobina Contador: '||rBOBIMAQU_B.Contador||' ContBobi: '||rBOBIMAQU_B.ContBobi||' Articulo: '||rBOBIMAQU_B.Tip_Arti||'-'||rBOBIMAQU_B.Cod_Arti||' Lote: '||rBOBIMAQU_B.Lote||' Ancho Bueno: '||rBOBIMAQU_B.ANCHO_BUENO||' contra el Material '||rMaterial_B1.Tip_Arti||'-'||rMaterial_B1.Cod_Arti||' Lote: '||rMaterial_B1.Lote||' Ancho Bueno Total: '||rMaterial_B1.ANCHO_BUENO_TOTAL||'|35','R','E');
                                    --dbms_output.put_line('Error: Calculo de Factor de Conversion de la Bobina '||rBOBIMAQU_B.Empresa||'-'||rBOBIMAQU_B.NumeOtre||'-'||rBOBIMAQU_B.Contador||'-'||rBOBIMAQU_B.ContBobi||'-'||rBOBIMAQU_B.Tip_Arti||'-'||rBOBIMAQU_B.Cod_Arti||'-'||rBOBIMAQU_B.Lote||' Ancho: '||rBOBIMAQU_B.Ancho||
                                    --                     ' contra el Material '||rMaterial_B1.Tip_Arti||'-'||rMaterial_B1.Cod_Arti||'-'||rMaterial_B1.Lote||' Ancho: '||rMaterial_B1.ANCHO);
                                 END IF;
                                 --
                                 P_MATERIAL(rMaterial_B1,'U',
                                            NULL,--nCantProd
                                            NULL,--nCantCons_E
                                            NULL,--nCantCons
                                            NULL,--nCantAjus
                                            NULL,--nAncho
                                            NULL,--nFACTOR_CONVERSION_M2_KG
                                            NULL,--nPrecio_ML_E
                                            NULL,--vLog_Precio
                                            NULL,--nMermEnhe_E
                                            NULL,--nMermEnhe
                                            NULL,--nMermAjus_E
                                            NULL,--nMermAjus
                                            NULL,--nMermCabo_E
                                            NULL,--nMermCabo
                                            NULL,--nMermPico_E
                                            NULL,--nMermPico
                                            ((NVL(rMERMA.Merma,0) - NVL(nMermaAsignada,0)) * nFactor),--nMermTita
                                            NULL,--nMermSane
                                            NULL,--nCantCons_Bobinas
                                            --
                                             NULL, --nCONTFSMU_01 
                                             NULL, --nCANTFSMU_01 
                                             NULL, --nCATOFSMU 
                                             NULL, --nCONTFSMU_02 
                                             NULL, --nCANTFSMU_02 
                                             NULL, --nCONTFSMU_03 
                                             NULL, --nCANTFSMU_03 
                                             NULL, --nCONTFSMU_04 
                                             NULL, --nCANTFSMU_04 
                                             NULL, --nCONTFSMU_05 
                                             NULL, --nCANTFSMU_05 
                                             NULL, --nCONTFSMU_06 
                                             NULL, --nCANTFSMU_06 
                                             NULL, --nCONTFSMU_07 
                                             NULL, --nCANTFSMU_07 
                                             NULL, --nCONTFSMU_08 
                                             NULL, --nCANTFSMU_08 
                                             NULL, --nCONTFSMU_09 
                                             NULL, --nCANTFSMU_09 
                                             NULL, --nCONTFSMU_10 
                                             NULL, --nCANTFSMU_10 
                                             NULL, --nANCHO_BUENO_TOTAL_01 
                                             NULL, --nANCHO_BUENO_OT_01 
                                             NULL, --nANCHO_BUENO_TOTAL_02 
                                             NULL, --nANCHO_BUENO_OT_02 
                                             NULL, --nANCHO_BUENO_TOTAL_03 
                                             NULL, --nANCHO_BUENO_OT_03 
                                             NULL, --nANCHO_BUENO_TOTAL_04 
                                             NULL, --nANCHO_BUENO_OT_04 
                                             NULL, --nANCHO_BUENO_TOTAL_05 
                                             NULL, --nANCHO_BUENO_OT_05 
                                             NULL, --nANCHO_BUENO_TOTAL_06 
                                             NULL, --nANCHO_BUENO_OT_06 
                                             NULL, --nANCHO_BUENO_TOTAL_07 
                                             NULL, --nANCHO_BUENO_OT_07 
                                             NULL, --nANCHO_BUENO_TOTAL_08 
                                             NULL, --nANCHO_BUENO_OT_08 
                                             NULL, --nANCHO_BUENO_TOTAL_09 
                                             NULL, --nANCHO_BUENO_OT_09 
                                             NULL, --nANCHO_BUENO_TOTAL_10 
                                             NULL, --nANCHO_BUENO_OT_10 
                                             NULL, --nANCHO_BUENO_TOTAL 
                                             NULL, --nANCHO_BUENO_OT 
                                             NULL, --nNUMECORT 
                                             NULL, --nMM_MERMPRCO_01 
                                             NULL, --nMM_MERMPLAN_EXESO_01 
                                             NULL, --nMM_MERMPLAN_01 
                                             NULL, --nMM_MERMPRCO_02 
                                             NULL, --nMM_MERMPLAN_EXESO_02 
                                             NULL, --nMM_MERMPLAN_02 
                                             NULL, --nMM_MERMPRCO_03 
                                             NULL, --nMM_MERMPLAN_EXESO_03 
                                             NULL, --nMM_MERMPLAN_03 
                                             NULL, --nMM_MERMPRCO_04 
                                             NULL, --nMM_MERMPLAN_EXESO_04 
                                             NULL, --nMM_MERMPLAN_04 
                                             NULL, --nMM_MERMPRCO_05 
                                             NULL, --nMM_MERMPLAN_EXESO_05 
                                             NULL, --nMM_MERMPLAN_05 
                                             NULL, --nMM_MERMPRCO_06 
                                             NULL, --nMM_MERMPLAN_EXESO_06 
                                             NULL, --nMM_MERMPLAN_06 
                                             NULL, --nMM_MERMPRCO_07 
                                             NULL, --nMM_MERMPLAN_EXESO_07 
                                             NULL, --nMM_MERMPLAN_07 
                                             NULL, --nMM_MERMPRCO_08 
                                             NULL, --nMM_MERMPLAN_EXESO_08 
                                             NULL, --nMM_MERMPLAN_08 
                                             NULL, --nMM_MERMPRCO_09 
                                             NULL, --nMM_MERMPLAN_EXESO_09 
                                             NULL, --nMM_MERMPLAN_09 
                                             NULL, --nMM_MERMPRCO_10 
                                             NULL, --nMM_MERMPLAN_EXESO_10 
                                             NULL, --nMM_MERMPLAN_10 
                                             NULL, --nMM_MERMPRCO 
                                             NULL, --nMM_MERMPLAN_EXESO 
                                             NULL); --nMM_MERMPLAN
                                 --t_MATERIAL(rMaterial_B1.IDENTIFICADOR).MermTira := NVL(rMaterial_B1.MERMTIRA,0) + ((NVL(rMERMA.Merma,0) - NVL(nMermaAsignada,0)) * nFactor);
                              ELSE
                                 --647 No se encuentra @1. [Contador @2]
                                 P_ERRORES(vEmpresa, nNumeOtre, '647','4-Calculo de Anchos de Material y Bobina: El Ancho en la Bobina Contador: '||rBOBIMAQU_B.Contador||' ContBobi: '||rBOBIMAQU_B.ContBobi||' Articulo: '||rBOBIMAQU_B.Tip_Arti||'-'||rBOBIMAQU_B.Cod_Arti||' Lote: '||rBOBIMAQU_B.Lote||' Ancho Bueno: '||rBOBIMAQU_B.ANCHO_BUENO||' es mayor al Ancho en el Material '||rMaterial_B1.Tip_Arti||'-'||rMaterial_B1.Cod_Arti||' Lote: '||rMaterial_B1.Lote||' Ancho Bueno Total: '||rMaterial_B1.ANCHO_BUENO_TOTAL||'|36','R','E');
                                 --dbms_output.put_line('Error: El Ancho en la Bobina '||rBOBIMAQU_B.Empresa||'-'||rBOBIMAQU_B.NumeOtre||'-'||rBOBIMAQU_B.Contador||'-'||rBOBIMAQU_B.ContBobi||'-'||rBOBIMAQU_B.Tip_Arti||'-'||rBOBIMAQU_B.Cod_Arti||'-'||rBOBIMAQU_B.Lote||' Ancho: '||rBOBIMAQU_B.Ancho||
                                 --                     ' es mayor al Ancho en el Material '||rMaterial_B1.Tip_Arti||'-'||rMaterial_B1.Cod_Arti||'-'||rMaterial_B1.Lote||' Ancho: '||rMaterial_B1.ANCHO);
                              END IF;
                           ELSE
                              --Error
                              IF rMaterial_B1.ANCHO_BUENO_TOTAL IS NULL THEN
                                 --647 No se encuentra @1. [Contador @2]
                                 P_ERRORES(vEmpresa, nNumeOtre, '647','el Ancho Bueno Total en el Material Contador: '||rMaterial_B1.Contador||' Articulo: '||rMaterial_B1.Tip_Arti||'-'||rMaterial_B1.Cod_Arti||' Lote: '||rMaterial_B1.Lote||'|37','R','E');
                                 --dbms_output.put_line('Error: No se encuentra el Ancho en el Material '||rMaterial_B1.Empresa||'-'||rMaterial_B1.NumeOtre||'-'||rMaterial_B1.Contador||'-'||rMaterial_B1.Tip_Arti||'-'||rMaterial_B1.Cod_Arti||'-'||rMaterial_B1.Lote);
                              ELSIF rBOBIMAQU_B.ANCHO_BUENO IS NULL THEN
                                 --647 No se encuentra @1. [Contador @2]
                                 P_ERRORES(vEmpresa, nNumeOtre, '647','el Ancho Bueno en la Bobina Contador: '||rBOBIMAQU_B.Contador||'-'||rBOBIMAQU_B.ContBobi||' Articulo: '||rBOBIMAQU_B.Tip_Arti||'-'||rBOBIMAQU_B.Cod_Arti||' Lote: '||rBOBIMAQU_B.Lote||'|38','R','E');
                                 --dbms_output.put_line('Error: No se encuentra el Ancho en la Bobina '||rBOBIMAQU_B.Empresa||'-'||rBOBIMAQU_B.NumeOtre||'-'||rBOBIMAQU_B.Contador||'-'||rBOBIMAQU_B.ContBobi||'-'||rBOBIMAQU_B.Tip_Arti||'-'||rBOBIMAQU_B.Cod_Arti||'-'||rBOBIMAQU_B.Lote);
                              END IF;
                           END IF;
                        END IF;
                        --
                        IF rMaterial_B2.IDENTIFICADOR IS NOT NULL THEN
                           --Se confronta el Ancho de la Bobina contra el Ancho del Material
                           /*NOTA POR ADICION DE ANCHO BUENO TOTAL
                                - SI EL ANCHO DEL MATERIAL ES MAYOR O IGUAL QUE EL DE LA BOBINA Y (NO ES BOBINA DE PRE-CORTE O ES DE PRE-CORTE Y ES DE UN SOLO CORTE)
                                - SI EL ANCHO DEL MATERIAL ES MAYIR AL DE LA BOBUNA SE TRATARA CON EL FACTOR DE EQUIVALENCIA EN ML TOMADO DE LA RELACION DE ML->M2 DE LA BOBINA CONTRA LOS ML->M2 DEL MATERIAL (PERO USANDO EL ANCHO_BUENO_TOTAL DEL MATERIAL)
                           */
                           IF rMaterial_B2.ANCHO_BUENO_TOTAL IS NOT NULL AND rBOBIMAQU_B.ANCHO_BUENO IS NOT NULL THEN
                              IF rMaterial_B2.ANCHO_BUENO_TOTAL = rBOBIMAQU_B.ANCHO_BUENO THEN
                                 --Actualizaci¿e Mermas
                                 P_MATERIAL(rMaterial_B2,'U',
                                            NULL,--nCantProd
                                            NULL,--nCantCons_E
                                            NULL,--nCantCons
                                            NULL,--nCantAjus
                                            NULL,--nAncho
                                            NULL,--nFACTOR_CONVERSION_M2_KG
                                            NULL,--nPrecio_ML_E
                                            NULL,--vLog_Precio
                                            NULL,--nMermEnhe_E
                                            NULL,--nMermEnhe
                                            NULL,--nMermAjus_E
                                            NULL,--nMermAjus
                                            NULL,--nMermCabo_E
                                            NULL,--nMermCabo
                                            NULL,--nMermPico_E
                                            NULL,--nMermPico
                                            (NVL(rMERMA.Merma,0) - NVL(nMermaAsignada,0)),--nMermTita
                                            NULL,--nMermSane
                                            NULL,--nCantCons_Bobinas
                                            --
                                             NULL, --nCONTFSMU_01 
                                             NULL, --nCANTFSMU_01 
                                             NULL, --nCATOFSMU 
                                             NULL, --nCONTFSMU_02 
                                             NULL, --nCANTFSMU_02 
                                             NULL, --nCONTFSMU_03 
                                             NULL, --nCANTFSMU_03 
                                             NULL, --nCONTFSMU_04 
                                             NULL, --nCANTFSMU_04 
                                             NULL, --nCONTFSMU_05 
                                             NULL, --nCANTFSMU_05 
                                             NULL, --nCONTFSMU_06 
                                             NULL, --nCANTFSMU_06 
                                             NULL, --nCONTFSMU_07 
                                             NULL, --nCANTFSMU_07 
                                             NULL, --nCONTFSMU_08 
                                             NULL, --nCANTFSMU_08 
                                             NULL, --nCONTFSMU_09 
                                             NULL, --nCANTFSMU_09 
                                             NULL, --nCONTFSMU_10 
                                             NULL, --nCANTFSMU_10 
                                             NULL, --nANCHO_BUENO_TOTAL_01 
                                             NULL, --nANCHO_BUENO_OT_01 
                                             NULL, --nANCHO_BUENO_TOTAL_02 
                                             NULL, --nANCHO_BUENO_OT_02 
                                             NULL, --nANCHO_BUENO_TOTAL_03 
                                             NULL, --nANCHO_BUENO_OT_03 
                                             NULL, --nANCHO_BUENO_TOTAL_04 
                                             NULL, --nANCHO_BUENO_OT_04 
                                             NULL, --nANCHO_BUENO_TOTAL_05 
                                             NULL, --nANCHO_BUENO_OT_05 
                                             NULL, --nANCHO_BUENO_TOTAL_06 
                                             NULL, --nANCHO_BUENO_OT_06 
                                             NULL, --nANCHO_BUENO_TOTAL_07 
                                             NULL, --nANCHO_BUENO_OT_07 
                                             NULL, --nANCHO_BUENO_TOTAL_08 
                                             NULL, --nANCHO_BUENO_OT_08 
                                             NULL, --nANCHO_BUENO_TOTAL_09 
                                             NULL, --nANCHO_BUENO_OT_09 
                                             NULL, --nANCHO_BUENO_TOTAL_10 
                                             NULL, --nANCHO_BUENO_OT_10 
                                             NULL, --nANCHO_BUENO_TOTAL 
                                             NULL, --nANCHO_BUENO_OT 
                                             NULL, --nNUMECORT 
                                             NULL, --nMM_MERMPRCO_01 
                                             NULL, --nMM_MERMPLAN_EXESO_01 
                                             NULL, --nMM_MERMPLAN_01 
                                             NULL, --nMM_MERMPRCO_02 
                                             NULL, --nMM_MERMPLAN_EXESO_02 
                                             NULL, --nMM_MERMPLAN_02 
                                             NULL, --nMM_MERMPRCO_03 
                                             NULL, --nMM_MERMPLAN_EXESO_03 
                                             NULL, --nMM_MERMPLAN_03 
                                             NULL, --nMM_MERMPRCO_04 
                                             NULL, --nMM_MERMPLAN_EXESO_04 
                                             NULL, --nMM_MERMPLAN_04 
                                             NULL, --nMM_MERMPRCO_05 
                                             NULL, --nMM_MERMPLAN_EXESO_05 
                                             NULL, --nMM_MERMPLAN_05 
                                             NULL, --nMM_MERMPRCO_06 
                                             NULL, --nMM_MERMPLAN_EXESO_06 
                                             NULL, --nMM_MERMPLAN_06 
                                             NULL, --nMM_MERMPRCO_07 
                                             NULL, --nMM_MERMPLAN_EXESO_07 
                                             NULL, --nMM_MERMPLAN_07 
                                             NULL, --nMM_MERMPRCO_08 
                                             NULL, --nMM_MERMPLAN_EXESO_08 
                                             NULL, --nMM_MERMPLAN_08 
                                             NULL, --nMM_MERMPRCO_09 
                                             NULL, --nMM_MERMPLAN_EXESO_09 
                                             NULL, --nMM_MERMPLAN_09 
                                             NULL, --nMM_MERMPRCO_10 
                                             NULL, --nMM_MERMPLAN_EXESO_10 
                                             NULL, --nMM_MERMPLAN_10 
                                             NULL, --nMM_MERMPRCO 
                                             NULL, --nMM_MERMPLAN_EXESO 
                                             NULL); --nMM_MERMPLAN
                                 --t_MATERIAL(rMaterial_B2.IDENTIFICADOR).MermTira := NVL(rMaterial_B2.MERMTIRA,0) + (NVL(rMERMA.Merma,0) - NVL(nMermaAsignada,0));
                              ELSIF rMaterial_B2.ANCHO_BUENO_TOTAL > rBOBIMAQU_B.ANCHO_BUENO THEN
                                 nFactor := (NVL(rBOBIMAQU_B.ANCHO_BUENO,0) / 1000);--Convierte a M2 de Bobina
                                 --
                                 IF (NVL(rMaterial_B2.ANCHO_BUENO_TOTAL,0) / 1000) > 0 THEN
                                    nFactor := nFactor  / (NVL(rMaterial_B2.ANCHO_BUENO_TOTAL,0) / 1000);--Convierte los M2 de Bobina a ML de Material
                                 ELSE
                                    nFactor := 0;
                                    --606 No existe FC: @1. [Contador @2]
                                    P_ERRORES(vEmpresa, nNumeOtre, '606','Calculo de Factor de Conversion de la Bobina Contador: '||rBOBIMAQU_B.Contador||' ContBobi: '||rBOBIMAQU_B.ContBobi||' Articulo: '||rBOBIMAQU_B.Tip_Arti||'-'||rBOBIMAQU_B.Cod_Arti||' Lote: '||rBOBIMAQU_B.Lote||' Ancho Bueno: '||rBOBIMAQU_B.ANCHO_BUENO||' contra el Material '||rMaterial_B2.Tip_Arti||'-'||rMaterial_B2.Cod_Arti||' Lote: '||rMaterial_B2.Lote||' Ancho Bueno Total: '||rMaterial_B2.ANCHO_BUENO_TOTAL||'|39','R','E');
                                    --dbms_output.put_line('Error: Calculo de Factor de Conversion de la Bobina '||rBOBIMAQU_B.Empresa||'-'||rBOBIMAQU_B.NumeOtre||'-'||rBOBIMAQU_B.Contador||'-'||rBOBIMAQU_B.ContBobi||'-'||rBOBIMAQU_B.Tip_Arti||'-'||rBOBIMAQU_B.Cod_Arti||'-'||rBOBIMAQU_B.Lote||' Ancho: '||rBOBIMAQU_B.Ancho||
                                    --                     ' contra el Material '||rMaterial_B2.Tip_Arti||'-'||rMaterial_B2.Cod_Arti||'-'||rMaterial_B2.Lote||' Ancho: '||rMaterial_B2.ANCHO);
                                 END IF;
                                 --
                                 P_MATERIAL(rMaterial_B2,'U',
                                            NULL,--nCantProd
                                            NULL,--nCantCons_E
                                            NULL,--nCantCons
                                            NULL,--nCantAjus
                                            NULL,--nAncho
                                            NULL,--nFACTOR_CONVERSION_M2_KG
                                            NULL,--nPrecio_ML_E
                                            NULL,--vLog_Precio
                                            NULL,--nMermEnhe_E
                                            NULL,--nMermEnhe
                                            NULL,--nMermAjus_E
                                            NULL,--nMermAjus
                                            NULL,--nMermCabo_E
                                            NULL,--nMermCabo
                                            NULL,--nMermPico_E
                                            NULL,--nMermPico
                                            ((NVL(rMERMA.Merma,0) - NVL(nMermaAsignada,0)) * nFactor),--nMermTita
                                            NULL,--nMermSane
                                            NULL,--nCantCons_Bobinas
                                            --
                                             NULL, --nCONTFSMU_01 
                                             NULL, --nCANTFSMU_01 
                                             NULL, --nCATOFSMU 
                                             NULL, --nCONTFSMU_02 
                                             NULL, --nCANTFSMU_02 
                                             NULL, --nCONTFSMU_03 
                                             NULL, --nCANTFSMU_03 
                                             NULL, --nCONTFSMU_04 
                                             NULL, --nCANTFSMU_04 
                                             NULL, --nCONTFSMU_05 
                                             NULL, --nCANTFSMU_05 
                                             NULL, --nCONTFSMU_06 
                                             NULL, --nCANTFSMU_06 
                                             NULL, --nCONTFSMU_07 
                                             NULL, --nCANTFSMU_07 
                                             NULL, --nCONTFSMU_08 
                                             NULL, --nCANTFSMU_08 
                                             NULL, --nCONTFSMU_09 
                                             NULL, --nCANTFSMU_09 
                                             NULL, --nCONTFSMU_10 
                                             NULL, --nCANTFSMU_10 
                                             NULL, --nANCHO_BUENO_TOTAL_01 
                                             NULL, --nANCHO_BUENO_OT_01 
                                             NULL, --nANCHO_BUENO_TOTAL_02 
                                             NULL, --nANCHO_BUENO_OT_02 
                                             NULL, --nANCHO_BUENO_TOTAL_03 
                                             NULL, --nANCHO_BUENO_OT_03 
                                             NULL, --nANCHO_BUENO_TOTAL_04 
                                             NULL, --nANCHO_BUENO_OT_04 
                                             NULL, --nANCHO_BUENO_TOTAL_05 
                                             NULL, --nANCHO_BUENO_OT_05 
                                             NULL, --nANCHO_BUENO_TOTAL_06 
                                             NULL, --nANCHO_BUENO_OT_06 
                                             NULL, --nANCHO_BUENO_TOTAL_07 
                                             NULL, --nANCHO_BUENO_OT_07 
                                             NULL, --nANCHO_BUENO_TOTAL_08 
                                             NULL, --nANCHO_BUENO_OT_08 
                                             NULL, --nANCHO_BUENO_TOTAL_09 
                                             NULL, --nANCHO_BUENO_OT_09 
                                             NULL, --nANCHO_BUENO_TOTAL_10 
                                             NULL, --nANCHO_BUENO_OT_10 
                                             NULL, --nANCHO_BUENO_TOTAL 
                                             NULL, --nANCHO_BUENO_OT 
                                             NULL, --nNUMECORT 
                                             NULL, --nMM_MERMPRCO_01 
                                             NULL, --nMM_MERMPLAN_EXESO_01 
                                             NULL, --nMM_MERMPLAN_01 
                                             NULL, --nMM_MERMPRCO_02 
                                             NULL, --nMM_MERMPLAN_EXESO_02 
                                             NULL, --nMM_MERMPLAN_02 
                                             NULL, --nMM_MERMPRCO_03 
                                             NULL, --nMM_MERMPLAN_EXESO_03 
                                             NULL, --nMM_MERMPLAN_03 
                                             NULL, --nMM_MERMPRCO_04 
                                             NULL, --nMM_MERMPLAN_EXESO_04 
                                             NULL, --nMM_MERMPLAN_04 
                                             NULL, --nMM_MERMPRCO_05 
                                             NULL, --nMM_MERMPLAN_EXESO_05 
                                             NULL, --nMM_MERMPLAN_05 
                                             NULL, --nMM_MERMPRCO_06 
                                             NULL, --nMM_MERMPLAN_EXESO_06 
                                             NULL, --nMM_MERMPLAN_06 
                                             NULL, --nMM_MERMPRCO_07 
                                             NULL, --nMM_MERMPLAN_EXESO_07 
                                             NULL, --nMM_MERMPLAN_07 
                                             NULL, --nMM_MERMPRCO_08 
                                             NULL, --nMM_MERMPLAN_EXESO_08 
                                             NULL, --nMM_MERMPLAN_08 
                                             NULL, --nMM_MERMPRCO_09 
                                             NULL, --nMM_MERMPLAN_EXESO_09 
                                             NULL, --nMM_MERMPLAN_09 
                                             NULL, --nMM_MERMPRCO_10 
                                             NULL, --nMM_MERMPLAN_EXESO_10 
                                             NULL, --nMM_MERMPLAN_10 
                                             NULL, --nMM_MERMPRCO 
                                             NULL, --nMM_MERMPLAN_EXESO 
                                             NULL); --nMM_MERMPLAN
                                 --t_MATERIAL(rMaterial_B2.IDENTIFICADOR).MermTira := NVL(rMaterial_B2.MERMTIRA,0) + ((NVL(rMERMA.Merma,0) - NVL(nMermaAsignada,0)) * nFactor);
                              ELSE
                                 --647 No se encuentra @1. [Contador @2]
                                 P_ERRORES(vEmpresa, nNumeOtre, '647','5-Calculo de Anchos de Material y Bobina: El Ancho en la Bobina Contador: '||rBOBIMAQU_B.Contador||' ContBobi: '||rBOBIMAQU_B.ContBobi||' Articulo: '||rBOBIMAQU_B.Tip_Arti||'-'||rBOBIMAQU_B.Cod_Arti||' Lote: '||rBOBIMAQU_B.Lote||' Ancho Bueno: '||rBOBIMAQU_B.ANCHO_BUENO||' es mayor al Ancho en el Material '||rMaterial_B2.Tip_Arti||'-'||rMaterial_B2.Cod_Arti||' Lote: '||rMaterial_B2.Lote||' Ancho Bueno Total: '||rMaterial_B2.ANCHO_BUENO_TOTAL||'|40','R','E');
                                 --dbms_output.put_line('Error: El Ancho en la Bobina '||rBOBIMAQU_B.Empresa||'-'||rBOBIMAQU_B.NumeOtre||'-'||rBOBIMAQU_B.Contador||'-'||rBOBIMAQU_B.ContBobi||'-'||rBOBIMAQU_B.Tip_Arti||'-'||rBOBIMAQU_B.Cod_Arti||'-'||rBOBIMAQU_B.Lote||' Ancho: '||rBOBIMAQU_B.Ancho||
                                 --                     ' es mayor al Ancho en el Material '||rMaterial_B2.Tip_Arti||'-'||rMaterial_B2.Cod_Arti||'-'||rMaterial_B2.Lote||' Ancho: '||rMaterial_B2.ANCHO);
                              END IF;
                           ELSE
                              --Error
                              IF rMaterial_B2.ANCHO_BUENO_TOTAL IS NULL THEN
                                 --647 No se encuentra @1. [Contador @2]
                                 P_ERRORES(vEmpresa, nNumeOtre, '647','el Ancho Bueno Total en el Material Contador: '||rMaterial_B2.Contador||' Articulo: '||rMaterial_B2.Tip_Arti||'-'||rMaterial_B2.Cod_Arti||'Lote'||rMaterial_B2.Lote||'|41','R','E');
                                 --dbms_output.put_line('Error: No se encuentra el Ancho en el Material '||rMaterial_B2.Empresa||'-'||rMaterial_B2.NumeOtre||'-'||rMaterial_B2.Contador||'-'||rMaterial_B2.Tip_Arti||'-'||rMaterial_B2.Cod_Arti||'-'||rMaterial_B2.Lote);
                              ELSIF rBOBIMAQU_B.ANCHO_BUENO IS NULL THEN
                                 --647 No se encuentra @1. [Contador @2]
                                 P_ERRORES(vEmpresa, nNumeOtre, '647','el Ancho Bueno en la Bobina Contador: '||rBOBIMAQU_B.Contador||' ContBobi: '||rBOBIMAQU_B.ContBobi||'-'||rBOBIMAQU_B.Tip_Arti||'-'||rBOBIMAQU_B.Cod_Arti||' Lote:'||rBOBIMAQU_B.Lote||'|42','R','E');
                                 --dbms_output.put_line('Error: No se encuentra el Ancho en la Bobina '||rBOBIMAQU_B.Empresa||'-'||rBOBIMAQU_B.NumeOtre||'-'||rBOBIMAQU_B.Contador||'-'||rBOBIMAQU_B.ContBobi||'-'||rBOBIMAQU_B.Tip_Arti||'-'||rBOBIMAQU_B.Cod_Arti||'-'||rBOBIMAQU_B.Lote);
                              END IF;
                           END IF;
                        END IF;
                     END IF;
                  END IF;
               END IF;
            END LOOP;
         END IF;
-->
-->MERMA DE SANEAMIENTO REAL
--BMERMA
--dbms_output.put_line('RECORRIDO DE BOBINAS PARA ACTUALIZAR MERMAS DE SANEAMIENTO Y TIRADA->'||rBOBIMAQU_B.MERMSANE);
         IF NVL(rBOBIMAQU_B.MERMSANE,0) > 0 THEN
            --Se buscan las Mermas Picadas para encontrar a que Material Pertencen apoyandose en el Cuenta Metros
            FOR rMERMA IN cMERMA(rBOBIMAQU_B.EMPRESA, rBOBIMAQU_B.NUMEOTRE, rBOBIMAQU_B.CONTADOR, rBOBIMAQU_B.CONTBOBI, vTimeSane) LOOP
--dbms_output.put_line('->'||rMERMA.Merma);
               IF NVL(rMERMA.Merma,0) > 0 THEN
--dbms_output.put_line('MATOR QUE 0');
                  nCuenMetr := 0;
                  nMermaAsignada := 0;
                  --Materiales que intervienen en la Fabricaci¿e la Bobina
                  FOR rMateBobi IN cMateBobi_Merma(rBOBIMAQU_B.EMPRESA, rBOBIMAQU_B.NUMEOTRE, rBOBIMAQU_B.CONTADOR, rBOBIMAQU_B.CONTBOBI, rBOBIMAQU_B.TIP_ARTI) LOOP
--dbms_output.put_line('MATERIALES QUE INTERVIENEN:'||rMateBobi.TIP_ARTI||', '||rMateBobi.COD_ARTI||', '||'|EMPRBOBI:'||rMateBobi.EmprBobi||'|NUOTBOBI:'||rMateBobi.NuotBobi||'|CONTBOBI:'||rMateBobi.ContBobi||'|COBOBOBI:'||rMateBobi.CoboBobi||'|LOTE:'||rMateBobi.Lote);
                     IF rMateBobi.CONTMATE = 1 THEN --Solo se Actualiza el Cuenta Metros en el Material 1 el 2 es que se esta laminando cuando esto aplique
--dbms_output.put_line('rMateBobi.CONTMATE:'||rMateBobi.CONTMATE);
                        nCuenMetr := nCuenMetr + rMateBobi.CantCons;
                        --
                        nMermaSuma := 0;
                        --
                        IF rMERMA.DESDE <= nCuenMetr AND rMERMA.HASTA <= nCuenMetr THEN --Caso 1 Ejemplo: Total Consumida 2500 Merma Dese 2100 Hasta 2300 Total 200
                           nMermaSuma := rMERMA.Merma - nMermaAsignada;
                        --ELSIF rMERMA.DESDE > nCuenMetr THEN --Caso 2 Ejemplo: Total Consumida 2500 Merma Dese 2800 Hasta 2900 Total 100 No se causa en Este Material
                           --NO SE REALIZA NADA PORQUE HAY QUE DAR OTRO CICLO
                        ELSIF rMERMA.DESDE <= nCuenMetr AND rMERMA.HASTA >= nCuenMetr THEN --Caso 2 Ejemplo: Total Consumida 2500 Merma Dese 2400 Hasta 2800 Total 400 Son dos Materiales
                           nMermaSuma := rMERMA.Merma - (nCuenMetr - rMERMA.DESDE);
                        --ELSE --Mal introducidos los cuenta Metros, Se imputa al primer Material
                           --NO SE REALIZA NADA PORQUE SE TRATARA CUANDO SALGA DEL FOR DE MATERIALES Y SE VERIFIQUE QUE TODO FUE ASIGNADO
                        END IF;
                        --
                        nMermaAsignada := nMermaAsignada + nMermaSuma;
                        --
                        IF NVL(nMermaSuma,0) > 0 THEN
--dbms_output.put_line('nMermaSuma:'||nMermaSuma);
                           IF rMateBobi.CoboBobi > 0 THEN --Se trata de una Bobina Generada
                              rMaterial_B1 := F_MATERIAL(rBOBIMAQU_B.EMPRESA, rBOBIMAQU_B.NUMEOTRE, rBOBIMAQU_B.CONTADOR, 
                                                         rMateBobi.TIP_ARTI, rMateBobi.COD_ARTI, '|EMPRBOBI:'||rMateBobi.EmprBobi||'|NUOTBOBI:'||rMateBobi.NuotBobi||'|CONTBOBI:'||rMateBobi.ContBobi||'|COBOBOBI:'||rMateBobi.CoboBobi||'|LOTE:'||rMateBobi.Lote,
                                                         NULL, NULL);
                           ELSE --Es un material de Almacen
                              rMaterial_B1 := F_MATERIAL(rBOBIMAQU_B.EMPRESA, rBOBIMAQU_B.NUMEOTRE, rBOBIMAQU_B.CONTADOR, 
                                                         rMateBobi.TIP_ARTI, rMateBobi.COD_ARTI, '|EMPRBOBI:'||rMateBobi.EmprBobi||'|NUOTBOBI:'||rMateBobi.NuotBobi||'|LOTE:'||rMateBobi.Lote||
																		   '|COBOMATE:'||rMateBobi.ContBobi||'|BOBIMATE:'||rMateBobi.CoboBobi, -- 11-11-2016 Solo para materiales tipo M
                                                         NULL, NULL);
                           END IF;
--dbms_output.put_line('rMaterial_B1.IDENTIFICADOR:'||rMaterial_B1.IDENTIFICADOR);
                           --
                           IF rMaterial_B1.IDENTIFICADOR IS NOT NULL THEN
                              --Se confronta el Ancho de la Bobina contra el Ancho del Material
                              /*NOTA POR ADICION DE ANCHO BUENO TOTAL
                                - SI EL ANCHO DEL MATERIAL ES MAYOR O IGUAL QUE EL DE LA BOBINA Y (NO ES BOBINA DE PRE-CORTE O ES DE PRE-CORTE Y ES DE UN SOLO CORTE)
                                - SI EL ANCHO DEL MATERIAL ES MAYIR AL DE LA BOBUNA SE TRATARA CON EL FACTOR DE EQUIVALENCIA EN ML TOMADO DE LA RELACION DE ML->M2 DE LA BOBINA CONTRA LOS ML->M2 DEL MATERIAL (PERO USANDO EL ANCHO_BUENO_TOTAL DEL MATERIAL)
                              */
--dbms_output.put_line('*******************************************************************->>>>>>'||rMaterial_B1.ANCHO_BUENO_TOTAL||'-'||rBOBIMAQU_B.ANCHO_BUENO);
                              IF rMaterial_B1.ANCHO_BUENO_TOTAL IS NOT NULL AND rBOBIMAQU_B.ANCHO_BUENO IS NOT NULL THEN
--dbms_output.put_line('ENTRA*******************************************************************->>>>>>'||rMaterial_B1.ANCHO_BUENO_TOTAL||'-'||rBOBIMAQU_B.ANCHO_BUENO);
                                 IF rMaterial_B1.ANCHO_BUENO_TOTAL >= rBOBIMAQU_B.ANCHO_BUENO AND (rBOBIMAQU_B.TIP_ARTI != vTiarCosc OR (rBOBIMAQU_B.TIP_ARTI = vTiarCosc AND rBOBIMAQU_B.NUMERO_BOBINAS_CORTE = 1)) THEN--Se imputa todo el ancho si es cualquier bobina diferente de un Corte de Precorte o si es Bobina de Pre-Corte pero el Pre-Corte solo tiene un Corte
--dbms_output.put_line('*******************************************************************->>>>>>1');
                                    --Actualizaci¿e Mermas
                                    --
                                    P_MATERIAL(rMaterial_B1,'U',
                                               NULL,--nCantProd
                                               NULL,--nCantCons_E
                                               NULL,--nCantCons
                                               NULL,--nCantAjus
                                               NULL,--nAncho
                                               NULL,--nFACTOR_CONVERSION_M2_KG
                                               NULL,--nPrecio_ML_E
                                               NULL,--vLog_Precio
                                               NULL,--nMermEnhe_E
                                               NULL,--nMermEnhe
                                               NULL,--nMermAjus_E
                                               NULL,--nMermAjus
                                               NULL,--nMermCabo_E
                                               NULL,--nMermCabo
                                               NULL,--nMermPico_E
                                               NULL,--nMermPico
                                               NULL,--nMermTita
                                               NVL(nMermaSuma,0),--nMermSane
                                               NULL,--nCantCons_Bobinas
                                               --
                                                NULL, --nCONTFSMU_01 
                                                NULL, --nCANTFSMU_01 
                                                NULL, --nCATOFSMU 
                                                NULL, --nCONTFSMU_02 
                                                NULL, --nCANTFSMU_02 
                                                NULL, --nCONTFSMU_03 
                                                NULL, --nCANTFSMU_03 
                                                NULL, --nCONTFSMU_04 
                                                NULL, --nCANTFSMU_04 
                                                NULL, --nCONTFSMU_05 
                                                NULL, --nCANTFSMU_05 
                                                NULL, --nCONTFSMU_06 
                                                NULL, --nCANTFSMU_06 
                                                NULL, --nCONTFSMU_07 
                                                NULL, --nCANTFSMU_07 
                                                NULL, --nCONTFSMU_08 
                                                NULL, --nCANTFSMU_08 
                                                NULL, --nCONTFSMU_09 
                                                NULL, --nCANTFSMU_09 
                                                NULL, --nCONTFSMU_10 
                                                NULL, --nCANTFSMU_10 
                                                NULL, --nANCHO_BUENO_TOTAL_01 
                                                NULL, --nANCHO_BUENO_OT_01 
                                                NULL, --nANCHO_BUENO_TOTAL_02 
                                                NULL, --nANCHO_BUENO_OT_02 
                                                NULL, --nANCHO_BUENO_TOTAL_03 
                                                NULL, --nANCHO_BUENO_OT_03 
                                                NULL, --nANCHO_BUENO_TOTAL_04 
                                                NULL, --nANCHO_BUENO_OT_04 
                                                NULL, --nANCHO_BUENO_TOTAL_05 
                                                NULL, --nANCHO_BUENO_OT_05 
                                                NULL, --nANCHO_BUENO_TOTAL_06 
                                                NULL, --nANCHO_BUENO_OT_06 
                                                NULL, --nANCHO_BUENO_TOTAL_07 
                                                NULL, --nANCHO_BUENO_OT_07 
                                                NULL, --nANCHO_BUENO_TOTAL_08 
                                                NULL, --nANCHO_BUENO_OT_08 
                                                NULL, --nANCHO_BUENO_TOTAL_09 
                                                NULL, --nANCHO_BUENO_OT_09 
                                                NULL, --nANCHO_BUENO_TOTAL_10 
                                                NULL, --nANCHO_BUENO_OT_10 
                                                NULL, --nANCHO_BUENO_TOTAL 
                                                NULL, --nANCHO_BUENO_OT 
                                                NULL, --nNUMECORT 
                                                NULL, --nMM_MERMPRCO_01 
                                                NULL, --nMM_MERMPLAN_EXESO_01 
                                                NULL, --nMM_MERMPLAN_01 
                                                NULL, --nMM_MERMPRCO_02 
                                                NULL, --nMM_MERMPLAN_EXESO_02 
                                                NULL, --nMM_MERMPLAN_02 
                                                NULL, --nMM_MERMPRCO_03 
                                                NULL, --nMM_MERMPLAN_EXESO_03 
                                                NULL, --nMM_MERMPLAN_03 
                                                NULL, --nMM_MERMPRCO_04 
                                                NULL, --nMM_MERMPLAN_EXESO_04 
                                                NULL, --nMM_MERMPLAN_04 
                                                NULL, --nMM_MERMPRCO_05 
                                                NULL, --nMM_MERMPLAN_EXESO_05 
                                                NULL, --nMM_MERMPLAN_05 
                                                NULL, --nMM_MERMPRCO_06 
                                                NULL, --nMM_MERMPLAN_EXESO_06 
                                                NULL, --nMM_MERMPLAN_06 
                                                NULL, --nMM_MERMPRCO_07 
                                                NULL, --nMM_MERMPLAN_EXESO_07 
                                                NULL, --nMM_MERMPLAN_07 
                                                NULL, --nMM_MERMPRCO_08 
                                                NULL, --nMM_MERMPLAN_EXESO_08 
                                                NULL, --nMM_MERMPLAN_08 
                                                NULL, --nMM_MERMPRCO_09 
                                                NULL, --nMM_MERMPLAN_EXESO_09 
                                                NULL, --nMM_MERMPLAN_09 
                                                NULL, --nMM_MERMPRCO_10 
                                                NULL, --nMM_MERMPLAN_EXESO_10 
                                                NULL, --nMM_MERMPLAN_10 
                                                NULL, --nMM_MERMPRCO 
                                                NULL, --nMM_MERMPLAN_EXESO 
                                                NULL); --nMM_MERMPLAN
                                    --t_MATERIAL(rMaterial_B1.IDENTIFICADOR).MermSane := NVL(rMaterial_B1.MERMSANE,0) + NVL(nMermaSuma,0);
                                 ELSIF rMaterial_B1.ANCHO_BUENO_TOTAL > rBOBIMAQU_B.ANCHO_BUENO THEN
--dbms_output.put_line('*******************************************************************->>>>>>2');
                                    nFactor := (NVL(rBOBIMAQU_B.ANCHO_BUENO,0) / 1000);--Convierte a M2 de Bobina
                                    --
                                    IF (NVL(rMaterial_B1.ANCHO_BUENO_TOTAL,0) / 1000) > 0 THEN
                                       nFactor := nFactor  / (NVL(rMaterial_B1.ANCHO_BUENO_TOTAL,0) / 1000);--Convierte los M2 de Bobina a ML de Material
                                    ELSE
                                       nFactor := 0;
                                       --606 No existe FC: @1. [Contador @2]
                                       P_ERRORES(vEmpresa, nNumeOtre, '606','Calculo de Factor de Conversion de la Bobina Contador: '||rBOBIMAQU_B.Contador||' ContBobi: '||rBOBIMAQU_B.ContBobi||' Articulo: '||rBOBIMAQU_B.Tip_Arti||'-'||rBOBIMAQU_B.Cod_Arti||' Lote: '||rBOBIMAQU_B.Lote||' Ancho Bueno: '||rBOBIMAQU_B.ANCHO_BUENO||' contra el Material '||rMaterial_B1.Tip_Arti||'-'||rMaterial_B1.Cod_Arti||' Lote: '||rMaterial_B1.Lote||' Ancho Bueno Total: '||rMaterial_B1.ANCHO_BUENO_TOTAL||'|43','R','E');
                                       --dbms_output.put_line('Error: Calculo de Factor de Conversion de la Bobina '||rBOBIMAQU_B.Empresa||'-'||rBOBIMAQU_B.NumeOtre||'-'||rBOBIMAQU_B.Contador||'-'||rBOBIMAQU_B.ContBobi||'-'||rBOBIMAQU_B.Tip_Arti||'-'||rBOBIMAQU_B.Cod_Arti||'-'||rBOBIMAQU_B.Lote||' Ancho: '||rBOBIMAQU_B.Ancho||
                                       --                     ' contra el Material '||rMaterial_B1.Tip_Arti||'-'||rMaterial_B1.Cod_Arti||'-'||rMaterial_B1.Lote||' Ancho: '||rMaterial_B1.ANCHO);
                                    END IF;
                                    --
--dbms_output.put_line('1_>'||NVL(rMaterial_B1.MERMSANE,0)||' + ('||NVL(nMermaSuma,0)||' * '||nFactor||')');
                                    P_MATERIAL(rMaterial_B1,'U',
                                               NULL,--nCantProd
                                               NULL,--nCantCons_E
                                               NULL,--nCantCons
                                               NULL,--nCantAjus
                                               NULL,--nAncho
                                               NULL,--nFACTOR_CONVERSION_M2_KG
                                               NULL,--nPrecio_ML_E
                                               NULL,--vLog_Precio
                                               NULL,--nMermEnhe_E
                                               NULL,--nMermEnhe
                                               NULL,--nMermAjus_E
                                               NULL,--nMermAjus
                                               NULL,--nMermCabo_E
                                               NULL,--nMermCabo
                                               NULL,--nMermPico_E
                                               NULL,--nMermPico
                                               NULL,--nMermTita
                                               (NVL(nMermaSuma,0) * nFactor),--nMermSane
                                               NULL,--nCantCons_Bobinas
                                               --
                                                NULL, --nCONTFSMU_01 
                                                NULL, --nCANTFSMU_01 
                                                NULL, --nCATOFSMU 
                                                NULL, --nCONTFSMU_02 
                                                NULL, --nCANTFSMU_02 
                                                NULL, --nCONTFSMU_03 
                                                NULL, --nCANTFSMU_03 
                                                NULL, --nCONTFSMU_04 
                                                NULL, --nCANTFSMU_04 
                                                NULL, --nCONTFSMU_05 
                                                NULL, --nCANTFSMU_05 
                                                NULL, --nCONTFSMU_06 
                                                NULL, --nCANTFSMU_06 
                                                NULL, --nCONTFSMU_07 
                                                NULL, --nCANTFSMU_07 
                                                NULL, --nCONTFSMU_08 
                                                NULL, --nCANTFSMU_08 
                                                NULL, --nCONTFSMU_09 
                                                NULL, --nCANTFSMU_09 
                                                NULL, --nCONTFSMU_10 
                                                NULL, --nCANTFSMU_10 
                                                NULL, --nANCHO_BUENO_TOTAL_01 
                                                NULL, --nANCHO_BUENO_OT_01 
                                                NULL, --nANCHO_BUENO_TOTAL_02 
                                                NULL, --nANCHO_BUENO_OT_02 
                                                NULL, --nANCHO_BUENO_TOTAL_03 
                                                NULL, --nANCHO_BUENO_OT_03 
                                                NULL, --nANCHO_BUENO_TOTAL_04 
                                                NULL, --nANCHO_BUENO_OT_04 
                                                NULL, --nANCHO_BUENO_TOTAL_05 
                                                NULL, --nANCHO_BUENO_OT_05 
                                                NULL, --nANCHO_BUENO_TOTAL_06 
                                                NULL, --nANCHO_BUENO_OT_06 
                                                NULL, --nANCHO_BUENO_TOTAL_07 
                                                NULL, --nANCHO_BUENO_OT_07 
                                                NULL, --nANCHO_BUENO_TOTAL_08 
                                                NULL, --nANCHO_BUENO_OT_08 
                                                NULL, --nANCHO_BUENO_TOTAL_09 
                                                NULL, --nANCHO_BUENO_OT_09 
                                                NULL, --nANCHO_BUENO_TOTAL_10 
                                                NULL, --nANCHO_BUENO_OT_10 
                                                NULL, --nANCHO_BUENO_TOTAL 
                                                NULL, --nANCHO_BUENO_OT 
                                                NULL, --nNUMECORT 
                                                NULL, --nMM_MERMPRCO_01 
                                                NULL, --nMM_MERMPLAN_EXESO_01 
                                                NULL, --nMM_MERMPLAN_01 
                                                NULL, --nMM_MERMPRCO_02 
                                                NULL, --nMM_MERMPLAN_EXESO_02 
                                                NULL, --nMM_MERMPLAN_02 
                                                NULL, --nMM_MERMPRCO_03 
                                                NULL, --nMM_MERMPLAN_EXESO_03 
                                                NULL, --nMM_MERMPLAN_03 
                                                NULL, --nMM_MERMPRCO_04 
                                                NULL, --nMM_MERMPLAN_EXESO_04 
                                                NULL, --nMM_MERMPLAN_04 
                                                NULL, --nMM_MERMPRCO_05 
                                                NULL, --nMM_MERMPLAN_EXESO_05 
                                                NULL, --nMM_MERMPLAN_05 
                                                NULL, --nMM_MERMPRCO_06 
                                                NULL, --nMM_MERMPLAN_EXESO_06 
                                                NULL, --nMM_MERMPLAN_06 
                                                NULL, --nMM_MERMPRCO_07 
                                                NULL, --nMM_MERMPLAN_EXESO_07 
                                                NULL, --nMM_MERMPLAN_07 
                                                NULL, --nMM_MERMPRCO_08 
                                                NULL, --nMM_MERMPLAN_EXESO_08 
                                                NULL, --nMM_MERMPLAN_08 
                                                NULL, --nMM_MERMPRCO_09 
                                                NULL, --nMM_MERMPLAN_EXESO_09 
                                                NULL, --nMM_MERMPLAN_09 
                                                NULL, --nMM_MERMPRCO_10 
                                                NULL, --nMM_MERMPLAN_EXESO_10 
                                                NULL, --nMM_MERMPLAN_10 
                                                NULL, --nMM_MERMPRCO 
                                                NULL, --nMM_MERMPLAN_EXESO 
                                                NULL); --nMM_MERMPLAN
                                    --t_MATERIAL(rMaterial_B1.IDENTIFICADOR).MermSane := NVL(rMaterial_B1.MERMSANE,0) + (NVL(nMermaSuma,0) * nFactor);
                                 ELSE
--dbms_output.put_line('*******************************************************************->>>>>>3');
                                    --647 No se encuentra @1. [Contador @2]
                                    --[IB] No se encuentra 6-Calculo de Anchos de Material y Bobina: El Ancho en la Bobina Contador: 3 ContBobi: 15 Articulo: IM-214502502952 Lote: 2012002924 Ancho Bueno: 615 es mayor al Ancho en el Material LA-214502502952 Lote:. [Contador EMPRBOBI:10]
                                    P_ERRORES(vEmpresa, nNumeOtre, '647','6-Calculo de Anchos de Material y Bobina: El Ancho en la Bobina Contador: '||rBOBIMAQU_B.Contador||' ContBobi: '||rBOBIMAQU_B.ContBobi||' Articulo: '||rBOBIMAQU_B.Tip_Arti||'-'||rBOBIMAQU_B.Cod_Arti||' Lote: '||rBOBIMAQU_B.Lote||' Ancho Bueno: '||rBOBIMAQU_B.ANCHO_BUENO||' es mayor al Ancho en el Material '||rMaterial_B1.Tip_Arti||'-'||rMaterial_B1.Cod_Arti||' Lote: '||rMaterial_B1.Lote||' Ancho Bueno Total: '||rMaterial_B1.ANCHO_BUENO_TOTAL||'|44','R','E');
                                    --P_ERRORES(vEmpresa, nNumeOtre, '647','6-Calculo de Anchos de Material y Bobina: El Ancho en la Bobina Contador: '||rBOBIMAQU_B.Contador||' ContBobi: '||rBOBIMAQU_B.ContBobi||' Articulo: '||rBOBIMAQU_B.Tip_Arti||'-'||rBOBIMAQU_B.Cod_Arti||' Lote: '||rBOBIMAQU_B.Lote||' Ancho Bueno: '||rBOBIMAQU_B.ANCHO_BUENO||' es mayor al Ancho en el Material '||rMaterial_B1.Tip_Arti||'-'||rMaterial_B1.Cod_Arti||' Ancho Bueno Total: '||rMaterial_B1.ANCHO_BUENO_TOTAL||'|44','R','E');
                                    --dbms_output.put_line('Error: El Ancho en la Bobina '||rBOBIMAQU_B.Empresa||'-'||rBOBIMAQU_B.NumeOtre||'-'||rBOBIMAQU_B.Contador||'-'||rBOBIMAQU_B.ContBobi||'-'||rBOBIMAQU_B.Tip_Arti||'-'||rBOBIMAQU_B.Cod_Arti||'-'||rBOBIMAQU_B.Lote||' Ancho: '||rBOBIMAQU_B.Ancho||
                                    --                     ' es mayor al Ancho en el Material '||rMaterial_B1.Tip_Arti||'-'||rMaterial_B1.Cod_Arti||'-'||rMaterial_B1.Lote||' Ancho: '||rMaterial_B1.ANCHO);
                                 END IF;
                              ELSE
                                 --Error
                                 IF rMaterial_B1.ANCHO_BUENO_TOTAL IS NULL THEN
                                    --647 No se encuentra @1. [Contador @2]
                                    P_ERRORES(vEmpresa, nNumeOtre, '647','el Ancho Bueno Total en el Material Contador: '||rMaterial_B1.Contador||' Articulo: '||rMaterial_B1.Tip_Arti||'-'||rMaterial_B1.Cod_Arti||' Lote: '||rMaterial_B1.Lote||'|45','R','E');
                                    --dbms_output.put_line('Error: No se encuentra el Ancho en el Material '||rMaterial_B1.Empresa||'-'||rMaterial_B1.NumeOtre||'-'||rMaterial_B1.Contador||'-'||rMaterial_B1.Tip_Arti||'-'||rMaterial_B1.Cod_Arti||'-'||rMaterial_B1.Lote);
                                 ELSIF rBOBIMAQU_B.ANCHO_BUENO IS NULL THEN
                                    --647 No se encuentra @1. [Contador @2]
                                    P_ERRORES(vEmpresa, nNumeOtre, '647','el Ancho Bueno en la Bobina Contador: '||rBOBIMAQU_B.Contador||' ContBobi: '||rBOBIMAQU_B.ContBobi||' Articulo: '||rBOBIMAQU_B.Tip_Arti||'-'||rBOBIMAQU_B.Cod_Arti||' Lote: '||rBOBIMAQU_B.Lote||'|46','R','E');
                                    --dbms_output.put_line('Error: No se encuentra el Ancho en la Bobina '||rBOBIMAQU_B.Empresa||'-'||rBOBIMAQU_B.NumeOtre||'-'||rBOBIMAQU_B.Contador||'-'||rBOBIMAQU_B.ContBobi||'-'||rBOBIMAQU_B.Tip_Arti||'-'||rBOBIMAQU_B.Cod_Arti||'-'||rBOBIMAQU_B.Lote);
                                 END IF;
                              END IF;
                           END IF;
                        END IF;
                     ELSE
                        IF NVL(nMermaSuma,0) > 0 THEN
                           IF rMateBobi.CoboBobi > 0 THEN --Se trata de una Bobina Generada
                              rMaterial_B2 := F_MATERIAL(rBOBIMAQU_B.EMPRESA, rBOBIMAQU_B.NUMEOTRE, rBOBIMAQU_B.CONTADOR, 
                                                         rMateBobi.TIP_ARTI, rMateBobi.COD_ARTI, '|EMPRBOBI:'||rMateBobi.EmprBobi||'|NUOTBOBI:'||rMateBobi.NuotBobi||'|CONTBOBI:'||rMateBobi.ContBobi||'|COBOBOBI:'||rMateBobi.CoboBobi||'|LOTE:'||rMateBobi.Lote,
                                                         NULL, NULL);
                           ELSE --Es un material de Almacen
                              rMaterial_B2 := F_MATERIAL(rBOBIMAQU_B.EMPRESA, rBOBIMAQU_B.NUMEOTRE, rBOBIMAQU_B.CONTADOR, 
                                                         rMateBobi.TIP_ARTI, rMateBobi.COD_ARTI, '|EMPRBOBI:'||rMateBobi.EmprBobi||'|NUOTBOBI:'||rMateBobi.NuotBobi||'|LOTE:'||rMateBobi.Lote||
																		   '|COBOMATE:'||rMateBobi.ContBobi||'|BOBIMATE:'||rMateBobi.CoboBobi, -- 11-11-2016 Solo para materiales tipo M
                                                         NULL, NULL);
                           END IF;
                           --
                           IF rMaterial_B2.IDENTIFICADOR IS NOT NULL THEN
                              --Se confronta el Ancho de la Bobina contra el Ancho del Material
                              /*NOTA POR ADICION DE ANCHO BUENO TOTAL
                                - SI EL ANCHO DEL MATERIAL ES MAYOR O IGUAL QUE EL DE LA BOBINA Y (NO ES BOBINA DE PRE-CORTE O ES DE PRE-CORTE Y ES DE UN SOLO CORTE)
                                - SI EL ANCHO DEL MATERIAL ES MAYIR AL DE LA BOBUNA SE TRATARA CON EL FACTOR DE EQUIVALENCIA EN ML TOMADO DE LA RELACION DE ML->M2 DE LA BOBINA CONTRA LOS ML->M2 DEL MATERIAL (PERO USANDO EL ANCHO_BUENO_TOTAL DEL MATERIAL)
                              */
                              IF rMaterial_B2.ANCHO_BUENO_TOTAL IS NOT NULL AND rBOBIMAQU_B.ANCHO_BUENO IS NOT NULL THEN
                                 IF rMaterial_B2.ANCHO_BUENO_TOTAL >= rBOBIMAQU_B.ANCHO_BUENO AND (rBOBIMAQU_B.TIP_ARTI != vTiarCosc OR (rBOBIMAQU_B.TIP_ARTI = vTiarCosc AND rBOBIMAQU_B.NUMERO_BOBINAS_CORTE = 1)) THEN--Se imputa todo el ancho si es cualquier bobina diferente de un Corte de Precorte o si es Bobina de Pre-Corte pero el Pre-Corte solo tiene un Corte
                                    --Actualizaci¿e Mermas
                                    P_MATERIAL(rMaterial_B2,'U',
                                               NULL,--nCantProd
                                               NULL,--nCantCons_E
                                               NULL,--nCantCons
                                               NULL,--nCantAjus
                                               NULL,--nAncho
                                               NULL,--nFACTOR_CONVERSION_M2_KG
                                               NULL,--nPrecio_ML_E
                                               NULL,--vLog_Precio
                                               NULL,--nMermEnhe_E
                                               NULL,--nMermEnhe
                                               NULL,--nMermAjus_E
                                               NULL,--nMermAjus
                                               NULL,--nMermCabo_E
                                               NULL,--nMermCabo
                                               NULL,--nMermPico_E
                                               NULL,--nMermPico
                                               NULL,--nMermTita
                                               NVL(nMermaSuma,0),--nMermSane
                                               NULL,--nCantCons_Bobinas
                                               --
                                                NULL, --nCONTFSMU_01 
                                                NULL, --nCANTFSMU_01 
                                                NULL, --nCATOFSMU 
                                                NULL, --nCONTFSMU_02 
                                                NULL, --nCANTFSMU_02 
                                                NULL, --nCONTFSMU_03 
                                                NULL, --nCANTFSMU_03 
                                                NULL, --nCONTFSMU_04 
                                                NULL, --nCANTFSMU_04 
                                                NULL, --nCONTFSMU_05 
                                                NULL, --nCANTFSMU_05 
                                                NULL, --nCONTFSMU_06 
                                                NULL, --nCANTFSMU_06 
                                                NULL, --nCONTFSMU_07 
                                                NULL, --nCANTFSMU_07 
                                                NULL, --nCONTFSMU_08 
                                                NULL, --nCANTFSMU_08 
                                                NULL, --nCONTFSMU_09 
                                                NULL, --nCANTFSMU_09 
                                                NULL, --nCONTFSMU_10 
                                                NULL, --nCANTFSMU_10 
                                                NULL, --nANCHO_BUENO_TOTAL_01 
                                                NULL, --nANCHO_BUENO_OT_01 
                                                NULL, --nANCHO_BUENO_TOTAL_02 
                                                NULL, --nANCHO_BUENO_OT_02 
                                                NULL, --nANCHO_BUENO_TOTAL_03 
                                                NULL, --nANCHO_BUENO_OT_03 
                                                NULL, --nANCHO_BUENO_TOTAL_04 
                                                NULL, --nANCHO_BUENO_OT_04 
                                                NULL, --nANCHO_BUENO_TOTAL_05 
                                                NULL, --nANCHO_BUENO_OT_05 
                                                NULL, --nANCHO_BUENO_TOTAL_06 
                                                NULL, --nANCHO_BUENO_OT_06 
                                                NULL, --nANCHO_BUENO_TOTAL_07 
                                                NULL, --nANCHO_BUENO_OT_07 
                                                NULL, --nANCHO_BUENO_TOTAL_08 
                                                NULL, --nANCHO_BUENO_OT_08 
                                                NULL, --nANCHO_BUENO_TOTAL_09 
                                                NULL, --nANCHO_BUENO_OT_09 
                                                NULL, --nANCHO_BUENO_TOTAL_10 
                                                NULL, --nANCHO_BUENO_OT_10 
                                                NULL, --nANCHO_BUENO_TOTAL 
                                                NULL, --nANCHO_BUENO_OT 
                                                NULL, --nNUMECORT 
                                                NULL, --nMM_MERMPRCO_01 
                                                NULL, --nMM_MERMPLAN_EXESO_01 
                                                NULL, --nMM_MERMPLAN_01 
                                                NULL, --nMM_MERMPRCO_02 
                                                NULL, --nMM_MERMPLAN_EXESO_02 
                                                NULL, --nMM_MERMPLAN_02 
                                                NULL, --nMM_MERMPRCO_03 
                                                NULL, --nMM_MERMPLAN_EXESO_03 
                                                NULL, --nMM_MERMPLAN_03 
                                                NULL, --nMM_MERMPRCO_04 
                                                NULL, --nMM_MERMPLAN_EXESO_04 
                                                NULL, --nMM_MERMPLAN_04 
                                                NULL, --nMM_MERMPRCO_05 
                                                NULL, --nMM_MERMPLAN_EXESO_05 
                                                NULL, --nMM_MERMPLAN_05 
                                                NULL, --nMM_MERMPRCO_06 
                                                NULL, --nMM_MERMPLAN_EXESO_06 
                                                NULL, --nMM_MERMPLAN_06 
                                                NULL, --nMM_MERMPRCO_07 
                                                NULL, --nMM_MERMPLAN_EXESO_07 
                                                NULL, --nMM_MERMPLAN_07 
                                                NULL, --nMM_MERMPRCO_08 
                                                NULL, --nMM_MERMPLAN_EXESO_08 
                                                NULL, --nMM_MERMPLAN_08 
                                                NULL, --nMM_MERMPRCO_09 
                                                NULL, --nMM_MERMPLAN_EXESO_09 
                                                NULL, --nMM_MERMPLAN_09 
                                                NULL, --nMM_MERMPRCO_10 
                                                NULL, --nMM_MERMPLAN_EXESO_10 
                                                NULL, --nMM_MERMPLAN_10 
                                                NULL, --nMM_MERMPRCO 
                                                NULL, --nMM_MERMPLAN_EXESO 
                                                NULL); --nMM_MERMPLAN
                                    --t_MATERIAL(rMaterial_B2.IDENTIFICADOR).MermSane := NVL(rMaterial_B2.MERMSANE,0) + NVL(nMermaSuma,0);
                                 ELSIF rMaterial_B2.ANCHO_BUENO_TOTAL > rBOBIMAQU_B.ANCHO_BUENO THEN
                                    nFactor := (NVL(rBOBIMAQU_B.ANCHO_BUENO,0) / 1000);--Convierte a M2 de Bobina
                                    --
                                    IF (NVL(rMaterial_B2.ANCHO_BUENO_TOTAL,0) / 1000) > 0 THEN
                                       nFactor := nFactor  / (NVL(rMaterial_B2.ANCHO_BUENO_TOTAL,0) / 1000);--Convierte los M2 de Bobina a ML de Material
                                    ELSE
                                       nFactor := 0;
                                       --606 No existe FC: @1. [Contador @2]
                                       P_ERRORES(vEmpresa, nNumeOtre, '606','Calculo de Factor de Conversion de la Bobina Contador: '||rBOBIMAQU_B.Contador||' ContBobi: '||rBOBIMAQU_B.ContBobi||' Articulo: '||rBOBIMAQU_B.Tip_Arti||'-'||rBOBIMAQU_B.Cod_Arti||' Lote: '||rBOBIMAQU_B.Lote||' Ancho Bueno: '||rBOBIMAQU_B.ANCHO_BUENO||' contra el Material '||rMaterial_B2.Tip_Arti||'-'||rMaterial_B2.Cod_Arti||' Lote: '||rMaterial_B2.Lote||' Ancho Bueno Total: '||rMaterial_B2.ANCHO_BUENO_TOTAL||'|47','R','E');
                                       --dbms_output.put_line('Error: Calculo de Factor de Conversion de la Bobina '||rBOBIMAQU_B.Empresa||'-'||rBOBIMAQU_B.NumeOtre||'-'||rBOBIMAQU_B.Contador||'-'||rBOBIMAQU_B.ContBobi||'-'||rBOBIMAQU_B.Tip_Arti||'-'||rBOBIMAQU_B.Cod_Arti||'-'||rBOBIMAQU_B.Lote||' Ancho: '||rBOBIMAQU_B.Ancho||
                                       --                     ' contra el Material '||rMaterial_B2.Tip_Arti||'-'||rMaterial_B2.Cod_Arti||'-'||rMaterial_B2.Lote||' Ancho: '||rMaterial_B2.ANCHO);
                                    END IF;
                                    --
--dbms_output.put_line('2_>'||NVL(rMaterial_B2.MERMSANE,0)||' + ('||NVL(nMermaSuma,0)||' * '||nFactor||')');
                                    P_MATERIAL(rMaterial_B2,'U',
                                               NULL,--nCantProd
                                               NULL,--nCantCons_E
                                               NULL,--nCantCons
                                               NULL,--nCantAjus
                                               NULL,--nAncho
                                               NULL,--nFACTOR_CONVERSION_M2_KG
                                               NULL,--nPrecio_ML_E
                                               NULL,--vLog_Precio
                                               NULL,--nMermEnhe_E
                                               NULL,--nMermEnhe
                                               NULL,--nMermAjus_E
                                               NULL,--nMermAjus
                                               NULL,--nMermCabo_E
                                               NULL,--nMermCabo
                                               NULL,--nMermPico_E
                                               NULL,--nMermPico
                                               NULL,--nMermTita
                                               (NVL(nMermaSuma,0) * nFactor),--nMermSane
                                               NULL,--nCantCons_Bobinas
                                               --
                                                NULL, --nCONTFSMU_01 
                                                NULL, --nCANTFSMU_01 
                                                NULL, --nCATOFSMU 
                                                NULL, --nCONTFSMU_02 
                                                NULL, --nCANTFSMU_02 
                                                NULL, --nCONTFSMU_03 
                                                NULL, --nCANTFSMU_03 
                                                NULL, --nCONTFSMU_04 
                                                NULL, --nCANTFSMU_04 
                                                NULL, --nCONTFSMU_05 
                                                NULL, --nCANTFSMU_05 
                                                NULL, --nCONTFSMU_06 
                                                NULL, --nCANTFSMU_06 
                                                NULL, --nCONTFSMU_07 
                                                NULL, --nCANTFSMU_07 
                                                NULL, --nCONTFSMU_08 
                                                NULL, --nCANTFSMU_08 
                                                NULL, --nCONTFSMU_09 
                                                NULL, --nCANTFSMU_09 
                                                NULL, --nCONTFSMU_10 
                                                NULL, --nCANTFSMU_10 
                                                NULL, --nANCHO_BUENO_TOTAL_01 
                                                NULL, --nANCHO_BUENO_OT_01 
                                                NULL, --nANCHO_BUENO_TOTAL_02 
                                                NULL, --nANCHO_BUENO_OT_02 
                                                NULL, --nANCHO_BUENO_TOTAL_03 
                                                NULL, --nANCHO_BUENO_OT_03 
                                                NULL, --nANCHO_BUENO_TOTAL_04 
                                                NULL, --nANCHO_BUENO_OT_04 
                                                NULL, --nANCHO_BUENO_TOTAL_05 
                                                NULL, --nANCHO_BUENO_OT_05 
                                                NULL, --nANCHO_BUENO_TOTAL_06 
                                                NULL, --nANCHO_BUENO_OT_06 
                                                NULL, --nANCHO_BUENO_TOTAL_07 
                                                NULL, --nANCHO_BUENO_OT_07 
                                                NULL, --nANCHO_BUENO_TOTAL_08 
                                                NULL, --nANCHO_BUENO_OT_08 
                                                NULL, --nANCHO_BUENO_TOTAL_09 
                                                NULL, --nANCHO_BUENO_OT_09 
                                                NULL, --nANCHO_BUENO_TOTAL_10 
                                                NULL, --nANCHO_BUENO_OT_10 
                                                NULL, --nANCHO_BUENO_TOTAL 
                                                NULL, --nANCHO_BUENO_OT 
                                                NULL, --nNUMECORT 
                                                NULL, --nMM_MERMPRCO_01 
                                                NULL, --nMM_MERMPLAN_EXESO_01 
                                                NULL, --nMM_MERMPLAN_01 
                                                NULL, --nMM_MERMPRCO_02 
                                                NULL, --nMM_MERMPLAN_EXESO_02 
                                                NULL, --nMM_MERMPLAN_02 
                                                NULL, --nMM_MERMPRCO_03 
                                                NULL, --nMM_MERMPLAN_EXESO_03 
                                                NULL, --nMM_MERMPLAN_03 
                                                NULL, --nMM_MERMPRCO_04 
                                                NULL, --nMM_MERMPLAN_EXESO_04 
                                                NULL, --nMM_MERMPLAN_04 
                                                NULL, --nMM_MERMPRCO_05 
                                                NULL, --nMM_MERMPLAN_EXESO_05 
                                                NULL, --nMM_MERMPLAN_05 
                                                NULL, --nMM_MERMPRCO_06 
                                                NULL, --nMM_MERMPLAN_EXESO_06 
                                                NULL, --nMM_MERMPLAN_06 
                                                NULL, --nMM_MERMPRCO_07 
                                                NULL, --nMM_MERMPLAN_EXESO_07 
                                                NULL, --nMM_MERMPLAN_07 
                                                NULL, --nMM_MERMPRCO_08 
                                                NULL, --nMM_MERMPLAN_EXESO_08 
                                                NULL, --nMM_MERMPLAN_08 
                                                NULL, --nMM_MERMPRCO_09 
                                                NULL, --nMM_MERMPLAN_EXESO_09 
                                                NULL, --nMM_MERMPLAN_09 
                                                NULL, --nMM_MERMPRCO_10 
                                                NULL, --nMM_MERMPLAN_EXESO_10 
                                                NULL, --nMM_MERMPLAN_10 
                                                NULL, --nMM_MERMPRCO 
                                                NULL, --nMM_MERMPLAN_EXESO 
                                                NULL); --nMM_MERMPLAN
                                    --t_MATERIAL(rMaterial_B2.IDENTIFICADOR).MermSane := NVL(rMaterial_B2.MERMSANE,0) + (NVL(nMermaSuma,0) * nFactor);
                                 ELSE
                                    --647 No se encuentra @1. [Contador @2]
                                    P_ERRORES(vEmpresa, nNumeOtre, '647','7-Calculo de Anchos de Material y Bobina: El Ancho en la Bobina Contador: '||rBOBIMAQU_B.Contador||' ContBobi: '||rBOBIMAQU_B.ContBobi||' Articulo: '||rBOBIMAQU_B.Tip_Arti||'-'||rBOBIMAQU_B.Cod_Arti||' Lote: '||rBOBIMAQU_B.Lote||' Ancho Bueno: '||rBOBIMAQU_B.ANCHO_BUENO||' es mayor al Ancho en el Material '||rMaterial_B2.Tip_Arti||'-'||rMaterial_B2.Cod_Arti||' Lote: '||rMaterial_B2.Lote||' Ancho Bueno Total: '||rMaterial_B2.ANCHO_BUENO_TOTAL||'|48','R','E');
                                    --dbms_output.put_line('Error: El Ancho en la Bobina '||rBOBIMAQU_B.Empresa||'-'||rBOBIMAQU_B.NumeOtre||'-'||rBOBIMAQU_B.Contador||'-'||rBOBIMAQU_B.ContBobi||'-'||rBOBIMAQU_B.Tip_Arti||'-'||rBOBIMAQU_B.Cod_Arti||'-'||rBOBIMAQU_B.Lote||' Ancho: '||rBOBIMAQU_B.Ancho||
                                    --                     ' es mayor al Ancho en el Material '||rMaterial_B2.Tip_Arti||'-'||rMaterial_B2.Cod_Arti||'-'||rMaterial_B2.Lote||' Ancho: '||rMaterial_B2.ANCHO);
                                 END IF;
                              ELSE
                                 --Error
                                 IF rMaterial_B2.ANCHO_BUENO_TOTAL IS NULL THEN
                                    --647 No se encuentra @1. [Contador @2]
                                    P_ERRORES(vEmpresa, nNumeOtre, '647','el Ancho Bueno Total en el Material Contador: '||rMaterial_B2.Contador||' ContBobi: '||rMaterial_B2.Tip_Arti||'-'||rMaterial_B2.Cod_Arti||' Lote: '||rMaterial_B2.Lote||'|49','R','E');
                                    --dbms_output.put_line('Error: No se encuentra el Ancho en el Material '||rMaterial_B2.Empresa||'-'||rMaterial_B2.NumeOtre||'-'||rMaterial_B2.Contador||'-'||rMaterial_B2.Tip_Arti||'-'||rMaterial_B2.Cod_Arti||'-'||rMaterial_B2.Lote);
                                 ELSIF rBOBIMAQU_B.ANCHO_BUENO IS NULL THEN
                                    --647 No se encuentra @1. [Contador @2]
                                    P_ERRORES(vEmpresa, nNumeOtre, '647','el Ancho Bueno en la Bobina Contador: '||rBOBIMAQU_B.Contador||' ContBobi: '||rBOBIMAQU_B.ContBobi||' Articulo: '||rBOBIMAQU_B.Tip_Arti||'-'||rBOBIMAQU_B.Cod_Arti||' Lote: '||rBOBIMAQU_B.Lote||'|50','R','E');
                                    --dbms_output.put_line('Error: No se encuentra el Ancho en la Bobina '||rBOBIMAQU_B.Empresa||'-'||rBOBIMAQU_B.NumeOtre||'-'||rBOBIMAQU_B.Contador||'-'||rBOBIMAQU_B.ContBobi||'-'||rBOBIMAQU_B.Tip_Arti||'-'||rBOBIMAQU_B.Cod_Arti||'-'||rBOBIMAQU_B.Lote);
                                 END IF;
                              END IF;
                           END IF;
                        END IF;
                     END IF;
                  END LOOP;
                  --Si quedo algo por Asignar, se asignara al primer material
                  IF nMermaAsignada < rMERMA.Merma THEN
                     --647 No se encuentra @1. [Contador @2]
                     P_ERRORES(vEmpresa, nNumeOtre, '647','Merma en Materiales donde asignar la Merma en Saneamiento se asignara al 1er Material Utilizado Contador: '||rBOBIMAQU_B.Contador||' ContBobi: '||rBOBIMAQU_B.ContBobi||' Articulo: '||rBOBIMAQU_B.Tip_Arti||'-'||rBOBIMAQU_B.Cod_Arti||' Lote: '||rBOBIMAQU_B.Lote||', Datos de la Merma DESDE: '||rMERMA.DESDE||' HASTA: '||rMERMA.HASTA||' MERMA: '||rMERMA.MERMA||'|51','R','A');
                     --dbms_output.put_line('Error: No se asigno la Merma de Saneamiento en los Materiales Utilizados para la Bobina '||rBOBIMAQU_B.Empresa||'-'||rBOBIMAQU_B.NumeOtre||'-'||rBOBIMAQU_B.Contador||'-'||rBOBIMAQU_B.ContBobi||'-'||rBOBIMAQU_B.Tip_Arti||'-'||rBOBIMAQU_B.Cod_Arti||'-'||rBOBIMAQU_B.Lote||', Datos de la Merma DESDE: '||rMERMA.DESDE||' HASTA: '||rMERMA.HASTA||' MERMA: '||rMERMA.MERMA||', Se Asignara al Primer Material Utilizado');
                     --
                     IF NVL(rBOBIMAQU_B.MERMSANE,0) > 0 THEN
                        --Se busca el 1er Material Consumido en las Pasadas para asignarle valores 
                        rMaterial_B1 := F_MATERIAL(rBOBIMAQU_B.EMPRESA, rBOBIMAQU_B.NUMEOTRE, rBOBIMAQU_B.CONTADOR, 
                                                  NULL, NULL, NULL,
                                                  1, 1);
                        --
                        rMaterial_B2 := F_MATERIAL(rBOBIMAQU_B.EMPRESA, rBOBIMAQU_B.NUMEOTRE, rBOBIMAQU_B.CONTADOR, 
                                                  NULL, NULL, NULL,
                                                  2, 1);
                        --
                        IF rMaterial_B1.IDENTIFICADOR IS NOT NULL THEN
                           --Se confronta el Ancho de la Bobina contra el Ancho del Material
                           IF rMaterial_B1.ANCHO_BUENO_TOTAL IS NOT NULL AND rBOBIMAQU_B.ANCHO_BUENO IS NOT NULL THEN
                              IF rMaterial_B1.ANCHO_BUENO_TOTAL = rBOBIMAQU_B.ANCHO_BUENO THEN
                                 --Actualizaci¿e Mermas
                                 P_MATERIAL(rMaterial_B1,'U',
                                            NULL,--nCantProd
                                            NULL,--nCantCons_E
                                            NULL,--nCantCons
                                            NULL,--nCantAjus
                                            NULL,--nAncho
                                            NULL,--nFACTOR_CONVERSION_M2_KG
                                            NULL,--nPrecio_ML_E
                                            NULL,--vLog_Precio
                                            NULL,--nMermEnhe_E
                                            NULL,--nMermEnhe
                                            NULL,--nMermAjus_E
                                            NULL,--nMermAjus
                                            NULL,--nMermCabo_E
                                            NULL,--nMermCabo
                                            NULL,--nMermPico_E
                                            NULL,--nMermPico
                                            NULL,--nMermTita
                                            (NVL(rMERMA.Merma,0) - NVL(nMermaAsignada,0)),--nMermSane
                                            NULL,--nCantCons_Bobinas
                                            --
                                             NULL, --nCONTFSMU_01 
                                             NULL, --nCANTFSMU_01 
                                             NULL, --nCATOFSMU 
                                             NULL, --nCONTFSMU_02 
                                             NULL, --nCANTFSMU_02 
                                             NULL, --nCONTFSMU_03 
                                             NULL, --nCANTFSMU_03 
                                             NULL, --nCONTFSMU_04 
                                             NULL, --nCANTFSMU_04 
                                             NULL, --nCONTFSMU_05 
                                             NULL, --nCANTFSMU_05 
                                             NULL, --nCONTFSMU_06 
                                             NULL, --nCANTFSMU_06 
                                             NULL, --nCONTFSMU_07 
                                             NULL, --nCANTFSMU_07 
                                             NULL, --nCONTFSMU_08 
                                             NULL, --nCANTFSMU_08 
                                             NULL, --nCONTFSMU_09 
                                             NULL, --nCANTFSMU_09 
                                             NULL, --nCONTFSMU_10 
                                             NULL, --nCANTFSMU_10 
                                             NULL, --nANCHO_BUENO_TOTAL_01 
                                             NULL, --nANCHO_BUENO_OT_01 
                                             NULL, --nANCHO_BUENO_TOTAL_02 
                                             NULL, --nANCHO_BUENO_OT_02 
                                             NULL, --nANCHO_BUENO_TOTAL_03 
                                             NULL, --nANCHO_BUENO_OT_03 
                                             NULL, --nANCHO_BUENO_TOTAL_04 
                                             NULL, --nANCHO_BUENO_OT_04 
                                             NULL, --nANCHO_BUENO_TOTAL_05 
                                             NULL, --nANCHO_BUENO_OT_05 
                                             NULL, --nANCHO_BUENO_TOTAL_06 
                                             NULL, --nANCHO_BUENO_OT_06 
                                             NULL, --nANCHO_BUENO_TOTAL_07 
                                             NULL, --nANCHO_BUENO_OT_07 
                                             NULL, --nANCHO_BUENO_TOTAL_08 
                                             NULL, --nANCHO_BUENO_OT_08 
                                             NULL, --nANCHO_BUENO_TOTAL_09 
                                             NULL, --nANCHO_BUENO_OT_09 
                                             NULL, --nANCHO_BUENO_TOTAL_10 
                                             NULL, --nANCHO_BUENO_OT_10 
                                             NULL, --nANCHO_BUENO_TOTAL 
                                             NULL, --nANCHO_BUENO_OT 
                                             NULL, --nNUMECORT 
                                             NULL, --nMM_MERMPRCO_01 
                                             NULL, --nMM_MERMPLAN_EXESO_01 
                                             NULL, --nMM_MERMPLAN_01 
                                             NULL, --nMM_MERMPRCO_02 
                                             NULL, --nMM_MERMPLAN_EXESO_02 
                                             NULL, --nMM_MERMPLAN_02 
                                             NULL, --nMM_MERMPRCO_03 
                                             NULL, --nMM_MERMPLAN_EXESO_03 
                                             NULL, --nMM_MERMPLAN_03 
                                             NULL, --nMM_MERMPRCO_04 
                                             NULL, --nMM_MERMPLAN_EXESO_04 
                                             NULL, --nMM_MERMPLAN_04 
                                             NULL, --nMM_MERMPRCO_05 
                                             NULL, --nMM_MERMPLAN_EXESO_05 
                                             NULL, --nMM_MERMPLAN_05 
                                             NULL, --nMM_MERMPRCO_06 
                                             NULL, --nMM_MERMPLAN_EXESO_06 
                                             NULL, --nMM_MERMPLAN_06 
                                             NULL, --nMM_MERMPRCO_07 
                                             NULL, --nMM_MERMPLAN_EXESO_07 
                                             NULL, --nMM_MERMPLAN_07 
                                             NULL, --nMM_MERMPRCO_08 
                                             NULL, --nMM_MERMPLAN_EXESO_08 
                                             NULL, --nMM_MERMPLAN_08 
                                             NULL, --nMM_MERMPRCO_09 
                                             NULL, --nMM_MERMPLAN_EXESO_09 
                                             NULL, --nMM_MERMPLAN_09 
                                             NULL, --nMM_MERMPRCO_10 
                                             NULL, --nMM_MERMPLAN_EXESO_10 
                                             NULL, --nMM_MERMPLAN_10 
                                             NULL, --nMM_MERMPRCO 
                                             NULL, --nMM_MERMPLAN_EXESO 
                                             NULL); --nMM_MERMPLAN
                                 --t_MATERIAL(rMaterial_B1.IDENTIFICADOR).MermSane := NVL(rMaterial_B1.MERMSANE,0) + (NVL(rMERMA.Merma,0) - NVL(nMermaAsignada,0));
                              ELSIF rMaterial_B1.ANCHO_BUENO_TOTAL > rBOBIMAQU_B.ANCHO_BUENO THEN
                                 nFactor := (NVL(rBOBIMAQU_B.ANCHO_BUENO,0) / 1000);--Convierte a M2 de Bobina
                                 --
                                 IF (NVL(rMaterial_B1.ANCHO_BUENO_TOTAL,0) / 1000) > 0 THEN
                                    nFactor := nFactor  / (NVL(rMaterial_B1.ANCHO_BUENO_TOTAL,0) / 1000);--Convierte los M2 de Bobina a ML de Material
                                 ELSE
                                    nFactor := 0;
                                    --606 No existe FC: @1. [Contador @2]
                                    P_ERRORES(vEmpresa, nNumeOtre, '606','Calculo de Factor de Conversion de la Bobina Contador: '||rBOBIMAQU_B.Contador||' ContBobi: '||rBOBIMAQU_B.ContBobi||' Articulo: '||rBOBIMAQU_B.Tip_Arti||'-'||rBOBIMAQU_B.Cod_Arti||' Lote: '||rBOBIMAQU_B.Lote||' Ancho Bueno: '||rBOBIMAQU_B.ANCHO_BUENO||' contra el Material '||rMaterial_B1.Tip_Arti||'-'||rMaterial_B1.Cod_Arti||' Lote: '||rMaterial_B1.Lote||' Ancho Bueno Total: '||rMaterial_B1.ANCHO_BUENO_TOTAL||'|52','R','E');
                                    --dbms_output.put_line('Error: Calculo de Factor de Conversion de la Bobina '||rBOBIMAQU_B.Empresa||'-'||rBOBIMAQU_B.NumeOtre||'-'||rBOBIMAQU_B.Contador||'-'||rBOBIMAQU_B.ContBobi||'-'||rBOBIMAQU_B.Tip_Arti||'-'||rBOBIMAQU_B.Cod_Arti||'-'||rBOBIMAQU_B.Lote||' Ancho: '||rBOBIMAQU_B.Ancho||
                                    --                     ' contra el Material '||rMaterial_B1.Tip_Arti||'-'||rMaterial_B1.Cod_Arti||'-'||rMaterial_B1.Lote||' Ancho: '||rMaterial_B1.ANCHO);
                                 END IF;
                                 --
--dbms_output.put_line('3_> Articulo: '||rMaterial_B1.Tip_Arti||'-'||rMaterial_B1.Cod_Arti||' Lote: '||rMaterial_B1.Lote||' Ancho Bueno Total: '||rMaterial_B1.ANCHO_BUENO_TOTAL||'-> '||NVL(rMaterial_B1.MERMSANE,0)||' + (('||NVL(rMERMA.Merma,0)||' - '||NVL(nMermaAsignada,0)||') * '||nFactor||')');
                                 P_MATERIAL(rMaterial_B1,'U',
                                            NULL,--nCantProd
                                            NULL,--nCantCons_E
                                            NULL,--nCantCons
                                            NULL,--nCantAjus
                                            NULL,--nAncho
                                            NULL,--nFACTOR_CONVERSION_M2_KG
                                            NULL,--nPrecio_ML_E
                                            NULL,--vLog_Precio
                                            NULL,--nMermEnhe_E
                                            NULL,--nMermEnhe
                                            NULL,--nMermAjus_E
                                            NULL,--nMermAjus
                                            NULL,--nMermCabo_E
                                            NULL,--nMermCabo
                                            NULL,--nMermPico_E
                                            NULL,--nMermPico
                                            NULL,--nMermTita
                                            ((NVL(rMERMA.Merma,0) - NVL(nMermaAsignada,0)) * nFactor),--nMermSane
                                            NULL,--nCantCons_Bobinas
                                            --
                                             NULL, --nCONTFSMU_01 
                                             NULL, --nCANTFSMU_01 
                                             NULL, --nCATOFSMU 
                                             NULL, --nCONTFSMU_02 
                                             NULL, --nCANTFSMU_02 
                                             NULL, --nCONTFSMU_03 
                                             NULL, --nCANTFSMU_03 
                                             NULL, --nCONTFSMU_04 
                                             NULL, --nCANTFSMU_04 
                                             NULL, --nCONTFSMU_05 
                                             NULL, --nCANTFSMU_05 
                                             NULL, --nCONTFSMU_06 
                                             NULL, --nCANTFSMU_06 
                                             NULL, --nCONTFSMU_07 
                                             NULL, --nCANTFSMU_07 
                                             NULL, --nCONTFSMU_08 
                                             NULL, --nCANTFSMU_08 
                                             NULL, --nCONTFSMU_09 
                                             NULL, --nCANTFSMU_09 
                                             NULL, --nCONTFSMU_10 
                                             NULL, --nCANTFSMU_10 
                                             NULL, --nANCHO_BUENO_TOTAL_01 
                                             NULL, --nANCHO_BUENO_OT_01 
                                             NULL, --nANCHO_BUENO_TOTAL_02 
                                             NULL, --nANCHO_BUENO_OT_02 
                                             NULL, --nANCHO_BUENO_TOTAL_03 
                                             NULL, --nANCHO_BUENO_OT_03 
                                             NULL, --nANCHO_BUENO_TOTAL_04 
                                             NULL, --nANCHO_BUENO_OT_04 
                                             NULL, --nANCHO_BUENO_TOTAL_05 
                                             NULL, --nANCHO_BUENO_OT_05 
                                             NULL, --nANCHO_BUENO_TOTAL_06 
                                             NULL, --nANCHO_BUENO_OT_06 
                                             NULL, --nANCHO_BUENO_TOTAL_07 
                                             NULL, --nANCHO_BUENO_OT_07 
                                             NULL, --nANCHO_BUENO_TOTAL_08 
                                             NULL, --nANCHO_BUENO_OT_08 
                                             NULL, --nANCHO_BUENO_TOTAL_09 
                                             NULL, --nANCHO_BUENO_OT_09 
                                             NULL, --nANCHO_BUENO_TOTAL_10 
                                             NULL, --nANCHO_BUENO_OT_10 
                                             NULL, --nANCHO_BUENO_TOTAL 
                                             NULL, --nANCHO_BUENO_OT 
                                             NULL, --nNUMECORT 
                                             NULL, --nMM_MERMPRCO_01 
                                             NULL, --nMM_MERMPLAN_EXESO_01 
                                             NULL, --nMM_MERMPLAN_01 
                                             NULL, --nMM_MERMPRCO_02 
                                             NULL, --nMM_MERMPLAN_EXESO_02 
                                             NULL, --nMM_MERMPLAN_02 
                                             NULL, --nMM_MERMPRCO_03 
                                             NULL, --nMM_MERMPLAN_EXESO_03 
                                             NULL, --nMM_MERMPLAN_03 
                                             NULL, --nMM_MERMPRCO_04 
                                             NULL, --nMM_MERMPLAN_EXESO_04 
                                             NULL, --nMM_MERMPLAN_04 
                                             NULL, --nMM_MERMPRCO_05 
                                             NULL, --nMM_MERMPLAN_EXESO_05 
                                             NULL, --nMM_MERMPLAN_05 
                                             NULL, --nMM_MERMPRCO_06 
                                             NULL, --nMM_MERMPLAN_EXESO_06 
                                             NULL, --nMM_MERMPLAN_06 
                                             NULL, --nMM_MERMPRCO_07 
                                             NULL, --nMM_MERMPLAN_EXESO_07 
                                             NULL, --nMM_MERMPLAN_07 
                                             NULL, --nMM_MERMPRCO_08 
                                             NULL, --nMM_MERMPLAN_EXESO_08 
                                             NULL, --nMM_MERMPLAN_08 
                                             NULL, --nMM_MERMPRCO_09 
                                             NULL, --nMM_MERMPLAN_EXESO_09 
                                             NULL, --nMM_MERMPLAN_09 
                                             NULL, --nMM_MERMPRCO_10 
                                             NULL, --nMM_MERMPLAN_EXESO_10 
                                             NULL, --nMM_MERMPLAN_10 
                                             NULL, --nMM_MERMPRCO 
                                             NULL, --nMM_MERMPLAN_EXESO 
                                             NULL); --nMM_MERMPLAN
                                 --t_MATERIAL(rMaterial_B1.IDENTIFICADOR).MermSane := NVL(rMaterial_B1.MERMSANE,0) + ((NVL(rMERMA.Merma,0) - NVL(nMermaAsignada,0)) * nFactor);
                              ELSE
                                 --647 No se encuentra @1. [Contador @2]
                                 P_ERRORES(vEmpresa, nNumeOtre, '647','8-Calculo de Anchos de Material y Bobina: El Ancho en la Bobina Contador: '||rBOBIMAQU_B.Contador||' ContBobi: '||rBOBIMAQU_B.ContBobi||' Articulo: '||rBOBIMAQU_B.Tip_Arti||'-'||rBOBIMAQU_B.Cod_Arti||' Lote: '||rBOBIMAQU_B.Lote||' Ancho Bueno: '||rBOBIMAQU_B.ANCHO_BUENO||' es mayor al Ancho en el Material '||rMaterial_B1.Tip_Arti||'-'||rMaterial_B1.Cod_Arti||' Lote: '||rMaterial_B1.Lote||' Ancho Bueno Total: '||rMaterial_B1.ANCHO_BUENO_TOTAL||'|53','R','E');
                                 --dbms_output.put_line('Error: El Ancho en la Bobina '||rBOBIMAQU_B.Empresa||'-'||rBOBIMAQU_B.NumeOtre||'-'||rBOBIMAQU_B.Contador||'-'||rBOBIMAQU_B.ContBobi||'-'||rBOBIMAQU_B.Tip_Arti||'-'||rBOBIMAQU_B.Cod_Arti||'-'||rBOBIMAQU_B.Lote||' Ancho: '||rBOBIMAQU_B.Ancho||
                                 --                     ' es mayor al Ancho en el Material '||rMaterial_B1.Tip_Arti||'-'||rMaterial_B1.Cod_Arti||'-'||rMaterial_B1.Lote||' Ancho: '||rMaterial_B1.ANCHO);
                              END IF;
                           ELSE
                              --Error
                              IF rMaterial_B1.ANCHO_BUENO_TOTAL IS NULL THEN
                                 --647 No se encuentra @1. [Contador @2]
                                 P_ERRORES(vEmpresa, nNumeOtre, '647','el Ancho Bueno Total en el Material Contador: '||rMaterial_B1.Contador||' Articulo: '||rMaterial_B1.Tip_Arti||'-'||rMaterial_B1.Cod_Arti||' Lote: '||rMaterial_B1.Lote||'|54','R','E');
                                 --dbms_output.put_line('Error: No se encuentra el Ancho en el Material '||rMaterial_B1.Empresa||'-'||rMaterial_B1.NumeOtre||'-'||rMaterial_B1.Contador||'-'||rMaterial_B1.Tip_Arti||'-'||rMaterial_B1.Cod_Arti||'-'||rMaterial_B1.Lote);
                              ELSIF rBOBIMAQU_B.ANCHO_BUENO IS NULL THEN
                                 --647 No se encuentra @1. [Contador @2]
                                 P_ERRORES(vEmpresa, nNumeOtre, '647','el Ancho Bueno en la Bobina Contador: '||rBOBIMAQU_B.Contador||' ContBobi: '||rBOBIMAQU_B.ContBobi||' Articulo: '||rBOBIMAQU_B.Tip_Arti||'-'||rBOBIMAQU_B.Cod_Arti||' Lote: '||rBOBIMAQU_B.Lote||'|55','R','E');
                                 --dbms_output.put_line('Error: No se encuentra el Ancho en la Bobina '||rBOBIMAQU_B.Empresa||'-'||rBOBIMAQU_B.NumeOtre||'-'||rBOBIMAQU_B.Contador||'-'||rBOBIMAQU_B.ContBobi||'-'||rBOBIMAQU_B.Tip_Arti||'-'||rBOBIMAQU_B.Cod_Arti||'-'||rBOBIMAQU_B.Lote);
                              END IF;
                           END IF;
                        END IF;
                        --
                        IF rMaterial_B2.IDENTIFICADOR IS NOT NULL THEN
                           --Se confronta el Ancho de la Bobina contra el Ancho del Material
                           /*NOTA POR ADICION DE ANCHO BUENO TOTAL
                                - SI EL ANCHO DEL MATERIAL ES MAYOR O IGUAL QUE EL DE LA BOBINA Y (NO ES BOBINA DE PRE-CORTE O ES DE PRE-CORTE Y ES DE UN SOLO CORTE)
                                - SI EL ANCHO DEL MATERIAL ES MAYIR AL DE LA BOBUNA SE TRATARA CON EL FACTOR DE EQUIVALENCIA EN ML TOMADO DE LA RELACION DE ML->M2 DE LA BOBINA CONTRA LOS ML->M2 DEL MATERIAL (PERO USANDO EL ANCHO_BUENO_TOTAL DEL MATERIAL)
                           */
                           IF rMaterial_B2.ANCHO_BUENO_TOTAL IS NOT NULL AND rBOBIMAQU_B.ANCHO_BUENO IS NOT NULL THEN
                              IF rMaterial_B2.ANCHO_BUENO_TOTAL = rBOBIMAQU_B.ANCHO_BUENO THEN
                                 --Actualizaci¿e Mermas
                                 P_MATERIAL(rMaterial_B2,'U',
                                            NULL,--nCantProd
                                            NULL,--nCantCons_E
                                            NULL,--nCantCons
                                            NULL,--nCantAjus
                                            NULL,--nAncho
                                            NULL,--nFACTOR_CONVERSION_M2_KG
                                            NULL,--nPrecio_ML_E
                                            NULL,--vLog_Precio
                                            NULL,--nMermEnhe_E
                                            NULL,--nMermEnhe
                                            NULL,--nMermAjus_E
                                            NULL,--nMermAjus
                                            NULL,--nMermCabo_E
                                            NULL,--nMermCabo
                                            NULL,--nMermPico_E
                                            NULL,--nMermPico
                                            NULL,--nMermTita
                                            (NVL(rMERMA.Merma,0) - NVL(nMermaAsignada,0)),--nMermSane
                                            NULL,--nCantCons_Bobinas
                                            --
                                             NULL, --nCONTFSMU_01 
                                             NULL, --nCANTFSMU_01 
                                             NULL, --nCATOFSMU 
                                             NULL, --nCONTFSMU_02 
                                             NULL, --nCANTFSMU_02 
                                             NULL, --nCONTFSMU_03 
                                             NULL, --nCANTFSMU_03 
                                             NULL, --nCONTFSMU_04 
                                             NULL, --nCANTFSMU_04 
                                             NULL, --nCONTFSMU_05 
                                             NULL, --nCANTFSMU_05 
                                             NULL, --nCONTFSMU_06 
                                             NULL, --nCANTFSMU_06 
                                             NULL, --nCONTFSMU_07 
                                             NULL, --nCANTFSMU_07 
                                             NULL, --nCONTFSMU_08 
                                             NULL, --nCANTFSMU_08 
                                             NULL, --nCONTFSMU_09 
                                             NULL, --nCANTFSMU_09 
                                             NULL, --nCONTFSMU_10 
                                             NULL, --nCANTFSMU_10 
                                             NULL, --nANCHO_BUENO_TOTAL_01 
                                             NULL, --nANCHO_BUENO_OT_01 
                                             NULL, --nANCHO_BUENO_TOTAL_02 
                                             NULL, --nANCHO_BUENO_OT_02 
                                             NULL, --nANCHO_BUENO_TOTAL_03 
                                             NULL, --nANCHO_BUENO_OT_03 
                                             NULL, --nANCHO_BUENO_TOTAL_04 
                                             NULL, --nANCHO_BUENO_OT_04 
                                             NULL, --nANCHO_BUENO_TOTAL_05 
                                             NULL, --nANCHO_BUENO_OT_05 
                                             NULL, --nANCHO_BUENO_TOTAL_06 
                                             NULL, --nANCHO_BUENO_OT_06 
                                             NULL, --nANCHO_BUENO_TOTAL_07 
                                             NULL, --nANCHO_BUENO_OT_07 
                                             NULL, --nANCHO_BUENO_TOTAL_08 
                                             NULL, --nANCHO_BUENO_OT_08 
                                             NULL, --nANCHO_BUENO_TOTAL_09 
                                             NULL, --nANCHO_BUENO_OT_09 
                                             NULL, --nANCHO_BUENO_TOTAL_10 
                                             NULL, --nANCHO_BUENO_OT_10 
                                             NULL, --nANCHO_BUENO_TOTAL 
                                             NULL, --nANCHO_BUENO_OT 
                                             NULL, --nNUMECORT 
                                             NULL, --nMM_MERMPRCO_01 
                                             NULL, --nMM_MERMPLAN_EXESO_01 
                                             NULL, --nMM_MERMPLAN_01 
                                             NULL, --nMM_MERMPRCO_02 
                                             NULL, --nMM_MERMPLAN_EXESO_02 
                                             NULL, --nMM_MERMPLAN_02 
                                             NULL, --nMM_MERMPRCO_03 
                                             NULL, --nMM_MERMPLAN_EXESO_03 
                                             NULL, --nMM_MERMPLAN_03 
                                             NULL, --nMM_MERMPRCO_04 
                                             NULL, --nMM_MERMPLAN_EXESO_04 
                                             NULL, --nMM_MERMPLAN_04 
                                             NULL, --nMM_MERMPRCO_05 
                                             NULL, --nMM_MERMPLAN_EXESO_05 
                                             NULL, --nMM_MERMPLAN_05 
                                             NULL, --nMM_MERMPRCO_06 
                                             NULL, --nMM_MERMPLAN_EXESO_06 
                                             NULL, --nMM_MERMPLAN_06 
                                             NULL, --nMM_MERMPRCO_07 
                                             NULL, --nMM_MERMPLAN_EXESO_07 
                                             NULL, --nMM_MERMPLAN_07 
                                             NULL, --nMM_MERMPRCO_08 
                                             NULL, --nMM_MERMPLAN_EXESO_08 
                                             NULL, --nMM_MERMPLAN_08 
                                             NULL, --nMM_MERMPRCO_09 
                                             NULL, --nMM_MERMPLAN_EXESO_09 
                                             NULL, --nMM_MERMPLAN_09 
                                             NULL, --nMM_MERMPRCO_10 
                                             NULL, --nMM_MERMPLAN_EXESO_10 
                                             NULL, --nMM_MERMPLAN_10 
                                             NULL, --nMM_MERMPRCO 
                                             NULL, --nMM_MERMPLAN_EXESO 
                                             NULL); --nMM_MERMPLAN
                                 --t_MATERIAL(rMaterial_B2.IDENTIFICADOR).MermSane := NVL(rMaterial_B2.MERMSANE,0) + (NVL(rMERMA.Merma,0) - NVL(nMermaAsignada,0));
                              ELSIF rMaterial_B2.ANCHO_BUENO_TOTAL > rBOBIMAQU_B.ANCHO_BUENO THEN
                                 nFactor := (NVL(rBOBIMAQU_B.ANCHO_BUENO,0) / 1000);--Convierte a M2 de Bobina
                                 --
                                 IF (NVL(rMaterial_B2.ANCHO_BUENO_TOTAL,0) / 1000) > 0 THEN
                                    nFactor := nFactor  / (NVL(rMaterial_B2.ANCHO_BUENO_TOTAL,0) / 1000);--Convierte los M2 de Bobina a ML de Material
                                 ELSE
                                    nFactor := 0;
                                    --606 No existe FC: @1. [Contador @2]
                                    P_ERRORES(vEmpresa, nNumeOtre, '606','Calculo de Factor de Conversion de la Bobina Contador: '||rBOBIMAQU_B.Contador||' ContBobi: '||rBOBIMAQU_B.ContBobi||' Articulo: '||rBOBIMAQU_B.Tip_Arti||'-'||rBOBIMAQU_B.Cod_Arti||' Lote: '||rBOBIMAQU_B.Lote||' Ancho Bueno: '||rBOBIMAQU_B.ANCHO_BUENO||' contra el Material '||rMaterial_B2.Tip_Arti||'-'||rMaterial_B2.Cod_Arti||' Lote: '||rMaterial_B2.Lote||' Ancho Bueno Total: '||rMaterial_B2.ANCHO_BUENO_TOTAL||'|56','R','E');
                                    --dbms_output.put_line('Error: Calculo de Factor de Conversion de la Bobina '||rBOBIMAQU_B.Empresa||'-'||rBOBIMAQU_B.NumeOtre||'-'||rBOBIMAQU_B.Contador||'-'||rBOBIMAQU_B.ContBobi||'-'||rBOBIMAQU_B.Tip_Arti||'-'||rBOBIMAQU_B.Cod_Arti||'-'||rBOBIMAQU_B.Lote||' Ancho: '||rBOBIMAQU_B.Ancho||
                                    --                     ' contra el Material '||rMaterial_B2.Tip_Arti||'-'||rMaterial_B2.Cod_Arti||'-'||rMaterial_B2.Lote||' Ancho: '||rMaterial_B2.ANCHO);
                                 END IF;
                                 --
--dbms_output.put_line('4_>'||NVL(rMaterial_B2.MERMSANE,0)||' + (('||NVL(rMERMA.Merma,0)||' - '||NVL(nMermaAsignada,0)||') * '||nFactor||')');
                                 P_MATERIAL(rMaterial_B2,'U',
                                            NULL,--nCantProd
                                            NULL,--nCantCons_E
                                            NULL,--nCantCons
                                            NULL,--nCantAjus
                                            NULL,--nAncho
                                            NULL,--nFACTOR_CONVERSION_M2_KG
                                            NULL,--nPrecio_ML_E
                                            NULL,--vLog_Precio
                                            NULL,--nMermEnhe_E
                                            NULL,--nMermEnhe
                                            NULL,--nMermAjus_E
                                            NULL,--nMermAjus
                                            NULL,--nMermCabo_E
                                            NULL,--nMermCabo
                                            NULL,--nMermPico_E
                                            NULL,--nMermPico
                                            NULL,--nMermTita
                                            ((NVL(rMERMA.Merma,0) - NVL(nMermaAsignada,0)) * nFactor),--nMermSane
                                            NULL,--nCantCons_Bobinas
                                            --
                                             NULL, --nCONTFSMU_01 
                                             NULL, --nCANTFSMU_01 
                                             NULL, --nCATOFSMU 
                                             NULL, --nCONTFSMU_02 
                                             NULL, --nCANTFSMU_02 
                                             NULL, --nCONTFSMU_03 
                                             NULL, --nCANTFSMU_03 
                                             NULL, --nCONTFSMU_04 
                                             NULL, --nCANTFSMU_04 
                                             NULL, --nCONTFSMU_05 
                                             NULL, --nCANTFSMU_05 
                                             NULL, --nCONTFSMU_06 
                                             NULL, --nCANTFSMU_06 
                                             NULL, --nCONTFSMU_07 
                                             NULL, --nCANTFSMU_07 
                                             NULL, --nCONTFSMU_08 
                                             NULL, --nCANTFSMU_08 
                                             NULL, --nCONTFSMU_09 
                                             NULL, --nCANTFSMU_09 
                                             NULL, --nCONTFSMU_10 
                                             NULL, --nCANTFSMU_10 
                                             NULL, --nANCHO_BUENO_TOTAL_01 
                                             NULL, --nANCHO_BUENO_OT_01 
                                             NULL, --nANCHO_BUENO_TOTAL_02 
                                             NULL, --nANCHO_BUENO_OT_02 
                                             NULL, --nANCHO_BUENO_TOTAL_03 
                                             NULL, --nANCHO_BUENO_OT_03 
                                             NULL, --nANCHO_BUENO_TOTAL_04 
                                             NULL, --nANCHO_BUENO_OT_04 
                                             NULL, --nANCHO_BUENO_TOTAL_05 
                                             NULL, --nANCHO_BUENO_OT_05 
                                             NULL, --nANCHO_BUENO_TOTAL_06 
                                             NULL, --nANCHO_BUENO_OT_06 
                                             NULL, --nANCHO_BUENO_TOTAL_07 
                                             NULL, --nANCHO_BUENO_OT_07 
                                             NULL, --nANCHO_BUENO_TOTAL_08 
                                             NULL, --nANCHO_BUENO_OT_08 
                                             NULL, --nANCHO_BUENO_TOTAL_09 
                                             NULL, --nANCHO_BUENO_OT_09 
                                             NULL, --nANCHO_BUENO_TOTAL_10 
                                             NULL, --nANCHO_BUENO_OT_10 
                                             NULL, --nANCHO_BUENO_TOTAL 
                                             NULL, --nANCHO_BUENO_OT 
                                             NULL, --nNUMECORT 
                                             NULL, --nMM_MERMPRCO_01 
                                             NULL, --nMM_MERMPLAN_EXESO_01 
                                             NULL, --nMM_MERMPLAN_01 
                                             NULL, --nMM_MERMPRCO_02 
                                             NULL, --nMM_MERMPLAN_EXESO_02 
                                             NULL, --nMM_MERMPLAN_02 
                                             NULL, --nMM_MERMPRCO_03 
                                             NULL, --nMM_MERMPLAN_EXESO_03 
                                             NULL, --nMM_MERMPLAN_03 
                                             NULL, --nMM_MERMPRCO_04 
                                             NULL, --nMM_MERMPLAN_EXESO_04 
                                             NULL, --nMM_MERMPLAN_04 
                                             NULL, --nMM_MERMPRCO_05 
                                             NULL, --nMM_MERMPLAN_EXESO_05 
                                             NULL, --nMM_MERMPLAN_05 
                                             NULL, --nMM_MERMPRCO_06 
                                             NULL, --nMM_MERMPLAN_EXESO_06 
                                             NULL, --nMM_MERMPLAN_06 
                                             NULL, --nMM_MERMPRCO_07 
                                             NULL, --nMM_MERMPLAN_EXESO_07 
                                             NULL, --nMM_MERMPLAN_07 
                                             NULL, --nMM_MERMPRCO_08 
                                             NULL, --nMM_MERMPLAN_EXESO_08 
                                             NULL, --nMM_MERMPLAN_08 
                                             NULL, --nMM_MERMPRCO_09 
                                             NULL, --nMM_MERMPLAN_EXESO_09 
                                             NULL, --nMM_MERMPLAN_09 
                                             NULL, --nMM_MERMPRCO_10 
                                             NULL, --nMM_MERMPLAN_EXESO_10 
                                             NULL, --nMM_MERMPLAN_10 
                                             NULL, --nMM_MERMPRCO 
                                             NULL, --nMM_MERMPLAN_EXESO 
                                             NULL); --nMM_MERMPLAN
                                 --t_MATERIAL(rMaterial_B2.IDENTIFICADOR).MermSane := NVL(rMaterial_B2.MERMSANE,0) + ((NVL(rMERMA.Merma,0) - NVL(nMermaAsignada,0)) * nFactor);
                              ELSE
                                 --647 No se encuentra @1. [Contador @2]
                                 P_ERRORES(vEmpresa, nNumeOtre, '647','9-Calculo de Anchos de Material y Bobina: El Ancho en la Bobina Contador: '||rBOBIMAQU_B.Contador||' ContBobi: '||rBOBIMAQU_B.ContBobi||' Articulo: '||rBOBIMAQU_B.Tip_Arti||'-'||rBOBIMAQU_B.Cod_Arti||' Lote: '||rBOBIMAQU_B.Lote||' Ancho Bueno: '||rBOBIMAQU_B.ANCHO_BUENO||' es mayor al Ancho en el Material '||rMaterial_B2.Tip_Arti||'-'||rMaterial_B2.Cod_Arti||' Lote: '||rMaterial_B2.Lote||' Ancho Bueno Total: '||rMaterial_B2.ANCHO_BUENO_TOTAL||'|57','R','E');
                                 --dbms_output.put_line('Error: El Ancho en la Bobina '||rBOBIMAQU_B.Empresa||'-'||rBOBIMAQU_B.NumeOtre||'-'||rBOBIMAQU_B.Contador||'-'||rBOBIMAQU_B.ContBobi||'-'||rBOBIMAQU_B.Tip_Arti||'-'||rBOBIMAQU_B.Cod_Arti||'-'||rBOBIMAQU_B.Lote||' Ancho: '||rBOBIMAQU_B.Ancho||
                                 --                     ' es mayor al Ancho en el Material '||rMaterial_B2.Tip_Arti||'-'||rMaterial_B2.Cod_Arti||'-'||rMaterial_B2.Lote||' Ancho: '||rMaterial_B2.ANCHO);
                              END IF;
                           ELSE
                              --Error
                              IF rMaterial_B2.ANCHO_BUENO_TOTAL IS NULL THEN
                                 --647 No se encuentra @1. [Contador @2]
                                 P_ERRORES(vEmpresa, nNumeOtre, '647','el Ancho Bueno Total en el Material Contador: '||rMaterial_B2.Contador||' Articulo: '||rMaterial_B2.Tip_Arti||'-'||rMaterial_B2.Cod_Arti||' Lote: '||rMaterial_B2.Lote||'|58','R','E');
                                 --dbms_output.put_line('Error: No se encuentra el Ancho en el Material '||rMaterial_B2.Empresa||'-'||rMaterial_B2.NumeOtre||'-'||rMaterial_B2.Contador||'-'||rMaterial_B2.Tip_Arti||'-'||rMaterial_B2.Cod_Arti||'-'||rMaterial_B2.Lote);
                              ELSIF rBOBIMAQU_B.ANCHO_BUENO IS NULL THEN
                                 --647 No se encuentra @1. [Contador @2]
                                 P_ERRORES(vEmpresa, nNumeOtre, '647','el Ancho Bueno en la Bobina Contador: '||rBOBIMAQU_B.Contador||' ContBobi: '||rBOBIMAQU_B.ContBobi||' Articulo: '||rBOBIMAQU_B.Tip_Arti||'-'||rBOBIMAQU_B.Cod_Arti||' Lote: '||rBOBIMAQU_B.Lote||'|59','R','E');
                                 --dbms_output.put_line('Error: No se encuentra el Ancho en la Bobina '||rBOBIMAQU_B.Empresa||'-'||rBOBIMAQU_B.NumeOtre||'-'||rBOBIMAQU_B.Contador||'-'||rBOBIMAQU_B.ContBobi||'-'||rBOBIMAQU_B.Tip_Arti||'-'||rBOBIMAQU_B.Cod_Arti||'-'||rBOBIMAQU_B.Lote);
                              END IF;
                           END IF;
                        END IF;
                     END IF;
                  END IF;
               END IF;
            END LOOP;
         END IF;
         --Busqueda de Precios de las Bobinas
         IF rBOBIMAQU_B.PRECIO_ML IS NULL THEN
            bExisMabo := FALSE;
            nCantTota := 0;
            nPrecTota := 0;
            nPrecTota_E := 0;
            --dbms_Output.put_line('Calculo de Precios de: '||vEmpresa||', '||vTip_Arti||', '||vCod_Arti||', '||vLote);     
            FOR rMateBobi IN cMateBobi(rBOBIMAQU_B.Empresa,rBOBIMAQU_B.NumeOtre,rBOBIMAQU_B.Contador,rBOBIMAQU_B.ContBobi,rBOBIMAQU_B.Tip_Arti) LOOP
               IF NOT (bExisMabo) THEN
                  bExisMabo := TRUE;
               END IF;
               --
               nCantTota := nCantTota + rMateBobi.CANTCONS;
               --
               IF rMateBobi.CoboBobi > 0 THEN --Se trata de una Bobina Generada
                  --dbms_Output.put_line('   *** Bobinas Materiales de Precios: '||rMateBobi.Empresa||', '||rMateBobi.Tip_Arti||', '||rMateBobi.Cod_Arti||', '||rMateBobi.Contador||'->'||'|EMPRBOBI:'||rMateBobi.EmprBobi||'|NUOTBOBI:'||rMateBobi.NuotBobi||'|CONTBOBI:'||rMateBobi.ContBobi||'|COBOBOBI:'||rMateBobi.CoboBobi||'|LOTE:'||rMateBobi.Lote);                          
                  rMaterial := F_MATERIAL(rMateBobi.Empresa, rMateBobi.NumeOtre, rMateBobi.Contador, 
                                          rMateBobi.Tip_Arti, rMateBobi.Cod_Arti, '|EMPRBOBI:'||rMateBobi.EmprBobi||'|NUOTBOBI:'||rMateBobi.NuotBobi||'|CONTBOBI:'||rMateBobi.ContBobi||'|COBOBOBI:'||rMateBobi.CoboBobi||'|LOTE:'||rMateBobi.Lote,
                                          NULL, NULL);
               ELSE --Es un material de Almacen
                  --dbms_Output.put_line('   *** Materiales de Precios: '||rMateBobi.Empresa||', '||rMateBobi.Tip_Arti||', '||rMateBobi.Cod_Arti||', '||rMateBobi.Contador||'->'||'|EMPRBOBI:'||rMateBobi.EmprBobi||'|NUOTBOBI:'||rMateBobi.NuotBobi||'|LOTE:'||rMateBobi.Lote);                                      
                  rMaterial := F_MATERIAL(rMateBobi.Empresa, rMateBobi.NumeOtre, rMateBobi.Contador, 
                                          rMateBobi.Tip_Arti, rMateBobi.Cod_Arti, '|EMPRBOBI:'||rMateBobi.EmprBobi||'|NUOTBOBI:'||rMateBobi.NuotBobi||'|LOTE:'||rMateBobi.Lote||
														'|COBOMATE:'||rMateBobi.ContBobi||'|BOBIMATE:'||rMateBobi.CoboBobi, -- 11-11-2016 Solo para materiales tipo M
                                          NULL, NULL);
               END IF;
               --
               IF rMaterial.PRECIO_ML IS NOT NULL THEN
                  IF rBOBIMAQU_B.Tip_Arti != vTiarCosc THEN --Solo si es la Bobina Madre de Pasada en el caso de Cortes
                     --Se actualiza la Cantidad consumida por las Bobinas
                     P_MATERIAL(rMaterial,'U',
                                NULL,--nCantProd
                                NULL,--nCantCons_E
                                NULL,--nCantCons
                                NULL,--nCantAjus
                                NULL,--nAncho
                                NULL,--nFACTOR_CONVERSION_M2_KG
                                NULL,--nPrecio_ML_E
                                NULL,--vLog_Precio
                                NULL,--nMermEnhe_E
                                NULL,--nMermEnhe
                                NULL,--nMermAjus_E
                                NULL,--nMermAjus
                                NULL,--nMermCabo_E
                                NULL,--nMermCabo
                                NULL,--nMermPico_E
                                NULL,--nMermPico
                                NULL,--nMermTita
                                NULL,--nMermSane
                                rMateBobi.CANTCONS,--nCantCons_Bobinas
                                --
                                 NULL, --nCONTFSMU_01 
                                 NULL, --nCANTFSMU_01 
                                 NULL, --nCATOFSMU 
                                 NULL, --nCONTFSMU_02 
                                 NULL, --nCANTFSMU_02 
                                 NULL, --nCONTFSMU_03 
                                 NULL, --nCANTFSMU_03 
                                 NULL, --nCONTFSMU_04 
                                 NULL, --nCANTFSMU_04 
                                 NULL, --nCONTFSMU_05 
                                 NULL, --nCANTFSMU_05 
                                 NULL, --nCONTFSMU_06 
                                 NULL, --nCANTFSMU_06 
                                 NULL, --nCONTFSMU_07 
                                 NULL, --nCANTFSMU_07 
                                 NULL, --nCONTFSMU_08 
                                 NULL, --nCANTFSMU_08 
                                 NULL, --nCONTFSMU_09 
                                 NULL, --nCANTFSMU_09 
                                 NULL, --nCONTFSMU_10 
                                 NULL, --nCANTFSMU_10 
                                 NULL, --nANCHO_BUENO_TOTAL_01 
                                 NULL, --nANCHO_BUENO_OT_01 
                                 NULL, --nANCHO_BUENO_TOTAL_02 
                                 NULL, --nANCHO_BUENO_OT_02 
                                 NULL, --nANCHO_BUENO_TOTAL_03 
                                 NULL, --nANCHO_BUENO_OT_03 
                                 NULL, --nANCHO_BUENO_TOTAL_04 
                                 NULL, --nANCHO_BUENO_OT_04 
                                 NULL, --nANCHO_BUENO_TOTAL_05 
                                 NULL, --nANCHO_BUENO_OT_05 
                                 NULL, --nANCHO_BUENO_TOTAL_06 
                                 NULL, --nANCHO_BUENO_OT_06 
                                 NULL, --nANCHO_BUENO_TOTAL_07 
                                 NULL, --nANCHO_BUENO_OT_07 
                                 NULL, --nANCHO_BUENO_TOTAL_08 
                                 NULL, --nANCHO_BUENO_OT_08 
                                 NULL, --nANCHO_BUENO_TOTAL_09 
                                 NULL, --nANCHO_BUENO_OT_09 
                                 NULL, --nANCHO_BUENO_TOTAL_10 
                                 NULL, --nANCHO_BUENO_OT_10 
                                 NULL, --nANCHO_BUENO_TOTAL 
                                 NULL, --nANCHO_BUENO_OT 
                                 NULL, --nNUMECORT 
                                 NULL, --nMM_MERMPRCO_01 
                                 NULL, --nMM_MERMPLAN_EXESO_01 
                                 NULL, --nMM_MERMPLAN_01 
                                 NULL, --nMM_MERMPRCO_02 
                                 NULL, --nMM_MERMPLAN_EXESO_02 
                                 NULL, --nMM_MERMPLAN_02 
                                 NULL, --nMM_MERMPRCO_03 
                                 NULL, --nMM_MERMPLAN_EXESO_03 
                                 NULL, --nMM_MERMPLAN_03 
                                 NULL, --nMM_MERMPRCO_04 
                                 NULL, --nMM_MERMPLAN_EXESO_04 
                                 NULL, --nMM_MERMPLAN_04 
                                 NULL, --nMM_MERMPRCO_05 
                                 NULL, --nMM_MERMPLAN_EXESO_05 
                                 NULL, --nMM_MERMPLAN_05 
                                 NULL, --nMM_MERMPRCO_06 
                                 NULL, --nMM_MERMPLAN_EXESO_06 
                                 NULL, --nMM_MERMPLAN_06 
                                 NULL, --nMM_MERMPRCO_07 
                                 NULL, --nMM_MERMPLAN_EXESO_07 
                                 NULL, --nMM_MERMPLAN_07 
                                 NULL, --nMM_MERMPRCO_08 
                                 NULL, --nMM_MERMPLAN_EXESO_08 
                                 NULL, --nMM_MERMPLAN_08 
                                 NULL, --nMM_MERMPRCO_09 
                                 NULL, --nMM_MERMPLAN_EXESO_09 
                                 NULL, --nMM_MERMPLAN_09 
                                 NULL, --nMM_MERMPRCO_10 
                                 NULL, --nMM_MERMPLAN_EXESO_10 
                                 NULL, --nMM_MERMPLAN_10 
                                 NULL, --nMM_MERMPRCO 
                                 NULL, --nMM_MERMPLAN_EXESO 
                                 NULL); --nMM_MERMPLAN
                     --t_MATERIAL(rMaterial.IDENTIFICADOR).CantCons_Bobinas := NVL(t_MATERIAL(rMaterial.IDENTIFICADOR).CantCons_Bobinas,0) + rMateBobi.CANTCONS;
                  END IF;
                  --dbms_Output.put_line('      --- Encuentra Precio: '||rMaterial.PRECIO_ML);
                  --dbms_Output.put_line('         --- Acumula nPrecTota2: '||nPrecTota||' + ('||rMateBobi.CANTCONS||' * '||rMaterial.PRECIO_ML||')');
                  nPrecTota := nPrecTota + (rMateBobi.CANTCONS * rMaterial.PRECIO_ML);
                  --dbms_Output.put_line('            --- nPrecTota: '||nPrecTota);
               ELSE
                  --No se puede establecer el precio para la MP: @1-@2. [Contador @3]
                  --Posiblemente no existen movimientos de entrada para este material valoradas a un precio	
                  --Realizar un movimiento Manual de Entrada valorado con precio y realizar un movimiento de Salida por la misma cantidad
                  IF rMateBobi.CoboBobi > 0 THEN --Se trata de una Bobina Generada
                     P_ERRORES(vEmpresa, nNumeOtre, '602','Contador: '||rMateBobi.Contador||' Articulo: '||rMateBobi.Tip_Arti||'-'||rMateBobi.Cod_Arti||' ContBobi: '||rMateBobi.ContBobi||' ContBobiGene: '||rMateBobi.CoboBobi||' Lote: '||rMateBobi.Lote||'|60.1','R','E');
                  ELSE
                     P_ERRORES(vEmpresa, nNumeOtre, '602','Contador: '||rMateBobi.Contador||' Articulo:'||rMateBobi.Tip_Arti||'-'||rMateBobi.Cod_Arti||' Lote: '||rMateBobi.Lote||'|60.2','R','E');
                  END IF;
                  --dbms_output.put_line('Error: 602 '||rMateBobi.Empresa||', '||rMateBobi.NumeOtre||', '||rMateBobi.Contador||', '||rMateBobi.Tip_Arti||', '||rMateBobi.Cod_Arti);
               END IF;
               --
               IF rMaterial.PRECIO_ML_E IS NOT NULL THEN
                  --dbms_Output.put_line('      --- Encuentra Precio Estandar: '||rMaterial.PRECIO_ML_E);
                  --dbms_Output.put_line('         --- Acumula nPrecTota_E2: '||nPrecTota_E||' + ('||rMateBobi.CANTCONS||' * '||rMaterial.PRECIO_ML_E||')');
                  nPrecTota_E := nPrecTota_E + (rMateBobi.CANTCONS * rMaterial.PRECIO_ML_E);
                  --dbms_Output.put_line('            --- nPrecTota: '||nPrecTota);
               ELSE
                  --No se puede establecer el precio para la MP: @1-@2. [Contador @3]
                  --Posiblemente no existen movimientos de entrada para este material valoradas a un precio	
                  --Realizar un movimiento Manual de Entrada valorado con precio y realizar un movimiento de Salida por la misma cantidad
                  IF rMateBobi.CoboBobi > 0 THEN --Se trata de una Bobina Generada
                     P_ERRORES(vEmpresa, nNumeOtre, '602','Contador: '||rMateBobi.Contador||' Articulo: '||rMateBobi.Tip_Arti||'-'||rMateBobi.Cod_Arti||' ContBobi: '||rMateBobi.ContBobi||' ContBobiGene: '||rMateBobi.CoboBobi||' Lote: '||rMateBobi.Lote||'|60.3','E','E');
                  ELSE
                     P_ERRORES(vEmpresa, nNumeOtre, '602','Contador: '||rMateBobi.Contador||' Articulo:'||rMateBobi.Tip_Arti||'-'||rMateBobi.Cod_Arti||' Lote: '||rMateBobi.Lote||'|60.4','E','E');
                  END IF;
                  --dbms_output.put_line('Error: 602 '||rMateBobi.Empresa||', '||rMateBobi.NumeOtre||', '||rMateBobi.Contador||', '||rMateBobi.Tip_Arti||', '||rMateBobi.Cod_Arti);
               END IF;
            END LOOP;
            --
            IF NOT (bExisMabo) THEN
               --No se puede establecer el precio para la MP: @1-@2. [Contador @3]	
               --Posiblemente no existen movimientos de entrada para este material valoradas a un precio	
               --Realizar un movimiento Manual de Entrada valorado con precio y realizar un movimiento de Salida por la misma cantidad
               P_ERRORES(vEmpresa, nNumeOtre, '602','de la Bobina Contador: '||rBOBIMAQU_B.Contador||' ContBobi: '||rBOBIMAQU_B.ContBobi||' Tipo Arti: '||rBOBIMAQU_B.Tip_Arti||'|No existen materiales de la Bobina|61','R','E');
               --dbms_output.put_line('Error: 602 '||rBOBIMAQU_B.Empresa||', '||rBOBIMAQU_B.NumeOtre||', '||rBOBIMAQU_B.Contador||', '||rBOBIMAQU_B.Contador);
            END IF;
            --
            IF NVL(nCantTota,0) != 0 THEN
               nPrecio := nPrecTota / nCantTota;
               nPrecio_E := nPrecTota_E / nCantTota;
               --dbms_Output.put_line('         --- Precio de Cantidades Utilizadas '||nPrecTota||' / '||nCantTota||' = '||nPrecio);                           
               --Si es un corte hay que calcular la parte proporcional a su ancho del precio
               IF rBOBIMAQU_B.Tip_Arti = vTiarCosc THEN
                  --dbms_Output.put_line('         --- Precio de Corte Total '||nPrecio);                           
                  --Se busca la Bobina Utilizada
                  rBOBIMAQU_U := F_BOBIMAQU(rBOBIMAQU_B.Empresa,rBOBIMAQU_B.NumeOtre,rBOBIMAQU_B.Contador,rBOBIMAQU_B.ContBobi);
                  --
                  IF NVL(rBOBIMAQU_U.ESTADO,'X') != 'X' THEN
                     nPrecio := (rBOBIMAQU_U.Ancho * nPrecio) / rBOBIMAQU_U.Ancho_Total;--Se calcula el precio del Corte
                     nPrecio_E := (rBOBIMAQU_U.Ancho * nPrecio_E) / rBOBIMAQU_U.Ancho_Total;--Se calcula el precio del Corte
                     --dbms_Output.put_line('         --- Precio de Corte '||nPrecio);                           
                  ELSE
                     --No se puede establecer el precio para la MP: @1-@2. [Contador @3]	
                     P_ERRORES(vEmpresa, nNumeOtre, '602','para la Bobina Utilizada para calculo de Precios Contador: '||rBOBIMAQU_B.Contador||' ContBobi: '||rBOBIMAQU_B.ContBobi||' Tipo Arti: '||rBOBIMAQU_B.Tip_Arti||'|No se encuentra la Bobina Utilizada|62','R','E');
                     --dbms_output.put_line('Error: No se encuentra la Bobina Utilizada para calculo de Precios: '||rBOBIMAQU_B.Empresa||'-'||rBOBIMAQU_B.NumeOtre||'-'||rBOBIMAQU_B.Contador||'-'||rBOBIMAQU_B.ContBobi);
                  END IF;
               END IF;
            END IF;
            --
            P_BOBIMAQU(rBOBIMAQU_B.IDENTIFICADOR,--nIdentificador
                       NULL,--nAncho 
                       NULL,--nAncho_Total 
                       NULL,--vDesbarbe 
                       NULL,--nNumero_Bobinas_Corte 
                       NULL,--nFACTOR_CONVERSION_M2_KG
                       nPrecio,--nPRECIO_ML
                       NULL);--nAncho_Bueno
            --
            rBOBIMAQU_B.PRECIO_ML := nPrecio;
            --t_BOBIMAQU(rBOBIMAQU_B.IDENTIFICADOR).Precio_ML := nPrecio;
            --t_BOBIMAQU(rBOBIMAQU_B.IDENTIFICADOR).Precio_ML_E := nPrecio_E;
         END IF;
      END LOOP;
		/*
		--Busqueda de Mermas de Planificación
      FOR nI In 1..T_MATERIAL.COUNT LOOP
         biIndice   := nI;
         rMATERIAL_B := T_MATERIAL(biIndice);
         --Si la cantidad Consumida es 0 se debe calcular, esto puede darse por que el material solo se utilizo para ajustar
         IF NVL(t_MATERIAL(rMATERIAL_B.IDENTIFICADOR).CantCons,0) = 0 THEN
            t_MATERIAL(rMATERIAL_B.IDENTIFICADOR).CantCons := NVL(rMATERIAL_B.MERMENHE,0) + NVL(rMATERIAL_B.MERMAJUS,0) + NVL(rMATERIAL_B.MERMTIRA,0) + NVL(rMATERIAL_B.MERMSANE,0) + NVL(rMATERIAL_B.MERMCABO,0) + NVL(rMATERIAL_B.MERMPICO,0);
         END IF;
         --
         IF NVL(rMATERIAL_B.Ancho,0) != 0 THEN
            --Se toma la Cantidad Consumida se Pasa a M2 de Merma de Planificacion, y estando en M2 se pasa a ML de Ancho de Material y se multiplica por su precio
            nPrecio_Merma_Planificacion := NVL(t_MATERIAL(rMATERIAL_B.IDENTIFICADOR).CantCons,0) * ((NVL(t_MATERIAL(rMATERIAL_B.IDENTIFICADOR).MM_MERMPLAN,0) / 1000) / (NVL(rMATERIAL_B.Ancho,0) / 1000)) * NVL(rMATERIAL_B.PRECIO_ML,0);
            nPrecio_Merma_Planificacion_E := NVL(t_MATERIAL(rMATERIAL_B.IDENTIFICADOR).CantCons,0) * ((NVL(t_MATERIAL(rMATERIAL_B.IDENTIFICADOR).MM_MERMPLAN_E,0) / 1000) / (NVL(rMATERIAL_B.Ancho,0) / 1000)) * NVL(rMATERIAL_B.PRECIO_ML_E,0);
            nPrecio_Merma_Plan_Exeso := NVL(t_MATERIAL(rMATERIAL_B.IDENTIFICADOR).CantCons,0) * ((NVL(t_MATERIAL(rMATERIAL_B.IDENTIFICADOR).MM_MERMPLAN_EXESO,0) / 1000) / (NVL(rMATERIAL_B.Ancho,0) / 1000)) * NVL(rMATERIAL_B.PRECIO_ML,0);
            nPrecio_Merma_Pre_Corte  := NVL(t_MATERIAL(rMATERIAL_B.IDENTIFICADOR).CantCons,0) * ((NVL(t_MATERIAL(rMATERIAL_B.IDENTIFICADOR).MM_MERMPRCO,0) / 1000) / (NVL(rMATERIAL_B.Ancho,0) / 1000)) * NVL(rMATERIAL_B.PRECIO_ML,0);
         ELSE
            nPrecio_Merma_Planificacion := 0;
            nPrecio_Merma_Planificacion_E := 0;
            nPrecio_Merma_Plan_Exeso := 0;
            nPrecio_Merma_Pre_Corte  := 0;
         END IF;
		END LOOP;*/
		FOR rMaterial IN cMaterial LOOP
		   IF NVL(rMaterial.CantCons,0) = 0 THEN
			   rMATERIAL_B.EMPRESA := rMaterial.EMPRESA;
				rMATERIAL_B.NUMEOTRE := rMaterial.NUMEOTRE;
				rMATERIAL_B.CONTADOR := rMaterial.CONTADOR;
				rMATERIAL_B.CONTMATE := rMaterial.CONTMATE;
				rMATERIAL_B.CONTMAEV := rMaterial.CONTMAEV;
				rMATERIAL_B.IDENTIFICADOR := rMaterial.IDENTIFICADOR;
				rMATERIAL_B.TIP_ARTI := rMaterial.TIP_ARTI;
				rMATERIAL_B.COD_ARTI := rMaterial.COD_ARTI;
				rMATERIAL_B.LOTE := rMaterial.LOTE;
				rMATERIAL_B.CANTCONS := rMaterial.CANTCONS;
				rMATERIAL_B.CANTCONS_BOBINAS := rMaterial.CANTCONS_BOBINAS;
				rMATERIAL_B.CANTPROD := rMaterial.CANTPROD;
				rMATERIAL_B.CANTAJUS := rMaterial.CANTAJUS;
				rMATERIAL_B.MERMENHE := rMaterial.MERMENHE;
				rMATERIAL_B.MERMAJUS := rMaterial.MERMAJUS;
				rMATERIAL_B.MERMCABO := rMaterial.MERMCABO;
				rMATERIAL_B.MERMPICO := rMaterial.MERMPICO;
				rMATERIAL_B.MERMTIRA := rMaterial.MERMTIRA;
				rMATERIAL_B.MERMSANE := rMaterial.MERMSANE;
				rMATERIAL_B.CONTFSMU_01 := rMaterial.CONTFSMU_01;
				rMATERIAL_B.CONTFSMU_02 := rMaterial.CONTFSMU_02;
				rMATERIAL_B.CONTFSMU_03 := rMaterial.CONTFSMU_03;
				rMATERIAL_B.CONTFSMU_04 := rMaterial.CONTFSMU_04;
				rMATERIAL_B.CONTFSMU_05 := rMaterial.CONTFSMU_05;
				rMATERIAL_B.CONTFSMU_06 := rMaterial.CONTFSMU_06;
				rMATERIAL_B.CONTFSMU_07 := rMaterial.CONTFSMU_07;
				rMATERIAL_B.CONTFSMU_08 := rMaterial.CONTFSMU_08;
				rMATERIAL_B.CONTFSMU_09 := rMaterial.CONTFSMU_09;
				rMATERIAL_B.CONTFSMU_10 := rMaterial.CONTFSMU_10;
				rMATERIAL_B.CANTFSMU_01 := rMaterial.CANTFSMU_01;
				rMATERIAL_B.CANTFSMU_02 := rMaterial.CANTFSMU_02;
				rMATERIAL_B.CANTFSMU_03 := rMaterial.CANTFSMU_03;
				rMATERIAL_B.CANTFSMU_04 := rMaterial.CANTFSMU_04;
				rMATERIAL_B.CANTFSMU_05 := rMaterial.CANTFSMU_05;
				rMATERIAL_B.CANTFSMU_06 := rMaterial.CANTFSMU_06;
				rMATERIAL_B.CANTFSMU_07 := rMaterial.CANTFSMU_07;
				rMATERIAL_B.CANTFSMU_08 := rMaterial.CANTFSMU_08;
				rMATERIAL_B.CANTFSMU_09 := rMaterial.CANTFSMU_09;
				rMATERIAL_B.CANTFSMU_10 := rMaterial.CANTFSMU_10;
				rMATERIAL_B.CATOFSMU := rMaterial.CATOFSMU;
				rMATERIAL_B.MM_MERMPLAN_01 := rMaterial.MM_MERMPLAN_01;
				rMATERIAL_B.MM_MERMPLAN_02 := rMaterial.MM_MERMPLAN_02;
				rMATERIAL_B.MM_MERMPLAN_03 := rMaterial.MM_MERMPLAN_03;
				rMATERIAL_B.MM_MERMPLAN_04 := rMaterial.MM_MERMPLAN_04;
				rMATERIAL_B.MM_MERMPLAN_05 := rMaterial.MM_MERMPLAN_05;
				rMATERIAL_B.MM_MERMPLAN_06 := rMaterial.MM_MERMPLAN_06;
				rMATERIAL_B.MM_MERMPLAN_07 := rMaterial.MM_MERMPLAN_07;
				rMATERIAL_B.MM_MERMPLAN_08 := rMaterial.MM_MERMPLAN_08;
				rMATERIAL_B.MM_MERMPLAN_09 := rMaterial.MM_MERMPLAN_09;
				rMATERIAL_B.MM_MERMPLAN_10 := rMaterial.MM_MERMPLAN_10;
				rMATERIAL_B.MM_MERMPLAN := rMaterial.MM_MERMPLAN;
				rMATERIAL_B.MERMPLAN := rMaterial.MERMPLAN;
				rMATERIAL_B.MM_MERMPLAN_EXESO_01 := rMaterial.MM_MERMPLAN_EXESO_01;
				rMATERIAL_B.MM_MERMPLAN_EXESO_02 := rMaterial.MM_MERMPLAN_EXESO_02;
				rMATERIAL_B.MM_MERMPLAN_EXESO_03 := rMaterial.MM_MERMPLAN_EXESO_03;
				rMATERIAL_B.MM_MERMPLAN_EXESO_04 := rMaterial.MM_MERMPLAN_EXESO_04;
				rMATERIAL_B.MM_MERMPLAN_EXESO_05 := rMaterial.MM_MERMPLAN_EXESO_05;
				rMATERIAL_B.MM_MERMPLAN_EXESO_06 := rMaterial.MM_MERMPLAN_EXESO_06;
				rMATERIAL_B.MM_MERMPLAN_EXESO_07 := rMaterial.MM_MERMPLAN_EXESO_07;
				rMATERIAL_B.MM_MERMPLAN_EXESO_08 := rMaterial.MM_MERMPLAN_EXESO_08;
				rMATERIAL_B.MM_MERMPLAN_EXESO_09 := rMaterial.MM_MERMPLAN_EXESO_09;
				rMATERIAL_B.MM_MERMPLAN_EXESO_10 := rMaterial.MM_MERMPLAN_EXESO_10;
				rMATERIAL_B.MM_MERMPLAN_EXESO := rMaterial.MM_MERMPLAN_EXESO;
				rMATERIAL_B.MERMPLAN_EXESO := rMaterial.MERMPLAN_EXESO;
				rMATERIAL_B.PRE_CORTE := rMaterial.PRE_CORTE;
				rMATERIAL_B.NUMECORT_01 := rMaterial.NUMECORT_01;
				rMATERIAL_B.NUMECORT_02 := rMaterial.NUMECORT_02;
				rMATERIAL_B.NUMECORT_03 := rMaterial.NUMECORT_03;
				rMATERIAL_B.NUMECORT_04 := rMaterial.NUMECORT_04;
				rMATERIAL_B.NUMECORT_05 := rMaterial.NUMECORT_05;
				rMATERIAL_B.NUMECORT_06 := rMaterial.NUMECORT_06;
				rMATERIAL_B.NUMECORT_07 := rMaterial.NUMECORT_07;
				rMATERIAL_B.NUMECORT_08 := rMaterial.NUMECORT_08;
				rMATERIAL_B.NUMECORT_09 := rMaterial.NUMECORT_09;
				rMATERIAL_B.NUMECORT_10 := rMaterial.NUMECORT_10;
				rMATERIAL_B.NUMECORT := rMaterial.NUMECORT;
				rMATERIAL_B.MM_MERMPRCO_01 := rMaterial.MM_MERMPRCO_01;
				rMATERIAL_B.MM_MERMPRCO_02 := rMaterial.MM_MERMPRCO_02;
				rMATERIAL_B.MM_MERMPRCO_03 := rMaterial.MM_MERMPRCO_03;
				rMATERIAL_B.MM_MERMPRCO_04 := rMaterial.MM_MERMPRCO_04;
				rMATERIAL_B.MM_MERMPRCO_05 := rMaterial.MM_MERMPRCO_05;
				rMATERIAL_B.MM_MERMPRCO_06 := rMaterial.MM_MERMPRCO_06;
				rMATERIAL_B.MM_MERMPRCO_07 := rMaterial.MM_MERMPRCO_07;
				rMATERIAL_B.MM_MERMPRCO_08 := rMaterial.MM_MERMPRCO_08;
				rMATERIAL_B.MM_MERMPRCO_09 := rMaterial.MM_MERMPRCO_09;
				rMATERIAL_B.MM_MERMPRCO_10 := rMaterial.MM_MERMPRCO_10;
				rMATERIAL_B.MM_MERMPRCO := rMaterial.MM_MERMPRCO;
				rMATERIAL_B.MERMPRCO := rMaterial.MERMPRCO;
				rMATERIAL_B.CANTCONS_E := rMaterial.CANTCONS_E;
				rMATERIAL_B.MERMENHE_E := rMaterial.MERMENHE_E;
				rMATERIAL_B.MERMAJUS_E := rMaterial.MERMAJUS_E;
				rMATERIAL_B.MERMCABO_E := rMaterial.MERMCABO_E;
				rMATERIAL_B.MERMPICO_E := rMaterial.MERMPICO_E;
				rMATERIAL_B.MERMTIRA_E := rMaterial.MERMTIRA_E;
				rMATERIAL_B.MERMSANE_E := rMaterial.MERMSANE_E;
				rMATERIAL_B.MM_MERMPLAN_E := rMaterial.MM_MERMPLAN_E;
				rMATERIAL_B.MERMPLAN_E := rMaterial.MERMPLAN_E;
				rMATERIAL_B.ANCHO := rMaterial.ANCHO;
				rMATERIAL_B.ANCHO_BUENO_OT_01 := rMaterial.ANCHO_BUENO_OT_01;
				rMATERIAL_B.ANCHO_BUENO_TOTAL_01 := rMaterial.ANCHO_BUENO_TOTAL_01;
				rMATERIAL_B.ANCHO_BUENO_OT_02 := rMaterial.ANCHO_BUENO_OT_02;
				rMATERIAL_B.ANCHO_BUENO_TOTAL_02 := rMaterial.ANCHO_BUENO_TOTAL_02;
				rMATERIAL_B.ANCHO_BUENO_OT_03 := rMaterial.ANCHO_BUENO_OT_03;
				rMATERIAL_B.ANCHO_BUENO_TOTAL_03 := rMaterial.ANCHO_BUENO_TOTAL_03;
				rMATERIAL_B.ANCHO_BUENO_OT_04 := rMaterial.ANCHO_BUENO_OT_04;
				rMATERIAL_B.ANCHO_BUENO_TOTAL_04 := rMaterial.ANCHO_BUENO_TOTAL_04;
				rMATERIAL_B.ANCHO_BUENO_OT_05 := rMaterial.ANCHO_BUENO_OT_05;
				rMATERIAL_B.ANCHO_BUENO_TOTAL_05 := rMaterial.ANCHO_BUENO_TOTAL_05;
				rMATERIAL_B.ANCHO_BUENO_OT_06 := rMaterial.ANCHO_BUENO_OT_06;
				rMATERIAL_B.ANCHO_BUENO_TOTAL_06 := rMaterial.ANCHO_BUENO_TOTAL_06;
				rMATERIAL_B.ANCHO_BUENO_OT_07 := rMaterial.ANCHO_BUENO_OT_07;
				rMATERIAL_B.ANCHO_BUENO_TOTAL_07 := rMaterial.ANCHO_BUENO_TOTAL_07;
				rMATERIAL_B.ANCHO_BUENO_OT_08 := rMaterial.ANCHO_BUENO_OT_08;
				rMATERIAL_B.ANCHO_BUENO_TOTAL_08 := rMaterial.ANCHO_BUENO_TOTAL_08;
				rMATERIAL_B.ANCHO_BUENO_OT_09 := rMaterial.ANCHO_BUENO_OT_09;
				rMATERIAL_B.ANCHO_BUENO_TOTAL_09 := rMaterial.ANCHO_BUENO_TOTAL_09;
				rMATERIAL_B.ANCHO_BUENO_OT_10 := rMaterial.ANCHO_BUENO_OT_10;
				rMATERIAL_B.ANCHO_BUENO_TOTAL_10 := rMaterial.ANCHO_BUENO_TOTAL_10;
				rMATERIAL_B.ANCHO_BUENO_TOTAL := rMaterial.ANCHO_BUENO_TOTAL;
				rMATERIAL_B.ANCHO_BUENO_OT := rMaterial.ANCHO_BUENO_OT;
				rMATERIAL_B.CANTIDAD_CONSUMIDA_FINAL_01 := rMaterial.CANTIDAD_CONSUMIDA_FINAL_01;
				rMATERIAL_B.CANTIDAD_CONSUMIDA_FINAL_02 := rMaterial.CANTIDAD_CONSUMIDA_FINAL_02;
				rMATERIAL_B.CANTIDAD_CONSUMIDA_FINAL_03 := rMaterial.CANTIDAD_CONSUMIDA_FINAL_03;
				rMATERIAL_B.CANTIDAD_CONSUMIDA_FINAL_04 := rMaterial.CANTIDAD_CONSUMIDA_FINAL_04;
				rMATERIAL_B.CANTIDAD_CONSUMIDA_FINAL_05 := rMaterial.CANTIDAD_CONSUMIDA_FINAL_05;
				rMATERIAL_B.CANTIDAD_CONSUMIDA_FINAL_06 := rMaterial.CANTIDAD_CONSUMIDA_FINAL_06;
				rMATERIAL_B.CANTIDAD_CONSUMIDA_FINAL_07 := rMaterial.CANTIDAD_CONSUMIDA_FINAL_07;
				rMATERIAL_B.CANTIDAD_CONSUMIDA_FINAL_08 := rMaterial.CANTIDAD_CONSUMIDA_FINAL_08;
				rMATERIAL_B.CANTIDAD_CONSUMIDA_FINAL_09 := rMaterial.CANTIDAD_CONSUMIDA_FINAL_09;
				rMATERIAL_B.CANTIDAD_CONSUMIDA_FINAL_10 := rMaterial.CANTIDAD_CONSUMIDA_FINAL_10;
				rMATERIAL_B.CANTIDAD_CONSUMIDA_FINAL_TOTAL := rMaterial.CANTIDAD_CONSUMIDA_FINAL_TOTAL;
				rMATERIAL_B.PRECIO_ML := rMaterial.PRECIO_ML;
				rMATERIAL_B.PRECIO_ML_E := rMaterial.PRECIO_ML_E;
				rMATERIAL_B.FACTOR_CONVERSION_M2_KG := rMaterial.FACTOR_CONVERSION_M2_KG;
            --
            P_MATERIAL(rMaterial_B,'U',
							  NULL,--nCantProd
							  NULL,--nCantCons_E
							  NVL(rMATERIAL_B.MERMENHE,0) + NVL(rMATERIAL_B.MERMAJUS,0) + NVL(rMATERIAL_B.MERMTIRA,0) + NVL(rMATERIAL_B.MERMSANE,0) + NVL(rMATERIAL_B.MERMCABO,0) + NVL(rMATERIAL_B.MERMPICO,0),--nCantCons
							  NULL,--nCantAjus
							  NULL,--nAncho
							  NULL,--nFACTOR_CONVERSION_M2_KG
							  NULL,--nPrecio_ML_E
							  NULL,--vLog_Precio
							  NULL,--nMermEnhe_E
							  NULL,--nMermEnhe
							  NULL,--nMermAjus_E
							  NULL,--nMermAjus
							  NULL,--nMermCabo_E
							  NULL,--nMermCabo
							  NULL,--nMermPico_E
                       NULL,--nMermPico
                       NULL,--nMermTita
                       NULL,--nMermSane
                       NULL,--nCantCons_Bobinas
                       --
                        NULL, --nCONTFSMU_01 
                        NULL, --nCANTFSMU_01 
                        NULL, --nCATOFSMU 
                        NULL, --nCONTFSMU_02 
                        NULL, --nCANTFSMU_02 
                        NULL, --nCONTFSMU_03 
                        NULL, --nCANTFSMU_03 
                        NULL, --nCONTFSMU_04 
                        NULL, --nCANTFSMU_04 
                        NULL, --nCONTFSMU_05 
                        NULL, --nCANTFSMU_05 
                        NULL, --nCONTFSMU_06 
                        NULL, --nCANTFSMU_06 
                        NULL, --nCONTFSMU_07 
                        NULL, --nCANTFSMU_07 
                        NULL, --nCONTFSMU_08 
                        NULL, --nCANTFSMU_08 
                        NULL, --nCONTFSMU_09 
                        NULL, --nCANTFSMU_09 
                        NULL, --nCONTFSMU_10 
                        NULL, --nCANTFSMU_10 
                        NULL, --nANCHO_BUENO_TOTAL_01 
                        NULL, --nANCHO_BUENO_OT_01 
                        NULL, --nANCHO_BUENO_TOTAL_02 
                        NULL, --nANCHO_BUENO_OT_02 
                        NULL, --nANCHO_BUENO_TOTAL_03 
                        NULL, --nANCHO_BUENO_OT_03 
                        NULL, --nANCHO_BUENO_TOTAL_04 
                        NULL, --nANCHO_BUENO_OT_04 
                        NULL, --nANCHO_BUENO_TOTAL_05 
                        NULL, --nANCHO_BUENO_OT_05 
                        NULL, --nANCHO_BUENO_TOTAL_06 
                        NULL, --nANCHO_BUENO_OT_06 
                        NULL, --nANCHO_BUENO_TOTAL_07 
                        NULL, --nANCHO_BUENO_OT_07 
                        NULL, --nANCHO_BUENO_TOTAL_08 
                        NULL, --nANCHO_BUENO_OT_08 
                        NULL, --nANCHO_BUENO_TOTAL_09 
                        NULL, --nANCHO_BUENO_OT_09 
                        NULL, --nANCHO_BUENO_TOTAL_10 
                        NULL, --nANCHO_BUENO_OT_10 
                        NULL, --nANCHO_BUENO_TOTAL 
                        NULL, --nANCHO_BUENO_OT 
                        NULL, --nNUMECORT 
                        NULL, --nMM_MERMPRCO_01 
                        NULL, --nMM_MERMPLAN_EXESO_01 
                        NULL, --nMM_MERMPLAN_01 
                        NULL, --nMM_MERMPRCO_02 
                        NULL, --nMM_MERMPLAN_EXESO_02 
                        NULL, --nMM_MERMPLAN_02 
                        NULL, --nMM_MERMPRCO_03 
                        NULL, --nMM_MERMPLAN_EXESO_03 
                        NULL, --nMM_MERMPLAN_03 
                        NULL, --nMM_MERMPRCO_04 
                        NULL, --nMM_MERMPLAN_EXESO_04 
                        NULL, --nMM_MERMPLAN_04 
                        NULL, --nMM_MERMPRCO_05 
                        NULL, --nMM_MERMPLAN_EXESO_05 
                        NULL, --nMM_MERMPLAN_05 
                        NULL, --nMM_MERMPRCO_06 
                        NULL, --nMM_MERMPLAN_EXESO_06 
                        NULL, --nMM_MERMPLAN_06 
                        NULL, --nMM_MERMPRCO_07 
                        NULL, --nMM_MERMPLAN_EXESO_07 
                        NULL, --nMM_MERMPLAN_07 
                        NULL, --nMM_MERMPRCO_08 
                        NULL, --nMM_MERMPLAN_EXESO_08 
                        NULL, --nMM_MERMPLAN_08 
                        NULL, --nMM_MERMPRCO_09 
                        NULL, --nMM_MERMPLAN_EXESO_09 
                        NULL, --nMM_MERMPLAN_09 
                        NULL, --nMM_MERMPRCO_10 
                        NULL, --nMM_MERMPLAN_EXESO_10 
                        NULL, --nMM_MERMPLAN_10 
                        NULL, --nMM_MERMPRCO 
                        NULL, --nMM_MERMPLAN_EXESO 
                        NULL); --nMM_MERMPLAN
			END IF;
		END LOOP;
		-----------------------------------
		--NO SE IMPLEMENTA SE REALIZA DIRECTAMENTE EN LAS TABLAS O VISTAS DE MERMAS PARA CALCULAR LAS MERAMAS PLANIFICACION Y SU PRECIO SI SE IMPLEMENTA LA ACTUALIZACION DE CANTCONS
		------------------------------------
   END;--P_ACTUALIZA_MATERIALES
	--
	PROCEDURE P_CALCULA_REALES(vEmpresa FIC_CABEOTRE.EMPRESA%TYPE, nNumero FIC_CABEOTRE.NUMERO%TYPE) IS
		--vEmpresa FIC_CABEOTRE.EMPRESA%TYPE := '10';--'05';--'10';
		--nNumero FIC_CABEOTRE.NUMERO%TYPE := 2013001748;--2016000205;--2016002783;--2016002037;
		--
		TYPE vEMPRBOBI_A IS TABLE OF VARCHAR2(32) INDEX BY PLS_INTEGER;
		TYPE vNUOTBOBI_A IS TABLE OF VARCHAR2(32) INDEX BY PLS_INTEGER;
		TYPE vCONTBOBI_A IS TABLE OF VARCHAR2(32) INDEX BY PLS_INTEGER;
		TYPE vCOBOBOBI_A IS TABLE OF VARCHAR2(32) INDEX BY PLS_INTEGER;
		TYPE vLOTE_A IS TABLE OF VARCHAR2(32) INDEX BY PLS_INTEGER;
		TYPE vCONTADOR_A IS TABLE OF VARCHAR2(32) INDEX BY PLS_INTEGER;
		TYPE vTIP_ARTI_A IS TABLE OF VARCHAR2(32) INDEX BY PLS_INTEGER;
		TYPE vCOD_ARTI_A IS TABLE OF VARCHAR2(32) INDEX BY PLS_INTEGER;
		--
		vEMPRBOBI vEMPRBOBI_A;
		vNUOTBOBI vNUOTBOBI_A;
		vCONTBOBI vCONTBOBI_A;
		vCOBOBOBI vCOBOBOBI_A;
		vLOTE vLOTE_A;
		vCONTADOR vCONTADOR_A;
		vTIP_ARTI vTIP_ARTI_A;
		vCOD_ARTI vCOD_ARTI_A;
		--
		bExisMate BOOLEAN;
		--Tipo para carga de Materiales Reales - Calculo de Mermas Acumuladas
		Type St_MATERIALES Is Record
			(
			 vEmpresa      PRD_MAPAMAQU.EMPRESA%TYPE,
			 nNumeOtre     PRD_MAPAMAQU.NUMEOTRE%TYPE,
			 nContador     PRD_MAPAMAQU.CONTADOR%TYPE,
			 vTip_Arti     PRD_MAPAMAQU.TIP_ARTI%TYPE,
			 vCod_Arti     PRD_MAPAMAQU.COD_ARTI%TYPE,
			 nMermTira     NUMBER,
			 nMermSane     NUMBER,
			 nMermEnhe     NUMBER,
			 nMermAjus     NUMBER,
			 nMermCabo     NUMBER,
			 nMermPico     NUMBER,
			 --
		    nMermCoan_T   NUMBER,
		    nMermCoan_P   NUMBER
			);
		-- Definicion de tabla PL de MATERIALES
		Type tMateriales Is Table Of St_MATERIALES Index By Binary_Integer;
		t_Materiales   tMateriales;
		--
		bExisMateRama BOOLEAN;
		--Tipo para carga de Materiales Reales - Calculo de Mermas Acumuladas
		Type St_MATERIALES_RAMA Is Record
			(
			 vEmpresa      PRD_MAPAMAQU.EMPRESA%TYPE,
			 nNumeOtre     PRD_MAPAMAQU.NUMEOTRE%TYPE,
			 nContador     PRD_MAPAMAQU.CONTADOR%TYPE,
			 vTip_Arti     PRD_MAPAMAQU.TIP_ARTI%TYPE,
			 vCod_Arti     PRD_MAPAMAQU.COD_ARTI%TYPE,
			 --
			 vEmprBobi     PRD_MAPAMAQU.EMPRBOBI%TYPE,
			 nNuotBobi     PRD_MAPAMAQU.NUOTBOBI%TYPE,
			 nContBobi     PRD_MAPAMAQU.CONTBOBI%TYPE,
			 nCoboBobi     PRD_MAPAMAQU.COBOBOBI%TYPE,
			 vLote     		PRD_MAPAMAQU.LOTE%TYPE,
			 --
			 nMermTira     NUMBER,
			 nMermSane     NUMBER,
			 nMermEnhe     NUMBER,
			 nMermAjus     NUMBER,
			 nMermCabo     NUMBER,
			 nMermPico     NUMBER
			);
		-- Definicion de tabla PL de MATERIALES
		Type tMateriales_Rama Is Table Of St_MATERIALES_RAMA Index By Binary_Integer;
		t_Materiales_Rama   tMateriales_Rama;
		--Tipo para control de Materiales ya acumulados - Calculo de Mermas Acumuladas
		Type St_MATERIALES_PROCESADOS Is Record
			(
			 vEmprBobi     PRD_MAPAMAQU.EMPRBOBI%TYPE,
			 nNuotBobi     PRD_MAPAMAQU.NUOTBOBI%TYPE,
			 nContBobi     PRD_MAPAMAQU.CONTBOBI%TYPE,
			 nCoboBobi     PRD_MAPAMAQU.COBOBOBI%TYPE,
			 vLote     		PRD_MAPAMAQU.LOTE%TYPE,
			 nMermTira     NUMBER,
			 nMermSane     NUMBER,
			 nMermEnhe     NUMBER,
			 nMermAjus     NUMBER,
			 nMermCabo     NUMBER,
			 nMermPico     NUMBER
			);
		-- Definicion de tabla PL de MATERIALES PROCESADOS
		Type tMateriales_Procesados Is Table Of St_MATERIALES_PROCESADOS Index By Binary_Integer;
		t_Materiales_Procesados   tMateriales_Procesados;
		--
		biIndice Binary_Integer := 0;
		biIndice_Carga Binary_Integer := 0;
		--
		rMateriales St_MATERIALES;
		rMateriales_Procesados St_MATERIALES_PROCESADOS;
		rMateriales_Rama St_MATERIALES_RAMA;
		--
		nContador NUMBER;
		--
		vCadenaAux VARCHAR2(32000);
		vRama VARCHAR2(32000);
		nPosicion NUMBER;-- := 0;
		--
		bExiste BOOLEAN;
		--Cursor que verifica las cortadoras para buscar mermas en otras maquinas
		CURSOR cApliCome IS
			SELECT ME.ROWID, ME.EMPRESA, ME.NUMEOTRE, ME.CONTADOR, ME.LOTE, M.MAQUCODI, ME.TIP_ARTI, ME.COD_ARTI
			FROM ANALESTA.ANE_MER_MATERIAL_OT ME,
				  (SELECT MR.EMPRESA, MR.NUMEOTRE, MR.MAQUCODI, MR.CONTADOR FROM PRD_MAQURUTA MR
					WHERE NOT EXISTS (SELECT 'X' FROM PRD_HCABEOTR OTC WHERE OTC.EMPRESA = MR.EMPRESA AND OTC.NUMEOTRE = MR.NUMEOTRE)
					UNION
					SELECT MR.EMPRESA, MR.NUMEOTRE, MR.MAQUCODI, MR.CONTADOR FROM PRD_HMAQURUT MR) M
			WHERE ME.EMPRESA = M.EMPRESA
			  AND ME.NUMEOTRE = M.NUMEOTRE
			  AND ME.CONTADOR = M.CONTADOR
			  --NEW II
			  --AND ME.TIP_ARTI != P_UTILIDAD.F_VALODEVA('TIARREST')
			  --FIN NEW II
			  AND NVL(ME.CANTCONS,0) != 0 --Filtra Materiales en 0
			  AND ME.EMPRESA = vEmpresa 
			  AND ME.NUMEOTRE = nNumero
			ORDER BY ME.CONTADOR;
		--
		CURSOR cMermaTira(vEmpresa ANALESTA.ANE_MER_BOBIMAQU_OT.EMPRESA%TYPE, nNumeOtre ANALESTA.ANE_MER_BOBIMAQU_OT.NUMEOTRE%TYPE, nContador ANALESTA.ANE_MER_BOBIMAQU_OT.CONTADOR%TYPE, nContBobi ANALESTA.ANE_MER_BOBIMAQU_OT.CONTBOBI%TYPE) IS
			SELECT MERMTIRA, MERMSANE 
			FROM ANALESTA.ANE_MER_BOBIMAQU_OT 
			WHERE EMPRESA = vEmpresa 
			  AND NUMEOTRE = nNumeOtre
			  AND CONTADOR = nContador
			  AND CONTBOBI = nContBobi;
		--
		nMermTira NUMBER;
		nMermTira_T NUMBER;
		nMermTira_P NUMBER;
		nMermSane NUMBER;
		nMermSane_T NUMBER;
		nMermSane_P NUMBER;
	/*
	|EMPRBOBI:10|NUOTBOBI:2016002783|LOTE:16000256|COBOMATE:1|BOBIMATE:-2
	|EMPRBOBI:10|NUOTBOBI:2016002783|LOTE:|COBOMATE:|BOBIMATE:
	|EMPRBOBI:10|NUOTBOBI:2016002783|CONTBOBI:1|COBOBOBI:1|LOTE:2016002783
	*/
		CURSOR cMermas(vEmprBobi PRD_MAPAMAQU.EMPRBOBI%TYPE, nNuotBobi PRD_MAPAMAQU.NUOTBOBI%TYPE, 
							nContBobi PRD_MAPAMAQU.CONTBOBI%TYPE, nCoboBobi PRD_MAPAMAQU.COBOBOBI%TYPE, 
							vLote VARCHAR2) IS
			SELECT CANTPROD,MERMENHE, MERMAJUS, MERMCABO, MERMPICO 
			FROM ANALESTA.ANE_MER_MATERIAL_OT 
			WHERE EMPRESA = vEmpresa 
			  AND NUMEOTRE = nNumero
			  AND (
					 (nCoboBobi < 0
				 AND LOTE = '|EMPRBOBI:'||vEmprBobi||'|NUOTBOBI:'||nNuotBobi||'|LOTE:'||vLote||'|COBOMATE:'||nContBobi||'|BOBIMATE:'||nCoboBobi) OR
					 (nCoboBobi > 0
				 AND LOTE = '|EMPRBOBI:'||vEmprBobi||'|NUOTBOBI:'||nNuotBobi||'|CONTBOBI:'||nContBobi||'|COBOBOBI:'||nCoboBobi||'|LOTE:'||vLote)
					);
		--
		rMermas cMermas%ROWTYPE;
		--Cursor para mermas de NO Tiradas
		CURSOR cMermas_NT(vEmprBobi PRD_MAPAMAQU.EMPRBOBI%TYPE, nNuotBobi PRD_MAPAMAQU.NUOTBOBI%TYPE,vLote VARCHAR2) IS
			SELECT CANTPROD,MERMENHE, MERMAJUS, MERMCABO, MERMPICO 
			FROM ANALESTA.ANE_MER_MATERIAL_OT 
			WHERE EMPRESA = vEmpresa 
			  AND NUMEOTRE = nNumero
			  --|EMPRBOBI:05|NUOTBOBI:2016000205|LOTE:15000225|COBOMATE:|BOBIMATE:
			  AND LOTE = '|EMPRBOBI:'||vEmprBobi||'|NUOTBOBI:'||nNuotBobi||'|LOTE:'||vLote||'|COBOMATE:|BOBIMATE:';
		--
		rMermas_NT cMermas_NT%ROWTYPE;
		--
		nMermEnhe_T NUMBER;
		nMermAjus_T NUMBER;
		nMermCabo_T NUMBER;
		nMermPico_T NUMBER;
		--
		nMermEnhe_P NUMBER;
		nMermAjus_P NUMBER;
		nMermCabo_P NUMBER;
		nMermPico_P NUMBER;
		--
		vExisMeti VARCHAR2(1);
		vExisMesa VARCHAR2(1);
		vExisMeen VARCHAR2(1);
		vExisMeaj VARCHAR2(1);
		vExisMeca VARCHAR2(1);
		vExisMepi VARCHAR2(1);
		--
		CURSOR cMermSafi(vMerma VARCHAR2) IS
			SELECT 'X' FROM VALORES_LISTA 
			WHERE CODIGO = 'ANE_MERMSAFI'
			  AND VALOR = vMerma;
		--Merma consumida anterior
		nMermCoan_T NUMBER;
		nMermCoan_P NUMBER;
		--
		nCantPran_T NUMBER;
		nMermEnPa_T NUMBER;
		nMermAjPa_T NUMBER;
		nMermCaPa_T NUMBER;
		nMermPiPa_T NUMBER;
		nMermTiPa_T NUMBER;
		nMermSaPa_T NUMBER;
		--Verifica si el contador es justo de la máquina anterior
		CURSOR cContMaquAnte(vEmpresa ANALESTA.ANE_MER_BOBIMAQU_OT.EMPRESA%TYPE, nNumeOtre ANALESTA.ANE_MER_BOBIMAQU_OT.NUMEOTRE%TYPE, nContador ANALESTA.ANE_MER_BOBIMAQU_OT.CONTADOR%TYPE) IS
			SELECT MAA.CONTADOR, MAA.MAQUCODI
            FROM (SELECT MR.EMPRESA, MR.NUMEOTRE, MR.FASESEQU, MR.CONTADOR, MR.MAQUCODI FROM PRD_MAQURUTA MR
                  WHERE NOT EXISTS (SELECT 'X' FROM PRD_HCABEOTR OTC WHERE OTC.EMPRESA = MR.EMPRESA AND OTC.NUMEOTRE = MR.NUMEOTRE)
                  UNION
                  SELECT MR.EMPRESA, MR.NUMEOTRE, MR.FASESEQU, MR.CONTADOR, MR.MAQUCODI FROM PRD_HMAQURUT MR) MA, 
                 FIC_LINEOTRE L,
					  (SELECT MR.EMPRESA, MR.NUMEOTRE, MR.FASESEQU, MR.CONTADOR, MR.MAQUCODI FROM PRD_MAQURUTA MR
                  WHERE NOT EXISTS (SELECT 'X' FROM PRD_HCABEOTR OTC WHERE OTC.EMPRESA = MR.EMPRESA AND OTC.NUMEOTRE = MR.NUMEOTRE)
                  UNION
                  SELECT MR.EMPRESA, MR.NUMEOTRE, MR.FASESEQU, MR.CONTADOR, MR.MAQUCODI FROM PRD_HMAQURUT MR) MAA, 
                 FIC_LINEOTRE LA
               WHERE L.EMPRESA = MA.EMPRESA
                 AND L.NUMERO = MA.NUMEOTRE
                 AND MA.FASESEQU = (L.FASE * 100) + L.SECUENCI
					  AND L.TIP_ARES = P_UTILIDAD.F_VALODEVA('TIPORECU')
					  --
					  AND LA.EMPRESA = MAA.EMPRESA
                 AND LA.NUMERO = MAA.NUMEOTRE
                 AND MAA.FASESEQU = (LA.FASE * 100) + LA.SECUENCI
					  AND LA.TIP_ARES = P_UTILIDAD.F_VALODEVA('TIPORECU')
					  --
					  AND L.EMPRESA = LA.EMPRESA
					  AND L.NUMERO = LA.NUMERO
					  AND L.FASE = LA.FASESI01
					  AND LA.FASE != LA.FASESI01
					  AND LA.FASESI01 IS NOT NULL
					  --
                 AND MA.EMPRESA = vEmpresa
                 AND MA.NUMEOTRE = nNumeOtre
                 AND MA.CONTADOR = nContador
			UNION
			SELECT MAA.CONTADOR, MAA.MAQUCODI
            FROM (SELECT MR.EMPRESA, MR.NUMEOTRE, MR.FASESEQU, MR.CONTADOR, MR.MAQUCODI FROM PRD_MAQURUTA MR
                  WHERE NOT EXISTS (SELECT 'X' FROM PRD_HCABEOTR OTC WHERE OTC.EMPRESA = MR.EMPRESA AND OTC.NUMEOTRE = MR.NUMEOTRE)
                  UNION
                  SELECT MR.EMPRESA, MR.NUMEOTRE, MR.FASESEQU, MR.CONTADOR, MR.MAQUCODI FROM PRD_HMAQURUT MR) MA, 
                 FIC_LINEOTRE L,
					  (SELECT MR.EMPRESA, MR.NUMEOTRE, MR.FASESEQU, MR.CONTADOR, MR.MAQUCODI FROM PRD_MAQURUTA MR
                  WHERE NOT EXISTS (SELECT 'X' FROM PRD_HCABEOTR OTC WHERE OTC.EMPRESA = MR.EMPRESA AND OTC.NUMEOTRE = MR.NUMEOTRE)
                  UNION
                  SELECT MR.EMPRESA, MR.NUMEOTRE, MR.FASESEQU, MR.CONTADOR, MR.MAQUCODI FROM PRD_HMAQURUT MR) MAA, 
                 FIC_LINEOTRE LA
               WHERE L.EMPRESA = MA.EMPRESA
                 AND L.NUMERO = MA.NUMEOTRE
                 AND MA.FASESEQU = (L.FASE * 100) + L.SECUENCI
					  AND L.TIP_ARES = P_UTILIDAD.F_VALODEVA('TIPORECU')
					  --
					  AND LA.EMPRESA = MAA.EMPRESA
                 AND LA.NUMERO = MAA.NUMEOTRE
                 AND MAA.FASESEQU = (LA.FASE * 100) + LA.SECUENCI
					  AND LA.TIP_ARES = P_UTILIDAD.F_VALODEVA('TIPORECU')
					  --
					  AND L.EMPRESA = LA.EMPRESA
					  AND L.NUMERO = LA.NUMERO
					  AND L.FASE = LA.FASESI02
					  AND LA.FASE != LA.FASESI02
					  AND LA.FASESI02 IS NOT NULL
					  --
                 AND MA.EMPRESA = vEmpresa
                 AND MA.NUMEOTRE = nNumeOtre
                 AND MA.CONTADOR = nContador
			UNION
			SELECT MAA.CONTADOR, MAA.MAQUCODI
            FROM (SELECT MR.EMPRESA, MR.NUMEOTRE, MR.FASESEQU, MR.CONTADOR, MR.MAQUCODI FROM PRD_MAQURUTA MR
                  WHERE NOT EXISTS (SELECT 'X' FROM PRD_HCABEOTR OTC WHERE OTC.EMPRESA = MR.EMPRESA AND OTC.NUMEOTRE = MR.NUMEOTRE)
                  UNION
                  SELECT MR.EMPRESA, MR.NUMEOTRE, MR.FASESEQU, MR.CONTADOR, MR.MAQUCODI FROM PRD_HMAQURUT MR) MA, 
                 FIC_LINEOTRE L,
					  (SELECT MR.EMPRESA, MR.NUMEOTRE, MR.FASESEQU, MR.CONTADOR, MR.MAQUCODI FROM PRD_MAQURUTA MR
                  WHERE NOT EXISTS (SELECT 'X' FROM PRD_HCABEOTR OTC WHERE OTC.EMPRESA = MR.EMPRESA AND OTC.NUMEOTRE = MR.NUMEOTRE)
                  UNION
                  SELECT MR.EMPRESA, MR.NUMEOTRE, MR.FASESEQU, MR.CONTADOR, MR.MAQUCODI FROM PRD_HMAQURUT MR) MAA, 
                 FIC_LINEOTRE LA
               WHERE L.EMPRESA = MA.EMPRESA
                 AND L.NUMERO = MA.NUMEOTRE
                 AND MA.FASESEQU = (L.FASE * 100) + L.SECUENCI
					  AND L.TIP_ARES = P_UTILIDAD.F_VALODEVA('TIPORECU')
					  --
					  AND LA.EMPRESA = MAA.EMPRESA
                 AND LA.NUMERO = MAA.NUMEOTRE
                 AND MAA.FASESEQU = (LA.FASE * 100) + LA.SECUENCI
					  AND LA.TIP_ARES = P_UTILIDAD.F_VALODEVA('TIPORECU')
					  --
					  AND L.EMPRESA = LA.EMPRESA
					  AND L.NUMERO = LA.NUMERO
					  AND L.FASE = LA.FASESI03
					  AND LA.FASE != LA.FASESI03
					  AND LA.FASESI03 IS NOT NULL
					  --
                 AND MA.EMPRESA = vEmpresa
                 AND MA.NUMEOTRE = nNumeOtre
                 AND MA.CONTADOR = nContador
			UNION
			SELECT MAA.CONTADOR, MAA.MAQUCODI
            FROM (SELECT MR.EMPRESA, MR.NUMEOTRE, MR.FASESEQU, MR.CONTADOR, MR.MAQUCODI FROM PRD_MAQURUTA MR
                  WHERE NOT EXISTS (SELECT 'X' FROM PRD_HCABEOTR OTC WHERE OTC.EMPRESA = MR.EMPRESA AND OTC.NUMEOTRE = MR.NUMEOTRE)
                  UNION
                  SELECT MR.EMPRESA, MR.NUMEOTRE, MR.FASESEQU, MR.CONTADOR, MR.MAQUCODI FROM PRD_HMAQURUT MR) MA, 
                 FIC_LINEOTRE L,
					  (SELECT MR.EMPRESA, MR.NUMEOTRE, MR.FASESEQU, MR.CONTADOR, MR.MAQUCODI FROM PRD_MAQURUTA MR
                  WHERE NOT EXISTS (SELECT 'X' FROM PRD_HCABEOTR OTC WHERE OTC.EMPRESA = MR.EMPRESA AND OTC.NUMEOTRE = MR.NUMEOTRE)
                  UNION
                  SELECT MR.EMPRESA, MR.NUMEOTRE, MR.FASESEQU, MR.CONTADOR, MR.MAQUCODI FROM PRD_HMAQURUT MR) MAA, 
                 FIC_LINEOTRE LA
               WHERE L.EMPRESA = MA.EMPRESA
                 AND L.NUMERO = MA.NUMEOTRE
                 AND MA.FASESEQU = (L.FASE * 100) + L.SECUENCI
					  AND L.TIP_ARES = P_UTILIDAD.F_VALODEVA('TIPORECU')
					  --
					  AND LA.EMPRESA = MAA.EMPRESA
                 AND LA.NUMERO = MAA.NUMEOTRE
                 AND MAA.FASESEQU = (LA.FASE * 100) + LA.SECUENCI
					  AND LA.TIP_ARES = P_UTILIDAD.F_VALODEVA('TIPORECU')
					  --
					  AND L.EMPRESA = LA.EMPRESA
					  AND L.NUMERO = LA.NUMERO
					  AND L.FASE = LA.FASESI04
					  AND LA.FASE != LA.FASESI04
					  AND LA.FASESI04 IS NOT NULL
					  --
                 AND MA.EMPRESA = vEmpresa
                 AND MA.NUMEOTRE = nNumeOtre
                 AND MA.CONTADOR = nContador
			UNION
			SELECT MAA.CONTADOR, MAA.MAQUCODI
            FROM (SELECT MR.EMPRESA, MR.NUMEOTRE, MR.FASESEQU, MR.CONTADOR, MR.MAQUCODI FROM PRD_MAQURUTA MR
                  WHERE NOT EXISTS (SELECT 'X' FROM PRD_HCABEOTR OTC WHERE OTC.EMPRESA = MR.EMPRESA AND OTC.NUMEOTRE = MR.NUMEOTRE)
                  UNION
                  SELECT MR.EMPRESA, MR.NUMEOTRE, MR.FASESEQU, MR.CONTADOR, MR.MAQUCODI FROM PRD_HMAQURUT MR) MA, 
                 FIC_LINEOTRE L,
					  (SELECT MR.EMPRESA, MR.NUMEOTRE, MR.FASESEQU, MR.CONTADOR, MR.MAQUCODI FROM PRD_MAQURUTA MR
                  WHERE NOT EXISTS (SELECT 'X' FROM PRD_HCABEOTR OTC WHERE OTC.EMPRESA = MR.EMPRESA AND OTC.NUMEOTRE = MR.NUMEOTRE)
                  UNION
                  SELECT MR.EMPRESA, MR.NUMEOTRE, MR.FASESEQU, MR.CONTADOR, MR.MAQUCODI FROM PRD_HMAQURUT MR) MAA, 
                 FIC_LINEOTRE LA
               WHERE L.EMPRESA = MA.EMPRESA
                 AND L.NUMERO = MA.NUMEOTRE
                 AND MA.FASESEQU = (L.FASE * 100) + L.SECUENCI
					  AND L.TIP_ARES = P_UTILIDAD.F_VALODEVA('TIPORECU')
					  --
					  AND LA.EMPRESA = MAA.EMPRESA
                 AND LA.NUMERO = MAA.NUMEOTRE
                 AND MAA.FASESEQU = (LA.FASE * 100) + LA.SECUENCI
					  AND LA.TIP_ARES = P_UTILIDAD.F_VALODEVA('TIPORECU')
					  --
					  AND L.EMPRESA = LA.EMPRESA
					  AND L.NUMERO = LA.NUMERO
					  AND L.FASE = LA.FASESI05
					  AND LA.FASE != LA.FASESI05
					  AND LA.FASESI05 IS NOT NULL
					  --
                 AND MA.EMPRESA = vEmpresa
                 AND MA.NUMEOTRE = nNumeOtre
                 AND MA.CONTADOR = nContador;
	   --
		nContMaquAnte ANALESTA.ANE_MER_BOBIMAQU_OT.CONTADOR%TYPE;
		vMaquCodi PRD_MAQURUTA.MAQUCODI%TYPE;
		--Verifica si el contador es justo de la máquina siguiente
		CURSOR cContMaquSigu(vEmpresa ANALESTA.ANE_MER_BOBIMAQU_OT.EMPRESA%TYPE, nNumeOtre ANALESTA.ANE_MER_BOBIMAQU_OT.NUMEOTRE%TYPE, nContador ANALESTA.ANE_MER_BOBIMAQU_OT.CONTADOR%TYPE) IS
			SELECT MA.CONTADOR, MA.MAQUCODI
            FROM (SELECT MR.EMPRESA, MR.NUMEOTRE, MR.FASESEQU, MR.CONTADOR, MR.MAQUCODI FROM PRD_MAQURUTA MR
                  WHERE NOT EXISTS (SELECT 'X' FROM PRD_HCABEOTR OTC WHERE OTC.EMPRESA = MR.EMPRESA AND OTC.NUMEOTRE = MR.NUMEOTRE)
                  UNION
                  SELECT MR.EMPRESA, MR.NUMEOTRE, MR.FASESEQU, MR.CONTADOR, MR.MAQUCODI FROM PRD_HMAQURUT MR) MA, 
                 FIC_LINEOTRE L,
					  (SELECT MR.EMPRESA, MR.NUMEOTRE, MR.FASESEQU, MR.CONTADOR, MR.MAQUCODI FROM PRD_MAQURUTA MR
                  WHERE NOT EXISTS (SELECT 'X' FROM PRD_HCABEOTR OTC WHERE OTC.EMPRESA = MR.EMPRESA AND OTC.NUMEOTRE = MR.NUMEOTRE)
                  UNION
                  SELECT MR.EMPRESA, MR.NUMEOTRE, MR.FASESEQU, MR.CONTADOR, MR.MAQUCODI FROM PRD_HMAQURUT MR) MAA, 
                 FIC_LINEOTRE LA
               WHERE L.EMPRESA = MA.EMPRESA
                 AND L.NUMERO = MA.NUMEOTRE
                 AND MA.FASESEQU = (L.FASE * 100) + L.SECUENCI
					  AND L.TIP_ARES = P_UTILIDAD.F_VALODEVA('TIPORECU')
					  --
					  AND LA.EMPRESA = MAA.EMPRESA
                 AND LA.NUMERO = MAA.NUMEOTRE
                 AND MAA.FASESEQU = (LA.FASE * 100) + LA.SECUENCI
					  AND LA.TIP_ARES = P_UTILIDAD.F_VALODEVA('TIPORECU')
					  --
					  AND L.EMPRESA = LA.EMPRESA
					  AND L.NUMERO = LA.NUMERO
					  AND L.FASE = LA.FASESI01
					  AND LA.FASE != LA.FASESI01
					  AND LA.FASESI01 IS NOT NULL
					  --
                 AND MAA.EMPRESA = vEmpresa
                 AND MAA.NUMEOTRE = nNumeOtre
                 AND MAA.CONTADOR = nContador
			UNION
			SELECT MA.CONTADOR, MA.MAQUCODI
            FROM (SELECT MR.EMPRESA, MR.NUMEOTRE, MR.FASESEQU, MR.CONTADOR, MR.MAQUCODI FROM PRD_MAQURUTA MR
                  WHERE NOT EXISTS (SELECT 'X' FROM PRD_HCABEOTR OTC WHERE OTC.EMPRESA = MR.EMPRESA AND OTC.NUMEOTRE = MR.NUMEOTRE)
                  UNION
                  SELECT MR.EMPRESA, MR.NUMEOTRE, MR.FASESEQU, MR.CONTADOR, MR.MAQUCODI FROM PRD_HMAQURUT MR) MA, 
                 FIC_LINEOTRE L,
					  (SELECT MR.EMPRESA, MR.NUMEOTRE, MR.FASESEQU, MR.CONTADOR, MR.MAQUCODI FROM PRD_MAQURUTA MR
                  WHERE NOT EXISTS (SELECT 'X' FROM PRD_HCABEOTR OTC WHERE OTC.EMPRESA = MR.EMPRESA AND OTC.NUMEOTRE = MR.NUMEOTRE)
                  UNION
                  SELECT MR.EMPRESA, MR.NUMEOTRE, MR.FASESEQU, MR.CONTADOR, MR.MAQUCODI FROM PRD_HMAQURUT MR) MAA, 
                 FIC_LINEOTRE LA
               WHERE L.EMPRESA = MA.EMPRESA
                 AND L.NUMERO = MA.NUMEOTRE
                 AND MA.FASESEQU = (L.FASE * 100) + L.SECUENCI
					  AND L.TIP_ARES = P_UTILIDAD.F_VALODEVA('TIPORECU')
					  --
					  AND LA.EMPRESA = MAA.EMPRESA
                 AND LA.NUMERO = MAA.NUMEOTRE
                 AND MAA.FASESEQU = (LA.FASE * 100) + LA.SECUENCI
					  AND LA.TIP_ARES = P_UTILIDAD.F_VALODEVA('TIPORECU')
					  --
					  AND L.EMPRESA = LA.EMPRESA
					  AND L.NUMERO = LA.NUMERO
					  AND L.FASE = LA.FASESI02
					  AND LA.FASE != LA.FASESI02
					  AND LA.FASESI02 IS NOT NULL
					  --
                 AND MAA.EMPRESA = vEmpresa
                 AND MAA.NUMEOTRE = nNumeOtre
                 AND MAA.CONTADOR = nContador
			UNION
			SELECT MA.CONTADOR, MA.MAQUCODI
            FROM (SELECT MR.EMPRESA, MR.NUMEOTRE, MR.FASESEQU, MR.CONTADOR, MR.MAQUCODI FROM PRD_MAQURUTA MR
                  WHERE NOT EXISTS (SELECT 'X' FROM PRD_HCABEOTR OTC WHERE OTC.EMPRESA = MR.EMPRESA AND OTC.NUMEOTRE = MR.NUMEOTRE)
                  UNION
                  SELECT MR.EMPRESA, MR.NUMEOTRE, MR.FASESEQU, MR.CONTADOR, MR.MAQUCODI FROM PRD_HMAQURUT MR) MA, 
                 FIC_LINEOTRE L,
					  (SELECT MR.EMPRESA, MR.NUMEOTRE, MR.FASESEQU, MR.CONTADOR, MR.MAQUCODI FROM PRD_MAQURUTA MR
                  WHERE NOT EXISTS (SELECT 'X' FROM PRD_HCABEOTR OTC WHERE OTC.EMPRESA = MR.EMPRESA AND OTC.NUMEOTRE = MR.NUMEOTRE)
                  UNION
                  SELECT MR.EMPRESA, MR.NUMEOTRE, MR.FASESEQU, MR.CONTADOR, MR.MAQUCODI FROM PRD_HMAQURUT MR) MAA, 
                 FIC_LINEOTRE LA
               WHERE L.EMPRESA = MA.EMPRESA
                 AND L.NUMERO = MA.NUMEOTRE
                 AND MA.FASESEQU = (L.FASE * 100) + L.SECUENCI
					  AND L.TIP_ARES = P_UTILIDAD.F_VALODEVA('TIPORECU')
					  --
					  AND LA.EMPRESA = MAA.EMPRESA
                 AND LA.NUMERO = MAA.NUMEOTRE
                 AND MAA.FASESEQU = (LA.FASE * 100) + LA.SECUENCI
					  AND LA.TIP_ARES = P_UTILIDAD.F_VALODEVA('TIPORECU')
					  --
					  AND L.EMPRESA = LA.EMPRESA
					  AND L.NUMERO = LA.NUMERO
					  AND L.FASE = LA.FASESI03
					  AND LA.FASE != LA.FASESI03
					  AND LA.FASESI03 IS NOT NULL
					  --
                 AND MAA.EMPRESA = vEmpresa
                 AND MAA.NUMEOTRE = nNumeOtre
                 AND MAA.CONTADOR = nContador
			UNION
			SELECT MA.CONTADOR, MA.MAQUCODI
            FROM (SELECT MR.EMPRESA, MR.NUMEOTRE, MR.FASESEQU, MR.CONTADOR, MR.MAQUCODI FROM PRD_MAQURUTA MR
                  WHERE NOT EXISTS (SELECT 'X' FROM PRD_HCABEOTR OTC WHERE OTC.EMPRESA = MR.EMPRESA AND OTC.NUMEOTRE = MR.NUMEOTRE)
                  UNION
                  SELECT MR.EMPRESA, MR.NUMEOTRE, MR.FASESEQU, MR.CONTADOR, MR.MAQUCODI FROM PRD_HMAQURUT MR) MA, 
                 FIC_LINEOTRE L,
					  (SELECT MR.EMPRESA, MR.NUMEOTRE, MR.FASESEQU, MR.CONTADOR, MR.MAQUCODI FROM PRD_MAQURUTA MR
                  WHERE NOT EXISTS (SELECT 'X' FROM PRD_HCABEOTR OTC WHERE OTC.EMPRESA = MR.EMPRESA AND OTC.NUMEOTRE = MR.NUMEOTRE)
                  UNION
                  SELECT MR.EMPRESA, MR.NUMEOTRE, MR.FASESEQU, MR.CONTADOR, MR.MAQUCODI FROM PRD_HMAQURUT MR) MAA, 
                 FIC_LINEOTRE LA
               WHERE L.EMPRESA = MA.EMPRESA
                 AND L.NUMERO = MA.NUMEOTRE
                 AND MA.FASESEQU = (L.FASE * 100) + L.SECUENCI
					  AND L.TIP_ARES = P_UTILIDAD.F_VALODEVA('TIPORECU')
					  --
					  AND LA.EMPRESA = MAA.EMPRESA
                 AND LA.NUMERO = MAA.NUMEOTRE
                 AND MAA.FASESEQU = (LA.FASE * 100) + LA.SECUENCI
					  AND LA.TIP_ARES = P_UTILIDAD.F_VALODEVA('TIPORECU')
					  --
					  AND L.EMPRESA = LA.EMPRESA
					  AND L.NUMERO = LA.NUMERO
					  AND L.FASE = LA.FASESI04
					  AND LA.FASE != LA.FASESI04
					  AND LA.FASESI04 IS NOT NULL
					  --
                 AND MAA.EMPRESA = vEmpresa
                 AND MAA.NUMEOTRE = nNumeOtre
                 AND MAA.CONTADOR = nContador
			UNION
			SELECT MA.CONTADOR, MA.MAQUCODI
            FROM (SELECT MR.EMPRESA, MR.NUMEOTRE, MR.FASESEQU, MR.CONTADOR, MR.MAQUCODI FROM PRD_MAQURUTA MR
                  WHERE NOT EXISTS (SELECT 'X' FROM PRD_HCABEOTR OTC WHERE OTC.EMPRESA = MR.EMPRESA AND OTC.NUMEOTRE = MR.NUMEOTRE)
                  UNION
                  SELECT MR.EMPRESA, MR.NUMEOTRE, MR.FASESEQU, MR.CONTADOR, MR.MAQUCODI FROM PRD_HMAQURUT MR) MA, 
                 FIC_LINEOTRE L,
					  (SELECT MR.EMPRESA, MR.NUMEOTRE, MR.FASESEQU, MR.CONTADOR, MR.MAQUCODI FROM PRD_MAQURUTA MR
                  WHERE NOT EXISTS (SELECT 'X' FROM PRD_HCABEOTR OTC WHERE OTC.EMPRESA = MR.EMPRESA AND OTC.NUMEOTRE = MR.NUMEOTRE)
                  UNION
                  SELECT MR.EMPRESA, MR.NUMEOTRE, MR.FASESEQU, MR.CONTADOR, MR.MAQUCODI FROM PRD_HMAQURUT MR) MAA, 
                 FIC_LINEOTRE LA
               WHERE L.EMPRESA = MA.EMPRESA
                 AND L.NUMERO = MA.NUMEOTRE
                 AND MA.FASESEQU = (L.FASE * 100) + L.SECUENCI
					  AND L.TIP_ARES = P_UTILIDAD.F_VALODEVA('TIPORECU')
					  --
					  AND LA.EMPRESA = MAA.EMPRESA
                 AND LA.NUMERO = MAA.NUMEOTRE
                 AND MAA.FASESEQU = (LA.FASE * 100) + LA.SECUENCI
					  AND LA.TIP_ARES = P_UTILIDAD.F_VALODEVA('TIPORECU')
					  --
					  AND L.EMPRESA = LA.EMPRESA
					  AND L.NUMERO = LA.NUMERO
					  AND L.FASE = LA.FASESI05
					  AND LA.FASE != LA.FASESI05
					  AND LA.FASESI05 IS NOT NULL
					  --
                 AND MAA.EMPRESA = vEmpresa
                 AND MAA.NUMEOTRE = nNumeOtre
                 AND MAA.CONTADOR = nContador;
	   --
		nContMaquSigu ANALESTA.ANE_MER_BOBIMAQU_OT.CONTADOR%TYPE;
		vMaquCodiSigu PRD_MAQURUTA.MAQUCODI%TYPE;
		--
		CURSOR cANE_M_PRO_REAL(vEmpresa ANALESTA.ANE_MER_BOBIMAQU_OT.EMPRESA%TYPE, nNumeOtre ANALESTA.ANE_MER_BOBIMAQU_OT.NUMEOTRE%TYPE) IS
		   --NEW
			SELECT ME.ROWID, ME.*
			--SELECT ROWID, FASE_MP, TIPO_MP, ML_CONSUMIDOS, M2_CONSUMIDOS, EUROS_ML_CONSUMIDOS
			--FIN NEW
			FROM ANALESTA.ANE_M_PRO_REAL ME
			WHERE ME.EMPRESA = vEmpresa 
			  AND ME.OT = nNumeOtre;
		--
		CURSOR cANE_M_PRO_REAL_MAQUANTE(vEmpresa ANALESTA.ANE_MER_BOBIMAQU_OT.EMPRESA%TYPE, nNumeOtre ANALESTA.ANE_MER_BOBIMAQU_OT.NUMEOTRE%TYPE, nContador ANALESTA.ANE_MER_BOBIMAQU_OT.CONTADOR%TYPE) IS
		   SELECT SUM(ML_PRODUCIDOS_REALES) ML_PRODUCIDOS_REALES
			FROM ANALESTA.ANE_M_PRO_REAL 
			WHERE EMPRESA = vEmpresa 
			  AND OT = nNumeOtre
			  AND FASE_MP = nContador;
		--
		nML_Producidos_Maquina_Ant NUMBER;
		nM2_Producidos_Maquina_Ant NUMBER;
		--
		vMaquinas VARCHAR2(5000);
	   --
      vTiarSeF4 VARIABLES.VALOR%TYPE := P_UTILIDAD.F_VALODEVA('TIARSEF4');
      vTiarMpF4 VARIABLES.VALOR%TYPE := P_UTILIDAD.F_VALODEVA('TIARMPF4');
      vTiarFiF4 VARIABLES.VALOR%TYPE := P_UTILIDAD.F_VALODEVA('TIARFIF4');
      vTiarReF4 VARIABLES.VALOR%TYPE := P_UTILIDAD.F_VALODEVA('TIARREST');
		--NEW
		vTiarCOSC VARIABLES.VALOR%TYPE := P_UTILIDAD.F_VALODEVA('TIARCOSC');
		--FIN NEW
		--
		nAncho NUMBER;
		nPrecio NUMBER;
		--NEW
		vExisEstru VARCHAR2(1);
		--
		CURSOR cExisEstru(vEmpresa ANALESTA.ANE_M_PRO_REAL_MATERIALES.EMPRESA%TYPE, nNumeOtre ANALESTA.ANE_M_PRO_REAL_MATERIALES.OT%TYPE,
		                  vTipo_Material ANALESTA.ANE_M_PRO_REAL_MATERIALES.TIPO_MATERIAL%TYPE, vMaterial ANALESTA.ANE_M_PRO_REAL_MATERIALES.MATERIAL%TYPE, nFase_Material ANALESTA.ANE_M_PRO_REAL_MATERIALES.FASE_MATERIAL%TYPE,
								vTipo_CompMate ANALESTA.ANE_M_PRO_REAL_MATERIALES.TIPO_COMPMATE%TYPE, vCodi_CompMate ANALESTA.ANE_M_PRO_REAL_MATERIALES.CODI_COMPMATE%TYPE, nFase_CompMate ANALESTA.ANE_M_PRO_REAL_MATERIALES.FASE_COMPMATE%TYPE) IS
		    SELECT 'X' FROM ANALESTA.ANE_M_PRO_REAL_MATERIALES
             WHERE EMPRESA = vEmpresa
					AND OT = nNumeOtre
	            AND TIPO_MATERIAL = vTipo_Material
	            AND MATERIAL = vMaterial
	            AND FASE_MATERIAL = nFase_Material
	            AND TIPO_COMPMATE = vTipo_CompMate
	            AND CODI_COMPMATE = vCodi_CompMate
	            AND FASE_COMPMATE = nFase_CompMate;
		--
		CURSOR cEstructura(vEmpresa ANALESTA.ANE_M_PRO_REAL_MATERIALES.EMPRESA%TYPE, nNumeOtre ANALESTA.ANE_M_PRO_REAL_MATERIALES.OT%TYPE,
		                   vTipo_Material ANALESTA.ANE_M_PRO_REAL_MATERIALES.TIPO_MATERIAL%TYPE, vMaterial ANALESTA.ANE_M_PRO_REAL_MATERIALES.MATERIAL%TYPE, nFase_Material ANALESTA.ANE_M_PRO_REAL_MATERIALES.FASE_MATERIAL%TYPE) IS
		    SELECT M.*,
			        --NEW IV
					  M.ROWID
					  --END NEW IV
			 FROM ANALESTA.ANE_M_PRO_REAL_MATERIALES E, ANALESTA.ANE_M_PRO_REAL M
             WHERE E.EMPRESA = vEmpresa
					AND E.OT = nNumeOtre
	            AND E.TIPO_MATERIAL = vTipo_Material
	            AND E.MATERIAL = vMaterial
	            AND E.FASE_MATERIAL = nFase_Material
					AND E.EMPRESA = M.EMPRESA
					AND E.OT = M.OT
               AND E.TIPO_COMPMATE = M.TIPO_MP
               AND E.CODI_COMPMATE = M.COD_MP
					AND E.FASE_COMPMATE = M.FASE_MP
					AND E.TIPO_COMPMATE IN (vTiarMPF4,vTiarSEF4,vTiarFIF4,vTiarCOSC,
					                        --NEW II
													vTiarReF4);
													--FIN NEW II
		--FIN NEW 
		--NEW IV
		CURSOR cEstructura_Total(vEmpresa ANALESTA.ANE_M_PRO_REAL_MATERIALES.EMPRESA%TYPE, nNumeOtre ANALESTA.ANE_M_PRO_REAL_MATERIALES.OT%TYPE,
		                         vTipo_Material ANALESTA.ANE_M_PRO_REAL_MATERIALES.TIPO_MATERIAL%TYPE, vMaterial ANALESTA.ANE_M_PRO_REAL_MATERIALES.MATERIAL%TYPE, nFase_Material ANALESTA.ANE_M_PRO_REAL_MATERIALES.FASE_MATERIAL%TYPE) IS
		    SELECT M.*,
			        --NEW IV
					  M.ROWID
					  --END NEW IV
			 FROM ANALESTA.ANE_M_PRO_REAL_MATERIALES E, ANALESTA.ANE_M_PRO_REAL M
             WHERE E.EMPRESA = vEmpresa
					AND E.OT = nNumeOtre
	            AND E.TIPO_MATERIAL = vTipo_Material
	            AND E.MATERIAL = vMaterial
	            AND E.FASE_MATERIAL = nFase_Material
					AND E.EMPRESA = M.EMPRESA
					AND E.OT = M.OT
               AND E.TIPO_COMPMATE = M.TIPO_MP
               AND E.CODI_COMPMATE = M.COD_MP
					AND E.FASE_COMPMATE = M.FASE_MP;
		--
		CURSOR cANE_M_PRO_REAL_VALOREAL(vEmpresa ANALESTA.ANE_MER_BOBIMAQU_OT.EMPRESA%TYPE, nNumeOtre ANALESTA.ANE_MER_BOBIMAQU_OT.NUMEOTRE%TYPE, nContador ANALESTA.ANE_MER_BOBIMAQU_OT.CONTADOR%TYPE,
		                                vTip_Arti ANALESTA.ANE_M_PRO_REAL.TIPO_MP%TYPE, vCod_Arti ANALESTA.ANE_M_PRO_REAL.COD_MP%TYPE) IS
		   SELECT ML_CONSUMIDOS_REALES, M2_CONSUMIDOS_REALES, ML_PRODUCIDOS_REALES, M2_PRODUCIDOS_REALES, ANCHO_MP,
					 ML_CONSUMIDOS_REALES_01,ML_CONSUMIDOS_REALES_02,ML_CONSUMIDOS_REALES_03,ML_CONSUMIDOS_REALES_04,ML_CONSUMIDOS_REALES_05,
					 ML_CONSUMIDOS_REALES_06,ML_CONSUMIDOS_REALES_07,ML_CONSUMIDOS_REALES_08,ML_CONSUMIDOS_REALES_09,ML_CONSUMIDOS_REALES_10,
					 M2_CONSUMIDOS_REALES_01,M2_CONSUMIDOS_REALES_02,M2_CONSUMIDOS_REALES_03,M2_CONSUMIDOS_REALES_04,M2_CONSUMIDOS_REALES_05,
					 M2_CONSUMIDOS_REALES_06,M2_CONSUMIDOS_REALES_07,M2_CONSUMIDOS_REALES_08,M2_CONSUMIDOS_REALES_09,M2_CONSUMIDOS_REALES_10,
					 --
					 ML_PRODUCIDOS_REALES_01,ML_PRODUCIDOS_REALES_02,ML_PRODUCIDOS_REALES_03,ML_PRODUCIDOS_REALES_04,ML_PRODUCIDOS_REALES_05,
					 ML_PRODUCIDOS_REALES_06,ML_PRODUCIDOS_REALES_07,ML_PRODUCIDOS_REALES_08,ML_PRODUCIDOS_REALES_09,ML_PRODUCIDOS_REALES_10,
					 M2_PRODUCIDOS_REALES_01,M2_PRODUCIDOS_REALES_02,M2_PRODUCIDOS_REALES_03,M2_PRODUCIDOS_REALES_04,M2_PRODUCIDOS_REALES_05,
					 M2_PRODUCIDOS_REALES_06,M2_PRODUCIDOS_REALES_07,M2_PRODUCIDOS_REALES_08,M2_PRODUCIDOS_REALES_09,M2_PRODUCIDOS_REALES_10--,
					 --
					 --DECODE(NVL(M2_CONSUMIDOS,0),0,0,NVL(EUROS_ML_CONSUMIDOS,0) / M2_CONSUMIDOS) PRECIO
			FROM ANALESTA.ANE_M_PRO_REAL 
			WHERE EMPRESA = vEmpresa 
			  AND OT = nNumeOtre
			  AND FASE_MP = nContador
			  AND TIPO_MP = vTip_Arti
			  AND COD_MP = vCod_Arti;
		--
		rANE_M_PRO_REAL_VALOREAL cANE_M_PRO_REAL_VALOREAL%ROWTYPE;
		--
		CURSOR cANE_M_PRO_REAL_VALOREAL_PREC(vEmpresa ANALESTA.ANE_MER_BOBIMAQU_OT.EMPRESA%TYPE, nNumeOtre ANALESTA.ANE_MER_BOBIMAQU_OT.NUMEOTRE%TYPE, nContador ANALESTA.ANE_MER_BOBIMAQU_OT.CONTADOR%TYPE,
		                                       vLFS_MP ANALESTA.ANE_M_PRO_REAL.LFS_MP%TYPE) IS
		   SELECT DECODE(SUM(NVL(M2_CONSUMIDOS,0)),0,0,SUM(NVL(EUROS_ML_CONSUMIDOS,0)) / SUM(M2_CONSUMIDOS)) PRECIO
			FROM ANALESTA.ANE_M_PRO_REAL 
			WHERE EMPRESA = vEmpresa 
			  AND OT = nNumeOtre
			  AND FASE_MP = nContador
			  AND LFS_MP = vLFS_MP;
		--
		rANE_M_PRO_REAL_VALOREAL_PREC cANE_M_PRO_REAL_VALOREAL_PREC%ROWTYPE;
		--
		CURSOR cEstructura_MaquAnte(vEmpresa ANALESTA.ANE_M_PRO_REAL_MATERIALES.EMPRESA%TYPE, nNumeOtre ANALESTA.ANE_M_PRO_REAL_MATERIALES.OT%TYPE,
		                            vTipo_Material ANALESTA.ANE_M_PRO_REAL_MATERIALES.TIPO_MATERIAL%TYPE, vMaterial ANALESTA.ANE_M_PRO_REAL_MATERIALES.MATERIAL%TYPE, nFase_Material ANALESTA.ANE_M_PRO_REAL_MATERIALES.FASE_MATERIAL%TYPE,
											 nFase_Material_Anterior ANALESTA.ANE_M_PRO_REAL_MATERIALES.FASE_MATERIAL%TYPE) IS
		    SELECT M.*,
			        --NEW IV
					  M.ROWID
					  --END NEW IV
			 FROM ANALESTA.ANE_M_PRO_REAL_MATERIALES E, ANALESTA.ANE_M_PRO_REAL M
             WHERE E.EMPRESA = vEmpresa
					AND E.OT = nNumeOtre
	            AND E.TIPO_MATERIAL = vTipo_Material
	            AND E.MATERIAL = vMaterial
	            AND E.FASE_MATERIAL = nFase_Material
					AND E.EMPRESA = M.EMPRESA
					AND E.OT = M.OT
               AND E.TIPO_COMPMATE = M.TIPO_MP
               AND E.CODI_COMPMATE = M.COD_MP
					AND E.FASE_COMPMATE = M.FASE_MP
					--
					AND M.FASE_MP = nFase_Material_Anterior;
		--
		nML_Consumidos_Reales NUMBER;
		nM2_Consumidos_Reales NUMBER;
		nML_Producidos_Reales NUMBER;
		nM2_Producidos_Reales NUMBER;
		--
		/*CURSOR cANE_M_PRO_REAL_MAQUANTE_MATE(vEmpresa ANALESTA.ANE_MER_BOBIMAQU_OT.EMPRESA%TYPE, nNumeOtre ANALESTA.ANE_MER_BOBIMAQU_OT.NUMEOTRE%TYPE, nContador ANALESTA.ANE_MER_BOBIMAQU_OT.CONTADOR%TYPE,
		                                vTip_Arti ANALESTA.ANE_M_PRO_REAL.TIPO_MP%TYPE, vCod_Arti ANALESTA.ANE_M_PRO_REAL.COD_MP%TYPE) IS
		   SELECT SUM(ML_PRODUCIDOS_REALES) ML_PRODUCIDOS_REALES, SUM(M2_PRODUCIDOS_REALES) M2_PRODUCIDOS_REALES
			FROM ANALESTA.ANE_M_PRO_REAL 
			WHERE EMPRESA = vEmpresa 
			  AND OT = nNumeOtre
			  AND FASE_MP = nContador
			  AND TIPO_MP = vTip_Arti
			  AND COD_MP = vCod_Arti;
		--
		nML_Producidos_Maquina_Ant_Mate NUMBER;
		nM2_Producidos_Maquina_Ant_Mate NUMBER;
		--
		CURSOR cANE_M_PRO_REAL_MATE(vEmpresa ANALESTA.ANE_MER_BOBIMAQU_OT.EMPRESA%TYPE, nNumeOtre ANALESTA.ANE_MER_BOBIMAQU_OT.NUMEOTRE%TYPE, nContador ANALESTA.ANE_MER_BOBIMAQU_OT.CONTADOR%TYPE) IS
		   --NEW
			SELECT ME.ROWID, ME.*
			--SELECT ROWID, FASE_MP, TIPO_MP, ML_CONSUMIDOS, M2_CONSUMIDOS, EUROS_ML_CONSUMIDOS
			--FIN NEW
			FROM ANALESTA.ANE_M_PRO_REAL ME
			WHERE ME.EMPRESA = vEmpresa 
			  AND ME.OT = nNumeOtre
			  AND FASE_MP = nContador;*/
		--END NEW IV
		--Cursor que verifica las bobinas que intervinieron para buscar las mermas
		FUNCTION F_RAMA(vMaterial VARCHAR2) 
		RETURN VARCHAR2 IS
			CURSOR cRama(vEmprBobi VARCHAR2, 
							 nNuotBobi VARCHAR2, 
							 --nContBobi NUMBER, 
							 nCoboGene NUMBER--, 
							 --vLote VARCHAR2
							 ) IS
				SELECT 'MAQUINA:'||M.MAQUCODI||
					  '<>CONTADOR:'||P.CONTADOR||
					  '<>TIP_ARTI:'||P.TIP_ARTI||
					  '<>COD_ARTI:'||P.COD_ARTI||
					  '<>LOTE:'||P.LOTE||
					  '<>EMPRBOBI:'||P.EMPRBOBI||
					  '<>NUOTBOBI:'||P.NUOTBOBI||
					  '<>CONTBOBI:'||P.CONTBOBI||
					  '<>COBOBOBI:'||P.COBOBOBI||
					  '<>COBOGENE:'||P.COBOGENE||
					  '<>CONTMATE:'||P.CONTMATE RAMA,
						 P.EMPRBOBI, P.NUOTBOBI, P.CONTBOBI, P.COBOBOBI, P.LOTE FROM
				(
				SELECT EMPRESA, NUMEOTRE, CONTADOR, CONTMATE, TIP_ARTI, COD_ARTI, EMPRBOBI, NUOTBOBI, CONTBOBI, NULL COBOBOBI, LOTE, COBOBOBI COBOGENE
				FROM PRD_MAPAMAQU
				WHERE EMPRESA = vEmprBobi
				  AND NUMEOTRE = nNuotBobi
				  AND COBOBOBI = nCoboGene
				  AND COBOBOBI < 0
				  AND NUMEOTRE = NUOTBOBI
				  AND MARCPASA = 'N'
				UNION
				SELECT EMPRESA, NUMEOTRE, CONTADOR, CONTMATE, TIP_ARTI, COD_ARTI, EMPRBOBI, NUOTBOBI, CONTBOBI, COBOBOBI, LOTE, COBOGENE
				FROM PRD_MAPAMAQU
				WHERE EMPRESA = vEmprBobi
				  AND NUMEOTRE = nNuotBobi
				  --AND CONTBOBI = nContBobi
				  AND COBOGENE = nCoboGene
				  --AND LOTE = vLote
				  --AND NUMEOTRE = NUOTBOBI
				  AND MARCPASA = 'N'
				UNION
				SELECT M.EMPRESA, M.NUMEOTRE, M.CONTADOR, M.CONTMATE, M.TIP_ARTI, M.COD_ARTI, M.EMPRBOBI, M.NUOTBOBI, M.CONTBOBI, M.COBOBOBI, M.LOTE, M.COBOGENE
				FROM PRD_MAPAMAQU M
				WHERE M.EMPRESA = vEmprBobi
				  AND M.NUMEOTRE = nNuotBobi
				  --AND CONTBOBI = nContBobi
				  AND M.COBOGENE IN (SELECT C.COBOPADR FROM PRD_LIBOCORT C WHERE C.EMPRESA = M.EMPRESA AND C.NUMEOTRE = M.NUMEOTRE AND C.CONTBOBI = nCoboGene)--= nCoboGene
				  --AND LOTE = vLote
				  --AND NUMEOTRE = NUOTBOBI
				  AND M.MARCPASA = 'N') P,
						(SELECT MR.EMPRESA, MR.NUMEOTRE, MR.MAQUCODI, MR.CONTADOR FROM PRD_MAQURUTA MR
						 WHERE NOT EXISTS (SELECT 'X' FROM PRD_HCABEOTR OTC WHERE OTC.EMPRESA = MR.EMPRESA AND OTC.NUMEOTRE = MR.NUMEOTRE)
						 UNION
						 SELECT MR.EMPRESA, MR.NUMEOTRE, MR.MAQUCODI, MR.CONTADOR FROM PRD_HMAQURUT MR) M
				WHERE M.EMPRESA = P.EMPRESA
				  AND M.NUMEOTRE = P.NUMEOTRE
				  AND M.CONTADOR = P.CONTADOR;
		BEGIN
			FOR rRama IN cRama(P_UTILIDAD.F_VALOCAMPO(vMaterial,'EMPRBOBI')
									,P_UTILIDAD.F_VALOCAMPO(vMaterial,'NUOTBOBI')
									--,NVL(P_UTILIDAD.F_VALOCAMPO(vMaterial,'CONTBOBI'),P_UTILIDAD.F_VALOCAMPO(vMaterial,'COBOMATE'))
									,NVL(P_UTILIDAD.F_VALOCAMPO(vMaterial,'COBOBOBI'),P_UTILIDAD.F_VALOCAMPO(vMaterial,'BOBIMATE'))
									--,P_UTILIDAD.F_VALOCAMPO(vMaterial,'LOTE')
									 )LOOP
				IF vRama IS NULL THEN
					vRama := '|'||rRama.RAMA||'|'||'MAQUINA:'||P_UTILIDAD.F_VALOCAMPO(vMaterial,'MAQUCODI')||
														  '<>CONTADOR:'||P_UTILIDAD.F_VALOCAMPO(vMaterial,'CONTADOR')||
														  '<>TIP_ARTI:'||P_UTILIDAD.F_VALOCAMPO(vMaterial,'TIP_ARTI')||
														  '<>COD_ARTI:'||P_UTILIDAD.F_VALOCAMPO(vMaterial,'COD_ARTI')||
														  '<>LOTE:'||P_UTILIDAD.F_VALOCAMPO(vMaterial,'LOTE')||
														  '<>EMPRBOBI:'||P_UTILIDAD.F_VALOCAMPO(vMaterial,'EMPRBOBI')||
														  '<>NUOTBOBI:'||P_UTILIDAD.F_VALOCAMPO(vMaterial,'NUOTBOBI')||
														  '<>CONTBOBI:'||NVL(P_UTILIDAD.F_VALOCAMPO(vMaterial,'CONTBOBI'),P_UTILIDAD.F_VALOCAMPO(vMaterial,'COBOMATE'))||
														  '<>COBOBOBI:'||NVL(P_UTILIDAD.F_VALOCAMPO(vMaterial,'COBOBOBI'),P_UTILIDAD.F_VALOCAMPO(vMaterial,'BOBIMATE'))||
														  '<>COBOGENE:'||
														  '<>CONTMATE:';
				ELSE
					vRama := '|'||rRama.RAMA||vRama;
				END IF;
				--
				IF rRama.COBOBOBI > 0 THEN
					vRama := F_RAMA('|EMPRBOBI:'||rRama.EMPRBOBI||'|NUOTBOBI:'||rRama.NUOTBOBI||'|CONTBOBI:'||rRama.CONTBOBI||'|COBOBOBI:'||rRama.COBOBOBI||'|LOTE:'||rRama.LOTE);
				END IF;
			END LOOP;
			--
			RETURN vRama;
		END;
      --
		FUNCTION F_BUSCA_MERMAS_ANTERIORES(vEmpresa ANALESTA.ANE_MER_BOBIMAQU_OT.EMPRESA%TYPE, nNumeOtre ANALESTA.ANE_MER_BOBIMAQU_OT.NUMEOTRE%TYPE, nContador ANALESTA.ANE_MER_BOBIMAQU_OT.CONTADOR%TYPE, vMaquCodi PRD_MAQURUTA.MAQUCODI%TYPE) 
		RETURN VARCHAR2 IS
			--Verifica si el contador es justo de la máquina anterior
			CURSOR cContMaquAnte(vEmpresa ANALESTA.ANE_MER_BOBIMAQU_OT.EMPRESA%TYPE, nNumeOtre ANALESTA.ANE_MER_BOBIMAQU_OT.NUMEOTRE%TYPE, nContador ANALESTA.ANE_MER_BOBIMAQU_OT.CONTADOR%TYPE) IS
				SELECT MAA.EMPRESA, MAA.NUMEOTRE, MAA.CONTADOR, MAA.MAQUCODI
					FROM (SELECT MR.EMPRESA, MR.NUMEOTRE, MR.FASESEQU, MR.CONTADOR, MR.MAQUCODI FROM PRD_MAQURUTA MR
							WHERE NOT EXISTS (SELECT 'X' FROM PRD_HCABEOTR OTC WHERE OTC.EMPRESA = MR.EMPRESA AND OTC.NUMEOTRE = MR.NUMEOTRE)
							UNION
							SELECT MR.EMPRESA, MR.NUMEOTRE, MR.FASESEQU, MR.CONTADOR, MR.MAQUCODI FROM PRD_HMAQURUT MR) MA, 
						  FIC_LINEOTRE L,
						  (SELECT MR.EMPRESA, MR.NUMEOTRE, MR.FASESEQU, MR.CONTADOR, MR.MAQUCODI FROM PRD_MAQURUTA MR
							WHERE NOT EXISTS (SELECT 'X' FROM PRD_HCABEOTR OTC WHERE OTC.EMPRESA = MR.EMPRESA AND OTC.NUMEOTRE = MR.NUMEOTRE)
							UNION
							SELECT MR.EMPRESA, MR.NUMEOTRE, MR.FASESEQU, MR.CONTADOR, MR.MAQUCODI FROM PRD_HMAQURUT MR) MAA, 
						  FIC_LINEOTRE LA
						WHERE L.EMPRESA = MA.EMPRESA
						  AND L.NUMERO = MA.NUMEOTRE
						  AND MA.FASESEQU = (L.FASE * 100) + L.SECUENCI
						  AND L.TIP_ARES = P_UTILIDAD.F_VALODEVA('TIPORECU')
						  --
						  AND LA.EMPRESA = MAA.EMPRESA
						  AND LA.NUMERO = MAA.NUMEOTRE
						  AND MAA.FASESEQU = (LA.FASE * 100) + LA.SECUENCI
						  AND LA.TIP_ARES = P_UTILIDAD.F_VALODEVA('TIPORECU')
						  --
						  AND L.EMPRESA = LA.EMPRESA
						  AND L.NUMERO = LA.NUMERO
						  AND L.FASE = LA.FASESI01
						  AND LA.FASE != LA.FASESI01
						  AND LA.FASESI01 IS NOT NULL
						  --
						  AND MA.EMPRESA = vEmpresa
						  AND MA.NUMEOTRE = nNumeOtre
						  AND MA.CONTADOR = nContador
				UNION
				SELECT MAA.EMPRESA, MAA.NUMEOTRE, MAA.CONTADOR, MAA.MAQUCODI
					FROM (SELECT MR.EMPRESA, MR.NUMEOTRE, MR.FASESEQU, MR.CONTADOR, MR.MAQUCODI FROM PRD_MAQURUTA MR
							WHERE NOT EXISTS (SELECT 'X' FROM PRD_HCABEOTR OTC WHERE OTC.EMPRESA = MR.EMPRESA AND OTC.NUMEOTRE = MR.NUMEOTRE)
							UNION
							SELECT MR.EMPRESA, MR.NUMEOTRE, MR.FASESEQU, MR.CONTADOR, MR.MAQUCODI FROM PRD_HMAQURUT MR) MA, 
						  FIC_LINEOTRE L,
						  (SELECT MR.EMPRESA, MR.NUMEOTRE, MR.FASESEQU, MR.CONTADOR, MR.MAQUCODI FROM PRD_MAQURUTA MR
							WHERE NOT EXISTS (SELECT 'X' FROM PRD_HCABEOTR OTC WHERE OTC.EMPRESA = MR.EMPRESA AND OTC.NUMEOTRE = MR.NUMEOTRE)
							UNION
							SELECT MR.EMPRESA, MR.NUMEOTRE, MR.FASESEQU, MR.CONTADOR, MR.MAQUCODI FROM PRD_HMAQURUT MR) MAA, 
						  FIC_LINEOTRE LA
						WHERE L.EMPRESA = MA.EMPRESA
						  AND L.NUMERO = MA.NUMEOTRE
						  AND MA.FASESEQU = (L.FASE * 100) + L.SECUENCI
						  AND L.TIP_ARES = P_UTILIDAD.F_VALODEVA('TIPORECU')
						  --
						  AND LA.EMPRESA = MAA.EMPRESA
						  AND LA.NUMERO = MAA.NUMEOTRE
						  AND MAA.FASESEQU = (LA.FASE * 100) + LA.SECUENCI
						  AND LA.TIP_ARES = P_UTILIDAD.F_VALODEVA('TIPORECU')
						  --
						  AND L.EMPRESA = LA.EMPRESA
						  AND L.NUMERO = LA.NUMERO
						  AND L.FASE = LA.FASESI02
						  AND LA.FASE != LA.FASESI02
						  AND LA.FASESI02 IS NOT NULL
						  --
						  AND MA.EMPRESA = vEmpresa
						  AND MA.NUMEOTRE = nNumeOtre
						  AND MA.CONTADOR = nContador
				UNION
				SELECT MAA.EMPRESA, MAA.NUMEOTRE, MAA.CONTADOR, MAA.MAQUCODI
					FROM (SELECT MR.EMPRESA, MR.NUMEOTRE, MR.FASESEQU, MR.CONTADOR, MR.MAQUCODI FROM PRD_MAQURUTA MR
							WHERE NOT EXISTS (SELECT 'X' FROM PRD_HCABEOTR OTC WHERE OTC.EMPRESA = MR.EMPRESA AND OTC.NUMEOTRE = MR.NUMEOTRE)
							UNION
							SELECT MR.EMPRESA, MR.NUMEOTRE, MR.FASESEQU, MR.CONTADOR, MR.MAQUCODI FROM PRD_HMAQURUT MR) MA, 
						  FIC_LINEOTRE L,
						  (SELECT MR.EMPRESA, MR.NUMEOTRE, MR.FASESEQU, MR.CONTADOR, MR.MAQUCODI FROM PRD_MAQURUTA MR
							WHERE NOT EXISTS (SELECT 'X' FROM PRD_HCABEOTR OTC WHERE OTC.EMPRESA = MR.EMPRESA AND OTC.NUMEOTRE = MR.NUMEOTRE)
							UNION
							SELECT MR.EMPRESA, MR.NUMEOTRE, MR.FASESEQU, MR.CONTADOR, MR.MAQUCODI FROM PRD_HMAQURUT MR) MAA, 
						  FIC_LINEOTRE LA
						WHERE L.EMPRESA = MA.EMPRESA
						  AND L.NUMERO = MA.NUMEOTRE
						  AND MA.FASESEQU = (L.FASE * 100) + L.SECUENCI
						  AND L.TIP_ARES = P_UTILIDAD.F_VALODEVA('TIPORECU')
						  --
						  AND LA.EMPRESA = MAA.EMPRESA
						  AND LA.NUMERO = MAA.NUMEOTRE
						  AND MAA.FASESEQU = (LA.FASE * 100) + LA.SECUENCI
						  AND LA.TIP_ARES = P_UTILIDAD.F_VALODEVA('TIPORECU')
						  --
						  AND L.EMPRESA = LA.EMPRESA
						  AND L.NUMERO = LA.NUMERO
						  AND L.FASE = LA.FASESI03
						  AND LA.FASE != LA.FASESI03
						  AND LA.FASESI03 IS NOT NULL
						  --
						  AND MA.EMPRESA = vEmpresa
						  AND MA.NUMEOTRE = nNumeOtre
						  AND MA.CONTADOR = nContador
				UNION
				SELECT MAA.EMPRESA, MAA.NUMEOTRE, MAA.CONTADOR, MAA.MAQUCODI
					FROM (SELECT MR.EMPRESA, MR.NUMEOTRE, MR.FASESEQU, MR.CONTADOR, MR.MAQUCODI FROM PRD_MAQURUTA MR
							WHERE NOT EXISTS (SELECT 'X' FROM PRD_HCABEOTR OTC WHERE OTC.EMPRESA = MR.EMPRESA AND OTC.NUMEOTRE = MR.NUMEOTRE)
							UNION
							SELECT MR.EMPRESA, MR.NUMEOTRE, MR.FASESEQU, MR.CONTADOR, MR.MAQUCODI FROM PRD_HMAQURUT MR) MA, 
						  FIC_LINEOTRE L,
						  (SELECT MR.EMPRESA, MR.NUMEOTRE, MR.FASESEQU, MR.CONTADOR, MR.MAQUCODI FROM PRD_MAQURUTA MR
							WHERE NOT EXISTS (SELECT 'X' FROM PRD_HCABEOTR OTC WHERE OTC.EMPRESA = MR.EMPRESA AND OTC.NUMEOTRE = MR.NUMEOTRE)
							UNION
							SELECT MR.EMPRESA, MR.NUMEOTRE, MR.FASESEQU, MR.CONTADOR, MR.MAQUCODI FROM PRD_HMAQURUT MR) MAA, 
						  FIC_LINEOTRE LA
						WHERE L.EMPRESA = MA.EMPRESA
						  AND L.NUMERO = MA.NUMEOTRE
						  AND MA.FASESEQU = (L.FASE * 100) + L.SECUENCI
						  AND L.TIP_ARES = P_UTILIDAD.F_VALODEVA('TIPORECU')
						  --
						  AND LA.EMPRESA = MAA.EMPRESA
						  AND LA.NUMERO = MAA.NUMEOTRE
						  AND MAA.FASESEQU = (LA.FASE * 100) + LA.SECUENCI
						  AND LA.TIP_ARES = P_UTILIDAD.F_VALODEVA('TIPORECU')
						  --
						  AND L.EMPRESA = LA.EMPRESA
						  AND L.NUMERO = LA.NUMERO
						  AND L.FASE = LA.FASESI04
						  AND LA.FASE != LA.FASESI04
						  AND LA.FASESI04 IS NOT NULL
						  --
						  AND MA.EMPRESA = vEmpresa
						  AND MA.NUMEOTRE = nNumeOtre
						  AND MA.CONTADOR = nContador
				UNION
				SELECT MAA.EMPRESA, MAA.NUMEOTRE, MAA.CONTADOR, MAA.MAQUCODI
					FROM (SELECT MR.EMPRESA, MR.NUMEOTRE, MR.FASESEQU, MR.CONTADOR, MR.MAQUCODI FROM PRD_MAQURUTA MR
							WHERE NOT EXISTS (SELECT 'X' FROM PRD_HCABEOTR OTC WHERE OTC.EMPRESA = MR.EMPRESA AND OTC.NUMEOTRE = MR.NUMEOTRE)
							UNION
							SELECT MR.EMPRESA, MR.NUMEOTRE, MR.FASESEQU, MR.CONTADOR, MR.MAQUCODI FROM PRD_HMAQURUT MR) MA, 
						  FIC_LINEOTRE L,
						  (SELECT MR.EMPRESA, MR.NUMEOTRE, MR.FASESEQU, MR.CONTADOR, MR.MAQUCODI FROM PRD_MAQURUTA MR
							WHERE NOT EXISTS (SELECT 'X' FROM PRD_HCABEOTR OTC WHERE OTC.EMPRESA = MR.EMPRESA AND OTC.NUMEOTRE = MR.NUMEOTRE)
							UNION
							SELECT MR.EMPRESA, MR.NUMEOTRE, MR.FASESEQU, MR.CONTADOR, MR.MAQUCODI FROM PRD_HMAQURUT MR) MAA, 
						  FIC_LINEOTRE LA
						WHERE L.EMPRESA = MA.EMPRESA
						  AND L.NUMERO = MA.NUMEOTRE
						  AND MA.FASESEQU = (L.FASE * 100) + L.SECUENCI
						  AND L.TIP_ARES = P_UTILIDAD.F_VALODEVA('TIPORECU')
						  --
						  AND LA.EMPRESA = MAA.EMPRESA
						  AND LA.NUMERO = MAA.NUMEOTRE
						  AND MAA.FASESEQU = (LA.FASE * 100) + LA.SECUENCI
						  AND LA.TIP_ARES = P_UTILIDAD.F_VALODEVA('TIPORECU')
						  --
						  AND L.EMPRESA = LA.EMPRESA
						  AND L.NUMERO = LA.NUMERO
						  AND L.FASE = LA.FASESI05
						  AND LA.FASE != LA.FASESI05
						  AND LA.FASESI05 IS NOT NULL
						  --
						  AND MA.EMPRESA = vEmpresa
						  AND MA.NUMEOTRE = nNumeOtre
						  AND MA.CONTADOR = nContador;
		BEGIN
			FOR rContMaquAnte IN cContMaquAnte(vEmpresa, nNumeOtre, nContador) LOOP
				IF vMaquinas IS NULL THEN
					vMaquinas := '|EMPRESA:'||vEmpresa||'|NUMEOTRE:'||nNumeOtre||'|CONTADOR:'||nContador||'|MAQUCODI:'||vMaquCodi||'|EMPRESA:'||rContMaquAnte.EMPRESA||'|NUMEOTRE:'||rContMaquAnte.NUMEOTRE||'|CONTADOR:'||rContMaquAnte.CONTADOR||'|MAQUCODI:'||rContMaquAnte.MAQUCODI;
				ELSE
					vMaquinas := vMaquinas||'|EMPRESA:'||rContMaquAnte.EMPRESA||'|NUMEOTRE:'||rContMaquAnte.NUMEOTRE||'|CONTADOR:'||rContMaquAnte.CONTADOR||'|MAQUCODI:'||rContMaquAnte.MAQUCODI;
				END IF;
				--
				IF rContMaquAnte.CONTADOR IS NOT NULL THEN
					vMaquinas := F_BUSCA_MERMAS_ANTERIORES(rContMaquAnte.EMPRESA,rContMaquAnte.NUMEOTRE,rContMaquAnte.CONTADOR,rContMaquAnte.MAQUCODI);
				END IF;
			END LOOP;
			--
			IF vMaquinas IS NULL THEN
				vMaquinas := '|EMPRESA:'||vEmpresa||'|NUMEOTRE:'||nNumeOtre||'|CONTADOR:'||nContador||'|MAQUCODI:'||vMaquCodi;
			END IF;
			--
			RETURN vMaquinas;
		END;
	BEGIN
		--NEW
		DELETE ANALESTA.ANE_M_PRO_REAL_MATERIALES WHERE EMPRESA = vEmpresa AND OT = nNumero;
		--FIN NEW
		vExisMeti := NULL;
		--
		OPEN cMermSafi('TIRADA');
		FETCH cMermSafi INTO vExisMeti;
		CLOSE cMermSafi;
		--
		vExisMesa := NULL;
		--
		OPEN cMermSafi('SANEAMIENTO');
		FETCH cMermSafi INTO vExisMesa;
		CLOSE cMermSafi;
		--
		vExisMeen := NULL;
		--
		OPEN cMermSafi('ENHEBRADO');
		FETCH cMermSafi INTO vExisMeen;
		CLOSE cMermSafi;
		--
		vExisMeaj := NULL;
		--
		OPEN cMermSafi('AJUSTE');
		FETCH cMermSafi INTO vExisMeaj;
		CLOSE cMermSafi;
		--
		vExisMeca := NULL;
		--
		OPEN cMermSafi('CAMBIO BOBINA');
		FETCH cMermSafi INTO vExisMeca;
		CLOSE cMermSafi;
		--
		vExisMepi := NULL;
		--
		OPEN cMermSafi('PICOS');
		FETCH cMermSafi INTO vExisMepi;
		CLOSE cMermSafi;
	   -- Borra la tabla Pl
		IF (t_Materiales.Count) > 0 THEN
			t_Materiales.Delete;
		END IF;
		--
		IF (t_Materiales_Rama.Count) > 0 THEN
			t_Materiales_Rama.Delete;
		END IF;
		--Recorre Los Materiales de Cortadoras y la bobina usada
		FOR rApliCome IN cApliCome LOOP
--dbms_output.put_line('1->'||rApliCome.LOTE);
			--
			IF (t_Materiales_Procesados.Count) > 0 THEN
				t_Materiales_Procesados.Delete;
			END IF;
			--
			nMermTira_T := 0;
			nMermSane_T := 0;
			nMermEnhe_T := 0;
			nMermAjus_T := 0;
			nMermCabo_T := 0;
			nMermPico_T := 0;
			--
			nMermCoan_T := 0;
			--
			nCantPran_T := 0;
			nMermTiPa_T := 0;
			nMermSaPa_T := 0;
			nMermEnPa_T := 0;
			nMermAjPa_T := 0;
			nMermCaPa_T := 0;
			nMermPiPa_T := 0;
			--
			nMermTira_P := 0;
			nMermSane_P := 0;
			nMermEnhe_P := 0;
			nMermAjus_P := 0;
			nMermCabo_P := 0;
			nMermPico_P := 0;
			--
			nMermCoan_P := 0;
			--Busca bobinas involucradas en la fabricacion de la bobina
				vRama := NULL;
--dbms_output.put_line('ANTES DE RAMA: '||rApliCome.LOTE||'|CONTADOR:'||rApliCome.CONTADOR||'|MAQUCODI:'||rApliCome.MAQUCODI||'|TIP_ARTI:'||rApliCome.TIP_ARTI||'|COD_ARTI:'||rApliCome.COD_ARTI);
				vRama := REPLACE(F_RAMA(rApliCome.LOTE||'|CONTADOR:'||rApliCome.CONTADOR||'|MAQUCODI:'||rApliCome.MAQUCODI||'|TIP_ARTI:'||rApliCome.TIP_ARTI||'|COD_ARTI:'||rApliCome.COD_ARTI),'<>','|');
				--
--dbms_output.put_line('RAMA:'||vRama);
				vCadenaAux := vRama;
				nPosicion := 0;
				nContador := 0;
				--
				vEMPRBOBI.Delete;
				vNUOTBOBI.Delete;
				vCONTBOBI.Delete;
				vCOBOBOBI.Delete;
				vLOTE.Delete;
				vCONTADOR.Delete;
				vTIP_ARTI.Delete;
				vCOD_ARTI.Delete;
				--Encuentra datos identificativos de la bobina
				LOOP
					--nPosicion := INSTR(vCadenaAux,'COBOBOBI',nPosicion + 1);
					nPosicion := INSTR(vCadenaAux,'COBOBOBI');
					--dbms_output.put_line('nPosicion:'||nPosicion);
					--
					--IF nPosicion IS NOT NULL THEN
					IF NVL(nPosicion,0) != 0 THEN
						nContador := nContador + 1;
						--
						vEMPRBOBI(nContador) := P_UTILIDAD.F_VALOCAMPO(vCadenaAux,'EMPRBOBI');
						vNUOTBOBI(nContador) := P_UTILIDAD.F_VALOCAMPO(vCadenaAux,'NUOTBOBI');
						vCONTBOBI(nContador) := P_UTILIDAD.F_VALOCAMPO(vCadenaAux,'CONTBOBI');
						vCOBOBOBI(nContador) := P_UTILIDAD.F_VALOCAMPO(vCadenaAux,'COBOBOBI');
						vLOTE(nContador) := P_UTILIDAD.F_VALOCAMPO(vCadenaAux,'LOTE');
						vCONTADOR(nContador) := P_UTILIDAD.F_VALOCAMPO(vCadenaAux,'CONTADOR');
						vTIP_ARTI(nContador) := P_UTILIDAD.F_VALOCAMPO(vCadenaAux,'TIP_ARTI');
						vCOD_ARTI(nContador) := P_UTILIDAD.F_VALOCAMPO(vCadenaAux,'COD_ARTI');
						--
						IF NVL(INSTR(vCadenaAux,'|MAQUINA:',nPosicion + 1),0) != 0 THEN
						   vCadenaAux := SUBSTR(vCadenaAux,INSTR(vCadenaAux,'|MAQUINA:',nPosicion + 1));
						ELSE
						   vCadenaAux := NULL;
						END IF;
	--dbms_output.put_line('vCadenaAux subs: '||vCadenaAux);
					ELSE
						vCadenaAux := NULL;
					END IF;
					--
					EXIT WHEN vCadenaAux IS NULL OR NVL(nPosicion,0) = 0;
				END LOOP;
				/*
				IF nContador > 0 THEN
					dbms_output.put_line(vEMPRBOBI(nContador) ||' = '|| P_UTILIDAD.F_VALOCAMPO(rApliCome.LOTE,'EMPRBOBI'));
					dbms_output.put_line(vNUOTBOBI(nContador) ||' = '|| P_UTILIDAD.F_VALOCAMPO(rApliCome.LOTE,'NUOTBOBI'));
					dbms_output.put_line(vCONTBOBI(nContador) ||' = '|| NVL(P_UTILIDAD.F_VALOCAMPO(rApliCome.LOTE,'CONTBOBI'),P_UTILIDAD.F_VALOCAMPO(rApliCome.LOTE,'COBOMATE')));
					dbms_output.put_line(vCOBOBOBI(nContador) ||' = '|| NVL(P_UTILIDAD.F_VALOCAMPO(rApliCome.LOTE,'COBOBOBI'),P_UTILIDAD.F_VALOCAMPO(rApliCome.LOTE,'BOBIMATE')));
					dbms_output.put_line(vLOTE(nContador) ||' = '|| P_UTILIDAD.F_VALOCAMPO(rApliCome.LOTE,'LOTE'));
				END IF;*/
--dbms_output.put_line(nContador||' Antes Busca Mermas NT: '||NVL(P_UTILIDAD.F_VALOCAMPO(rApliCome.LOTE,'CONTBOBI'),P_UTILIDAD.F_VALOCAMPO(rApliCome.LOTE,'COBOMATE'))||'<>'||NVL(P_UTILIDAD.F_VALOCAMPO(rApliCome.LOTE,'COBOBOBI'),P_UTILIDAD.F_VALOCAMPO(rApliCome.LOTE,'BOBIMATE')));

				--Carga la lista de bobinas (Si cumple con que la ultima Bobina de la Rama sea la Utilizada en el Material. Por eso se usa el nContador final |EMPRBOBI:10|NUOTBOBI:2016002037|CONTBOBI:1|COBOBOBI:1|LOTE:2016002037)
				IF nContador > 0 THEN--AND 
					/*vEMPRBOBI(nContador) = P_UTILIDAD.F_VALOCAMPO(rApliCome.LOTE,'EMPRBOBI') AND
					vNUOTBOBI(nContador) = P_UTILIDAD.F_VALOCAMPO(rApliCome.LOTE,'NUOTBOBI') AND
					vCONTBOBI(nContador) = NVL(P_UTILIDAD.F_VALOCAMPO(rApliCome.LOTE,'CONTBOBI'),P_UTILIDAD.F_VALOCAMPO(rApliCome.LOTE,'COBOMATE')) AND
					vCOBOBOBI(nContador) = NVL(P_UTILIDAD.F_VALOCAMPO(rApliCome.LOTE,'COBOBOBI'),P_UTILIDAD.F_VALOCAMPO(rApliCome.LOTE,'BOBIMATE')) AND
					vLOTE(nContador) = P_UTILIDAD.F_VALOCAMPO(rApliCome.LOTE,'LOTE') THEN --Es la Bobina utilizada por lo que hay que revisar la rama*/
					--
					--dbms_output.put_line('-------------------ENCUENTRA LA ULTIMA BOBINA-------------------');
					--
					FOR c IN 1..nContador LOOP
						IF vCONTBOBI(c) IS NOT NULL AND vCOBOBOBI(c) IS NOT NULL THEN
							--NEW
							vExisEstru := NULL;
							--
							OPEN cExisEstru(vEmpresa, nNumero,
												 rApliCome.TIP_ARTI, rApliCome.COD_ARTI, rApliCome.CONTADOR,
												 vTIP_ARTI(c), vCOD_ARTI(c), vCONTADOR(c));
							FETCH cExisEstru INTO vExisEstru;
							CLOSE cExisEstru;
							--
							IF vExisEstru IS NULL THEN
							   INSERT INTO ANALESTA.ANE_M_PRO_REAL_MATERIALES(EMPRESA,OT,
								                                               TIPO_MATERIAL,MATERIAL,FASE_MATERIAL,
																							  TIPO_COMPMATE,CODI_COMPMATE,FASE_COMPMATE)
								VALUES(vEmpresa, nNumero,
										 rApliCome.TIP_ARTI, rApliCome.COD_ARTI, rApliCome.CONTADOR,
										 vTIP_ARTI(c), vCOD_ARTI(c), vCONTADOR(c));
							END IF;
							--FIN NEW
							nMermTira := NULL;
							nMermSane := NULL;
							--
							OPEN cMermaTira(vEMPRBOBI(c),vNUOTBOBI(c),vCONTBOBI(c),vCOBOBOBI(c));
							FETCH cMermaTira INTO nMermTira, nMermSane;
							CLOSE cMermaTira;
							--
							nMermTira_T := nMermTira_T + NVL(nMermTira,0);
							nMermSane_T := nMermSane_T + NVL(nMermSane,0);
							--
							rMermas.MERMENHE := NULL;
							rMermas.MERMAJUS := NULL;
							rMermas.MERMCABO := NULL;
							rMermas.MERMPICO := NULL;
							--
							OPEN cMermas(vEMPRBOBI(c),vNUOTBOBI(c), 
											 vCONTBOBI(c),vCOBOBOBI(c), 
											 vLOTE(c));
							FETCH cMermas INTO rMermas;
							CLOSE cMermas;
--dbms_output.put_line('Busca Mermas'||vEMPRBOBI(c)||','||vNUOTBOBI(c)||','||vCONTBOBI(c)||','||vCOBOBOBI(c)||','||vLOTE(c)||' ENHEBRADO: '||NVL(rMermas.MermEnhe,0)||' CAMBIO BOBINA: '||NVL(rMermas.MermCabo,0));
							--
							nMermEnhe_T := nMermEnhe_T + NVL(rMermas.MermEnhe,0);
							nMermAjus_T := nMermAjus_T + NVL(rMermas.MermAjus,0);
							nMermCabo_T := nMermCabo_T + NVL(rMermas.MermCabo,0);
							nMermPico_T := nMermPico_T + NVL(rMermas.MermPico,0);
							--Se va creando la lista de materiales que participan en la Bobina anteriores que se usara para acumular mermas en caso de no existir alguno de ellos
							rMateriales_Procesados.vEmprBobi := vEMPRBOBI(c);
							rMateriales_Procesados.nNuotBobi := vNUOTBOBI(c);
							rMateriales_Procesados.nContBobi := vCONTBOBI(c);
							rMateriales_Procesados.nCoboBobi := vCOBOBOBI(c);
							rMateriales_Procesados.vLote := vLOTE(c);
							--
							rMateriales_Procesados.nMermTira := NVL(nMermTira,0);
							rMateriales_Procesados.nMermSane := NVL(nMermSane,0);
							rMateriales_Procesados.nMermEnhe := NVL(rMermas.MermEnhe,0);
							rMateriales_Procesados.nMermAjus := NVL(rMermas.MermAjus,0);
							rMateriales_Procesados.nMermCabo := NVL(rMermas.MermCabo,0);
							rMateriales_Procesados.nMermPico := NVL(rMermas.MermPico,0);
							--
							t_Materiales_Procesados (t_Materiales_Procesados.Count + 1) := rMateriales_Procesados;
							--Acumula las mermas de las fases anteriores hasta la fase anterior
							IF vCONTADOR(c) < rApliCome.Contador THEN
							   nMermTiPa_T := nMermTiPa_T + NVL(nMermTira,0);
							   nMermSaPa_T := nMermSaPa_T + NVL(nMermSane,0);
								nMermEnPa_T := nMermEnPa_T + NVL(rMermas.MermEnhe,0);
							   nMermAjPa_T := nMermAjPa_T + NVL(rMermas.MermAjus,0);
							   nMermCaPa_T := nMermCaPa_T + NVL(rMermas.MermCabo,0);
							   nMermPiPa_T := nMermPiPa_T + NVL(rMermas.MermPico,0);
							END IF;
							--
/*dbms_output.put_line('BOBINA ACTUAL->'||vEMPRBOBI(c)||' = '||P_UTILIDAD.F_VALOCAMPO(rApliCome.LOTE,'EMPRBOBI')||' AND '||
								vNUOTBOBI(c) ||' = '|| P_UTILIDAD.F_VALOCAMPO(rApliCome.LOTE,'NUOTBOBI') ||' AND '||
								vCONTBOBI(c) ||' = '|| NVL(P_UTILIDAD.F_VALOCAMPO(rApliCome.LOTE,'CONTBOBI'),P_UTILIDAD.F_VALOCAMPO(rApliCome.LOTE,'COBOMATE')) ||' AND '||
								vCOBOBOBI(c) ||' = '|| NVL(P_UTILIDAD.F_VALOCAMPO(rApliCome.LOTE,'COBOBOBI'),P_UTILIDAD.F_VALOCAMPO(rApliCome.LOTE,'BOBIMATE')) ||' AND '||
								vLOTE(c) ||' = '|| P_UTILIDAD.F_VALOCAMPO(rApliCome.LOTE,'LOTE'));*/
							--Es la Bobina actual se toman los valores de mermas para la Bobina
							IF vEMPRBOBI(c) = P_UTILIDAD.F_VALOCAMPO(rApliCome.LOTE,'EMPRBOBI') AND
								vNUOTBOBI(c) = P_UTILIDAD.F_VALOCAMPO(rApliCome.LOTE,'NUOTBOBI') AND
								vCONTBOBI(c) = NVL(P_UTILIDAD.F_VALOCAMPO(rApliCome.LOTE,'CONTBOBI'),P_UTILIDAD.F_VALOCAMPO(rApliCome.LOTE,'COBOMATE')) AND
								vCOBOBOBI(c) = NVL(P_UTILIDAD.F_VALOCAMPO(rApliCome.LOTE,'COBOBOBI'),P_UTILIDAD.F_VALOCAMPO(rApliCome.LOTE,'BOBIMATE')) AND
								vLOTE(c) = P_UTILIDAD.F_VALOCAMPO(rApliCome.LOTE,'LOTE') THEN --Es la Bobina utilizada por lo que hay que revisar la rama
								--
								nMermTira_P := nMermTira_P + NVL(nMermTira,0);
								nMermSane_P := nMermSane_P + NVL(nMermSane,0);
								--
								nMermEnhe_P := nMermEnhe_P + NVL(rMermas.MermEnhe,0);
								nMermAjus_P := nMermAjus_P + NVL(rMermas.MermAjus,0);
								nMermCabo_P := nMermCabo_P + NVL(rMermas.MermCabo,0);
								nMermPico_P := nMermPico_P + NVL(rMermas.MermPico,0);
--dbms_output.put_line('CONTADOR DE MATERIALES PROCESADOS: '||t_Materiales_Procesados.Count);
								--Se verifica que no este en la tabla PL para acumular
								FOR nC In 1..t_Materiales_Procesados.Count LOOP
									biIndice_Carga   := nC;
									rMateriales_Procesados := t_Materiales_Procesados(biIndice_Carga);
									--
									bExisMateRama := FALSE;
/*dbms_output.put_line('MATERIAL PROCESADO: '||
											rMateriales_Procesados.vEmprBobi ||','||rMateriales_Procesados.nNuotBobi ||','||rMateriales_Procesados.nContBobi ||','||rMateriales_Procesados.nCoboBobi ||','||rMateriales_Procesados.vLote);*/
									--
									FOR nI In 1..t_Materiales_Rama.Count LOOP
										biIndice   := nI;
										rMateriales_Rama := t_Materiales_Rama(biIndice);
										--
/*dbms_output.put_line('VERIFICA QUE NO SE ENCUENTRE EN LA RAMA: '||
                                 rMateriales_Rama.vEmpresa ||' = '|| vEmpresa ||' AND '||
											rMateriales_Rama.nNumeOtre ||' = '|| nNumero ||' AND '|| 
											rMateriales_Rama.nContador ||' = '|| vCONTADOR(c) ||' AND '|| 
											rMateriales_Rama.vTip_Arti ||' = '|| vTIP_ARTI(c) ||' AND '|| 
											rMateriales_Rama.vCod_Arti ||' = '|| vCOD_ARTI(c) ||' AND '||
											rMateriales_Rama.vEmprBobi ||' = '|| rMateriales_Procesados.vEmprBobi ||' AND '||
											rMateriales_Rama.nNuotBobi ||' = '|| rMateriales_Procesados.nNuotBobi ||' AND '|| 
											rMateriales_Rama.nContBobi ||' = '|| rMateriales_Procesados.nContBobi ||' AND '|| 
											rMateriales_Rama.nCoboBobi ||' = '|| rMateriales_Procesados.nCoboBobi ||' AND '|| 
											rMateriales_Rama.vLote ||' = '|| rMateriales_Procesados.vLote);*/
										IF rMateriales_Rama.vEmpresa = vEmpresa AND
											rMateriales_Rama.nNumeOtre = nNumero AND 
											rMateriales_Rama.nContador = vCONTADOR(c) AND 
											rMateriales_Rama.vTip_Arti = vTIP_ARTI(c) AND 
											rMateriales_Rama.vCod_Arti = vCOD_ARTI(c) AND
											rMateriales_Rama.vEmprBobi = rMateriales_Procesados.vEmprBobi AND
											rMateriales_Rama.nNuotBobi = rMateriales_Procesados.nNuotBobi AND 
											rMateriales_Rama.nContBobi = rMateriales_Procesados.nContBobi AND 
											rMateriales_Rama.nCoboBobi = rMateriales_Procesados.nCoboBobi AND 
											rMateriales_Rama.vLote = rMateriales_Procesados.vLote THEN
											--
											bExisMateRama := TRUE;
--dbms_output.put_line('ENCONTRO');
											--
											EXIT WHEN TRUE;
										END IF;
									END LOOP;
									--
									IF NOT (bExisMateRama) THEN
										rMateriales_Rama.vEmpresa := vEmpresa;
										rMateriales_Rama.nNumeOtre := nNumero;
										rMateriales_Rama.nContador := vCONTADOR(c);
										rMateriales_Rama.vTip_Arti := vTIP_ARTI(c);
										rMateriales_Rama.vCod_Arti := vCOD_ARTI(c);
										--
										rMateriales_Rama.nMermTira := NVL(rMateriales_Procesados.nMermTira,0);
										rMateriales_Rama.nMermSane := NVL(rMateriales_Procesados.nMermSane,0);
										rMateriales_Rama.nMermEnhe := NVL(rMateriales_Procesados.nMermEnhe,0);
										rMateriales_Rama.nMermAjus := NVL(rMateriales_Procesados.nMermAjus,0);
										rMateriales_Rama.nMermCabo := NVL(rMateriales_Procesados.nMermCabo,0);
										rMateriales_Rama.nMermPico := NVL(rMateriales_Procesados.nMermPico,0);
										--
										rMateriales_Rama.vEmprBobi := rMateriales_Procesados.vEmprBobi;
										rMateriales_Rama.nNuotBobi := rMateriales_Procesados.nNuotBobi;
										rMateriales_Rama.nContBobi := rMateriales_Procesados.nContBobi;
										rMateriales_Rama.nCoboBobi := rMateriales_Procesados.nCoboBobi;
										rMateriales_Rama.vLote := rMateriales_Procesados.vLote;
										--
										t_Materiales_Rama (t_Materiales_Rama.Count + 1) := rMateriales_Rama;
									END IF;
								END LOOP;
								--Se verifica que no este en la tabla PL para acumular
								bExisMate := FALSE;
								--
								FOR nI In 1..t_Materiales.Count LOOP
									biIndice   := nI;
									rMateriales := t_Materiales(biIndice);
									--
									IF rMateriales.vEmpresa = vEmpresa AND
										rMateriales.nNumeOtre = nNumero AND 
										rMateriales.nContador = vCONTADOR(c) AND 
										rMateriales.vTip_Arti = vTIP_ARTI(c) AND 
										rMateriales.vCod_Arti = vCOD_ARTI(c) THEN
										--
										rMateriales.nMermTira := NVL(rMateriales.nMermTira,0) + NVL(nMermTira,0);
										rMateriales.nMermSane := NVL(rMateriales.nMermSane,0) + NVL(nMermSane,0);
										rMateriales.nMermEnhe := NVL(rMateriales.nMermEnhe,0) + NVL(rMermas.MermEnhe,0);
										rMateriales.nMermAjus := NVL(rMateriales.nMermAjus,0) + NVL(rMermas.MermAjus,0);
										rMateriales.nMermCabo := NVL(rMateriales.nMermCabo,0) + NVL(rMermas.MermCabo,0);
										rMateriales.nMermPico := NVL(rMateriales.nMermPico,0) + NVL(rMermas.MermPico,0);
										--
										t_Materiales (biIndice) := rMateriales;
										--
										bExisMate := TRUE;
										--
										EXIT WHEN TRUE;
									END IF;
								END LOOP;
								--
								IF NOT (bExisMate) THEN
									rMateriales.vEmpresa := vEmpresa;
									rMateriales.nNumeOtre := nNumero;
									rMateriales.nContador := vCONTADOR(c);
									rMateriales.vTip_Arti := vTIP_ARTI(c);
									rMateriales.vCod_Arti := vCOD_ARTI(c);
									--
									rMateriales.nMermTira := NVL(nMermTira,0);
									rMateriales.nMermSane := NVL(nMermSane,0);
									rMateriales.nMermEnhe := NVL(rMermas.MermEnhe,0);
									rMateriales.nMermAjus := NVL(rMermas.MermAjus,0);
									rMateriales.nMermCabo := NVL(rMermas.MermCabo,0);
									rMateriales.nMermPico := NVL(rMermas.MermPico,0);
									--
									t_Materiales (t_Materiales.Count + 1) := rMateriales;
								END IF;		
								--END IF;
							END IF;
						END IF;
					END LOOP;
				ELSIF NVL(P_UTILIDAD.F_VALOCAMPO(rApliCome.LOTE,'CONTBOBI'),P_UTILIDAD.F_VALOCAMPO(rApliCome.LOTE,'COBOMATE')) IS NULL AND NVL(P_UTILIDAD.F_VALOCAMPO(rApliCome.LOTE,'COBOBOBI'),P_UTILIDAD.F_VALOCAMPO(rApliCome.LOTE,'BOBIMATE')) IS NULL THEN--Son materiales de ajuste no se pueden buscar ramas por tiradas; entonces se busca directamente el fichaje
					--NEW II
					IF rApliCome.TIP_ARTI = vTiarReF4 THEN --Sergio necesita costear los materiales de ajuste En la tabla por LFS de Reales
						vExisEstru := NULL;
						--
--	dbms_output.put_line(vEmpresa||', '||nNumero||', '||rApliCome.TIP_ARTI||', '||rApliCome.COD_ARTI||', '||rApliCome.CONTADOR);
						OPEN cExisEstru(vEmpresa, nNumero,
											 rApliCome.TIP_ARTI, rApliCome.COD_ARTI, rApliCome.CONTADOR,
											 rApliCome.TIP_ARTI, rApliCome.COD_ARTI, rApliCome.CONTADOR);
						FETCH cExisEstru INTO vExisEstru;
						CLOSE cExisEstru;
						--
						IF vExisEstru IS NULL THEN
							INSERT INTO ANALESTA.ANE_M_PRO_REAL_MATERIALES(EMPRESA,OT,
																						  TIPO_MATERIAL,MATERIAL,FASE_MATERIAL,
																						  TIPO_COMPMATE,CODI_COMPMATE,FASE_COMPMATE)
							VALUES(vEmpresa, nNumero,
									 rApliCome.TIP_ARTI, rApliCome.COD_ARTI, rApliCome.CONTADOR,
									 rApliCome.TIP_ARTI, rApliCome.COD_ARTI, rApliCome.CONTADOR);
						END IF;
					END IF;
					--FIN NEW II
					rMermas_NT.MERMENHE := NULL;
					rMermas_NT.MERMAJUS := NULL;
					rMermas_NT.MERMCABO := NULL;
					rMermas_NT.MERMPICO := NULL;
					--
					OPEN cMermas_NT(P_UTILIDAD.F_VALOCAMPO(rApliCome.LOTE,'EMPRBOBI'),P_UTILIDAD.F_VALOCAMPO(rApliCome.LOTE,'NUOTBOBI'),P_UTILIDAD.F_VALOCAMPO(rApliCome.LOTE,'LOTE'));
					FETCH cMermas_NT INTO rMermas_NT;
					CLOSE cMermas_NT;
--dbms_output.put_line('Busca Mermas NT: '||P_UTILIDAD.F_VALOCAMPO(rApliCome.LOTE,'EMPRBOBI')||','||P_UTILIDAD.F_VALOCAMPO(rApliCome.LOTE,'NUOTBOBI')||','||P_UTILIDAD.F_VALOCAMPO(rApliCome.LOTE,'LOTE')||' ENHEBRADO: '||NVL(rMermas_NT.MermEnhe,0)||' CAMBIO BOBINA: '||NVL(rMermas_NT.MermCabo,0));
					--
					nMermEnhe_T := nMermEnhe_T + NVL(rMermas_NT.MermEnhe,0);
					nMermAjus_T := nMermAjus_T + NVL(rMermas_NT.MermAjus,0);
					nMermCabo_T := nMermCabo_T + NVL(rMermas_NT.MermCabo,0);
					nMermPico_T := nMermPico_T + NVL(rMermas_NT.MermPico,0);
					--
					nMermEnPa_T := nMermEnPa_T + NVL(rMermas_NT.MermEnhe,0);
					nMermAjPa_T := nMermAjPa_T + NVL(rMermas_NT.MermAjus,0);
					nMermCaPa_T := nMermCaPa_T + NVL(rMermas_NT.MermCabo,0);
					nMermPiPa_T := nMermPiPa_T + NVL(rMermas_NT.MermPico,0);
					--
					nMermEnhe_P := nMermEnhe_P + NVL(rMermas_NT.MermEnhe,0);
					nMermAjus_P := nMermAjus_P + NVL(rMermas_NT.MermAjus,0);
					nMermCabo_P := nMermCabo_P + NVL(rMermas_NT.MermCabo,0);
					nMermPico_P := nMermPico_P + NVL(rMermas_NT.MermPico,0);
					--Se va creando la lista de materiales que participan en la Bobina anteriores que se usara para acumular mermas en caso de no existir alguno de ellos
					rMateriales_Procesados.vEmprBobi := P_UTILIDAD.F_VALOCAMPO(rApliCome.LOTE,'EMPRBOBI');
					rMateriales_Procesados.nNuotBobi := P_UTILIDAD.F_VALOCAMPO(rApliCome.LOTE,'NUOTBOBI');
					rMateriales_Procesados.nContBobi := NULL;
					rMateriales_Procesados.nCoboBobi := NULL;
					rMateriales_Procesados.vLote := P_UTILIDAD.F_VALOCAMPO(rApliCome.LOTE,'LOTE');
					--
					rMateriales_Procesados.nMermTira := 0;
					rMateriales_Procesados.nMermSane := 0;
					rMateriales_Procesados.nMermEnhe := NVL(rMermas_NT.MermEnhe,0);
					rMateriales_Procesados.nMermAjus := NVL(rMermas_NT.MermAjus,0);
					rMateriales_Procesados.nMermCabo := NVL(rMermas_NT.MermCabo,0);
					rMateriales_Procesados.nMermPico := NVL(rMermas_NT.MermPico,0);
					--
					t_Materiales_Procesados (t_Materiales_Procesados.Count + 1) := rMateriales_Procesados;
--dbms_output.put_line('CONTADOR DE MATERIALES PROCESADOS: '||t_Materiales_Procesados.Count);
					--Se verifica que no este en la tabla PL para acumular
					FOR nC In 1..t_Materiales_Procesados.Count LOOP
						biIndice_Carga   := nC;
						rMateriales_Procesados := t_Materiales_Procesados(biIndice_Carga);
						--
						bExisMateRama := FALSE;
/*dbms_output.put_line('MATERIAL PROCESADO: '||
								rMateriales_Procesados.vEmprBobi ||','||rMateriales_Procesados.nNuotBobi ||','||rMateriales_Procesados.nContBobi ||','||rMateriales_Procesados.nCoboBobi ||','||rMateriales_Procesados.vLote);*/
						--
						FOR nI In 1..t_Materiales_Rama.Count LOOP
							biIndice   := nI;
							rMateriales_Rama := t_Materiales_Rama(biIndice);
							--
/*dbms_output.put_line('VERIFICA QUE NO SE ENCUENTRE EN LA RAMA: '||
								rMateriales_Rama.vEmpresa ||' = '|| vEmpresa ||' AND '||
								rMateriales_Rama.nNumeOtre ||' = '|| nNumero ||' AND '|| 
								rMateriales_Rama.nContador ||' = '|| rApliCome.CONTADOR ||' AND '|| 
								rMateriales_Rama.vTip_Arti ||' = '|| rApliCome.TIP_ARTI ||' AND '|| 
								rMateriales_Rama.vCod_Arti ||' = '|| rApliCome.COD_ARTI ||' AND '||
								rMateriales_Rama.vEmprBobi ||' = '|| rMateriales_Procesados.vEmprBobi ||' AND '||
								rMateriales_Rama.nNuotBobi ||' = '|| rMateriales_Procesados.nNuotBobi ||' AND '|| 
								rMateriales_Rama.nContBobi ||' = '|| rMateriales_Procesados.nContBobi ||' AND '|| 
								rMateriales_Rama.nCoboBobi ||' = '|| rMateriales_Procesados.nCoboBobi ||' AND '|| 
								rMateriales_Rama.vLote ||' = '|| rMateriales_Procesados.vLote);*/
							IF rMateriales_Rama.vEmpresa = vEmpresa AND
								rMateriales_Rama.nNumeOtre = nNumero AND 
								rMateriales_Rama.nContador = rApliCome.CONTADOR AND 
								rMateriales_Rama.vTip_Arti = rApliCome.TIP_ARTI AND 
								rMateriales_Rama.vCod_Arti = rApliCome.COD_ARTI AND
								rMateriales_Rama.vEmprBobi = rMateriales_Procesados.vEmprBobi AND
								rMateriales_Rama.nNuotBobi = rMateriales_Procesados.nNuotBobi AND 
								rMateriales_Rama.nContBobi IS NULL AND 
								rMateriales_Rama.nCoboBobi IS NULL AND 
								rMateriales_Rama.vLote = rMateriales_Procesados.vLote THEN
								--
								bExisMateRama := TRUE;
--dbms_output.put_line('ENCONTRO');
								--
								EXIT WHEN TRUE;
							END IF;
						END LOOP;
						--
						IF NOT (bExisMateRama) THEN
							rMateriales_Rama.vEmpresa := vEmpresa;
							rMateriales_Rama.nNumeOtre := nNumero;
							rMateriales_Rama.nContador := rApliCome.CONTADOR;
							rMateriales_Rama.vTip_Arti := rApliCome.TIP_ARTI;
							rMateriales_Rama.vCod_Arti := rApliCome.COD_ARTI;
							--
							rMateriales_Rama.nMermTira := NVL(rMateriales_Procesados.nMermTira,0);
							rMateriales_Rama.nMermSane := NVL(rMateriales_Procesados.nMermSane,0);
							rMateriales_Rama.nMermEnhe := NVL(rMateriales_Procesados.nMermEnhe,0);
							rMateriales_Rama.nMermAjus := NVL(rMateriales_Procesados.nMermAjus,0);
							rMateriales_Rama.nMermCabo := NVL(rMateriales_Procesados.nMermCabo,0);
							rMateriales_Rama.nMermPico := NVL(rMateriales_Procesados.nMermPico,0);
							--
							rMateriales_Rama.vEmprBobi := rMateriales_Procesados.vEmprBobi;
							rMateriales_Rama.nNuotBobi := rMateriales_Procesados.nNuotBobi;
							rMateriales_Rama.nContBobi := rMateriales_Procesados.nContBobi;
							rMateriales_Rama.nCoboBobi := rMateriales_Procesados.nCoboBobi;
							rMateriales_Rama.vLote := rMateriales_Procesados.vLote;
							--
							t_Materiales_Rama (t_Materiales_Rama.Count + 1) := rMateriales_Rama;
						END IF;
					END LOOP;
					--Se verifica que no este en la tabla PL para acumular
					bExisMate := FALSE;
					--
					FOR nI In 1..t_Materiales.Count LOOP
						biIndice   := nI;
						rMateriales := t_Materiales(biIndice);
						--
						IF rMateriales.vEmpresa = vEmpresa AND
							rMateriales.nNumeOtre = nNumero AND 
							rMateriales.nContador = rApliCome.CONTADOR AND 
							rMateriales.vTip_Arti = rApliCome.TIP_ARTI AND 
							rMateriales.vCod_Arti = rApliCome.COD_ARTI THEN
							--
							rMateriales.nMermEnhe := NVL(rMateriales.nMermEnhe,0) + NVL(rMermas_NT.MermEnhe,0);
							rMateriales.nMermAjus := NVL(rMateriales.nMermAjus,0) + NVL(rMermas_NT.MermAjus,0);
							rMateriales.nMermCabo := NVL(rMateriales.nMermCabo,0) + NVL(rMermas_NT.MermCabo,0);
							rMateriales.nMermPico := NVL(rMateriales.nMermPico,0) + NVL(rMermas_NT.MermPico,0);
							--
							t_Materiales (biIndice) := rMateriales;
							--
							bExisMate := TRUE;
							--
							EXIT WHEN TRUE;
						END IF;
					END LOOP;
					--
					IF NOT (bExisMate) THEN
						rMateriales.vEmpresa := vEmpresa;
						rMateriales.nNumeOtre := nNumero;
						rMateriales.nContador := rApliCome.CONTADOR;
						rMateriales.vTip_Arti := rApliCome.TIP_ARTI;
						rMateriales.vCod_Arti := rApliCome.COD_ARTI;
						--
						rMateriales.nMermEnhe := NVL(rMermas_NT.MermEnhe,0);
						rMateriales.nMermAjus := NVL(rMermas_NT.MermAjus,0);
						rMateriales.nMermCabo := NVL(rMermas_NT.MermCabo,0);
						rMateriales.nMermPico := NVL(rMermas_NT.MermPico,0);
						--
						t_Materiales (t_Materiales.Count + 1) := rMateriales;
					END IF;		
					--END IF;
				END IF;
			--END LOOP;
			/*--
			--dbms_output.put_line('rApliCome.MAQUCODI:'||rApliCome.MAQUCODI||' LOTE->'||rApliCome.LOTE);
			--
			dbms_output.put_line('nMermTira_T:'||nMermTira_T);
			dbms_output.put_line('nMermSane_T:'||nMermSane_T);
			dbms_output.put_line('nMermEnhe_T:'||nMermEnhe_T);
			dbms_output.put_line('nMermAjus_T:'||nMermAjus_T);
			dbms_output.put_line('nMermCabo_T:'||nMermCabo_T);
			dbms_output.put_line('nMermPico_T:'||nMermPico_T);
			--
			dbms_output.put_line('nMermTira_P:'||nMermTira_P);
			dbms_output.put_line('nMermSane_P:'||nMermSane_P);
			dbms_output.put_line('nMermEnhe_P:'||nMermEnhe_P);
			dbms_output.put_line('nMermAjus_P:'||nMermAjus_P);
			dbms_output.put_line('nMermCabo_P:'||nMermCabo_P);
			dbms_output.put_line('nMermPico_P:'||nMermPico_P);*/
			--
			IF vExisMeti IS NOT NULL THEN
				nMermCoan_T := nMermCoan_T + NVL(nMermTira_T,0);
				nMermCoan_P := nMermCoan_P + NVL(nMermTira_P,0);
				--
				nCantPran_T := nCantPran_T - NVL(nMermTiPa_T,0);
			END IF;
			--
			IF vExisMesa IS NOT NULL THEN
				nMermCoan_T := nMermCoan_T + NVL(nMermSane_T,0);
				nMermCoan_P := nMermCoan_P + NVL(nMermSane_P,0);
				--
				nCantPran_T := nCantPran_T - NVL(nMermSaPa_T,0);
			END IF;
			--
			IF vExisMeen IS NOT NULL THEN
				nMermCoan_T := nMermCoan_T + NVL(nMermEnhe_T,0);
				nMermCoan_P := nMermCoan_P + NVL(nMermEnhe_P,0);
				--
				nCantPran_T := nCantPran_T - NVL(nMermEnPa_T,0);
			END IF;
			--
			IF vExisMeaj IS NOT NULL THEN
				nMermCoan_T := nMermCoan_T + NVL(nMermAjus_T,0);
				nMermCoan_P := nMermCoan_P + NVL(nMermAjus_P,0);
				--
				nCantPran_T := nCantPran_T - NVL(nMermAjPa_T,0);
			END IF;
			--
			IF vExisMeca IS NOT NULL THEN
				nMermCoan_T := nMermCoan_T + NVL(nMermCabo_T,0);
				nMermCoan_P := nMermCoan_P + NVL(nMermCabo_P,0);
				--
				nCantPran_T := nCantPran_T - NVL(nMermCaPa_T,0);
			END IF;
			--
			IF vExisMepi IS NOT NULL THEN
				nMermCoan_T := nMermCoan_T + NVL(nMermPico_T,0);
				nMermCoan_P := nMermCoan_P + NVL(nMermPico_P,0);
				--
				nCantPran_T := nCantPran_T - NVL(nMermPiPa_T,0);
			END IF;
			--
			--dbms_output.put_line('nMermCoan_T:'||nMermCoan_T);
			--dbms_output.put_line('nMermCoan_P:'||nMermCoan_P);
			--
			/*
			IF INSTR(rApliCome.MAQUCODI,'CORTADORA') = 0 THEN
				UPDATE ANALESTA.ANE_MER_MATERIAL_OT
				SET MEACSAFI = NVL(nMermCoan_T,0),
					 MEACSFMA = NVL(nMermCoan_P,0),
					 CANTCORE = NVL(CANTCONS,0) - NVL(nMermCoan_T,0) + NVL(nMermCoan_P,0),
					 CANTPRRE = NVL(CANTPROD,0) - NVL(nMermCoan_P,0)
				WHERE ROWID = rApliCome.ROWID;
			ELSE
				UPDATE ANALESTA.ANE_MER_MATERIAL_OT
				SET MEACSAFI = NVL(nMermCoan_T,0),
					 MEACSFMA = NVL(nMermCoan_P,0),
					 CANTCORE = NVL(CANTCONS,0) - NVL(nMermCoan_T,0) + NVL(nMermCoan_P,0),
					 CANTPRRE = NVL(CANTPROD,0)
				WHERE ROWID = rApliCome.ROWID;
			END IF;
			*/
			IF nCantPran_T = 0 THEN
			   nCantPran_T := NULL;
			END IF;
			--
			/*IF INSTR(rApliCome.MAQUCODI,'CORTADORA') = 0 THEN
				UPDATE ANALESTA.ANE_MER_MATERIAL_OT
				SET MEACSAFI = NVL(nMermCoan_T,0),
					 MEACSFMA = NVL(nMermCoan_P,0),
					 CANTCORE = NVL(nCantPran_T,CANTCONS),
					 CANTPRRE = NVL(CANTPROD,0) - NVL(nMermCoan_T,0)
				WHERE ROWID = rApliCome.ROWID;

				dbms_output.put_line('UPDATE CANTCORE = '||nCantPran_T);
			ELSE
				UPDATE ANALESTA.ANE_MER_MATERIAL_OT
				SET MEACSAFI = NVL(nMermCoan_T,0),
					 MEACSFMA = NVL(nMermCoan_P,0),
					 CANTCORE = NVL(nCantPran_T,CANTCONS),
					 CANTPRRE = NVL(CANTPROD,0)
				WHERE ROWID = rApliCome.ROWID;
			END IF;*/
			UPDATE ANALESTA.ANE_MER_MATERIAL_OT
			SET MEACSAFI = NVL(nMermCoan_T,0),
				 MEACSFMA = NVL(nMermCoan_P,0)
			WHERE ROWID = rApliCome.ROWID;
		END LOOP;
		--
		DELETE ANALESTA.ANE_M_PRO_REAL WHERE EMPRESA = vEmpresa AND OT = nNumero;
		--NEW
		DELETE ANALESTA.ANE_M_PRO_REAL_CONTADOR WHERE EMPRESA = vEmpresa AND OT = nNumero;
		--FIN NEW
		--
		INSERT INTO ANALESTA.ANE_M_PRO_REAL(
														EMPRESA,N_CLIENTE,CLIENTE,OT,FECHA_DE_LA_OT,FECHA_CIERRE_DE_LA_OT,TIPO_PRD,ESPECIALIDAD,LINEA,LFS,N_CAPAS_TOTALES,CANTIDAD_DE_FASES,
														ANCHO_CLIENTE,N_DE_CORTES,N_DE_VECES,ANCHO_DE_PRODUCCION,ORIGEN_MP,UNIDAD_ORIGEN,
														TIPO_MP,COD_MP,LFS_MP,
														FASE_MP,SECCION_PRODUCTIVA_MP,MAQUINA_MP,
														--M2_MERMPLAN,
														--M2_MERMPLAN_EXESO,
														--EUR_MERMPLAN,
														--EUR_MERMPLAN_EXESO,
														ML_CONSUMIDOS,
														ML_PRODUCIDOS,
														ML_CONSUMIDOS_REALES,
														ML_PRODUCIDOS_REALES,
														ML_MERMAS_ACUMULADAS_HAS_MAQ,
														ML_MERMAS_ACUMULADAS_EN_MAQ,
														ML_ENHEBRADO_MAQUINA,
														ML_AJ_MAQUINA_MAQUINA,
														ML_CAMBIO_BOBINA_MAQUINA,
														ML_MERMA_TIRADA_MQUINA,
														ML_SANEAMIENTOS_MAQUINA,
														ML_MERMA_PROCESO_MQUINA,
														M2_CONSUMIDOS,
														M2_PRODUCIDOS,
														M2_PRODUCIDOS_REALES,
														M2_CONSUMIDOS_REALES,
														M2_MERMAS_ACUMULADAS_HAS_MAQ,
														M2_MERMAS_ACUMULADAS_EN_MAQ,
														M2_ENHEBRADO_MAQUINA,
														M2_AJ_MAQUINA_MAQUINA,
														M2_CAMBIO_BOBINA_MAQUINA,
														M2_MERMA_TIRADA_MQUINA,
														M2_SANEAMIENTOS_MAQUINA,
														M2_MERMA_PROCESO_MQUINA,
														EUROS_ML_CONSUMIDOS,
														EUROS_ML_PRODUCIDOS,
														EUROS_ML_CONSUMIDOS_REALES,
														EUROS_ML_PRODUCIDOS_REALES,
														EUR_MERMAS_ACUMULADAS_HAS_MAQ,
														EUR_MERMAS_ACUMULADAS_EN_MAQ,
														EUROS_ML_ENHEBRADO,
														EUROS_ML_AJ_MAQUINA,
														EUROS_ML_CAMBIO_BOBINA,
														EUROS_ML_MERMA_TIRADA,
														EUROS_ML_SANEAMIENTOS,
														EUROS_ML_MERMA_PROCESO,
														EUROS_MERMA_TOTAL_MAQUINA,
														FECHA_FACTURA,
														UNIDAD_CIERRE,
														Q_CERRADA_ML,
														Q_CERRADA_M2,
														Q_CERRADA_KG,
														Q_CERRADA_UN,
														FUENTE_DEL_CIERRE,
														--TOTAL_M2_MERMPLAN,
														--TOTAL_EUROS_MERMPLAN,
														ML_MERMA_TOTAL,
														M2_MERMA_TOTAL)
		SELECT EMPRESA,N_CLIENTE,CLIENTE,OT,FECHA_DE_LA_OT,FECHA_CIERRE_DE_LA_OT,TIPO_PRD,ESPECIALIDAD,LINEA,LFS,N_CAPAS_TOTALES,CANTIDAD_DE_FASES,
				 ANCHO_CLIENTE,N_DE_CORTES,N_DE_VECES,ANCHO_DE_PRODUCCION,MAX(ORIGEN_MP) ORIGEN_MP,MAX(UNIDAD_ORIGEN) UNIDAD_ORIGEN,
				 TIPO_MP,COD_MP,LFS_MP,
				 --ANCHO_MP,UNIDAD_ORIGEN,
				 --PRECIO_UNITARIO_MP_M2_COMPRAS,PRECIO_UNITARIO_MP_M2_ALGORIT,PRECIO_UNIT_MP_M2_ALGO_COSTES,PRECIO_UNITARIO_MP_M2,LOTE_CONSUMIDO,
				 --TRAZA_P_UNITARIO_MP_M2_ALGORIT,TRAZA_P_UNIT_MP_M2_ALGO_COSTES,
				 FASE_MP,SECCION_PRODUCTIVA_MP,MAQUINA_MP,
				 --SUM(M2_MERMPLAN) M2_MERMPLAN,
				 --SUM(M2_MERMPLAN_EXESO) M2_MERMPLAN_EXESO,
				 --SUM(EUR_MERMPLAN) EUR_MERMPLAN,
				 --SUM(EUR_MERMPLAN_EXESO) EUR_MERMPLAN_EXESO,
				 SUM(ML_CONSUMIDOS) ML_CONSUMIDOS,
				 SUM(ML_PRODUCIDOS) ML_PRODUCIDOS,
				 --BORRAR I
				 NULL ML_CONSUMIDOS_REALES, --SUM(ML_CONSUMIDOS_REALES) ML_CONSUMIDOS_REALES,
				 NULL ML_PRODUCIDOS_REALES, --SUM(ML_PRODUCIDOS_REALES) ML_PRODUCIDOS_REALES,
				 NULL ML_MERMAS_ACUMULADAS_HAS_MAQ, --MAX(ML_MERMAS_ACUMULADAS_HAS_MAQ) ML_MERMAS_ACUMULADAS_HAS_MAQ,
				 NULL ML_MERMAS_ACUMULADAS_EN_MAQ, --MAX(ML_MERMAS_ACUMULADAS_EN_MAQ) ML_MERMAS_ACUMULADAS_EN_MAQ,
				 --BORRAR F
		
				 SUM(ML_ENHEBRADO_MAQUINA) ML_ENHEBRADO_MAQUINA,
				 SUM(ML_AJ_MAQUINA_MAQUINA) ML_AJ_MAQUINA_MAQUINA,
				 SUM(ML_CAMBIO_BOBINA_MAQUINA) ML_CAMBIO_BOBINA_MAQUINA,
				 SUM(ML_MERMA_TIRADA_MQUINA) ML_MERMA_TIRADA_MQUINA,
				 SUM(ML_SANEAMIENTOS_MAQUINA) ML_SANEAMIENTOS_MAQUINA,
				 NULL ML_MERMA_PROCESO_MQUINA,--SUM(ML_MERMA_PROCESO_MQUINA) ML_MERMA_PROCESO_MQUINA,
				 --
				 SUM(M2_CONSUMIDOS) M2_CONSUMIDOS,
				 SUM(M2_PRODUCIDOS) M2_PRODUCIDOS,
				 
				 --BORRAR I
				 NULL M2_PRODUCIDOS_REALES, --SUM(M2_PRODUCIDOS_REALES) M2_PRODUCIDOS_REALES,
				 NULL M2_CONSUMIDOS_REALES, --SUM(M2_CONSUMIDOS_REALES) M2_CONSUMIDOS_REALES,
				 NULL M2_MERMAS_ACUMULADAS_HAS_MAQ, --MAX(M2_MERMAS_ACUMULADAS_HAS_MAQ) M2_MERMAS_ACUMULADAS_HAS_MAQ,
				 NULL M2_MERMAS_ACUMULADAS_EN_MAQ, --MAX(M2_MERMAS_ACUMULADAS_EN_MAQ) M2_MERMAS_ACUMULADAS_EN_MAQ,
				 --BORRAR F
				 
				 SUM(M2_ENHEBRADO_MAQUINA) M2_ENHEBRADO_MAQUINA,
				 SUM(M2_AJ_MAQUINA_MAQUINA) M2_AJ_MAQUINA_MAQUINA,
				 SUM(M2_CAMBIO_BOBINA_MAQUINA) M2_CAMBIO_BOBINA_MAQUINA,
				 SUM(M2_MERMA_TIRADA_MQUINA) M2_MERMA_TIRADA_MQUINA,
				 SUM(M2_SANEAMIENTOS_MAQUINA) M2_SANEAMIENTOS_MAQUINA,
				 NULL M2_MERMA_PROCESO_MQUINA,--SUM(M2_MERMA_PROCESO_MQUINA) M2_MERMA_PROCESO_MQUINA,
				 --
				 SUM(EUROS_ML_CONSUMIDOS) EUROS_ML_CONSUMIDOS,
				 SUM(EUROS_ML_PRODUCIDOS) EUROS_ML_PRODUCIDOS,
				 
				 --BORRAR I
				 NULL EUROS_ML_CONSUMIDOS_REALES, --SUM(EUROS_ML_CONSUMIDOS_REALES) EUROS_ML_CONSUMIDOS_REALES,
				 NULL EUROS_ML_PRODUCIDOS_REALES, --SUM(EUROS_ML_PRODUCIDOS_REALES) EUROS_ML_PRODUCIDOS_REALES,
				 NULL EUR_MERMAS_ACUMULADAS_HAS_MAQ, --MAX(EUR_MERMAS_ACUMULADAS_HAS_MAQ) EUR_MERMAS_ACUMULADAS_HAS_MAQ,
				 NULL EUR_MERMAS_ACUMULADAS_EN_MAQ, --MAX(EUR_MERMAS_ACUMULADAS_EN_MAQ) EUR_MERMAS_ACUMULADAS_EN_MAQ,
				 --BORRAR F
				 
				 SUM(EUROS_ML_ENHEBRADO) EUROS_ML_ENHEBRADO,
				 SUM(EUROS_ML_AJ_MAQUINA) EUROS_ML_AJ_MAQUINA,
				 SUM(EUROS_ML_CAMBIO_BOBINA) EUROS_ML_CAMBIO_BOBINA,
				 SUM(EUROS_ML_MERMA_TIRADA) EUROS_ML_MERMA_TIRADA,
				 SUM(EUROS_ML_SANEAMIENTOS) EUROS_ML_SANEAMIENTOS,
				 NULL EUROS_ML_MERMA_PROCESO,--SUM(EUROS_ML_MERMA_PROCESO) EUROS_ML_MERMA_PROCESO,
				 SUM(EUROS_MERMA_TOTAL_MAQUINA) EUROS_MERMA_TOTAL_MAQUINA,
				 FECHA_FACTURA,UNIDAD_CIERRE,Q_CERRADA_ML,Q_CERRADA_M2,Q_CERRADA_KG,Q_CERRADA_UN,FUENTE_DEL_CIERRE,
				 --SUM(TOTAL_M2_MERMPLAN) TOTAL_M2_MERMPLAN,
				 --NULL TOTAL_EUROS_MERMPLAN,--SUM(TOTAL_EUROS_MERMPLAN) TOTAL_EUROS_MERMPLAN,
				 NULL ML_MERMA_TOTAL,--SUM(ML_MERMA_TOTAL) ML_MERMA_TOTAL,
				 NULL M2_MERMA_TOTAL--SUM(M2_MERMA_TOTAL) M2_MERMA_TOTAL
		FROM ANE_M_PRO WHERE EMPRESA = vEmpresa AND OT = nNumero 
		GROUP BY EMPRESA,N_CLIENTE,CLIENTE,OT,FECHA_DE_LA_OT,FECHA_CIERRE_DE_LA_OT,TIPO_PRD,ESPECIALIDAD,LINEA,LFS,N_CAPAS_TOTALES,CANTIDAD_DE_FASES,
				 ANCHO_CLIENTE,N_DE_CORTES,N_DE_VECES,ANCHO_DE_PRODUCCION,--ORIGEN_MP,
				 TIPO_MP,COD_MP,LFS_MP,
				 FASE_MP,SECCION_PRODUCTIVA_MP,MAQUINA_MP,
				 FECHA_FACTURA,UNIDAD_CIERRE,Q_CERRADA_ML,Q_CERRADA_M2,Q_CERRADA_KG,Q_CERRADA_UN,FUENTE_DEL_CIERRE;
		--
		FOR nI In 1..t_Materiales.Count LOOP
			biIndice   := nI;
			rMateriales := t_Materiales(biIndice);
			--
/*dbms_output.put_line('MATERIAL: '||
			rMateriales.vEmpresa||','||
			rMateriales.nNumeOtre||','||
			rMateriales.nContador||','||
			rMateriales.vTip_Arti||','||
			rMateriales.vCod_Arti||','||
			--
			' nMermTira: '||rMateriales.nMermTira||
			' nMermSane: '||rMateriales.nMermSane||
			' nMermEnhe: '||rMateriales.nMermEnhe||
			' nMermAjus: '||rMateriales.nMermAjus||
			' nMermCabo: '||rMateriales.nMermCabo||
			' nMermPico: '||rMateriales.nMermPico);*/
		   --
			nMermCoan_T := 0;
			nMermCoan_P := 0;
			--
			IF vExisMeti IS NOT NULL THEN
				nMermCoan_P := nMermCoan_P + NVL(rMateriales.nMermTira,0);
			END IF;
			--
			IF vExisMesa IS NOT NULL THEN
				nMermCoan_P := nMermCoan_P + NVL(rMateriales.nMermSane,0);
			END IF;
			--
			IF vExisMeen IS NOT NULL THEN
				nMermCoan_P := nMermCoan_P + NVL(rMateriales.nMermEnhe,0);
			END IF;
			--
			IF vExisMeaj IS NOT NULL THEN
				nMermCoan_P := nMermCoan_P + NVL(rMateriales.nMermAjus,0);
			END IF;
			--
			IF vExisMeca IS NOT NULL THEN
				nMermCoan_P := nMermCoan_P + NVL(rMateriales.nMermCabo,0);
			END IF;
			--
			IF vExisMepi IS NOT NULL THEN
				nMermCoan_P := nMermCoan_P + NVL(rMateriales.nMermPico,0);
			END IF;
			--
			FOR nC In 1..t_Materiales_Rama.Count LOOP
				biIndice_Carga   := nC;
				rMateriales_Rama := t_Materiales_Rama(biIndice_Carga);
				--
				IF rMateriales_Rama.vEmpresa = rMateriales.vEmpresa AND
					rMateriales_Rama.nNumeOtre = rMateriales.nNumeOtre AND 
					rMateriales_Rama.nContador = rMateriales.nContador AND 
					rMateriales_Rama.vTip_Arti = rMateriales.vTip_Arti AND 
					rMateriales_Rama.vCod_Arti = rMateriales.vCod_Arti THEN
/*dbms_output.put_line('RAMA: '||
					rMateriales_Rama.vEmprBobi||','||rMateriales_Rama.nNuotBobi||','||rMateriales_Rama.nContBobi||','||rMateriales_Rama.nCoboBobi||','||rMateriales_Rama.vLote||
					' nMermTira: '||rMateriales_Rama.nMermTira||
					' nMermSane: '||rMateriales_Rama.nMermSane||
					' nMermEnhe: '||rMateriales_Rama.nMermEnhe||
					' nMermAjus: '||rMateriales_Rama.nMermAjus||
					' nMermCabo: '||rMateriales_Rama.nMermCabo||
					' nMermPico: '||rMateriales_Rama.nMermPico);*/
					--
					IF vExisMeti IS NOT NULL THEN
						nMermCoan_T := nMermCoan_T + NVL(rMateriales_Rama.nMermTira,0);
					END IF;
					--
					IF vExisMesa IS NOT NULL THEN
						nMermCoan_T := nMermCoan_T + NVL(rMateriales_Rama.nMermSane,0);
					END IF;
					--
					IF vExisMeen IS NOT NULL THEN
						nMermCoan_T := nMermCoan_T + NVL(rMateriales_Rama.nMermEnhe,0);
					END IF;
					--
					IF vExisMeaj IS NOT NULL THEN
						nMermCoan_T := nMermCoan_T + NVL(rMateriales_Rama.nMermAjus,0);
					END IF;
					--
					IF vExisMeca IS NOT NULL THEN
						nMermCoan_T := nMermCoan_T + NVL(rMateriales_Rama.nMermCabo,0);
					END IF;
					--
					IF vExisMepi IS NOT NULL THEN
						nMermCoan_T := nMermCoan_T + NVL(rMateriales_Rama.nMermPico,0);
					END IF;
				END IF;
			END LOOP;
			--
			rMateriales.nMermCoan_T := nMermCoan_T;
			rMateriales.nMermCoan_P := nMermCoan_P;
			--
			t_Materiales (biIndice) := rMateriales;
/*dbms_output.put_line('MATERIAL CON MERMAS ACUMULADAS: '||
			rMateriales.vEmpresa||','||
			rMateriales.nNumeOtre||','||
			rMateriales.nContador||','||
			rMateriales.vTip_Arti||','||
			rMateriales.vCod_Arti||','||
			--
			' nMermCoan_T: '||rMateriales.nMermCoan_T||
			' nMermCoan_P: '||rMateriales.nMermCoan_P);*/
			--Se busca la Maquina Siguiente para calcular la Cantidad Producida Real, equivalente a la Cantidad Producida menos las mermas acumuladas Anteriores sino es la ultima maquina o la cantidad producida en caso de serlo
			nContMaquSigu := NULL;
			vMaquCodiSigu := NULL;
			--
			OPEN cContMaquSigu(rMateriales.vEmpresa,rMateriales.nNumeOtre,rMateriales.nContador);
			FETCH cContMaquSigu INTO nContMaquSigu,vMaquCodiSigu;
			CLOSE cContMaquSigu;
--dbms_output.put_line('cContMaquSigu: '||rMateriales.vEmpresa||','||rMateriales.nNumeOtre||','||rMateriales.nContador||' ->'||nContMaquSigu);
			--
			IF nContMaquSigu IS NOT NULL THEN
				--NEW III
				IF rMateriales.vTip_Arti != vTiarReF4 THEN --Sergio Solicita que para materiales de restos la cantidad producida real siempre sea 0
					UPDATE ANALESTA.ANE_M_PRO_REAL 
					SET ML_MERMAS_ACUMULADAS_HAS_MAQ = NVL(rMateriales.nMermCoan_T,0),
						 ML_MERMAS_ACUMULADAS_EN_MAQ = NVL(rMateriales.nMermCoan_P,0),
						 --ML_PRODUCIDOS_REALES = NVL(ML_PRODUCIDOS,0) - NVL(rMateriales.nMermCoan_T,0) 
						 ML_PRODUCIDOS_REALES = NVL(ML_PRODUCIDOS,0) - NVL(rMateriales.nMermCoan_P,0) 
					WHERE EMPRESA = rMateriales.vEmpresa
					  AND OT = rMateriales.nNumeOtre
					  AND FASE_MP = rMateriales.nContador
					  AND TIPO_MP = rMateriales.vTip_Arti
					  AND COD_MP = rMateriales.vCod_Arti;
				ELSE
				   UPDATE ANALESTA.ANE_M_PRO_REAL 
					SET ML_MERMAS_ACUMULADAS_HAS_MAQ = NVL(rMateriales.nMermCoan_T,0),
						 ML_MERMAS_ACUMULADAS_EN_MAQ = NVL(rMateriales.nMermCoan_P,0),
						 ML_PRODUCIDOS_REALES = 0 
					WHERE EMPRESA = rMateriales.vEmpresa
					  AND OT = rMateriales.nNumeOtre
					  AND FASE_MP = rMateriales.nContador
					  AND TIPO_MP = rMateriales.vTip_Arti
					  AND COD_MP = rMateriales.vCod_Arti;
				END IF;
				--END NEW III
			ELSE
				--NEW III
				IF rMateriales.vTip_Arti != vTiarReF4 THEN --Sergio Solicita que para materiales de restos la cantidad producida real siempre sea 0
					UPDATE ANALESTA.ANE_M_PRO_REAL 
					SET ML_MERMAS_ACUMULADAS_HAS_MAQ = NVL(rMateriales.nMermCoan_T,0),
						 ML_MERMAS_ACUMULADAS_EN_MAQ = NVL(rMateriales.nMermCoan_P,0),
						 ML_PRODUCIDOS_REALES = NVL(ML_PRODUCIDOS,0)
					WHERE EMPRESA = rMateriales.vEmpresa
					  AND OT = rMateriales.nNumeOtre
					  AND FASE_MP = rMateriales.nContador
					  AND TIPO_MP = rMateriales.vTip_Arti
					  AND COD_MP = rMateriales.vCod_Arti;
				ELSE
					UPDATE ANALESTA.ANE_M_PRO_REAL 
					SET ML_MERMAS_ACUMULADAS_HAS_MAQ = NVL(rMateriales.nMermCoan_T,0),
						 ML_MERMAS_ACUMULADAS_EN_MAQ = NVL(rMateriales.nMermCoan_P,0),
						 ML_PRODUCIDOS_REALES = 0
					WHERE EMPRESA = rMateriales.vEmpresa
					  AND OT = rMateriales.nNumeOtre
					  AND FASE_MP = rMateriales.nContador
					  AND TIPO_MP = rMateriales.vTip_Arti
					  AND COD_MP = rMateriales.vCod_Arti;
            END IF;
				--END NEW III
			END IF;
		END LOOP;
		--Actualización de Consumido real y calculo de M2
		FOR rANE_M_PRO_REAL IN cANE_M_PRO_REAL(vEmpresa,nNumero) LOOP
			--Calculo del Ancho A=(M2/ML)*1000
			IF NVL(rANE_M_PRO_REAL.ML_CONSUMIDOS,0) = 0 THEN
				nAncho := 0;
			ELSE
				nAncho := (NVL(rANE_M_PRO_REAL.M2_CONSUMIDOS,0)/NVL(rANE_M_PRO_REAL.ML_CONSUMIDOS,0)) * 1000;
			END IF;
			--Calculo del Precio
			IF NVL(rANE_M_PRO_REAL.M2_CONSUMIDOS,0) = 0 THEN
			   nPrecio := 0;
		   ELSE
			   nPrecio := NVL(rANE_M_PRO_REAL.EUROS_ML_CONSUMIDOS,0) / rANE_M_PRO_REAL.M2_CONSUMIDOS;
			END IF;
			--
		   IF rANE_M_PRO_REAL.TIPO_MP IN (vTiarSeF4, vTiarMpF4, vTiarFiF4, vTiarReF4,vTiarCOSC) THEN
				UPDATE ANALESTA.ANE_M_PRO_REAL 
				SET ML_CONSUMIDOS_REALES = ML_CONSUMIDOS,
					 M2_CONSUMIDOS_REALES = M2_CONSUMIDOS,
					 M2_MERMAS_ACUMULADAS_HAS_MAQ = ML_MERMAS_ACUMULADAS_HAS_MAQ * (nAncho/1000),
					 M2_MERMAS_ACUMULADAS_EN_MAQ = ML_MERMAS_ACUMULADAS_EN_MAQ * (nAncho/1000),
					 M2_PRODUCIDOS_REALES = ML_PRODUCIDOS_REALES * (nAncho/1000),
					 EUROS_ML_CONSUMIDOS_REALES = M2_CONSUMIDOS * nPrecio,
					 EUROS_ML_PRODUCIDOS_REALES = (ML_PRODUCIDOS_REALES * (nAncho/1000)) * nPrecio,
					 EUR_MERMAS_ACUMULADAS_HAS_MAQ = (ML_MERMAS_ACUMULADAS_HAS_MAQ * (nAncho/1000)) * nPrecio,
					 EUR_MERMAS_ACUMULADAS_EN_MAQ = (ML_MERMAS_ACUMULADAS_EN_MAQ * (nAncho/1000)) * nPrecio,
					 ML_MERMA_PROCESO_MQUINA = NVL(ML_CONSUMIDOS,0) - NVL(ML_PRODUCIDOS_REALES,0) - NVL(ML_ENHEBRADO_MAQUINA,0) - NVL(ML_AJ_MAQUINA_MAQUINA,0) - NVL(ML_CAMBIO_BOBINA_MAQUINA,0) - NVL(ML_MERMA_TIRADA_MQUINA,0) - NVL(ML_SANEAMIENTOS_MAQUINA,0),
					 M2_MERMA_PROCESO_MQUINA = ((NVL(ML_CONSUMIDOS,0) - NVL(ML_PRODUCIDOS_REALES,0) - NVL(ML_ENHEBRADO_MAQUINA,0) - NVL(ML_AJ_MAQUINA_MAQUINA,0) - NVL(ML_CAMBIO_BOBINA_MAQUINA,0) - NVL(ML_MERMA_TIRADA_MQUINA,0) - NVL(ML_SANEAMIENTOS_MAQUINA,0)) * (nAncho/1000)),
					 EUROS_ML_MERMA_PROCESO = ((NVL(ML_CONSUMIDOS,0) - NVL(ML_PRODUCIDOS_REALES,0) - NVL(ML_ENHEBRADO_MAQUINA,0) - NVL(ML_AJ_MAQUINA_MAQUINA,0) - NVL(ML_CAMBIO_BOBINA_MAQUINA,0) - NVL(ML_MERMA_TIRADA_MQUINA,0) - NVL(ML_SANEAMIENTOS_MAQUINA,0)) * (nAncho/1000)) * nPrecio,
					 --TOTAL_EUROS_MERMPLAN = ((NVL(ML_CONSUMIDOS,0) - NVL(ML_PRODUCIDOS_REALES,0))  * (nAncho/1000)) * nPrecio,
					 ML_MERMA_TOTAL = NVL(ML_CONSUMIDOS,0) - NVL(ML_PRODUCIDOS_REALES,0),
					 M2_MERMA_TOTAL = (NVL(ML_CONSUMIDOS,0) - NVL(ML_PRODUCIDOS_REALES,0))  * (nAncho/1000),
					 PRECIO = nPrecio,
					 ANCHO_MP = nAncho
				WHERE ROWID = rANE_M_PRO_REAL.ROWID;
				--NEW IV
				--Actualización de Reales por Contador
				rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES := NULL;
				rANE_M_PRO_REAL_VALOREAL.M2_CONSUMIDOS_REALES := NULL;
				rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES := NULL;
				rANE_M_PRO_REAL_VALOREAL.M2_PRODUCIDOS_REALES := NULL;
				--
				OPEN cANE_M_PRO_REAL_VALOREAL(rANE_M_PRO_REAL.EMPRESA, rANE_M_PRO_REAL.OT, rANE_M_PRO_REAL.FASE_MP,
													   rANE_M_PRO_REAL.TIPO_MP, rANE_M_PRO_REAL.COD_MP);
				FETCH cANE_M_PRO_REAL_VALOREAL INTO rANE_M_PRO_REAL_VALOREAL;
				CLOSE cANE_M_PRO_REAL_VALOREAL;
				--
				FOR rEstructura IN cEstructura_Total(rANE_M_PRO_REAL.EMPRESA, rANE_M_PRO_REAL.OT,
		                                           rANE_M_PRO_REAL.TIPO_MP, rANE_M_PRO_REAL.COD_MP, rANE_M_PRO_REAL.FASE_MP) LOOP
				   IF rANE_M_PRO_REAL.FASE_MP = 1 THEN
						UPDATE ANALESTA.ANE_M_PRO_REAL 
						SET ML_CONSUMIDOS_REALES_01 = rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES, --ML_CONSUMIDOS_REALES_05 = 1, M2_CONSUMIDOS_REALES_05 = 1,
							 M2_CONSUMIDOS_REALES_01 = rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES * (rEstructura.Ancho_MP/1000),--rANE_M_PRO_REAL_VALOREAL.M2_CONSUMIDOS_REALES,
							 ML_PRODUCIDOS_REALES_01 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES,
							 M2_PRODUCIDOS_REALES_01 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES * (rEstructura.Ancho_MP/1000)--rANE_M_PRO_REAL_VALOREAL.M2_PRODUCIDOS_REALES
						WHERE ROWID = rEstructura.ROWID;
					ELSIF rANE_M_PRO_REAL.FASE_MP = 2 THEN
--dbms_output.put_line('1 rANE_M_PRO_REAL: '||rANE_M_PRO_REAL.EMPRESA||', '||rANE_M_PRO_REAL.OT||', '||rANE_M_PRO_REAL.TIPO_MP||', '||rANE_M_PRO_REAL.COD_MP||', '||rANE_M_PRO_REAL.FASE_MP||'->'||rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES);
						UPDATE ANALESTA.ANE_M_PRO_REAL 
						SET ML_CONSUMIDOS_REALES_02 = rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES, --ML_CONSUMIDOS_REALES_05 = 1, M2_CONSUMIDOS_REALES_05 = 2,
							 M2_CONSUMIDOS_REALES_02 = rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES * (rEstructura.Ancho_MP/1000),--rANE_M_PRO_REAL_VALOREAL.M2_CONSUMIDOS_REALES,
							 ML_PRODUCIDOS_REALES_02 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES,
							 M2_PRODUCIDOS_REALES_02 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES * (rEstructura.Ancho_MP/1000)--rANE_M_PRO_REAL_VALOREAL.M2_PRODUCIDOS_REALES
						WHERE ROWID = rEstructura.ROWID;
					ELSIF rANE_M_PRO_REAL.FASE_MP = 3 THEN
						UPDATE ANALESTA.ANE_M_PRO_REAL 
						SET ML_CONSUMIDOS_REALES_03 = rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES, --ML_CONSUMIDOS_REALES_05 = 1, M2_CONSUMIDOS_REALES_05 = 3,
							 M2_CONSUMIDOS_REALES_03 = rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES * (rEstructura.Ancho_MP/1000),--rANE_M_PRO_REAL_VALOREAL.M2_CONSUMIDOS_REALES,
							 ML_PRODUCIDOS_REALES_03 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES,
							 M2_PRODUCIDOS_REALES_03 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES * (rEstructura.Ancho_MP/1000)--rANE_M_PRO_REAL_VALOREAL.M2_PRODUCIDOS_REALES
						WHERE ROWID = rEstructura.ROWID;
					ELSIF rANE_M_PRO_REAL.FASE_MP = 4 THEN
						UPDATE ANALESTA.ANE_M_PRO_REAL 
						SET ML_CONSUMIDOS_REALES_04 = rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES, --ML_CONSUMIDOS_REALES_05 = 1, M2_CONSUMIDOS_REALES_05 = 4,
							 M2_CONSUMIDOS_REALES_04 = rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES * (rEstructura.Ancho_MP/1000),--rANE_M_PRO_REAL_VALOREAL.M2_CONSUMIDOS_REALES,
							 ML_PRODUCIDOS_REALES_04 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES,
							 M2_PRODUCIDOS_REALES_04 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES * (rEstructura.Ancho_MP/1000)--rANE_M_PRO_REAL_VALOREAL.M2_PRODUCIDOS_REALES
						WHERE ROWID = rEstructura.ROWID;
					ELSIF rANE_M_PRO_REAL.FASE_MP = 5 THEN
						UPDATE ANALESTA.ANE_M_PRO_REAL 
						SET ML_CONSUMIDOS_REALES_05 = rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES, --ML_CONSUMIDOS_REALES_05 = 1, M2_CONSUMIDOS_REALES_05 = 4,
							 M2_CONSUMIDOS_REALES_05 = rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES * (rEstructura.Ancho_MP/1000),--rANE_M_PRO_REAL_VALOREAL.M2_CONSUMIDOS_REALES,
							 ML_PRODUCIDOS_REALES_05 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES,
							 M2_PRODUCIDOS_REALES_05 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES * (rEstructura.Ancho_MP/1000)--rANE_M_PRO_REAL_VALOREAL.M2_PRODUCIDOS_REALES
						WHERE ROWID = rEstructura.ROWID;
					ELSIF rANE_M_PRO_REAL.FASE_MP = 6 THEN
						UPDATE ANALESTA.ANE_M_PRO_REAL 
						SET ML_CONSUMIDOS_REALES_06 = rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES, --ML_CONSUMIDOS_REALES_05 = 1, M2_CONSUMIDOS_REALES_05 = 4,
							 M2_CONSUMIDOS_REALES_06 = rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES * (rEstructura.Ancho_MP/1000),--rANE_M_PRO_REAL_VALOREAL.M2_CONSUMIDOS_REALES,
							 ML_PRODUCIDOS_REALES_06 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES,
							 M2_PRODUCIDOS_REALES_06 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES * (rEstructura.Ancho_MP/1000)--rANE_M_PRO_REAL_VALOREAL.M2_PRODUCIDOS_REALES
						WHERE ROWID = rEstructura.ROWID;
					ELSIF rANE_M_PRO_REAL.FASE_MP = 7 THEN
						UPDATE ANALESTA.ANE_M_PRO_REAL 
						SET ML_CONSUMIDOS_REALES_07 = rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES, --ML_CONSUMIDOS_REALES_05 = 1, M2_CONSUMIDOS_REALES_05 = 4,
							 M2_CONSUMIDOS_REALES_07 = rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES * (rEstructura.Ancho_MP/1000),--rANE_M_PRO_REAL_VALOREAL.M2_CONSUMIDOS_REALES,
							 ML_PRODUCIDOS_REALES_07 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES,
							 M2_PRODUCIDOS_REALES_07 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES * (rEstructura.Ancho_MP/1000)--rANE_M_PRO_REAL_VALOREAL.M2_PRODUCIDOS_REALES
						WHERE ROWID = rEstructura.ROWID;
					ELSIF rANE_M_PRO_REAL.FASE_MP = 8 THEN
						UPDATE ANALESTA.ANE_M_PRO_REAL 
						SET ML_CONSUMIDOS_REALES_08 = rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES, --ML_CONSUMIDOS_REALES_05 = 1, M2_CONSUMIDOS_REALES_05 = 4,
							 M2_CONSUMIDOS_REALES_08 = rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES * (rEstructura.Ancho_MP/1000),--rANE_M_PRO_REAL_VALOREAL.M2_CONSUMIDOS_REALES,
							 ML_PRODUCIDOS_REALES_08 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES,
							 M2_PRODUCIDOS_REALES_08 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES * (rEstructura.Ancho_MP/1000)--rANE_M_PRO_REAL_VALOREAL.M2_PRODUCIDOS_REALES
						WHERE ROWID = rEstructura.ROWID;
					ELSIF rANE_M_PRO_REAL.FASE_MP = 9 THEN
						UPDATE ANALESTA.ANE_M_PRO_REAL 
						SET ML_CONSUMIDOS_REALES_09 = rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES, --ML_CONSUMIDOS_REALES_05 = 1, M2_CONSUMIDOS_REALES_05 = 4,
							 M2_CONSUMIDOS_REALES_09 = rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES * (rEstructura.Ancho_MP/1000),--rANE_M_PRO_REAL_VALOREAL.M2_CONSUMIDOS_REALES,
							 ML_PRODUCIDOS_REALES_09 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES,
							 M2_PRODUCIDOS_REALES_09 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES * (rEstructura.Ancho_MP/1000)--rANE_M_PRO_REAL_VALOREAL.M2_PRODUCIDOS_REALES
						WHERE ROWID = rEstructura.ROWID;
					ELSIF rANE_M_PRO_REAL.FASE_MP = 10 THEN
						UPDATE ANALESTA.ANE_M_PRO_REAL 
						SET ML_CONSUMIDOS_REALES_10 = rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES, --ML_CONSUMIDOS_REALES_05 = 1, M2_CONSUMIDOS_REALES_05 = 4,
							 M2_CONSUMIDOS_REALES_10 = rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES * (rEstructura.Ancho_MP/1000),--rANE_M_PRO_REAL_VALOREAL.M2_CONSUMIDOS_REALES,
							 ML_PRODUCIDOS_REALES_10 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES,
							 M2_PRODUCIDOS_REALES_10 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES * (rEstructura.Ancho_MP/1000)--rANE_M_PRO_REAL_VALOREAL.M2_PRODUCIDOS_REALES
						WHERE ROWID = rEstructura.ROWID;
					END IF;
				END LOOP;
				--END NEW IV
			ELSE
				--Se busca la Maquina Anterior para calcular la Cantidad Consumida Real, equivalente a la Cantidad Producida Real de la Maquina Anterior
				nContMaquAnte := NULL;
				vMaquCodi := NULL;
				--
				OPEN cContMaquAnte(vEmpresa,nNumero,rANE_M_PRO_REAL.FASE_MP);
				FETCH cContMaquAnte INTO nContMaquAnte,vMaquCodi;
				CLOSE cContMaquAnte;
				--
				nML_Producidos_Maquina_Ant := NULL;
				--
				IF nContMaquAnte IS NOT NULL THEN
					OPEN cANE_M_PRO_REAL_MAQUANTE(vEmpresa,nNumero,nContMaquAnte);
					FETCH cANE_M_PRO_REAL_MAQUANTE INTO nML_Producidos_Maquina_Ant;
					CLOSE cANE_M_PRO_REAL_MAQUANTE;
				END IF;
				--
				IF INSTR(vMaquCodi,'LAMINADORA') != 0 THEN
					IF NVL(nML_Producidos_Maquina_Ant,0) != 0 THEN
						UPDATE ANALESTA.ANE_M_PRO_REAL 
						SET ML_CONSUMIDOS_REALES = nML_Producidos_Maquina_Ant/2,
							 M2_CONSUMIDOS_REALES = (nML_Producidos_Maquina_Ant/2) * (nAncho/1000),
							 M2_MERMAS_ACUMULADAS_HAS_MAQ = ML_MERMAS_ACUMULADAS_HAS_MAQ * (nAncho/1000),
							 M2_MERMAS_ACUMULADAS_EN_MAQ = ML_MERMAS_ACUMULADAS_EN_MAQ * (nAncho/1000),
							 M2_PRODUCIDOS_REALES = ML_PRODUCIDOS_REALES * (nAncho/1000),
							 EUROS_ML_CONSUMIDOS_REALES = ((nML_Producidos_Maquina_Ant/2) * (nAncho/1000)) * nPrecio,
							 EUROS_ML_PRODUCIDOS_REALES = (ML_PRODUCIDOS_REALES * (nAncho/1000)) * nPrecio,
							 EUR_MERMAS_ACUMULADAS_HAS_MAQ = (ML_MERMAS_ACUMULADAS_HAS_MAQ * (nAncho/1000)) * nPrecio,
							 EUR_MERMAS_ACUMULADAS_EN_MAQ = (ML_MERMAS_ACUMULADAS_EN_MAQ * (nAncho/1000)) * nPrecio,
							 ML_MERMA_PROCESO_MQUINA = NVL(nML_Producidos_Maquina_Ant/2,0) - NVL(ML_PRODUCIDOS_REALES,0) - NVL(ML_ENHEBRADO_MAQUINA,0) - NVL(ML_AJ_MAQUINA_MAQUINA,0) - NVL(ML_CAMBIO_BOBINA_MAQUINA,0) - NVL(ML_MERMA_TIRADA_MQUINA,0) - NVL(ML_SANEAMIENTOS_MAQUINA,0),
							 M2_MERMA_PROCESO_MQUINA = ((NVL(nML_Producidos_Maquina_Ant/2,0) - NVL(ML_PRODUCIDOS_REALES,0) - NVL(ML_ENHEBRADO_MAQUINA,0) - NVL(ML_AJ_MAQUINA_MAQUINA,0) - NVL(ML_CAMBIO_BOBINA_MAQUINA,0) - NVL(ML_MERMA_TIRADA_MQUINA,0) - NVL(ML_SANEAMIENTOS_MAQUINA,0)) * (nAncho/1000)),
							 EUROS_ML_MERMA_PROCESO = ((NVL(nML_Producidos_Maquina_Ant/2,0) - NVL(ML_PRODUCIDOS_REALES,0) - NVL(ML_ENHEBRADO_MAQUINA,0) - NVL(ML_AJ_MAQUINA_MAQUINA,0) - NVL(ML_CAMBIO_BOBINA_MAQUINA,0) - NVL(ML_MERMA_TIRADA_MQUINA,0) - NVL(ML_SANEAMIENTOS_MAQUINA,0)) * (nAncho/1000)) * nPrecio,
							 --TOTAL_EUROS_MERMPLAN = ((NVL(nML_Producidos_Maquina_Ant/2,0) - NVL(ML_PRODUCIDOS_REALES,0))  * (nAncho/1000)) * nPrecio,
							 ML_MERMA_TOTAL = NVL(nML_Producidos_Maquina_Ant/2,0) - NVL(ML_PRODUCIDOS_REALES,0),
							 M2_MERMA_TOTAL = (NVL(nML_Producidos_Maquina_Ant/2,0) - NVL(ML_PRODUCIDOS_REALES,0))  * (nAncho/1000),
							 PRECIO = nPrecio,
							 ANCHO_MP = nAncho
						WHERE ROWID = rANE_M_PRO_REAL.ROWID;
					--NEW IV PENDIENTE
					   --Se actualiza la fase actual en los contadores
						--Busqueda de valores reales
						rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES := NULL;
						rANE_M_PRO_REAL_VALOREAL.M2_CONSUMIDOS_REALES := NULL;
						rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES := NULL;
						rANE_M_PRO_REAL_VALOREAL.M2_PRODUCIDOS_REALES := NULL;
						--
						nML_Producidos_Maquina_Ant := NULL;
						nM2_Producidos_Maquina_Ant := NULL;
						--
						OPEN cANE_M_PRO_REAL_VALOREAL(rANE_M_PRO_REAL.EMPRESA, rANE_M_PRO_REAL.OT, rANE_M_PRO_REAL.FASE_MP,
																rANE_M_PRO_REAL.TIPO_MP, rANE_M_PRO_REAL.COD_MP);
						FETCH cANE_M_PRO_REAL_VALOREAL INTO rANE_M_PRO_REAL_VALOREAL;
						CLOSE cANE_M_PRO_REAL_VALOREAL;
						--
						nML_Producidos_Maquina_Ant := rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES;
						nM2_Producidos_Maquina_Ant := rANE_M_PRO_REAL_VALOREAL.M2_PRODUCIDOS_REALES;
--dbms_output.put_line(rANE_M_PRO_REAL.EMPRESA||', '||rANE_M_PRO_REAL.OT||', '||rANE_M_PRO_REAL.FASE_MP||', '||rANE_M_PRO_REAL.TIPO_MP||', '||rANE_M_PRO_REAL.COD_MP||'->'||nML_Producidos_Maquina_Ant);
						--
						IF rANE_M_PRO_REAL.FASE_MP = 1 THEN
							UPDATE ANALESTA.ANE_M_PRO_REAL 
							SET ML_CONSUMIDOS_REALES_01 = rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES, --ML_CONSUMIDOS_REALES_06 = 2, M2_CONSUMIDOS_REALES_06 = 1,
								 M2_CONSUMIDOS_REALES_01 = rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES * (rANE_M_PRO_REAL_VALOREAL.Ancho_MP/1000),--rANE_M_PRO_REAL_VALOREAL.M2_CONSUMIDOS_REALES,
								 ML_PRODUCIDOS_REALES_01 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES,
								 M2_PRODUCIDOS_REALES_01 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES * (rANE_M_PRO_REAL_VALOREAL.Ancho_MP/1000)--rANE_M_PRO_REAL_VALOREAL.M2_PRODUCIDOS_REALES
							WHERE EMPRESA = rANE_M_PRO_REAL.EMPRESA
							  AND OT = rANE_M_PRO_REAL.OT
							  AND FASE_MP = rANE_M_PRO_REAL.FASE_MP
							  AND TIPO_MP = rANE_M_PRO_REAL.TIPO_MP
							  AND COD_MP = rANE_M_PRO_REAL.COD_MP;
						ELSIF rANE_M_PRO_REAL.FASE_MP = 2 THEN
--dbms_output.put_line('2 rANE_M_PRO_REAL: '||rANE_M_PRO_REAL.EMPRESA||', '||rANE_M_PRO_REAL.OT||', '||rANE_M_PRO_REAL.TIPO_MP||', '||rANE_M_PRO_REAL.COD_MP||', '||rANE_M_PRO_REAL.FASE_MP||'->'||rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES);
							UPDATE ANALESTA.ANE_M_PRO_REAL 
							SET ML_CONSUMIDOS_REALES_02 = rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES, --ML_CONSUMIDOS_REALES_06 = 2, M2_CONSUMIDOS_REALES_06 = 2,
								 M2_CONSUMIDOS_REALES_02 = rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES * (rANE_M_PRO_REAL_VALOREAL.Ancho_MP/1000),--rANE_M_PRO_REAL_VALOREAL.M2_CONSUMIDOS_REALES,
								 ML_PRODUCIDOS_REALES_02 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES,
								 M2_PRODUCIDOS_REALES_02 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES * (rANE_M_PRO_REAL_VALOREAL.Ancho_MP/1000)--rANE_M_PRO_REAL_VALOREAL.M2_PRODUCIDOS_REALES
							WHERE EMPRESA = rANE_M_PRO_REAL.EMPRESA
							  AND OT = rANE_M_PRO_REAL.OT
							  AND FASE_MP = rANE_M_PRO_REAL.FASE_MP
							  AND TIPO_MP = rANE_M_PRO_REAL.TIPO_MP
							  AND COD_MP = rANE_M_PRO_REAL.COD_MP;
						ELSIF rANE_M_PRO_REAL.FASE_MP = 3 THEN
							UPDATE ANALESTA.ANE_M_PRO_REAL 
							SET ML_CONSUMIDOS_REALES_03 = rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES, --ML_CONSUMIDOS_REALES_06 = 2, M2_CONSUMIDOS_REALES_06 = 3,
								 M2_CONSUMIDOS_REALES_03 = rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES * (rANE_M_PRO_REAL_VALOREAL.Ancho_MP/1000),--rANE_M_PRO_REAL_VALOREAL.M2_CONSUMIDOS_REALES,
								 ML_PRODUCIDOS_REALES_03 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES,
								 M2_PRODUCIDOS_REALES_03 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES * (rANE_M_PRO_REAL_VALOREAL.Ancho_MP/1000)--rANE_M_PRO_REAL_VALOREAL.M2_PRODUCIDOS_REALES
							WHERE EMPRESA = rANE_M_PRO_REAL.EMPRESA
							  AND OT = rANE_M_PRO_REAL.OT
							  AND FASE_MP = rANE_M_PRO_REAL.FASE_MP
							  AND TIPO_MP = rANE_M_PRO_REAL.TIPO_MP
							  AND COD_MP = rANE_M_PRO_REAL.COD_MP;
						ELSIF rANE_M_PRO_REAL.FASE_MP = 4 THEN
							UPDATE ANALESTA.ANE_M_PRO_REAL 
							SET ML_CONSUMIDOS_REALES_04 = rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES, --ML_CONSUMIDOS_REALES_06 = 2, M2_CONSUMIDOS_REALES_06 = 4,
								 M2_CONSUMIDOS_REALES_04 = rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES * (rANE_M_PRO_REAL_VALOREAL.Ancho_MP/1000),--rANE_M_PRO_REAL_VALOREAL.M2_CONSUMIDOS_REALES,
								 ML_PRODUCIDOS_REALES_04 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES,
								 M2_PRODUCIDOS_REALES_04 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES * (rANE_M_PRO_REAL_VALOREAL.Ancho_MP/1000)--rANE_M_PRO_REAL_VALOREAL.M2_PRODUCIDOS_REALES
							WHERE EMPRESA = rANE_M_PRO_REAL.EMPRESA
							  AND OT = rANE_M_PRO_REAL.OT
							  AND FASE_MP = rANE_M_PRO_REAL.FASE_MP
							  AND TIPO_MP = rANE_M_PRO_REAL.TIPO_MP
							  AND COD_MP = rANE_M_PRO_REAL.COD_MP;
						ELSIF rANE_M_PRO_REAL.FASE_MP = 5 THEN
							UPDATE ANALESTA.ANE_M_PRO_REAL 
							SET ML_CONSUMIDOS_REALES_05 = rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES, --ML_CONSUMIDOS_REALES_06 = 2, M2_CONSUMIDOS_REALES_06 = 4,
								 M2_CONSUMIDOS_REALES_05 = rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES * (rANE_M_PRO_REAL_VALOREAL.Ancho_MP/1000),--rANE_M_PRO_REAL_VALOREAL.M2_CONSUMIDOS_REALES,
								 ML_PRODUCIDOS_REALES_05 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES,
								 M2_PRODUCIDOS_REALES_05 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES * (rANE_M_PRO_REAL_VALOREAL.Ancho_MP/1000)--rANE_M_PRO_REAL_VALOREAL.M2_PRODUCIDOS_REALES
							WHERE EMPRESA = rANE_M_PRO_REAL.EMPRESA
							  AND OT = rANE_M_PRO_REAL.OT
							  AND FASE_MP = rANE_M_PRO_REAL.FASE_MP
							  AND TIPO_MP = rANE_M_PRO_REAL.TIPO_MP
							  AND COD_MP = rANE_M_PRO_REAL.COD_MP;
						ELSIF rANE_M_PRO_REAL.FASE_MP = 6 THEN
							UPDATE ANALESTA.ANE_M_PRO_REAL 
							SET ML_CONSUMIDOS_REALES_06 = rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES, --ML_CONSUMIDOS_REALES_06 = 2, M2_CONSUMIDOS_REALES_06 = 4,
								 M2_CONSUMIDOS_REALES_06 = rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES * (rANE_M_PRO_REAL_VALOREAL.Ancho_MP/1000),--rANE_M_PRO_REAL_VALOREAL.M2_CONSUMIDOS_REALES,
								 ML_PRODUCIDOS_REALES_06 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES,
								 M2_PRODUCIDOS_REALES_06 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES * (rANE_M_PRO_REAL_VALOREAL.Ancho_MP/1000)--rANE_M_PRO_REAL_VALOREAL.M2_PRODUCIDOS_REALES
							WHERE EMPRESA = rANE_M_PRO_REAL.EMPRESA
							  AND OT = rANE_M_PRO_REAL.OT
							  AND FASE_MP = rANE_M_PRO_REAL.FASE_MP
							  AND TIPO_MP = rANE_M_PRO_REAL.TIPO_MP
							  AND COD_MP = rANE_M_PRO_REAL.COD_MP;
						ELSIF rANE_M_PRO_REAL.FASE_MP = 7 THEN
							UPDATE ANALESTA.ANE_M_PRO_REAL 
							SET ML_CONSUMIDOS_REALES_07 = rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES, --ML_CONSUMIDOS_REALES_06 = 2, M2_CONSUMIDOS_REALES_06 = 4,
								 M2_CONSUMIDOS_REALES_07 = rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES * (rANE_M_PRO_REAL_VALOREAL.Ancho_MP/1000),--rANE_M_PRO_REAL_VALOREAL.M2_CONSUMIDOS_REALES,
								 ML_PRODUCIDOS_REALES_07 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES,
								 M2_PRODUCIDOS_REALES_07 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES * (rANE_M_PRO_REAL_VALOREAL.Ancho_MP/1000)--rANE_M_PRO_REAL_VALOREAL.M2_PRODUCIDOS_REALES
							WHERE EMPRESA = rANE_M_PRO_REAL.EMPRESA
							  AND OT = rANE_M_PRO_REAL.OT
							  AND FASE_MP = rANE_M_PRO_REAL.FASE_MP
							  AND TIPO_MP = rANE_M_PRO_REAL.TIPO_MP
							  AND COD_MP = rANE_M_PRO_REAL.COD_MP;
						ELSIF rANE_M_PRO_REAL.FASE_MP = 8 THEN
							UPDATE ANALESTA.ANE_M_PRO_REAL 
							SET ML_CONSUMIDOS_REALES_08 = rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES, --ML_CONSUMIDOS_REALES_06 = 2, M2_CONSUMIDOS_REALES_06 = 4,
								 M2_CONSUMIDOS_REALES_08 = rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES * (rANE_M_PRO_REAL_VALOREAL.Ancho_MP/1000),--rANE_M_PRO_REAL_VALOREAL.M2_CONSUMIDOS_REALES,
								 ML_PRODUCIDOS_REALES_08 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES,
								 M2_PRODUCIDOS_REALES_08 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES * (rANE_M_PRO_REAL_VALOREAL.Ancho_MP/1000)--rANE_M_PRO_REAL_VALOREAL.M2_PRODUCIDOS_REALES
							WHERE EMPRESA = rANE_M_PRO_REAL.EMPRESA
							  AND OT = rANE_M_PRO_REAL.OT
							  AND FASE_MP = rANE_M_PRO_REAL.FASE_MP
							  AND TIPO_MP = rANE_M_PRO_REAL.TIPO_MP
							  AND COD_MP = rANE_M_PRO_REAL.COD_MP;
						ELSIF rANE_M_PRO_REAL.FASE_MP = 9 THEN
							UPDATE ANALESTA.ANE_M_PRO_REAL 
							SET ML_CONSUMIDOS_REALES_09 = rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES, --ML_CONSUMIDOS_REALES_06 = 2, M2_CONSUMIDOS_REALES_06 = 4,
								 M2_CONSUMIDOS_REALES_09 = rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES * (rANE_M_PRO_REAL_VALOREAL.Ancho_MP/1000),--rANE_M_PRO_REAL_VALOREAL.M2_CONSUMIDOS_REALES,
								 ML_PRODUCIDOS_REALES_09 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES,
								 M2_PRODUCIDOS_REALES_09 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES * (rANE_M_PRO_REAL_VALOREAL.Ancho_MP/1000)--rANE_M_PRO_REAL_VALOREAL.M2_PRODUCIDOS_REALES
							WHERE EMPRESA = rANE_M_PRO_REAL.EMPRESA
							  AND OT = rANE_M_PRO_REAL.OT
							  AND FASE_MP = rANE_M_PRO_REAL.FASE_MP
							  AND TIPO_MP = rANE_M_PRO_REAL.TIPO_MP
							  AND COD_MP = rANE_M_PRO_REAL.COD_MP;
						ELSIF rANE_M_PRO_REAL.FASE_MP = 10 THEN
							UPDATE ANALESTA.ANE_M_PRO_REAL 
							SET ML_CONSUMIDOS_REALES_10 = rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES, --ML_CONSUMIDOS_REALES_06 = 2, M2_CONSUMIDOS_REALES_06 = 4,
								 M2_CONSUMIDOS_REALES_10 = rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES * (rANE_M_PRO_REAL_VALOREAL.Ancho_MP/1000),--rANE_M_PRO_REAL_VALOREAL.M2_CONSUMIDOS_REALES,
								 ML_PRODUCIDOS_REALES_10 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES,
								 M2_PRODUCIDOS_REALES_10 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES * (rANE_M_PRO_REAL_VALOREAL.Ancho_MP/1000)--rANE_M_PRO_REAL_VALOREAL.M2_PRODUCIDOS_REALES
							WHERE EMPRESA = rANE_M_PRO_REAL.EMPRESA
							  AND OT = rANE_M_PRO_REAL.OT
							  AND FASE_MP = rANE_M_PRO_REAL.FASE_MP
							  AND TIPO_MP = rANE_M_PRO_REAL.TIPO_MP
							  AND COD_MP = rANE_M_PRO_REAL.COD_MP;
						END IF;
						--Se busca los materiales anteriores para calcular los ML Consumidos Reales a partir de la maquina anterior
--dbms_output.put_line('cEstructura_MaquAnte:' ||rANE_M_PRO_REAL.EMPRESA||', '||rANE_M_PRO_REAL.OT||', '||rANE_M_PRO_REAL.TIPO_MP||', '||rANE_M_PRO_REAL.COD_MP||', '||rANE_M_PRO_REAL.FASE_MP||', '||nContMaquAnte);
						FOR rEstructura_MaquAnte IN cEstructura_MaquAnte(rANE_M_PRO_REAL.EMPRESA, rANE_M_PRO_REAL.OT,
															                      rANE_M_PRO_REAL.TIPO_MP, rANE_M_PRO_REAL.COD_MP, rANE_M_PRO_REAL.FASE_MP,
																						 nContMaquAnte) LOOP
							--Busqueda de valores reales
							rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES := NULL;
							rANE_M_PRO_REAL_VALOREAL.M2_CONSUMIDOS_REALES := NULL;
							rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES := NULL;
							rANE_M_PRO_REAL_VALOREAL.M2_PRODUCIDOS_REALES := NULL;
							--
--dbms_output.put_line('cANE_M_PRO_REAL_VALOREAL: '||rEstructura_MaquAnte.EMPRESA||', '||rEstructura_MaquAnte.OT||', '||rEstructura_MaquAnte.FASE_MP||', '||rEstructura_MaquAnte.TIPO_MP||', '||rEstructura_MaquAnte.COD_MP);
							OPEN cANE_M_PRO_REAL_VALOREAL(rEstructura_MaquAnte.EMPRESA, rEstructura_MaquAnte.OT, rEstructura_MaquAnte.FASE_MP,
																	rEstructura_MaquAnte.TIPO_MP, rEstructura_MaquAnte.COD_MP);
							FETCH cANE_M_PRO_REAL_VALOREAL INTO rANE_M_PRO_REAL_VALOREAL;
							CLOSE cANE_M_PRO_REAL_VALOREAL;
							--Se recorre desde toda la rama de materiales anteriores para informar los calores Reales
--dbms_output.put_line('cEstructura_Total: '||rEstructura_MaquAnte.EMPRESA||', '||rEstructura_MaquAnte.OT||', '||rEstructura_MaquAnte.TIPO_MP||', '||rEstructura_MaquAnte.COD_MP||', '||rEstructura_MaquAnte.FASE_MP);
							FOR rEstructura IN cEstructura_Total(rEstructura_MaquAnte.EMPRESA, rEstructura_MaquAnte.OT,
															             rEstructura_MaquAnte.TIPO_MP, rEstructura_MaquAnte.COD_MP, rEstructura_MaquAnte.FASE_MP) LOOP
--dbms_output.put_line('rEstructura_Total: '||rEstructura.EMPRESA||', '||rEstructura.OT||', '||rEstructura.TIPO_MP||', '||rEstructura.COD_MP||', '||rEstructura.FASE_MP);
								IF rANE_M_PRO_REAL.FASE_MP = 1 THEN
									UPDATE ANALESTA.ANE_M_PRO_REAL 
									SET ML_CONSUMIDOS_REALES_01 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES, --ML_CONSUMIDOS_REALES_07 = 21, M2_CONSUMIDOS_REALES_07 = 1,
										 M2_CONSUMIDOS_REALES_01 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES * (rEstructura.Ancho_MP/1000),--rANE_M_PRO_REAL_VALOREAL.M2_PRODUCIDOS_REALES,
										 ML_PRODUCIDOS_REALES_01 = nML_Producidos_Maquina_Ant,
										 M2_PRODUCIDOS_REALES_01 = nML_Producidos_Maquina_Ant * (rEstructura.Ancho_MP/1000)--nM2_Producidos_Maquina_Ant
									WHERE ROWID = rEstructura.ROWID;
								ELSIF rANE_M_PRO_REAL.FASE_MP = 2 THEN
--dbms_output.put_line('rEstructura: '||rEstructura.EMPRESA||', '||rEstructura.OT||', '||rEstructura.TIPO_MP||', '||rEstructura.COD_MP||', '||rEstructura.FASE_MP);
									UPDATE ANALESTA.ANE_M_PRO_REAL 
									SET ML_CONSUMIDOS_REALES_02 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES, --ML_CONSUMIDOS_REALES_07 = 21, M2_CONSUMIDOS_REALES_07 = 2,
										 M2_CONSUMIDOS_REALES_02 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES * (rEstructura.Ancho_MP/1000),--rANE_M_PRO_REAL_VALOREAL.M2_PRODUCIDOS_REALES,
										 ML_PRODUCIDOS_REALES_02 = nML_Producidos_Maquina_Ant,
										 M2_PRODUCIDOS_REALES_02 = nML_Producidos_Maquina_Ant * (rEstructura.Ancho_MP/1000)--nM2_Producidos_Maquina_Ant
									WHERE ROWID = rEstructura.ROWID;
								ELSIF rANE_M_PRO_REAL.FASE_MP = 3 THEN
									UPDATE ANALESTA.ANE_M_PRO_REAL 
									SET ML_CONSUMIDOS_REALES_03 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES, --ML_CONSUMIDOS_REALES_07 = 21, M2_CONSUMIDOS_REALES_07 = 3,
										 M2_CONSUMIDOS_REALES_03 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES * (rEstructura.Ancho_MP/1000),--rANE_M_PRO_REAL_VALOREAL.M2_PRODUCIDOS_REALES,
										 ML_PRODUCIDOS_REALES_03 = nML_Producidos_Maquina_Ant,
										 M2_PRODUCIDOS_REALES_03 = nML_Producidos_Maquina_Ant * (rEstructura.Ancho_MP/1000)--nM2_Producidos_Maquina_Ant
									WHERE ROWID = rEstructura.ROWID;
								ELSIF rANE_M_PRO_REAL.FASE_MP = 4 THEN
									UPDATE ANALESTA.ANE_M_PRO_REAL 
									SET ML_CONSUMIDOS_REALES_04 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES, --ML_CONSUMIDOS_REALES_07 = 21, M2_CONSUMIDOS_REALES_07 = 4,
										 M2_CONSUMIDOS_REALES_04 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES * (rEstructura.Ancho_MP/1000),--rANE_M_PRO_REAL_VALOREAL.M2_PRODUCIDOS_REALES,
										 ML_PRODUCIDOS_REALES_04 = nML_Producidos_Maquina_Ant,
										 M2_PRODUCIDOS_REALES_04 = nML_Producidos_Maquina_Ant * (rEstructura.Ancho_MP/1000)--nM2_Producidos_Maquina_Ant
									WHERE ROWID = rEstructura.ROWID;
								ELSIF rANE_M_PRO_REAL.FASE_MP = 5 THEN
									UPDATE ANALESTA.ANE_M_PRO_REAL 
									SET ML_CONSUMIDOS_REALES_05 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES, --ML_CONSUMIDOS_REALES_07 = 21, M2_CONSUMIDOS_REALES_07 = 4,
										 M2_CONSUMIDOS_REALES_05 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES * (rEstructura.Ancho_MP/1000),--rANE_M_PRO_REAL_VALOREAL.M2_PRODUCIDOS_REALES,
										 ML_PRODUCIDOS_REALES_05 = nML_Producidos_Maquina_Ant,
										 M2_PRODUCIDOS_REALES_05 = nML_Producidos_Maquina_Ant * (rEstructura.Ancho_MP/1000)--nM2_Producidos_Maquina_Ant
									WHERE ROWID = rEstructura.ROWID;
								ELSIF rANE_M_PRO_REAL.FASE_MP = 6 THEN
									UPDATE ANALESTA.ANE_M_PRO_REAL 
									SET ML_CONSUMIDOS_REALES_06 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES, --ML_CONSUMIDOS_REALES_07 = 21, M2_CONSUMIDOS_REALES_07 = 4,
										 M2_CONSUMIDOS_REALES_06 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES * (rEstructura.Ancho_MP/1000),--rANE_M_PRO_REAL_VALOREAL.M2_PRODUCIDOS_REALES,
										 ML_PRODUCIDOS_REALES_06 = nML_Producidos_Maquina_Ant,
										 M2_PRODUCIDOS_REALES_06 = nML_Producidos_Maquina_Ant * (rEstructura.Ancho_MP/1000)--nM2_Producidos_Maquina_Ant
									WHERE ROWID = rEstructura.ROWID;
								ELSIF rANE_M_PRO_REAL.FASE_MP = 7 THEN
									UPDATE ANALESTA.ANE_M_PRO_REAL 
									SET ML_CONSUMIDOS_REALES_07 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES, --ML_CONSUMIDOS_REALES_07 = 21, M2_CONSUMIDOS_REALES_07 = 4,
										 M2_CONSUMIDOS_REALES_07 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES * (rEstructura.Ancho_MP/1000),--rANE_M_PRO_REAL_VALOREAL.M2_PRODUCIDOS_REALES,
										 ML_PRODUCIDOS_REALES_07 = nML_Producidos_Maquina_Ant,
										 M2_PRODUCIDOS_REALES_07 = nML_Producidos_Maquina_Ant * (rEstructura.Ancho_MP/1000)--nM2_Producidos_Maquina_Ant
									WHERE ROWID = rEstructura.ROWID;
								ELSIF rANE_M_PRO_REAL.FASE_MP = 8 THEN
									UPDATE ANALESTA.ANE_M_PRO_REAL 
									SET ML_CONSUMIDOS_REALES_08 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES, --ML_CONSUMIDOS_REALES_07 = 21, M2_CONSUMIDOS_REALES_07 = 4,
										 M2_CONSUMIDOS_REALES_08 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES * (rEstructura.Ancho_MP/1000),--rANE_M_PRO_REAL_VALOREAL.M2_PRODUCIDOS_REALES,
										 ML_PRODUCIDOS_REALES_08 = nML_Producidos_Maquina_Ant,
										 M2_PRODUCIDOS_REALES_08 = nML_Producidos_Maquina_Ant * (rEstructura.Ancho_MP/1000)--nM2_Producidos_Maquina_Ant
									WHERE ROWID = rEstructura.ROWID;
								ELSIF rANE_M_PRO_REAL.FASE_MP = 9 THEN
									UPDATE ANALESTA.ANE_M_PRO_REAL 
									SET ML_CONSUMIDOS_REALES_09 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES, --ML_CONSUMIDOS_REALES_07 = 21, M2_CONSUMIDOS_REALES_07 = 4,
										 M2_CONSUMIDOS_REALES_09 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES * (rEstructura.Ancho_MP/1000),--rANE_M_PRO_REAL_VALOREAL.M2_PRODUCIDOS_REALES,
										 ML_PRODUCIDOS_REALES_09 = nML_Producidos_Maquina_Ant,
										 M2_PRODUCIDOS_REALES_09 = nML_Producidos_Maquina_Ant * (rEstructura.Ancho_MP/1000)--nM2_Producidos_Maquina_Ant
									WHERE ROWID = rEstructura.ROWID;
								ELSIF rANE_M_PRO_REAL.FASE_MP = 10 THEN
									UPDATE ANALESTA.ANE_M_PRO_REAL 
									SET ML_CONSUMIDOS_REALES_10 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES, --ML_CONSUMIDOS_REALES_07 = 21, M2_CONSUMIDOS_REALES_07 = 4,
										 M2_CONSUMIDOS_REALES_10 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES * (rEstructura.Ancho_MP/1000),--rANE_M_PRO_REAL_VALOREAL.M2_PRODUCIDOS_REALES,
										 ML_PRODUCIDOS_REALES_10 = nML_Producidos_Maquina_Ant,
										 M2_PRODUCIDOS_REALES_10 = nML_Producidos_Maquina_Ant * (rEstructura.Ancho_MP/1000)--nM2_Producidos_Maquina_Ant
									WHERE ROWID = rEstructura.ROWID;
								END IF;
							END LOOP;
						END LOOP;
					--END NEW IV
					ELSE
						UPDATE ANALESTA.ANE_M_PRO_REAL 
						SET ML_CONSUMIDOS_REALES = ML_CONSUMIDOS,
							 M2_CONSUMIDOS_REALES = ML_CONSUMIDOS  * (nAncho/1000),
							 M2_MERMAS_ACUMULADAS_HAS_MAQ = ML_MERMAS_ACUMULADAS_HAS_MAQ * (nAncho/1000),
							 M2_MERMAS_ACUMULADAS_EN_MAQ = ML_MERMAS_ACUMULADAS_EN_MAQ * (nAncho/1000),
							 M2_PRODUCIDOS_REALES = ML_PRODUCIDOS_REALES * (nAncho/1000),
							 EUROS_ML_CONSUMIDOS_REALES = ML_CONSUMIDOS  * (nAncho/1000) * nPrecio,
							 EUROS_ML_PRODUCIDOS_REALES = (ML_PRODUCIDOS_REALES * (nAncho/1000)) * nPrecio,
							 EUR_MERMAS_ACUMULADAS_HAS_MAQ = (ML_MERMAS_ACUMULADAS_HAS_MAQ * (nAncho/1000)) * nPrecio,
							 EUR_MERMAS_ACUMULADAS_EN_MAQ = (ML_MERMAS_ACUMULADAS_EN_MAQ * (nAncho/1000)) * nPrecio,
							 ML_MERMA_PROCESO_MQUINA = NVL(ML_CONSUMIDOS,0) - NVL(ML_PRODUCIDOS_REALES,0) - NVL(ML_ENHEBRADO_MAQUINA,0) - NVL(ML_AJ_MAQUINA_MAQUINA,0) - NVL(ML_CAMBIO_BOBINA_MAQUINA,0) - NVL(ML_MERMA_TIRADA_MQUINA,0) - NVL(ML_SANEAMIENTOS_MAQUINA,0),
							 M2_MERMA_PROCESO_MQUINA = ((NVL(ML_CONSUMIDOS,0) - NVL(ML_PRODUCIDOS_REALES,0) - NVL(ML_ENHEBRADO_MAQUINA,0) - NVL(ML_AJ_MAQUINA_MAQUINA,0) - NVL(ML_CAMBIO_BOBINA_MAQUINA,0) - NVL(ML_MERMA_TIRADA_MQUINA,0) - NVL(ML_SANEAMIENTOS_MAQUINA,0)) * (nAncho/1000)),
							 EUROS_ML_MERMA_PROCESO = ((NVL(ML_CONSUMIDOS,0) - NVL(ML_PRODUCIDOS_REALES,0) - NVL(ML_ENHEBRADO_MAQUINA,0) - NVL(ML_AJ_MAQUINA_MAQUINA,0) - NVL(ML_CAMBIO_BOBINA_MAQUINA,0) - NVL(ML_MERMA_TIRADA_MQUINA,0) - NVL(ML_SANEAMIENTOS_MAQUINA,0)) * (nAncho/1000)) * nPrecio,
							 --TOTAL_EUROS_MERMPLAN = ((NVL(ML_CONSUMIDOS,0) - NVL(ML_PRODUCIDOS_REALES,0))  * (nAncho/1000)) * nPrecio,
							 ML_MERMA_TOTAL = NVL(ML_CONSUMIDOS,0) - NVL(ML_PRODUCIDOS_REALES,0),
							 M2_MERMA_TOTAL = (NVL(ML_CONSUMIDOS,0) - NVL(ML_PRODUCIDOS_REALES,0))  * (nAncho/1000),
							 PRECIO = nPrecio,
							 ANCHO_MP = nAncho
						WHERE ROWID = rANE_M_PRO_REAL.ROWID;
						--NEW IV
						--Actualización de Reales por Contador
						rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES := NULL;
						rANE_M_PRO_REAL_VALOREAL.M2_CONSUMIDOS_REALES := NULL;
						rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES := NULL;
						rANE_M_PRO_REAL_VALOREAL.M2_PRODUCIDOS_REALES := NULL;
						--
						OPEN cANE_M_PRO_REAL_VALOREAL(rANE_M_PRO_REAL.EMPRESA, rANE_M_PRO_REAL.OT, rANE_M_PRO_REAL.FASE_MP,
																rANE_M_PRO_REAL.TIPO_MP, rANE_M_PRO_REAL.COD_MP);
						FETCH cANE_M_PRO_REAL_VALOREAL INTO rANE_M_PRO_REAL_VALOREAL;
						CLOSE cANE_M_PRO_REAL_VALOREAL;
						--
						FOR rEstructura IN cEstructura_Total(rANE_M_PRO_REAL.EMPRESA, rANE_M_PRO_REAL.OT,
																       rANE_M_PRO_REAL.TIPO_MP, rANE_M_PRO_REAL.COD_MP, rANE_M_PRO_REAL.FASE_MP) LOOP
							IF rANE_M_PRO_REAL.FASE_MP = 1 THEN
								UPDATE ANALESTA.ANE_M_PRO_REAL 
								SET ML_CONSUMIDOS_REALES_01 = rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES, --ML_CONSUMIDOS_REALES_08 = 3, M2_CONSUMIDOS_REALES_08 = 1,
									 M2_CONSUMIDOS_REALES_01 = rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES * (rEstructura.Ancho_MP/1000),--rANE_M_PRO_REAL_VALOREAL.M2_CONSUMIDOS_REALES,
									 ML_PRODUCIDOS_REALES_01 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES,
									 M2_PRODUCIDOS_REALES_01 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES * (rEstructura.Ancho_MP/1000)--rANE_M_PRO_REAL_VALOREAL.M2_PRODUCIDOS_REALES
								WHERE ROWID = rEstructura.ROWID;
							ELSIF rANE_M_PRO_REAL.FASE_MP = 2 THEN
--dbms_output.put_line('4 rANE_M_PRO_REAL: '||rANE_M_PRO_REAL.EMPRESA||', '||rANE_M_PRO_REAL.OT||', '||rANE_M_PRO_REAL.TIPO_MP||', '||rANE_M_PRO_REAL.COD_MP||', '||rANE_M_PRO_REAL.FASE_MP||'->'||rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES);
								UPDATE ANALESTA.ANE_M_PRO_REAL 
								SET ML_CONSUMIDOS_REALES_02 = rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES, --ML_CONSUMIDOS_REALES_08 = 3, M2_CONSUMIDOS_REALES_08 = 2,
									 M2_CONSUMIDOS_REALES_02 = rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES * (rEstructura.Ancho_MP/1000),--rANE_M_PRO_REAL_VALOREAL.M2_CONSUMIDOS_REALES,
									 ML_PRODUCIDOS_REALES_02 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES,
									 M2_PRODUCIDOS_REALES_02 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES * (rEstructura.Ancho_MP/1000)--rANE_M_PRO_REAL_VALOREAL.M2_PRODUCIDOS_REALES
								WHERE ROWID = rEstructura.ROWID;
							ELSIF rANE_M_PRO_REAL.FASE_MP = 3 THEN
								UPDATE ANALESTA.ANE_M_PRO_REAL 
								SET ML_CONSUMIDOS_REALES_03 = rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES, --ML_CONSUMIDOS_REALES_08 = 3, M2_CONSUMIDOS_REALES_08 = 3,
									 M2_CONSUMIDOS_REALES_03 = rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES * (rEstructura.Ancho_MP/1000),--rANE_M_PRO_REAL_VALOREAL.M2_CONSUMIDOS_REALES,
									 ML_PRODUCIDOS_REALES_03 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES,
									 M2_PRODUCIDOS_REALES_03 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES * (rEstructura.Ancho_MP/1000)--rANE_M_PRO_REAL_VALOREAL.M2_PRODUCIDOS_REALES
								WHERE ROWID = rEstructura.ROWID;
							ELSIF rANE_M_PRO_REAL.FASE_MP = 4 THEN
								UPDATE ANALESTA.ANE_M_PRO_REAL 
								SET ML_CONSUMIDOS_REALES_04 = rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES, --ML_CONSUMIDOS_REALES_08 = 3, M2_CONSUMIDOS_REALES_08 = 4,
									 M2_CONSUMIDOS_REALES_04 = rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES * (rEstructura.Ancho_MP/1000),--rANE_M_PRO_REAL_VALOREAL.M2_CONSUMIDOS_REALES,
									 ML_PRODUCIDOS_REALES_04 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES,
									 M2_PRODUCIDOS_REALES_04 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES * (rEstructura.Ancho_MP/1000)--rANE_M_PRO_REAL_VALOREAL.M2_PRODUCIDOS_REALES
								WHERE ROWID = rEstructura.ROWID;
							ELSIF rANE_M_PRO_REAL.FASE_MP = 5 THEN
								UPDATE ANALESTA.ANE_M_PRO_REAL 
								SET ML_CONSUMIDOS_REALES_05 = rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES, --ML_CONSUMIDOS_REALES_08 = 3, M2_CONSUMIDOS_REALES_08 = 4,
									 M2_CONSUMIDOS_REALES_05 = rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES * (rEstructura.Ancho_MP/1000),--rANE_M_PRO_REAL_VALOREAL.M2_CONSUMIDOS_REALES,
									 ML_PRODUCIDOS_REALES_05 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES,
									 M2_PRODUCIDOS_REALES_05 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES * (rEstructura.Ancho_MP/1000)--rANE_M_PRO_REAL_VALOREAL.M2_PRODUCIDOS_REALES
								WHERE ROWID = rEstructura.ROWID;
							ELSIF rANE_M_PRO_REAL.FASE_MP = 6 THEN
								UPDATE ANALESTA.ANE_M_PRO_REAL 
								SET ML_CONSUMIDOS_REALES_06 = rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES, --ML_CONSUMIDOS_REALES_08 = 3, M2_CONSUMIDOS_REALES_08 = 4,
									 M2_CONSUMIDOS_REALES_06 = rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES * (rEstructura.Ancho_MP/1000),--rANE_M_PRO_REAL_VALOREAL.M2_CONSUMIDOS_REALES,
									 ML_PRODUCIDOS_REALES_06 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES,
									 M2_PRODUCIDOS_REALES_06 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES * (rEstructura.Ancho_MP/1000)--rANE_M_PRO_REAL_VALOREAL.M2_PRODUCIDOS_REALES
								WHERE ROWID = rEstructura.ROWID;
							ELSIF rANE_M_PRO_REAL.FASE_MP = 7 THEN
								UPDATE ANALESTA.ANE_M_PRO_REAL 
								SET ML_CONSUMIDOS_REALES_07 = rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES, --ML_CONSUMIDOS_REALES_08 = 3, M2_CONSUMIDOS_REALES_08 = 4,
									 M2_CONSUMIDOS_REALES_07 = rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES * (rEstructura.Ancho_MP/1000),--rANE_M_PRO_REAL_VALOREAL.M2_CONSUMIDOS_REALES,
									 ML_PRODUCIDOS_REALES_07 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES,
									 M2_PRODUCIDOS_REALES_07 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES * (rEstructura.Ancho_MP/1000)--rANE_M_PRO_REAL_VALOREAL.M2_PRODUCIDOS_REALES
								WHERE ROWID = rEstructura.ROWID;
							ELSIF rANE_M_PRO_REAL.FASE_MP = 8 THEN
								UPDATE ANALESTA.ANE_M_PRO_REAL 
								SET ML_CONSUMIDOS_REALES_08 = rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES, --ML_CONSUMIDOS_REALES_08 = 3, M2_CONSUMIDOS_REALES_08 = 4,
									 M2_CONSUMIDOS_REALES_08 = rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES * (rEstructura.Ancho_MP/1000),--rANE_M_PRO_REAL_VALOREAL.M2_CONSUMIDOS_REALES,
									 ML_PRODUCIDOS_REALES_08 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES,
									 M2_PRODUCIDOS_REALES_08 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES * (rEstructura.Ancho_MP/1000)--rANE_M_PRO_REAL_VALOREAL.M2_PRODUCIDOS_REALES
								WHERE ROWID = rEstructura.ROWID;
							ELSIF rANE_M_PRO_REAL.FASE_MP = 9 THEN
								UPDATE ANALESTA.ANE_M_PRO_REAL 
								SET ML_CONSUMIDOS_REALES_09 = rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES, --ML_CONSUMIDOS_REALES_08 = 3, M2_CONSUMIDOS_REALES_08 = 4,
									 M2_CONSUMIDOS_REALES_09 = rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES * (rEstructura.Ancho_MP/1000),--rANE_M_PRO_REAL_VALOREAL.M2_CONSUMIDOS_REALES,
									 ML_PRODUCIDOS_REALES_09 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES,
									 M2_PRODUCIDOS_REALES_09 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES * (rEstructura.Ancho_MP/1000)--rANE_M_PRO_REAL_VALOREAL.M2_PRODUCIDOS_REALES
								WHERE ROWID = rEstructura.ROWID;
							ELSIF rANE_M_PRO_REAL.FASE_MP = 10 THEN
								UPDATE ANALESTA.ANE_M_PRO_REAL 
								SET ML_CONSUMIDOS_REALES_10 = rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES, --ML_CONSUMIDOS_REALES_08 = 3, M2_CONSUMIDOS_REALES_08 = 4,
									 M2_CONSUMIDOS_REALES_10 = rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES * (rEstructura.Ancho_MP/1000),--rANE_M_PRO_REAL_VALOREAL.M2_CONSUMIDOS_REALES,
									 ML_PRODUCIDOS_REALES_10 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES,
									 M2_PRODUCIDOS_REALES_10 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES * (rEstructura.Ancho_MP/1000)--rANE_M_PRO_REAL_VALOREAL.M2_PRODUCIDOS_REALES
								WHERE ROWID = rEstructura.ROWID;
							END IF;
						END LOOP;
						--END NEW IV
					END IF;
				ELSE
					UPDATE ANALESTA.ANE_M_PRO_REAL 
					SET ML_CONSUMIDOS_REALES = NVL(nML_Producidos_Maquina_Ant,ML_CONSUMIDOS),
						 M2_CONSUMIDOS_REALES = NVL(nML_Producidos_Maquina_Ant,ML_CONSUMIDOS) * (nAncho/1000),
						 M2_MERMAS_ACUMULADAS_HAS_MAQ = ML_MERMAS_ACUMULADAS_HAS_MAQ * (nAncho/1000),
						 M2_MERMAS_ACUMULADAS_EN_MAQ = ML_MERMAS_ACUMULADAS_EN_MAQ * (nAncho/1000),
						 M2_PRODUCIDOS_REALES = ML_PRODUCIDOS_REALES * (nAncho/1000),
						 EUROS_ML_CONSUMIDOS_REALES = NVL(nML_Producidos_Maquina_Ant,ML_CONSUMIDOS) * (nAncho/1000) * nPrecio,
						 EUROS_ML_PRODUCIDOS_REALES = (ML_PRODUCIDOS_REALES * (nAncho/1000)) * nPrecio,
						 EUR_MERMAS_ACUMULADAS_HAS_MAQ = (ML_MERMAS_ACUMULADAS_HAS_MAQ * (nAncho/1000)) * nPrecio,
						 EUR_MERMAS_ACUMULADAS_EN_MAQ = (ML_MERMAS_ACUMULADAS_EN_MAQ * (nAncho/1000)) * nPrecio,
						 ML_MERMA_PROCESO_MQUINA = NVL(nML_Producidos_Maquina_Ant,ML_CONSUMIDOS) - NVL(ML_PRODUCIDOS_REALES,0) - NVL(ML_ENHEBRADO_MAQUINA,0) - NVL(ML_AJ_MAQUINA_MAQUINA,0) - NVL(ML_CAMBIO_BOBINA_MAQUINA,0) - NVL(ML_MERMA_TIRADA_MQUINA,0) - NVL(ML_SANEAMIENTOS_MAQUINA,0),
						 M2_MERMA_PROCESO_MQUINA = ((NVL(nML_Producidos_Maquina_Ant,ML_CONSUMIDOS) - NVL(ML_PRODUCIDOS_REALES,0) - NVL(ML_ENHEBRADO_MAQUINA,0) - NVL(ML_AJ_MAQUINA_MAQUINA,0) - NVL(ML_CAMBIO_BOBINA_MAQUINA,0) - NVL(ML_MERMA_TIRADA_MQUINA,0) - NVL(ML_SANEAMIENTOS_MAQUINA,0)) * (nAncho/1000)),
						 EUROS_ML_MERMA_PROCESO = ((NVL(nML_Producidos_Maquina_Ant,ML_CONSUMIDOS) - NVL(ML_PRODUCIDOS_REALES,0) - NVL(ML_ENHEBRADO_MAQUINA,0) - NVL(ML_AJ_MAQUINA_MAQUINA,0) - NVL(ML_CAMBIO_BOBINA_MAQUINA,0) - NVL(ML_MERMA_TIRADA_MQUINA,0) - NVL(ML_SANEAMIENTOS_MAQUINA,0)) * (nAncho/1000)) * nPrecio,
						 --TOTAL_EUROS_MERMPLAN = ((NVL(nML_Producidos_Maquina_Ant,ML_CONSUMIDOS) - NVL(ML_PRODUCIDOS_REALES,0))  * (nAncho/1000)) * nPrecio,
						 ML_MERMA_TOTAL = NVL(nML_Producidos_Maquina_Ant,ML_CONSUMIDOS) - NVL(ML_PRODUCIDOS_REALES,0),
						 M2_MERMA_TOTAL = (NVL(nML_Producidos_Maquina_Ant,ML_CONSUMIDOS) - NVL(ML_PRODUCIDOS_REALES,0))  * (nAncho/1000),
						 PRECIO = nPrecio,
						 ANCHO_MP = nAncho
					WHERE ROWID = rANE_M_PRO_REAL.ROWID;
					--NEW IV
					--Actualización de Reales por Contador
					rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES := NULL;
					rANE_M_PRO_REAL_VALOREAL.M2_CONSUMIDOS_REALES := NULL;
					rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES := NULL;
					rANE_M_PRO_REAL_VALOREAL.M2_PRODUCIDOS_REALES := NULL;
					--
					OPEN cANE_M_PRO_REAL_VALOREAL(rANE_M_PRO_REAL.EMPRESA, rANE_M_PRO_REAL.OT, rANE_M_PRO_REAL.FASE_MP,
															rANE_M_PRO_REAL.TIPO_MP, rANE_M_PRO_REAL.COD_MP);
					FETCH cANE_M_PRO_REAL_VALOREAL INTO rANE_M_PRO_REAL_VALOREAL;
					CLOSE cANE_M_PRO_REAL_VALOREAL;
					--
					FOR rEstructura IN cEstructura_Total(rANE_M_PRO_REAL.EMPRESA, rANE_M_PRO_REAL.OT,
															       rANE_M_PRO_REAL.TIPO_MP, rANE_M_PRO_REAL.COD_MP, rANE_M_PRO_REAL.FASE_MP) LOOP
						IF rANE_M_PRO_REAL.FASE_MP = 1 THEN
							UPDATE ANALESTA.ANE_M_PRO_REAL 
							SET ML_CONSUMIDOS_REALES_01 = NVL(nML_Producidos_Maquina_Ant,rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES), --ML_CONSUMIDOS_REALES_09 = 4, M2_CONSUMIDOS_REALES_09 = 1/*,
								 M2_CONSUMIDOS_REALES_01 = NVL(nML_Producidos_Maquina_Ant,rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES) * (rEstructura.Ancho_MP/1000),--rEstructura.M2_CONSUMIDOS_REALES,
								 ML_PRODUCIDOS_REALES_01 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES,--rEstructura.ML_PRODUCIDOS_REALES,
								 M2_PRODUCIDOS_REALES_01 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES * (rEstructura.Ancho_MP/1000)--rEstructura.ML_PRODUCIDOS_REALES * (rEstructura.Ancho_MP/1000)--rEstructura.M2_PRODUCIDOS_REALES*/
							WHERE ROWID = rEstructura.ROWID;
						ELSIF rANE_M_PRO_REAL.FASE_MP = 2 THEN
--dbms_output.put_line('5 rANE_M_PRO_REAL: '||rANE_M_PRO_REAL.EMPRESA||', '||rANE_M_PRO_REAL.OT||', '||rANE_M_PRO_REAL.TIPO_MP||', '||rANE_M_PRO_REAL.COD_MP||', '||rANE_M_PRO_REAL.FASE_MP||'->'||rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES);
							UPDATE ANALESTA.ANE_M_PRO_REAL 
							SET ML_CONSUMIDOS_REALES_02 = NVL(nML_Producidos_Maquina_Ant,rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES), --ML_CONSUMIDOS_REALES_09 = 4, M2_CONSUMIDOS_REALES_09 = 2/*,
								 M2_CONSUMIDOS_REALES_02 = NVL(nML_Producidos_Maquina_Ant,rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES) * (rEstructura.Ancho_MP/1000),--rEstructura.M2_CONSUMIDOS_REALES,
								 ML_PRODUCIDOS_REALES_02 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES,--rEstructura.ML_PRODUCIDOS_REALES,
								 M2_PRODUCIDOS_REALES_02 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES * (rEstructura.Ancho_MP/1000)--rEstructura.ML_PRODUCIDOS_REALES * (rEstructura.Ancho_MP/1000)--rEstructura.M2_PRODUCIDOS_REALES*/
							WHERE ROWID = rEstructura.ROWID;
						ELSIF rANE_M_PRO_REAL.FASE_MP = 3 THEN
							UPDATE ANALESTA.ANE_M_PRO_REAL 
							SET ML_CONSUMIDOS_REALES_03 = NVL(nML_Producidos_Maquina_Ant,rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES), --ML_CONSUMIDOS_REALES_09 = 4, M2_CONSUMIDOS_REALES_09 = 3/*,
								 M2_CONSUMIDOS_REALES_03 = NVL(nML_Producidos_Maquina_Ant,rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES) * (rEstructura.Ancho_MP/1000),--rEstructura.M2_CONSUMIDOS_REALES,
								 ML_PRODUCIDOS_REALES_03 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES,--rEstructura.ML_PRODUCIDOS_REALES,
								 M2_PRODUCIDOS_REALES_03 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES * (rEstructura.Ancho_MP/1000)--rEstructura.ML_PRODUCIDOS_REALES * (rEstructura.Ancho_MP/1000)--rEstructura.M2_PRODUCIDOS_REALES*/
							WHERE ROWID = rEstructura.ROWID;
						ELSIF rANE_M_PRO_REAL.FASE_MP = 4 THEN
							UPDATE ANALESTA.ANE_M_PRO_REAL 
							SET ML_CONSUMIDOS_REALES_04 = NVL(nML_Producidos_Maquina_Ant,rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES), --ML_CONSUMIDOS_REALES_09 = 4, M2_CONSUMIDOS_REALES_09 = 4/*,
								 M2_CONSUMIDOS_REALES_04 = NVL(nML_Producidos_Maquina_Ant,rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES) * (rEstructura.Ancho_MP/1000),--rEstructura.M2_CONSUMIDOS_REALES,
								 ML_PRODUCIDOS_REALES_04 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES,--rEstructura.ML_PRODUCIDOS_REALES,
								 M2_PRODUCIDOS_REALES_04 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES * (rEstructura.Ancho_MP/1000)--rEstructura.ML_PRODUCIDOS_REALES * (rEstructura.Ancho_MP/1000)--rEstructura.M2_PRODUCIDOS_REALES*/
							WHERE ROWID = rEstructura.ROWID;
						ELSIF rANE_M_PRO_REAL.FASE_MP = 5 THEN
							UPDATE ANALESTA.ANE_M_PRO_REAL 
							SET ML_CONSUMIDOS_REALES_05 = NVL(nML_Producidos_Maquina_Ant,rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES), --ML_CONSUMIDOS_REALES_09 = 4, M2_CONSUMIDOS_REALES_09 = 4/*,
								 M2_CONSUMIDOS_REALES_05 = NVL(nML_Producidos_Maquina_Ant,rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES) * (rEstructura.Ancho_MP/1000),--rEstructura.M2_CONSUMIDOS_REALES,
								 ML_PRODUCIDOS_REALES_05 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES,--rEstructura.ML_PRODUCIDOS_REALES,
								 M2_PRODUCIDOS_REALES_05 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES * (rEstructura.Ancho_MP/1000)--rEstructura.ML_PRODUCIDOS_REALES * (rEstructura.Ancho_MP/1000)--rEstructura.M2_PRODUCIDOS_REALES*/
							WHERE ROWID = rEstructura.ROWID;
						ELSIF rANE_M_PRO_REAL.FASE_MP = 6 THEN
							UPDATE ANALESTA.ANE_M_PRO_REAL 
							SET ML_CONSUMIDOS_REALES_06 = NVL(nML_Producidos_Maquina_Ant,rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES), --ML_CONSUMIDOS_REALES_09 = 4, M2_CONSUMIDOS_REALES_09 = 4/*,
								 M2_CONSUMIDOS_REALES_06 = NVL(nML_Producidos_Maquina_Ant,rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES) * (rEstructura.Ancho_MP/1000),--rEstructura.M2_CONSUMIDOS_REALES,
								 ML_PRODUCIDOS_REALES_06 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES,--rEstructura.ML_PRODUCIDOS_REALES,
								 M2_PRODUCIDOS_REALES_06 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES * (rEstructura.Ancho_MP/1000)--rEstructura.ML_PRODUCIDOS_REALES * (rEstructura.Ancho_MP/1000)--rEstructura.M2_PRODUCIDOS_REALES*/
							WHERE ROWID = rEstructura.ROWID;
						ELSIF rANE_M_PRO_REAL.FASE_MP = 7 THEN
							UPDATE ANALESTA.ANE_M_PRO_REAL 
							SET ML_CONSUMIDOS_REALES_07 = NVL(nML_Producidos_Maquina_Ant,rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES), --ML_CONSUMIDOS_REALES_09 = 4, M2_CONSUMIDOS_REALES_09 = 4/*,
								 M2_CONSUMIDOS_REALES_07 = NVL(nML_Producidos_Maquina_Ant,rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES) * (rEstructura.Ancho_MP/1000),--rEstructura.M2_CONSUMIDOS_REALES,
								 ML_PRODUCIDOS_REALES_07 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES,--rEstructura.ML_PRODUCIDOS_REALES,
								 M2_PRODUCIDOS_REALES_07 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES * (rEstructura.Ancho_MP/1000)--rEstructura.ML_PRODUCIDOS_REALES * (rEstructura.Ancho_MP/1000)--rEstructura.M2_PRODUCIDOS_REALES*/
							WHERE ROWID = rEstructura.ROWID;
						ELSIF rANE_M_PRO_REAL.FASE_MP = 8 THEN
							UPDATE ANALESTA.ANE_M_PRO_REAL 
							SET ML_CONSUMIDOS_REALES_08 = NVL(nML_Producidos_Maquina_Ant,rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES), --ML_CONSUMIDOS_REALES_09 = 4, M2_CONSUMIDOS_REALES_09 = 4/*,
								 M2_CONSUMIDOS_REALES_08 = NVL(nML_Producidos_Maquina_Ant,rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES) * (rEstructura.Ancho_MP/1000),--rEstructura.M2_CONSUMIDOS_REALES,
								 ML_PRODUCIDOS_REALES_08 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES,--rEstructura.ML_PRODUCIDOS_REALES,
								 M2_PRODUCIDOS_REALES_08 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES * (rEstructura.Ancho_MP/1000)--rEstructura.ML_PRODUCIDOS_REALES * (rEstructura.Ancho_MP/1000)--rEstructura.M2_PRODUCIDOS_REALES*/
							WHERE ROWID = rEstructura.ROWID;
						ELSIF rANE_M_PRO_REAL.FASE_MP = 9 THEN
							UPDATE ANALESTA.ANE_M_PRO_REAL 
							SET ML_CONSUMIDOS_REALES_09 = NVL(nML_Producidos_Maquina_Ant,rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES), --ML_CONSUMIDOS_REALES_09 = 4, M2_CONSUMIDOS_REALES_09 = 4/*,
								 M2_CONSUMIDOS_REALES_09 = NVL(nML_Producidos_Maquina_Ant,rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES) * (rEstructura.Ancho_MP/1000),--rEstructura.M2_CONSUMIDOS_REALES,
								 ML_PRODUCIDOS_REALES_09 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES,--rEstructura.ML_PRODUCIDOS_REALES,
								 M2_PRODUCIDOS_REALES_09 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES * (rEstructura.Ancho_MP/1000)--rEstructura.ML_PRODUCIDOS_REALES * (rEstructura.Ancho_MP/1000)--rEstructura.M2_PRODUCIDOS_REALES*/
							WHERE ROWID = rEstructura.ROWID;
						ELSIF rANE_M_PRO_REAL.FASE_MP = 10 THEN
							UPDATE ANALESTA.ANE_M_PRO_REAL 
							SET ML_CONSUMIDOS_REALES_10 = NVL(nML_Producidos_Maquina_Ant,rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES), --ML_CONSUMIDOS_REALES_09 = 4, M2_CONSUMIDOS_REALES_09 = 4/*,
								 M2_CONSUMIDOS_REALES_10 = NVL(nML_Producidos_Maquina_Ant,rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES) * (rEstructura.Ancho_MP/1000),--rEstructura.M2_CONSUMIDOS_REALES,
								 ML_PRODUCIDOS_REALES_10 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES,--rEstructura.ML_PRODUCIDOS_REALES,
								 M2_PRODUCIDOS_REALES_10 = rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES * (rEstructura.Ancho_MP/1000)--rEstructura.ML_PRODUCIDOS_REALES * (rEstructura.Ancho_MP/1000)--rEstructura.M2_PRODUCIDOS_REALES*/
							WHERE ROWID = rEstructura.ROWID;
						END IF;
					END LOOP;
					--END NEW IV
				END IF;
			END IF;
		END LOOP;
		--NEW
		--Creación de tabla de Materiales
		FOR rANE_M_PRO_REAL IN cANE_M_PRO_REAL(vEmpresa,nNumero) LOOP
			FOR rEstructura IN cEstructura(rANE_M_PRO_REAL.EMPRESA, rANE_M_PRO_REAL.OT,
		                                  rANE_M_PRO_REAL.TIPO_MP, rANE_M_PRO_REAL.COD_MP, rANE_M_PRO_REAL.FASE_MP) LOOP
				--NEW IV
				--Actualización de Reales por Contador
				rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES_01 := NULL;
				rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES_02 := NULL;
				rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES_03 := NULL;
				rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES_04 := NULL;
				rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES_05 := NULL;
				rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES_06 := NULL;
				rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES_07 := NULL;
				rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES_08 := NULL;
				rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES_09 := NULL;
				rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES_10 := NULL;
				rANE_M_PRO_REAL_VALOREAL.M2_CONSUMIDOS_REALES_01 := NULL;
				rANE_M_PRO_REAL_VALOREAL.M2_CONSUMIDOS_REALES_02 := NULL;
				rANE_M_PRO_REAL_VALOREAL.M2_CONSUMIDOS_REALES_03 := NULL;
				rANE_M_PRO_REAL_VALOREAL.M2_CONSUMIDOS_REALES_04 := NULL;
				rANE_M_PRO_REAL_VALOREAL.M2_CONSUMIDOS_REALES_05 := NULL;
				rANE_M_PRO_REAL_VALOREAL.M2_CONSUMIDOS_REALES_06 := NULL;
				rANE_M_PRO_REAL_VALOREAL.M2_CONSUMIDOS_REALES_07 := NULL;
				rANE_M_PRO_REAL_VALOREAL.M2_CONSUMIDOS_REALES_08 := NULL;
				rANE_M_PRO_REAL_VALOREAL.M2_CONSUMIDOS_REALES_09 := NULL;
				rANE_M_PRO_REAL_VALOREAL.M2_CONSUMIDOS_REALES_10 := NULL;
				--
				rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES_01 := NULL;
				rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES_02 := NULL;
				rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES_03 := NULL;
				rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES_04 := NULL;
				rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES_05 := NULL;
				rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES_06 := NULL;
				rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES_07 := NULL;
				rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES_08 := NULL;
				rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES_09 := NULL;
				rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES_10 := NULL;
				rANE_M_PRO_REAL_VALOREAL.M2_PRODUCIDOS_REALES_01 := NULL;
				rANE_M_PRO_REAL_VALOREAL.M2_PRODUCIDOS_REALES_02 := NULL;
				rANE_M_PRO_REAL_VALOREAL.M2_PRODUCIDOS_REALES_03 := NULL;
				rANE_M_PRO_REAL_VALOREAL.M2_PRODUCIDOS_REALES_04 := NULL;
				rANE_M_PRO_REAL_VALOREAL.M2_PRODUCIDOS_REALES_05 := NULL;
				rANE_M_PRO_REAL_VALOREAL.M2_PRODUCIDOS_REALES_06 := NULL;
				rANE_M_PRO_REAL_VALOREAL.M2_PRODUCIDOS_REALES_07 := NULL;
				rANE_M_PRO_REAL_VALOREAL.M2_PRODUCIDOS_REALES_08 := NULL;
				rANE_M_PRO_REAL_VALOREAL.M2_PRODUCIDOS_REALES_09 := NULL;
				rANE_M_PRO_REAL_VALOREAL.M2_PRODUCIDOS_REALES_10 := NULL;
				--
				--rANE_M_PRO_REAL_VALOREAL.PRECIO := NULL;
				rANE_M_PRO_REAL_VALOREAL.ANCHO_MP := NULL;
				--
				OPEN cANE_M_PRO_REAL_VALOREAL(rEstructura.EMPRESA, rEstructura.OT, rEstructura.FASE_MP,
													   rEstructura.TIPO_MP, rEstructura.COD_MP);
				FETCH cANE_M_PRO_REAL_VALOREAL INTO rANE_M_PRO_REAL_VALOREAL;
				CLOSE cANE_M_PRO_REAL_VALOREAL;
				--
				nML_Consumidos_Reales := NULL;
				nM2_Consumidos_Reales := NULL;
				nML_Producidos_Reales := NULL;
				nM2_Producidos_Reales := NULL;
				--
				IF rANE_M_PRO_REAL.FASE_MP = 1 THEN
				   nML_Consumidos_Reales := rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES_01;
					--nM2_Consumidos_Reales := rANE_M_PRO_REAL_VALOREAL.M2_CONSUMIDOS_REALES_01;
					nML_Producidos_Reales := rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES_01;
					--nM2_Producidos_Reales := rANE_M_PRO_REAL_VALOREAL.M2_PRODUCIDOS_REALES_01;
				ELSIF rANE_M_PRO_REAL.FASE_MP = 2 THEN
				   nML_Consumidos_Reales := rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES_02;
					--nM2_Consumidos_Reales := rANE_M_PRO_REAL_VALOREAL.M2_CONSUMIDOS_REALES_02;
					nML_Producidos_Reales := rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES_02;
					--nM2_Producidos_Reales := rANE_M_PRO_REAL_VALOREAL.M2_PRODUCIDOS_REALES_02;
				ELSIF rANE_M_PRO_REAL.FASE_MP = 3 THEN
				   nML_Consumidos_Reales := rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES_03;
					--nM2_Consumidos_Reales := rANE_M_PRO_REAL_VALOREAL.M2_CONSUMIDOS_REALES_03;
					nML_Producidos_Reales := rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES_03;
					--nM2_Producidos_Reales := rANE_M_PRO_REAL_VALOREAL.M2_PRODUCIDOS_REALES_03;
				ELSIF rANE_M_PRO_REAL.FASE_MP = 4 THEN
				   nML_Consumidos_Reales := rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES_04;
					--nM2_Consumidos_Reales := rANE_M_PRO_REAL_VALOREAL.M2_CONSUMIDOS_REALES_04;
					nML_Producidos_Reales := rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES_04;
					--nM2_Producidos_Reales := rANE_M_PRO_REAL_VALOREAL.M2_PRODUCIDOS_REALES_04;
				ELSIF rANE_M_PRO_REAL.FASE_MP = 5 THEN
				   nML_Consumidos_Reales := rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES_05;
					--nM2_Consumidos_Reales := rANE_M_PRO_REAL_VALOREAL.M2_CONSUMIDOS_REALES_05;
					nML_Producidos_Reales := rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES_05;
					--nM2_Producidos_Reales := rANE_M_PRO_REAL_VALOREAL.M2_PRODUCIDOS_REALES_05;
				ELSIF rANE_M_PRO_REAL.FASE_MP = 6 THEN
				   nML_Consumidos_Reales := rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES_06;
					--nM2_Consumidos_Reales := rANE_M_PRO_REAL_VALOREAL.M2_CONSUMIDOS_REALES_06;
					nML_Producidos_Reales := rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES_06;
					--nM2_Producidos_Reales := rANE_M_PRO_REAL_VALOREAL.M2_PRODUCIDOS_REALES_06;
				ELSIF rANE_M_PRO_REAL.FASE_MP = 7 THEN
				   nML_Consumidos_Reales := rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES_07;
					--nM2_Consumidos_Reales := rANE_M_PRO_REAL_VALOREAL.M2_CONSUMIDOS_REALES_07;
					nML_Producidos_Reales := rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES_07;
					--nM2_Producidos_Reales := rANE_M_PRO_REAL_VALOREAL.M2_PRODUCIDOS_REALES_07;
				ELSIF rANE_M_PRO_REAL.FASE_MP = 8 THEN
				   nML_Consumidos_Reales := rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES_08;
					--nM2_Consumidos_Reales := rANE_M_PRO_REAL_VALOREAL.M2_CONSUMIDOS_REALES_08;
					nML_Producidos_Reales := rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES_08;
					--nM2_Producidos_Reales := rANE_M_PRO_REAL_VALOREAL.M2_PRODUCIDOS_REALES_08;
				ELSIF rANE_M_PRO_REAL.FASE_MP = 9 THEN
				   nML_Consumidos_Reales := rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES_09;
					--nM2_Consumidos_Reales := rANE_M_PRO_REAL_VALOREAL.M2_CONSUMIDOS_REALES_09;
					nML_Producidos_Reales := rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES_09;
					--nM2_Producidos_Reales := rANE_M_PRO_REAL_VALOREAL.M2_PRODUCIDOS_REALES_09;
				ELSIF rANE_M_PRO_REAL.FASE_MP = 10 THEN
				   nML_Consumidos_Reales := rANE_M_PRO_REAL_VALOREAL.ML_CONSUMIDOS_REALES_10;
					--nM2_Consumidos_Reales := rANE_M_PRO_REAL_VALOREAL.M2_CONSUMIDOS_REALES_10;
					nML_Producidos_Reales := rANE_M_PRO_REAL_VALOREAL.ML_PRODUCIDOS_REALES_10;
					--nM2_Producidos_Reales := rANE_M_PRO_REAL_VALOREAL.M2_PRODUCIDOS_REALES_10;
				END IF;
				--
				nM2_Consumidos_Reales := nML_Consumidos_Reales * (rANE_M_PRO_REAL_VALOREAL.ANCHO_MP / 1000);
				nM2_Producidos_Reales := nML_Producidos_Reales * (rANE_M_PRO_REAL_VALOREAL.ANCHO_MP / 1000);
				--
				rANE_M_PRO_REAL_VALOREAL_PREC.PRECIO := NULL;
				--
				OPEN cANE_M_PRO_REAL_VALOREAL_PREC(rEstructura.EMPRESA, rEstructura.OT, rEstructura.FASE_MP,
													          rEstructura.LFS_MP);
				FETCH cANE_M_PRO_REAL_VALOREAL_PREC INTO rANE_M_PRO_REAL_VALOREAL_PREC;
				CLOSE cANE_M_PRO_REAL_VALOREAL_PREC;
				--END NEW IV
			   INSERT INTO ANALESTA.ANE_M_PRO_REAL_CONTADOR(EMPRESA,N_CLIENTE,CLIENTE,OT,FECHA_DE_LA_OT,FECHA_CIERRE_DE_LA_OT,TIPO_PRD,ESPECIALIDAD,LINEA,LFS,N_CAPAS_TOTALES,CANTIDAD_DE_FASES,ANCHO_CLIENTE,N_DE_CORTES,N_DE_VECES,ANCHO_DE_PRODUCCION,ORIGEN_MP,
																			TIPO_MP,COD_MP,LFS_MP,FASE_MP,SECCION_PRODUCTIVA_MP,MAQUINA_MP,M2_MERMPLAN,M2_MERMPLAN_EXESO,EUR_MERMPLAN,EUR_MERMPLAN_EXESO,ML_CONSUMIDOS,ML_PRODUCIDOS,
																			ML_CONSUMIDOS_REALES,ML_PRODUCIDOS_REALES,
																			ML_MERMAS_ACUMULADAS_HAS_MAQ,ML_MERMAS_ACUMULADAS_EN_MAQ,ML_ENHEBRADO_MAQUINA,ML_AJ_MAQUINA_MAQUINA,ML_CAMBIO_BOBINA_MAQUINA,ML_MERMA_TIRADA_MQUINA,ML_SANEAMIENTOS_MAQUINA,
																			ML_MERMA_PROCESO_MQUINA,
																			M2_CONSUMIDOS,M2_PRODUCIDOS,
																			M2_PRODUCIDOS_REALES,M2_CONSUMIDOS_REALES,
																			M2_MERMAS_ACUMULADAS_HAS_MAQ,
																			
																			M2_MERMAS_ACUMULADAS_EN_MAQ,
																			M2_ENHEBRADO_MAQUINA,
																			M2_AJ_MAQUINA_MAQUINA,
																			M2_CAMBIO_BOBINA_MAQUINA,
																			M2_MERMA_TIRADA_MQUINA,
																			M2_SANEAMIENTOS_MAQUINA,
																			
																			M2_MERMA_PROCESO_MQUINA,
																			
																			EUROS_ML_CONSUMIDOS,EUROS_ML_PRODUCIDOS,
																			EUROS_ML_CONSUMIDOS_REALES,EUROS_ML_PRODUCIDOS_REALES,
																			EUR_MERMAS_ACUMULADAS_HAS_MAQ,
																			EUR_MERMAS_ACUMULADAS_EN_MAQ,
																			EUROS_ML_ENHEBRADO,
																			EUROS_ML_AJ_MAQUINA,
																			EUROS_ML_CAMBIO_BOBINA,
																			EUROS_ML_MERMA_TIRADA,
																			EUROS_ML_SANEAMIENTOS,
																			EUROS_ML_MERMA_PROCESO,
																			EUROS_MERMA_TOTAL_MAQUINA,
																			
																			FECHA_FACTURA,
																			UNIDAD_CIERRE,Q_CERRADA_ML,Q_CERRADA_M2,Q_CERRADA_KG,Q_CERRADA_UN,FUENTE_DEL_CIERRE,TOTAL_M2_MERMPLAN,TOTAL_EUROS_MERMPLAN,
																			ML_MERMA_TOTAL,
																			M2_MERMA_TOTAL,
																			PRECIO,
																			ANCHO_MP,
																			UNIDAD_ORIGEN,
																			EMPRESA_M,N_CLIENTE_M,CLIENTE_M,OT_M,FECHA_DE_LA_OT_M,FECHA_CIERRE_DE_LA_OT_M,TIPO_PRD_M,ESPECIALIDAD_M,LINEA_M,LFS_M,N_CAPAS_TOTALES_M,CANTIDAD_DE_FASES_M,ANCHO_CLIENTE_M,N_DE_CORTES_M,N_DE_VECES_M,ANCHO_DE_PRODUCCION_M,ORIGEN_MP_M,
																			TIPO_MP_M,COD_MP_M,LFS_MP_M,FASE_MP_M,SECCION_PRODUCTIVA_MP_M,MAQUINA_MP_M,M2_MERMPLAN_M,M2_MERMPLAN_EXESO_M,EUR_MERMPLAN_M,EUR_MERMPLAN_EXESO_M,ML_CONSUMIDOS_M,ML_PRODUCIDOS_M,ML_CONSUMIDOS_REALES_M,ML_PRODUCIDOS_REALES_M,
																			ML_MERMAS_ACUMULADAS_HAS_MAQ_M,ML_MERMAS_ACUMULADAS_EN_MAQ_M,ML_ENHEBRADO_MAQUINA_M,ML_AJ_MAQUINA_MAQUINA_M,ML_CAMBIO_BOBINA_MAQUINA_M,ML_MERMA_TIRADA_MQUINA_M,ML_SANEAMIENTOS_MAQUINA_M,ML_MERMA_PROCESO_MQUINA_M,
																			M2_CONSUMIDOS_M,M2_PRODUCIDOS_M,M2_PRODUCIDOS_REALES_M,M2_CONSUMIDOS_REALES_M,M2_MERMAS_ACUMULADAS_HAS_MAQ_M,M2_MERMAS_ACUMULADAS_EN_MAQ_M,M2_ENHEBRADO_MAQUINA_M,M2_AJ_MAQUINA_MAQUINA_M,M2_CAMBIO_BOBINA_MAQUINA_M,
																			M2_MERMA_TIRADA_MQUINA_M,M2_SANEAMIENTOS_MAQUINA_M,M2_MERMA_PROCESO_MQUINA_M,EUROS_ML_CONSUMIDOS_M,EUROS_ML_PRODUCIDOS_M,EUROS_ML_CONSUMIDOS_REALES_M,EUROS_ML_PRODUCIDOS_REALES_M,EUR_MERMAS_ACUMULADAS_HAS_MA_M,
																			EUR_MERMAS_ACUMULADAS_EN_MAQ_M,EUROS_ML_ENHEBRADO_M,EUROS_ML_AJ_MAQUINA_M,EUROS_ML_CAMBIO_BOBINA_M,EUROS_ML_MERMA_TIRADA_M,EUROS_ML_SANEAMIENTOS_M,EUROS_ML_MERMA_PROCESO_M,EUROS_MERMA_TOTAL_MAQUINA_M,FECHA_FACTURA_M,
																			UNIDAD_CIERRE_M,Q_CERRADA_ML_M,Q_CERRADA_M2_M,Q_CERRADA_KG_M,Q_CERRADA_UN_M,FUENTE_DEL_CIERRE_M,TOTAL_M2_MERMPLAN_M,TOTAL_EUROS_MERMPLAN_M,ML_MERMA_TOTAL_M,M2_MERMA_TOTAL_M,PRECIO_M,ANCHO_MP_M,UNIDAD_ORIGEN_M
																			)
			   VALUES  (rANE_M_PRO_REAL.EMPRESA,rANE_M_PRO_REAL.N_CLIENTE,rANE_M_PRO_REAL.CLIENTE,rANE_M_PRO_REAL.OT,rANE_M_PRO_REAL.FECHA_DE_LA_OT,rANE_M_PRO_REAL.FECHA_CIERRE_DE_LA_OT,rANE_M_PRO_REAL.TIPO_PRD,rANE_M_PRO_REAL.ESPECIALIDAD,rANE_M_PRO_REAL.LINEA,rANE_M_PRO_REAL.LFS,rANE_M_PRO_REAL.N_CAPAS_TOTALES,rANE_M_PRO_REAL.CANTIDAD_DE_FASES,rANE_M_PRO_REAL.ANCHO_CLIENTE,rANE_M_PRO_REAL.N_DE_CORTES,rANE_M_PRO_REAL.N_DE_VECES,rANE_M_PRO_REAL.ANCHO_DE_PRODUCCION,rANE_M_PRO_REAL.ORIGEN_MP,
							rANE_M_PRO_REAL.TIPO_MP,rANE_M_PRO_REAL.COD_MP,rANE_M_PRO_REAL.LFS_MP,rANE_M_PRO_REAL.FASE_MP,rANE_M_PRO_REAL.SECCION_PRODUCTIVA_MP,rANE_M_PRO_REAL.MAQUINA_MP,rANE_M_PRO_REAL.M2_MERMPLAN,rANE_M_PRO_REAL.M2_MERMPLAN_EXESO,rANE_M_PRO_REAL.EUR_MERMPLAN,rANE_M_PRO_REAL.EUR_MERMPLAN_EXESO,rANE_M_PRO_REAL.ML_CONSUMIDOS,rANE_M_PRO_REAL.ML_PRODUCIDOS,
							nML_Consumidos_Reales,nML_Producidos_Reales,--NEW IV rANE_M_PRO_REAL.ML_CONSUMIDOS_REALES,rANE_M_PRO_REAL.ML_PRODUCIDOS_REALES,
							rANE_M_PRO_REAL.ML_MERMAS_ACUMULADAS_HAS_MAQ,rANE_M_PRO_REAL.ML_MERMAS_ACUMULADAS_EN_MAQ,rANE_M_PRO_REAL.ML_ENHEBRADO_MAQUINA,rANE_M_PRO_REAL.ML_AJ_MAQUINA_MAQUINA,rANE_M_PRO_REAL.ML_CAMBIO_BOBINA_MAQUINA,rANE_M_PRO_REAL.ML_MERMA_TIRADA_MQUINA,rANE_M_PRO_REAL.ML_SANEAMIENTOS_MAQUINA,
							NVL(nML_Consumidos_Reales,0) - NVL(nML_Producidos_Reales,0) - NVL(rANE_M_PRO_REAL.ML_ENHEBRADO_MAQUINA,0) - NVL(rANE_M_PRO_REAL.ML_AJ_MAQUINA_MAQUINA,0) - NVL(rANE_M_PRO_REAL.ML_CAMBIO_BOBINA_MAQUINA,0) - NVL(rANE_M_PRO_REAL.ML_MERMA_TIRADA_MQUINA,0) - NVL(rANE_M_PRO_REAL.ML_SANEAMIENTOS_MAQUINA,0),--rANE_M_PRO_REAL.ML_MERMA_PROCESO_MQUINA,
							rANE_M_PRO_REAL.M2_CONSUMIDOS,rANE_M_PRO_REAL.M2_PRODUCIDOS,
							nM2_Producidos_Reales,nM2_Consumidos_Reales,--NEW IV rANE_M_PRO_REAL.M2_PRODUCIDOS_REALES,rANE_M_PRO_REAL.M2_CONSUMIDOS_REALES,
							
							rANE_M_PRO_REAL.ML_MERMAS_ACUMULADAS_HAS_MAQ * (rANE_M_PRO_REAL_VALOREAL.ANCHO_MP / 1000), --rANE_M_PRO_REAL.M2_MERMAS_ACUMULADAS_HAS_MAQ,
							rANE_M_PRO_REAL.ML_MERMAS_ACUMULADAS_EN_MAQ * (rANE_M_PRO_REAL_VALOREAL.ANCHO_MP / 1000), --rANE_M_PRO_REAL.M2_MERMAS_ACUMULADAS_EN_MAQ,
							rANE_M_PRO_REAL.ML_ENHEBRADO_MAQUINA * (rANE_M_PRO_REAL_VALOREAL.ANCHO_MP / 1000), --rANE_M_PRO_REAL.M2_ENHEBRADO_MAQUINA,
							rANE_M_PRO_REAL.ML_AJ_MAQUINA_MAQUINA * (rANE_M_PRO_REAL_VALOREAL.ANCHO_MP / 1000), --rANE_M_PRO_REAL.M2_AJ_MAQUINA_MAQUINA,
							rANE_M_PRO_REAL.ML_CAMBIO_BOBINA_MAQUINA * (rANE_M_PRO_REAL_VALOREAL.ANCHO_MP / 1000), --rANE_M_PRO_REAL.M2_CAMBIO_BOBINA_MAQUINA,
							rANE_M_PRO_REAL.ML_MERMA_TIRADA_MQUINA * (rANE_M_PRO_REAL_VALOREAL.ANCHO_MP / 1000), --rANE_M_PRO_REAL.M2_MERMA_TIRADA_MQUINA,
							rANE_M_PRO_REAL.ML_SANEAMIENTOS_MAQUINA * (rANE_M_PRO_REAL_VALOREAL.ANCHO_MP / 1000), --rANE_M_PRO_REAL.M2_SANEAMIENTOS_MAQUINA,
							
							--NVL(nM2_Consumidos_Reales,0) - NVL(nM2_Producidos_Reales,0) - NVL(rANE_M_PRO_REAL.M2_ENHEBRADO_MAQUINA,0) - NVL(rANE_M_PRO_REAL.M2_AJ_MAQUINA_MAQUINA,0) - NVL(rANE_M_PRO_REAL.M2_CAMBIO_BOBINA_MAQUINA,0) - NVL(rANE_M_PRO_REAL.M2_MERMA_TIRADA_MQUINA,0) - NVL(rANE_M_PRO_REAL.M2_SANEAMIENTOS_MAQUINA,0),--rANE_M_PRO_REAL.M2_MERMA_PROCESO_MQUINA,
							NVL(nM2_Consumidos_Reales,0) - NVL(nM2_Producidos_Reales,0) - (NVL(rANE_M_PRO_REAL.ML_ENHEBRADO_MAQUINA,0) * NVL((rANE_M_PRO_REAL_VALOREAL.ANCHO_MP / 1000),0)) - (NVL(rANE_M_PRO_REAL.ML_AJ_MAQUINA_MAQUINA,0) * NVL((rANE_M_PRO_REAL_VALOREAL.ANCHO_MP / 1000),0)) - (NVL(rANE_M_PRO_REAL.ML_CAMBIO_BOBINA_MAQUINA,0) * NVL((rANE_M_PRO_REAL_VALOREAL.ANCHO_MP / 1000),0)) - (NVL(rANE_M_PRO_REAL.ML_MERMA_TIRADA_MQUINA,0) * NVL((rANE_M_PRO_REAL_VALOREAL.ANCHO_MP / 1000),0)) - (NVL(rANE_M_PRO_REAL.ML_SANEAMIENTOS_MAQUINA,0) * NVL((rANE_M_PRO_REAL_VALOREAL.ANCHO_MP / 1000),0)),--rANE_M_PRO_REAL.M2_MERMA_PROCESO_MQUINA,
							
							rANE_M_PRO_REAL.EUROS_ML_CONSUMIDOS,rANE_M_PRO_REAL.EUROS_ML_PRODUCIDOS,
							NVL(nM2_Consumidos_Reales,0) * rANE_M_PRO_REAL_VALOREAL_PREC.PRECIO, NVL(nM2_Producidos_Reales,0) * rANE_M_PRO_REAL_VALOREAL_PREC.PRECIO,--rANE_M_PRO_REAL.EUROS_ML_CONSUMIDOS_REALES,rANE_M_PRO_REAL.EUROS_ML_PRODUCIDOS_REALES,
							rANE_M_PRO_REAL.ML_MERMAS_ACUMULADAS_HAS_MAQ * (rANE_M_PRO_REAL_VALOREAL.ANCHO_MP / 1000) * rANE_M_PRO_REAL_VALOREAL_PREC.PRECIO,--rANE_M_PRO_REAL.EUR_MERMAS_ACUMULADAS_HAS_MAQ,
							rANE_M_PRO_REAL.ML_MERMAS_ACUMULADAS_EN_MAQ * (rANE_M_PRO_REAL_VALOREAL.ANCHO_MP / 1000) * rANE_M_PRO_REAL_VALOREAL_PREC.PRECIO,--rANE_M_PRO_REAL.EUR_MERMAS_ACUMULADAS_EN_MAQ,
							rANE_M_PRO_REAL.ML_ENHEBRADO_MAQUINA * (rANE_M_PRO_REAL_VALOREAL.ANCHO_MP / 1000) * rANE_M_PRO_REAL_VALOREAL_PREC.PRECIO, --rANE_M_PRO_REAL.EUROS_ML_ENHEBRADO,
							rANE_M_PRO_REAL.ML_AJ_MAQUINA_MAQUINA * (rANE_M_PRO_REAL_VALOREAL.ANCHO_MP / 1000) * rANE_M_PRO_REAL_VALOREAL_PREC.PRECIO, --rANE_M_PRO_REAL.EUROS_ML_AJ_MAQUINA,
							rANE_M_PRO_REAL.ML_CAMBIO_BOBINA_MAQUINA * (rANE_M_PRO_REAL_VALOREAL.ANCHO_MP / 1000) * rANE_M_PRO_REAL_VALOREAL_PREC.PRECIO, --rANE_M_PRO_REAL.EUROS_ML_CAMBIO_BOBINA,
							rANE_M_PRO_REAL.ML_MERMA_TIRADA_MQUINA * (rANE_M_PRO_REAL_VALOREAL.ANCHO_MP / 1000) * rANE_M_PRO_REAL_VALOREAL_PREC.PRECIO, --rANE_M_PRO_REAL.EUROS_ML_MERMA_TIRADA,
							rANE_M_PRO_REAL.ML_SANEAMIENTOS_MAQUINA * (rANE_M_PRO_REAL_VALOREAL.ANCHO_MP / 1000) * rANE_M_PRO_REAL_VALOREAL_PREC.PRECIO, --rANE_M_PRO_REAL.EUROS_ML_SANEAMIENTOS,
							(NVL(nM2_Consumidos_Reales,0) - NVL(nM2_Producidos_Reales,0) - (NVL(rANE_M_PRO_REAL.ML_ENHEBRADO_MAQUINA,0) * NVL((rANE_M_PRO_REAL_VALOREAL.ANCHO_MP / 1000),0)) - (NVL(rANE_M_PRO_REAL.ML_AJ_MAQUINA_MAQUINA,0) * NVL((rANE_M_PRO_REAL_VALOREAL.ANCHO_MP / 1000),0)) - (NVL(rANE_M_PRO_REAL.ML_CAMBIO_BOBINA_MAQUINA,0) * NVL((rANE_M_PRO_REAL_VALOREAL.ANCHO_MP / 1000),0)) - (NVL(rANE_M_PRO_REAL.ML_MERMA_TIRADA_MQUINA,0) * NVL((rANE_M_PRO_REAL_VALOREAL.ANCHO_MP / 1000),0)) - (NVL(rANE_M_PRO_REAL.ML_SANEAMIENTOS_MAQUINA,0) * NVL((rANE_M_PRO_REAL_VALOREAL.ANCHO_MP / 1000),0))) * rANE_M_PRO_REAL_VALOREAL_PREC.PRECIO,--rANE_M_PRO_REAL.EUROS_ML_MERMA_PROCESO,
							(NVL(nM2_Consumidos_Reales,0) - NVL(nM2_Producidos_Reales,0)) * rANE_M_PRO_REAL_VALOREAL_PREC.PRECIO,--rANE_M_PRO_REAL.EUROS_MERMA_TOTAL_MAQUINA,
							
							rANE_M_PRO_REAL.FECHA_FACTURA,
							rANE_M_PRO_REAL.UNIDAD_CIERRE,rANE_M_PRO_REAL.Q_CERRADA_ML,rANE_M_PRO_REAL.Q_CERRADA_M2,rANE_M_PRO_REAL.Q_CERRADA_KG,rANE_M_PRO_REAL.Q_CERRADA_UN,rANE_M_PRO_REAL.FUENTE_DEL_CIERRE,rANE_M_PRO_REAL.TOTAL_M2_MERMPLAN,rANE_M_PRO_REAL.TOTAL_EUROS_MERMPLAN,
							NVL(nML_Consumidos_Reales,0) - NVL(nML_Producidos_Reales,0),--rANE_M_PRO_REAL.ML_MERMA_TOTAL,
							NVL(nM2_Consumidos_Reales,0) - NVL(nM2_Producidos_Reales,0),--rANE_M_PRO_REAL.M2_MERMA_TOTAL,
							rANE_M_PRO_REAL_VALOREAL_PREC.PRECIO,--rANE_M_PRO_REAL.PRECIO,
							rANE_M_PRO_REAL_VALOREAL.ANCHO_MP,--rANE_M_PRO_REAL.ANCHO_MP,
							rANE_M_PRO_REAL.UNIDAD_ORIGEN,
							rEstructura.EMPRESA,rEstructura.N_CLIENTE,rEstructura.CLIENTE,rEstructura.OT,rEstructura.FECHA_DE_LA_OT,rEstructura.FECHA_CIERRE_DE_LA_OT,rEstructura.TIPO_PRD,rEstructura.ESPECIALIDAD,rEstructura.LINEA,rEstructura.LFS,rEstructura.N_CAPAS_TOTALES,rEstructura.CANTIDAD_DE_FASES,rEstructura.ANCHO_CLIENTE,rEstructura.N_DE_CORTES,rEstructura.N_DE_VECES,rEstructura.ANCHO_DE_PRODUCCION,rEstructura.ORIGEN_MP,
							rEstructura.TIPO_MP,rEstructura.COD_MP,rEstructura.LFS_MP,rEstructura.FASE_MP,rEstructura.SECCION_PRODUCTIVA_MP,rEstructura.MAQUINA_MP,rEstructura.M2_MERMPLAN,rEstructura.M2_MERMPLAN_EXESO,rEstructura.EUR_MERMPLAN,rEstructura.EUR_MERMPLAN_EXESO,rEstructura.ML_CONSUMIDOS,rEstructura.ML_PRODUCIDOS,rEstructura.ML_CONSUMIDOS_REALES,rEstructura.ML_PRODUCIDOS_REALES,
							rEstructura.ML_MERMAS_ACUMULADAS_HAS_MAQ,rEstructura.ML_MERMAS_ACUMULADAS_EN_MAQ,rEstructura.ML_ENHEBRADO_MAQUINA,rEstructura.ML_AJ_MAQUINA_MAQUINA,rEstructura.ML_CAMBIO_BOBINA_MAQUINA,rEstructura.ML_MERMA_TIRADA_MQUINA,rEstructura.ML_SANEAMIENTOS_MAQUINA,rEstructura.ML_MERMA_PROCESO_MQUINA,
							rEstructura.M2_CONSUMIDOS,rEstructura.M2_PRODUCIDOS,rEstructura.M2_PRODUCIDOS_REALES,rEstructura.M2_CONSUMIDOS_REALES,rEstructura.M2_MERMAS_ACUMULADAS_HAS_MAQ,rEstructura.M2_MERMAS_ACUMULADAS_EN_MAQ,rEstructura.M2_ENHEBRADO_MAQUINA,rEstructura.M2_AJ_MAQUINA_MAQUINA,rEstructura.M2_CAMBIO_BOBINA_MAQUINA,
							rEstructura.M2_MERMA_TIRADA_MQUINA,rEstructura.M2_SANEAMIENTOS_MAQUINA,rEstructura.M2_MERMA_PROCESO_MQUINA,rEstructura.EUROS_ML_CONSUMIDOS,rEstructura.EUROS_ML_PRODUCIDOS,rEstructura.EUROS_ML_CONSUMIDOS_REALES,rEstructura.EUROS_ML_PRODUCIDOS_REALES,rEstructura.EUR_MERMAS_ACUMULADAS_HAS_MAQ,
							rEstructura.EUR_MERMAS_ACUMULADAS_EN_MAQ,rEstructura.EUROS_ML_ENHEBRADO,rEstructura.EUROS_ML_AJ_MAQUINA,rEstructura.EUROS_ML_CAMBIO_BOBINA,rEstructura.EUROS_ML_MERMA_TIRADA,rEstructura.EUROS_ML_SANEAMIENTOS,rEstructura.EUROS_ML_MERMA_PROCESO,rEstructura.EUROS_MERMA_TOTAL_MAQUINA,rEstructura.FECHA_FACTURA,
							rEstructura.UNIDAD_CIERRE,rEstructura.Q_CERRADA_ML,rEstructura.Q_CERRADA_M2,rEstructura.Q_CERRADA_KG,rEstructura.Q_CERRADA_UN,rEstructura.FUENTE_DEL_CIERRE,rEstructura.TOTAL_M2_MERMPLAN,rEstructura.TOTAL_EUROS_MERMPLAN,rEstructura.ML_MERMA_TOTAL,rEstructura.M2_MERMA_TOTAL,rEstructura.PRECIO,rEstructura.ANCHO_MP,rEstructura.UNIDAD_ORIGEN
							);
			END LOOP;
		END LOOP;
		--FIN NEW
	END;--P_CALCULA_REALES
BEGIN--
   --dbms_output.put_line(TO_CHAR(SYSDATE,'DD-MM-YYYY HH24:MI:SS'));
   FOR rOt IN cOt LOOP
	   --dbms_output.put_line(rOt.EMPRESA||'-'||rOt.NUMERO);
      DELETE ANALESTA.ANE_MER_MATERIAL_OT WHERE EMPRESA = rOt.EMPRESA AND NUMEOTRE = rOt.NUMERO;
      DELETE ANALESTA.ANE_MER_BOBIMAQU_OT WHERE EMPRESA = rOt.EMPRESA AND NUMEOTRE = rOt.NUMERO;
      --
      vErrores := NULL;
      --
      nNumePedi := rOT.NUMEPEDI;
      --
      dFecha_Cierre := rOT.FEC_MODI;
      --Se verifica si la MP es propiedad del cliente
      vMaprPrCl := NULL;
      --
      OPEN cFIC_LICHOBOT(rOt.EMPRESA, rOt.NUMERO, SUBSTR(rOt.NUMERO,1,4));--14078
      FETCH cFIC_LICHOBOT INTO vMaprPrCl;
      CLOSE cFIC_LICHOBOT;
      --
      vMaprPrCl := NVL(vMaprPrCl,'N');
      ------------------------------------------------
      --Calculo de Merma de Planificación
      ------------------------------------------------
      --Se calcula la Merma de Planificación Estandar para las maquinas de la OT
      nMermPlan := NULL;
      --
      OPEN cMermPlan(rOt.EMPRESA, rOt.NUMERO); --14260
      FETCH cMermPlan INTO nMermPlan;
      CLOSE cMermPlan;
      --
      nMermPlan := NVL(nMermPlan,0);
--dbms_output.put_line('P_ANCHO_UTIL');
      P_ANCHO_UTIL(rOt.EMPRESA, rOt.NUMERO); --Busqueda de el Ancho de Produccion de OT y Total--14309
      --
      P_CONSUMO_MATERIALES(rOt.EMPRESA, rOt.NUMERO);
      --dbms_output.put_line('vErrores:'||vErrores);
      --Se asigna el Ancho Bueno
--dbms_output.put_line('P_Ancho_Bueno');
      P_Ancho_Bueno(rOt.EMPRESA, rOt.NUMERO); --Asignacion de Anchos faltantes en las MP
--dbms_output.put_line('P_ACTUALIZA_MATERIALES');
      P_ACTUALIZA_MATERIALES(rOt.EMPRESA, rOt.NUMERO);
		--
		P_CALCULA_REALES(rOt.EMPRESA, rOt.NUMERO);
      --
      COMMIT;
   END LOOP;
   --
   --ANALESTA.P_ANE_CARGTAOC;
END;

/
