CREATE OR REPLACE VIEW ANE_TODOS_LOS_COSTES_REPART_V AS
         SELECT EST.ANNO, 
                EST.ESTRUCTU ID_ESTRUCTURA, EST.DEPARTAM ID_DEPARTAMENTO, D.DEPARTAM DESCDEPA, EST.SECCION ID_SECCION, S.SECCION DESCSECC, EST.SECCAUXI ID_SECCION_AUXILIAR, SA.SECCAUXI DESCSEAU, EST.TIPOCOST ID_TIPO_COSTE, TC.TIPOCOST DESCTICO,
                --Costes Matriz por Meses
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,1),'MESCOMPA'),'S',CM_ENERIMCU) CM_ENERIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,2),'MESCOMPA'),'S',CM_FEBRIMCU) CM_FEBRIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,3),'MESCOMPA'),'S',CM_MARZIMCU) CM_MARZIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,4),'MESCOMPA'),'S',CM_ABRIIMCU) CM_ABRIIMCU,
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,5),'MESCOMPA'),'S',CM_MAYOIMCU) CM_MAYOIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,6),'MESCOMPA'),'S',CM_JUNIIMCU) CM_JUNIIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,7),'MESCOMPA'),'S',CM_JULIIMCU) CM_JULIIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,8),'MESCOMPA'),'S',CM_AGOSIMCU) CM_AGOSIMCU,
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,9),'MESCOMPA'),'S',CM_SEPTIMCU) CM_SEPTIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,10),'MESCOMPA'),'S',CM_OCTUIMCU) CM_OCTUIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,11),'MESCOMPA'),'S',CM_NOVIIMCU) CM_NOVIIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,12),'MESCOMPA'),'S',CM_DICIIMCU) CM_DICIIMCU,
                --% de Reparto
                PR.PORECMPH, PR.PORECMMA, PR.PORECMEX,
                --ANN_COSTMATRFormula
                --ANN_SUM_CM_ENERIMCU := ANN_SUM_CM_ENERIMCU + NVL(rValoAnno.CM_ENERIMCU,0);
                --..
                --ANN_CM_ENERIMCU := ANN_SUM_CM_ENERIMCU;
                --..
                --ANN_CM_TOTAL := ANN_CM_ENERIMCU + ANN_CM_FEBRIMCU + ANN_CM_MARZIMCU + ANN_CM_ABRIIMCU + ANN_CM_MAYOIMCU + ANN_CM_JUNIIMCU + ANN_CM_JULIIMCU + ANN_CM_AGOSIMCU + ANN_CM_SEPTIMCU + ANN_CM_OCTUIMCU + ANN_CM_NOVIIMCU + ANN_CM_DICIIMCU;
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,1),'MESCOMPA'),'S',NVL(CM_ENERIMCU,0),0) + 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,2),'MESCOMPA'),'S',NVL(CM_FEBRIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,3),'MESCOMPA'),'S',NVL(CM_MARZIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,4),'MESCOMPA'),'S',NVL(CM_ABRIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,5),'MESCOMPA'),'S',NVL(CM_MAYOIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,6),'MESCOMPA'),'S',NVL(CM_JUNIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,7),'MESCOMPA'),'S',NVL(CM_JULIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,8),'MESCOMPA'),'S',NVL(CM_AGOSIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,9),'MESCOMPA'),'S',NVL(CM_SEPTIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,10),'MESCOMPA'),'S',NVL(CM_OCTUIMCU,0),0) + 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,11),'MESCOMPA'),'S',NVL(CM_NOVIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,12),'MESCOMPA'),'S',NVL(CM_DICIIMCU,0),0) 
                --Costes Matriz
                ANN_CM_TOTAL,
                --ANN_CM_PHARMA := ANN_CM_TOTAL * (nP_PORECMPH / 100);
                (
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,1),'MESCOMPA'),'S',NVL(CM_ENERIMCU,0),0) + 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,2),'MESCOMPA'),'S',NVL(CM_FEBRIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,3),'MESCOMPA'),'S',NVL(CM_MARZIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,4),'MESCOMPA'),'S',NVL(CM_ABRIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,5),'MESCOMPA'),'S',NVL(CM_MAYOIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,6),'MESCOMPA'),'S',NVL(CM_JUNIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,7),'MESCOMPA'),'S',NVL(CM_JULIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,8),'MESCOMPA'),'S',NVL(CM_AGOSIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,9),'MESCOMPA'),'S',NVL(CM_SEPTIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,10),'MESCOMPA'),'S',NVL(CM_OCTUIMCU,0),0) + 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,11),'MESCOMPA'),'S',NVL(CM_NOVIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,12),'MESCOMPA'),'S',NVL(CM_DICIIMCU,0),0) --ANN_CM_TOTAL
                ) * (NVL(PR.PORECMPH,0)/100) 
                --Costes Matriz Pharma
                ANN_CM_PHARMA,
                --ANN_CM_MANVIEL := ANN_CM_TOTAL * (nP_PORECMMA / 100);
                (
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,1),'MESCOMPA'),'S',NVL(CM_ENERIMCU,0),0) + 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,2),'MESCOMPA'),'S',NVL(CM_FEBRIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,3),'MESCOMPA'),'S',NVL(CM_MARZIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,4),'MESCOMPA'),'S',NVL(CM_ABRIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,5),'MESCOMPA'),'S',NVL(CM_MAYOIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,6),'MESCOMPA'),'S',NVL(CM_JUNIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,7),'MESCOMPA'),'S',NVL(CM_JULIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,8),'MESCOMPA'),'S',NVL(CM_AGOSIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,9),'MESCOMPA'),'S',NVL(CM_SEPTIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,10),'MESCOMPA'),'S',NVL(CM_OCTUIMCU,0),0) + 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,11),'MESCOMPA'),'S',NVL(CM_NOVIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,12),'MESCOMPA'),'S',NVL(CM_DICIIMCU,0),0) --ANN_CM_TOTAL
                ) * (NVL(PR.PORECMMA,0)/100) 
                --Costes Matriz Manviel
                ANN_CM_MANVIEL,
                --ANN_CM_EXTREMADURA := ANN_CM_TOTAL * (nP_PORECMEX / 100);
                (
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,1),'MESCOMPA'),'S',NVL(CM_ENERIMCU,0),0) + 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,2),'MESCOMPA'),'S',NVL(CM_FEBRIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,3),'MESCOMPA'),'S',NVL(CM_MARZIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,4),'MESCOMPA'),'S',NVL(CM_ABRIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,5),'MESCOMPA'),'S',NVL(CM_MAYOIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,6),'MESCOMPA'),'S',NVL(CM_JUNIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,7),'MESCOMPA'),'S',NVL(CM_JULIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,8),'MESCOMPA'),'S',NVL(CM_AGOSIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,9),'MESCOMPA'),'S',NVL(CM_SEPTIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,10),'MESCOMPA'),'S',NVL(CM_OCTUIMCU,0),0) + 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,11),'MESCOMPA'),'S',NVL(CM_NOVIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,12),'MESCOMPA'),'S',NVL(CM_DICIIMCU,0),0) --ANN_CM_TOTAL
                ) * (NVL(PR.PORECMEX,0)/100) 
                --Costes Matriz Extremadura
                ANN_CM_EXTREMADURA,
                --RRHH
                COSTRRHH_10.COSTE COSTRRHH_10, COSTRRHH_05.COSTE COSTRRHH_05, COSTRRHH_35.COSTE COSTRRHH_35, 
                COSTRRHH_01.COSTE COSTRRHH_01, 
                COSTRRHH_01.COSTE * (NVL(PR.PORECMPH,0)/100) CP_COSTRRHH_01_10,
                COSTRRHH_01.COSTE * (NVL(PR.PORECMMA,0)/100) CP_COSTRRHH_01_05,
                COSTRRHH_01.COSTE * (NVL(PR.PORECMEX,0)/100) CP_COSTRRHH_01_35,
                --CPP_ Costes comunes Pharma mes a mes
                --CCPSP_ Costes comunes Pharma Reparto Pharma Mes a Mes
                --CCPSM_ Costes comunes Pharma Reparto Manviel Mes a Mes
                --CCPSE_ Costes comunes Pharma Reparto Extremadura Mes a Mes
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,1),'MESCOMPA'),'S',CCP_ENERIMCU) CCP_ENERIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,1),'MESCOMPA'),'S',CCPSP_ENERIMCU) CCPSP_ENERIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,1),'MESCOMPA'),'S',CCPSM_ENERIMCU) CCPSM_ENERIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,1),'MESCOMPA'),'S',CCPSE_ENERIMCU) CCPSE_ENERIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,2),'MESCOMPA'),'S',CCP_FEBRIMCU) CCP_FEBRIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,2),'MESCOMPA'),'S',CCPSP_FEBRIMCU) CCPSP_FEBRIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,2),'MESCOMPA'),'S',CCPSM_FEBRIMCU) CCPSM_FEBRIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,2),'MESCOMPA'),'S',CCPSE_FEBRIMCU) CCPSE_FEBRIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,3),'MESCOMPA'),'S',CCP_MARZIMCU) CCP_MARZIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,3),'MESCOMPA'),'S',CCPSP_MARZIMCU) CCPSP_MARZIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,3),'MESCOMPA'),'S',CCPSM_MARZIMCU) CCPSM_MARZIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,3),'MESCOMPA'),'S',CCPSE_MARZIMCU) CCPSE_MARZIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,4),'MESCOMPA'),'S',CCP_ABRIIMCU) CCP_ABRIIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,4),'MESCOMPA'),'S',CCPSP_ABRIIMCU) CCPSP_ABRIIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,4),'MESCOMPA'),'S',CCPSM_ABRIIMCU) CCPSM_ABRIIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,4),'MESCOMPA'),'S',CCPSE_ABRIIMCU) CCPSE_ABRIIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,5),'MESCOMPA'),'S',CCP_MAYOIMCU) CCP_MAYOIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,5),'MESCOMPA'),'S',CCPSP_MAYOIMCU) CCPSP_MAYOIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,5),'MESCOMPA'),'S',CCPSM_MAYOIMCU) CCPSM_MAYOIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,5),'MESCOMPA'),'S',CCPSE_MAYOIMCU) CCPSE_MAYOIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,6),'MESCOMPA'),'S',CCP_JUNIIMCU) CCP_JUNIIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,6),'MESCOMPA'),'S',CCPSP_JUNIIMCU) CCPSP_JUNIIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,6),'MESCOMPA'),'S',CCPSM_JUNIIMCU) CCPSM_JUNIIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,6),'MESCOMPA'),'S',CCPSE_JUNIIMCU) CCPSE_JUNIIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,7),'MESCOMPA'),'S',CCP_JULIIMCU) CCP_JULIIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,7),'MESCOMPA'),'S',CCPSP_JULIIMCU) CCPSP_JULIIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,7),'MESCOMPA'),'S',CCPSM_JULIIMCU) CCPSM_JULIIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,7),'MESCOMPA'),'S',CCPSE_JULIIMCU) CCPSE_JULIIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,8),'MESCOMPA'),'S',CCP_AGOSIMCU) CCP_AGOSIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,8),'MESCOMPA'),'S',CCPSP_AGOSIMCU) CCPSP_AGOSIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,8),'MESCOMPA'),'S',CCPSM_AGOSIMCU) CCPSM_AGOSIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,8),'MESCOMPA'),'S',CCPSE_AGOSIMCU) CCPSE_AGOSIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,9),'MESCOMPA'),'S',CCP_SEPTIMCU) CCP_SEPTIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,9),'MESCOMPA'),'S',CCPSP_SEPTIMCU) CCPSP_SEPTIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,9),'MESCOMPA'),'S',CCPSM_SEPTIMCU) CCPSM_SEPTIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,9),'MESCOMPA'),'S',CCPSE_SEPTIMCU) CCPSE_SEPTIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,10),'MESCOMPA'),'S',CCP_OCTUIMCU) CCP_OCTUIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,10),'MESCOMPA'),'S',CCPSP_OCTUIMCU) CCPSP_OCTUIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,10),'MESCOMPA'),'S',CCPSM_OCTUIMCU) CCPSM_OCTUIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,10),'MESCOMPA'),'S',CCPSE_OCTUIMCU) CCPSE_OCTUIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,11),'MESCOMPA'),'S',CCP_NOVIIMCU) CCP_NOVIIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,11),'MESCOMPA'),'S',CCPSP_NOVIIMCU) CCPSP_NOVIIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,11),'MESCOMPA'),'S',CCPSM_NOVIIMCU) CCPSM_NOVIIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,11),'MESCOMPA'),'S',CCPSE_NOVIIMCU) CCPSE_NOVIIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,12),'MESCOMPA'),'S',CCP_DICIIMCU) CCP_DICIIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,12),'MESCOMPA'),'S',CCPSP_DICIIMCU) CCPSP_DICIIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,12),'MESCOMPA'),'S',CCPSM_DICIIMCU) CCPSM_DICIIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,12),'MESCOMPA'),'S',CCPSE_DICIIMCU) CCPSE_DICIIMCU, 
                --ANN_COCOPHARFormula(rAnnos.Anno);
                --ANN_CCP_TOTAL := ANN_CCP_ENERIMCU + ANN_CCP_FEBRIMCU + ANN_CCP_MARZIMCU + ANN_CCP_ABRIIMCU + ANN_CCP_MAYOIMCU + ANN_CCP_JUNIIMCU + ANN_CCP_JULIIMCU + ANN_CCP_AGOSIMCU + ANN_CCP_SEPTIMCU + ANN_CCP_OCTUIMCU + ANN_CCP_NOVIIMCU + ANN_CCP_DICIIMCU;
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,1),'MESCOMPA'),'S',NVL(CCP_ENERIMCU,0),0) + 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,2),'MESCOMPA'),'S',NVL(CCP_FEBRIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,3),'MESCOMPA'),'S',NVL(CCP_MARZIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,4),'MESCOMPA'),'S',NVL(CCP_ABRIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,5),'MESCOMPA'),'S',NVL(CCP_MAYOIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,6),'MESCOMPA'),'S',NVL(CCP_JUNIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,7),'MESCOMPA'),'S',NVL(CCP_JULIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,8),'MESCOMPA'),'S',NVL(CCP_AGOSIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,9),'MESCOMPA'),'S',NVL(CCP_SEPTIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,10),'MESCOMPA'),'S',NVL(CCP_OCTUIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,11),'MESCOMPA'),'S',NVL(CCP_NOVIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,12),'MESCOMPA'),'S',NVL(CCP_DICIIMCU,0),0)
                --Costes comunes Pharma
                ANN_CCP_TOTAL,
                --
                --ANN_CCPSP_TOTAL := ANN_CCPSP_ENERIMCU + ANN_CCPSP_FEBRIMCU + ANN_CCPSP_MARZIMCU + ANN_CCPSP_ABRIIMCU + ANN_CCPSP_MAYOIMCU + ANN_CCPSP_JUNIIMCU + ANN_CCPSP_JULIIMCU + ANN_CCPSP_AGOSIMCU + ANN_CCPSP_SEPTIMCU + ANN_CCPSP_OCTUIMCU + ANN_CCPSP_NOVIIMCU + ANN_CCPSP_DICIIMCU;
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,1),'MESCOMPA'),'S',NVL(CCPSP_ENERIMCU,0),0) + 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,2),'MESCOMPA'),'S',NVL(CCPSP_FEBRIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,3),'MESCOMPA'),'S',NVL(CCPSP_MARZIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,4),'MESCOMPA'),'S',NVL(CCPSP_ABRIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,5),'MESCOMPA'),'S',NVL(CCPSP_MAYOIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,6),'MESCOMPA'),'S',NVL(CCPSP_JUNIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,7),'MESCOMPA'),'S',NVL(CCPSP_JULIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,8),'MESCOMPA'),'S',NVL(CCPSP_AGOSIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,9),'MESCOMPA'),'S',NVL(CCPSP_SEPTIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,10),'MESCOMPA'),'S',NVL(CCPSP_OCTUIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,11),'MESCOMPA'),'S',NVL(CCPSP_NOVIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,12),'MESCOMPA'),'S',NVL(CCPSP_DICIIMCU,0),0)
                --Costes comunes Pharma Reparto a Pharma
                ANN_CCPSP_TOTAL,
                --
                --ANN_CCPSM_TOTAL := ANN_CCPSM_ENERIMCU + ANN_CCPSM_FEBRIMCU + ANN_CCPSM_MARZIMCU + ANN_CCPSM_ABRIIMCU + ANN_CCPSM_MAYOIMCU + ANN_CCPSM_JUNIIMCU + ANN_CCPSM_JULIIMCU + ANN_CCPSM_AGOSIMCU + ANN_CCPSM_SEPTIMCU + ANN_CCPSM_OCTUIMCU + ANN_CCPSM_NOVIIMCU + ANN_CCPSM_DICIIMCU;
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,1),'MESCOMPA'),'S',NVL(CCPSM_ENERIMCU,0),0) + 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,2),'MESCOMPA'),'S',NVL(CCPSM_FEBRIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,3),'MESCOMPA'),'S',NVL(CCPSM_MARZIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,4),'MESCOMPA'),'S',NVL(CCPSM_ABRIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,5),'MESCOMPA'),'S',NVL(CCPSM_MAYOIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,6),'MESCOMPA'),'S',NVL(CCPSM_JUNIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,7),'MESCOMPA'),'S',NVL(CCPSM_JULIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,8),'MESCOMPA'),'S',NVL(CCPSM_AGOSIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,9),'MESCOMPA'),'S',NVL(CCPSM_SEPTIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,10),'MESCOMPA'),'S',NVL(CCPSM_OCTUIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,11),'MESCOMPA'),'S',NVL(CCPSM_NOVIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,12),'MESCOMPA'),'S',NVL(CCPSM_DICIIMCU,0),0)
                --Costes comunes Pharma Reparto a Manviel
                ANN_CCPSM_TOTAL,
                --
                --ANN_CCPSE_TOTAL := ANN_CCPSE_ENERIMCU + ANN_CCPSE_FEBRIMCU + ANN_CCPSE_MARZIMCU + ANN_CCPSE_ABRIIMCU + ANN_CCPSE_MAYOIMCU + ANN_CCPSE_JUNIIMCU + ANN_CCPSE_JULIIMCU + ANN_CCPSE_AGOSIMCU + ANN_CCPSE_SEPTIMCU + ANN_CCPSE_OCTUIMCU + ANN_CCPSE_NOVIIMCU + ANN_CCPSE_DICIIMCU;
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,1),'MESCOMPA'),'S',NVL(CCPSE_ENERIMCU,0),0) + 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,2),'MESCOMPA'),'S',NVL(CCPSE_FEBRIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,3),'MESCOMPA'),'S',NVL(CCPSE_MARZIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,4),'MESCOMPA'),'S',NVL(CCPSE_ABRIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,5),'MESCOMPA'),'S',NVL(CCPSE_MAYOIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,6),'MESCOMPA'),'S',NVL(CCPSE_JUNIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,7),'MESCOMPA'),'S',NVL(CCPSE_JULIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,8),'MESCOMPA'),'S',NVL(CCPSE_AGOSIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,9),'MESCOMPA'),'S',NVL(CCPSE_SEPTIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,10),'MESCOMPA'),'S',NVL(CCPSE_OCTUIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,11),'MESCOMPA'),'S',NVL(CCPSE_NOVIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,12),'MESCOMPA'),'S',NVL(CCPSE_DICIIMCU,0),0)
                --Costes comunes Pharma Reparto a Extremadura
                ANN_CCPSE_TOTAL,
                --CPM_ Costes comunes Manviel mes a mes
                --CCMSP_ Costes comunes Manviel Reparto Pharma Mes a Mes
                --CCMSM_ Costes comunes Manviel Reparto Manviel Mes a Mes
                --CCMSE_ Costes comunes Manviel Reparto Extremadura Mes a Mes
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,1),'MESCOMPA'),'S',CCM_ENERIMCU) CCM_ENERIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,1),'MESCOMPA'),'S',CCMSP_ENERIMCU) CCMSP_ENERIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,1),'MESCOMPA'),'S',CCMSM_ENERIMCU) CCMSM_ENERIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,1),'MESCOMPA'),'S',CCMSE_ENERIMCU) CCMSE_ENERIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,2),'MESCOMPA'),'S',CCM_FEBRIMCU) CCM_FEBRIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,2),'MESCOMPA'),'S',CCMSP_FEBRIMCU) CCMSP_FEBRIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,2),'MESCOMPA'),'S',CCMSM_FEBRIMCU) CCMSM_FEBRIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,2),'MESCOMPA'),'S',CCMSE_FEBRIMCU) CCMSE_FEBRIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,3),'MESCOMPA'),'S',CCM_MARZIMCU) CCM_MARZIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,3),'MESCOMPA'),'S',CCMSP_MARZIMCU) CCMSP_MARZIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,3),'MESCOMPA'),'S',CCMSM_MARZIMCU) CCMSM_MARZIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,3),'MESCOMPA'),'S',CCMSE_MARZIMCU) CCMSE_MARZIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,4),'MESCOMPA'),'S',CCM_ABRIIMCU) CCM_ABRIIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,4),'MESCOMPA'),'S',CCMSP_ABRIIMCU) CCMSP_ABRIIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,4),'MESCOMPA'),'S',CCMSM_ABRIIMCU) CCMSM_ABRIIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,4),'MESCOMPA'),'S',CCMSE_ABRIIMCU) CCMSE_ABRIIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,5),'MESCOMPA'),'S',CCM_MAYOIMCU) CCM_MAYOIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,5),'MESCOMPA'),'S',CCMSP_MAYOIMCU) CCMSP_MAYOIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,5),'MESCOMPA'),'S',CCMSM_MAYOIMCU) CCMSM_MAYOIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,5),'MESCOMPA'),'S',CCMSE_MAYOIMCU) CCMSE_MAYOIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,6),'MESCOMPA'),'S',CCM_JUNIIMCU) CCM_JUNIIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,6),'MESCOMPA'),'S',CCMSP_JUNIIMCU) CCMSP_JUNIIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,6),'MESCOMPA'),'S',CCMSM_JUNIIMCU) CCMSM_JUNIIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,6),'MESCOMPA'),'S',CCMSE_JUNIIMCU) CCMSE_JUNIIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,7),'MESCOMPA'),'S',CCM_JULIIMCU) CCM_JULIIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,7),'MESCOMPA'),'S',CCMSP_JULIIMCU) CCMSP_JULIIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,7),'MESCOMPA'),'S',CCMSM_JULIIMCU) CCMSM_JULIIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,7),'MESCOMPA'),'S',CCMSE_JULIIMCU) CCMSE_JULIIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,8),'MESCOMPA'),'S',CCM_AGOSIMCU) CCM_AGOSIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,8),'MESCOMPA'),'S',CCMSP_AGOSIMCU) CCMSP_AGOSIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,8),'MESCOMPA'),'S',CCMSM_AGOSIMCU) CCMSM_AGOSIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,8),'MESCOMPA'),'S',CCMSE_AGOSIMCU) CCMSE_AGOSIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,9),'MESCOMPA'),'S',CCM_SEPTIMCU) CCM_SEPTIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,9),'MESCOMPA'),'S',CCMSP_SEPTIMCU) CCMSP_SEPTIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,9),'MESCOMPA'),'S',CCMSM_SEPTIMCU) CCMSM_SEPTIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,9),'MESCOMPA'),'S',CCMSE_SEPTIMCU) CCMSE_SEPTIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,10),'MESCOMPA'),'S',CCM_OCTUIMCU) CCM_OCTUIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,10),'MESCOMPA'),'S',CCMSP_OCTUIMCU) CCMSP_OCTUIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,10),'MESCOMPA'),'S',CCMSM_OCTUIMCU) CCMSM_OCTUIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,10),'MESCOMPA'),'S',CCMSE_OCTUIMCU) CCMSE_OCTUIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,11),'MESCOMPA'),'S',CCM_NOVIIMCU) CCM_NOVIIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,11),'MESCOMPA'),'S',CCMSP_NOVIIMCU) CCMSP_NOVIIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,11),'MESCOMPA'),'S',CCMSM_NOVIIMCU) CCMSM_NOVIIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,11),'MESCOMPA'),'S',CCMSE_NOVIIMCU) CCMSE_NOVIIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,12),'MESCOMPA'),'S',CCM_DICIIMCU) CCM_DICIIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,12),'MESCOMPA'),'S',CCMSP_DICIIMCU) CCMSP_DICIIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,12),'MESCOMPA'),'S',CCMSM_DICIIMCU) CCMSM_DICIIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,12),'MESCOMPA'),'S',CCMSE_DICIIMCU) CCMSE_DICIIMCU, 
                --ANN_COCOMANVFormula(rAnnos.Anno);
                --ANN_CCM_TOTAL := ANN_CCM_ENERIMCU + ANN_CCM_FEBRIMCU + ANN_CCM_MARZIMCU + ANN_CCM_ABRIIMCU + ANN_CCM_MAYOIMCU + ANN_CCM_JUNIIMCU + ANN_CCM_JULIIMCU + ANN_CCM_AGOSIMCU + ANN_CCM_SEPTIMCU + ANN_CCM_OCTUIMCU + ANN_CCM_NOVIIMCU + ANN_CCM_DICIIMCU;
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,1),'MESCOMPA'),'S',NVL(CCM_ENERIMCU,0),0) + 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,2),'MESCOMPA'),'S',NVL(CCM_FEBRIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,3),'MESCOMPA'),'S',NVL(CCM_MARZIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,4),'MESCOMPA'),'S',NVL(CCM_ABRIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,5),'MESCOMPA'),'S',NVL(CCM_MAYOIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,6),'MESCOMPA'),'S',NVL(CCM_JUNIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,7),'MESCOMPA'),'S',NVL(CCM_JULIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,8),'MESCOMPA'),'S',NVL(CCM_AGOSIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,9),'MESCOMPA'),'S',NVL(CCM_SEPTIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,10),'MESCOMPA'),'S',NVL(CCM_OCTUIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,11),'MESCOMPA'),'S',NVL(CCM_NOVIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,12),'MESCOMPA'),'S',NVL(CCM_DICIIMCU,0),0)
                --CPM_ Costes comunes Manviel
                ANN_CCM_TOTAL,
                --ANN_CCMSP_TOTAL := ANN_CCMSP_ENERIMCU + ANN_CCMSP_FEBRIMCU + ANN_CCMSP_MARZIMCU + ANN_CCMSP_ABRIIMCU + ANN_CCMSP_MAYOIMCU + ANN_CCMSP_JUNIIMCU + ANN_CCMSP_JULIIMCU + ANN_CCMSP_AGOSIMCU + ANN_CCMSP_SEPTIMCU + ANN_CCMSP_OCTUIMCU + ANN_CCMSP_NOVIIMCU + ANN_CCMSP_DICIIMCU;
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,1),'MESCOMPA'),'S',NVL(CCMSP_ENERIMCU,0),0) + 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,2),'MESCOMPA'),'S',NVL(CCMSP_FEBRIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,3),'MESCOMPA'),'S',NVL(CCMSP_MARZIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,4),'MESCOMPA'),'S',NVL(CCMSP_ABRIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,5),'MESCOMPA'),'S',NVL(CCMSP_MAYOIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,6),'MESCOMPA'),'S',NVL(CCMSP_JUNIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,7),'MESCOMPA'),'S',NVL(CCMSP_JULIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,8),'MESCOMPA'),'S',NVL(CCMSP_AGOSIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,9),'MESCOMPA'),'S',NVL(CCMSP_SEPTIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,10),'MESCOMPA'),'S',NVL(CCMSP_OCTUIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,11),'MESCOMPA'),'S',NVL(CCMSP_NOVIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,12),'MESCOMPA'),'S',NVL(CCMSP_DICIIMCU,0),0)
                --CCMSP_ Costes comunes Manviel Reparto Pharma
                ANN_CCMSP_TOTAL,
                --ANN_CCMSM_TOTAL := ANN_CCMSM_ENERIMCU + ANN_CCMSM_FEBRIMCU + ANN_CCMSM_MARZIMCU + ANN_CCMSM_ABRIIMCU + ANN_CCMSM_MAYOIMCU + ANN_CCMSM_JUNIIMCU + ANN_CCMSM_JULIIMCU + ANN_CCMSM_AGOSIMCU + ANN_CCMSM_SEPTIMCU + ANN_CCMSM_OCTUIMCU + ANN_CCMSM_NOVIIMCU + ANN_CCMSM_DICIIMCU;
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,1),'MESCOMPA'),'S',NVL(CCMSM_ENERIMCU,0),0) + 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,2),'MESCOMPA'),'S',NVL(CCMSM_FEBRIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,3),'MESCOMPA'),'S',NVL(CCMSM_MARZIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,4),'MESCOMPA'),'S',NVL(CCMSM_ABRIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,5),'MESCOMPA'),'S',NVL(CCMSM_MAYOIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,6),'MESCOMPA'),'S',NVL(CCMSM_JUNIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,7),'MESCOMPA'),'S',NVL(CCMSM_JULIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,8),'MESCOMPA'),'S',NVL(CCMSM_AGOSIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,9),'MESCOMPA'),'S',NVL(CCMSM_SEPTIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,10),'MESCOMPA'),'S',NVL(CCMSM_OCTUIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,11),'MESCOMPA'),'S',NVL(CCMSM_NOVIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,12),'MESCOMPA'),'S',NVL(CCMSM_DICIIMCU,0),0)
                --CCMSM_ Costes comunes Manviel Reparto Manviel
                ANN_CCMSM_TOTAL,
                --ANN_CCMSE_TOTAL := ANN_CCMSE_ENERIMCU + ANN_CCMSE_FEBRIMCU + ANN_CCMSE_MARZIMCU + ANN_CCMSE_ABRIIMCU + ANN_CCMSE_MAYOIMCU + ANN_CCMSE_JUNIIMCU + ANN_CCMSE_JULIIMCU + ANN_CCMSE_AGOSIMCU + ANN_CCMSE_SEPTIMCU + ANN_CCMSE_OCTUIMCU + ANN_CCMSE_NOVIIMCU + ANN_CCMSE_DICIIMCU;
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,1),'MESCOMPA'),'S',NVL(CCMSE_ENERIMCU,0),0) + 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,2),'MESCOMPA'),'S',NVL(CCMSE_FEBRIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,3),'MESCOMPA'),'S',NVL(CCMSE_MARZIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,4),'MESCOMPA'),'S',NVL(CCMSE_ABRIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,5),'MESCOMPA'),'S',NVL(CCMSE_MAYOIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,6),'MESCOMPA'),'S',NVL(CCMSE_JUNIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,7),'MESCOMPA'),'S',NVL(CCMSE_JULIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,8),'MESCOMPA'),'S',NVL(CCMSE_AGOSIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,9),'MESCOMPA'),'S',NVL(CCMSE_SEPTIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,10),'MESCOMPA'),'S',NVL(CCMSE_OCTUIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,11),'MESCOMPA'),'S',NVL(CCMSE_NOVIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,12),'MESCOMPA'),'S',NVL(CCMSE_DICIIMCU,0),0)
                --CCMSE_ Costes comunes Manviel Reparto Extremadura
                ANN_CCMSE_TOTAL,
                --Extremadura
                --CPE_ Costes comunes Extremadura mes a mes
                --CCESP_ Costes comunes Extremadura Reparto Pharma Mes a Mes
                --CCESM_ Costes comunes Extremadura Reparto Manviel Mes a Mes
                --CCESE_ Costes comunes Extremadura Reparto Extremadura Mes a Mes
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,1),'MESCOMPA'),'S',CCE_ENERIMCU) CCE_ENERIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,1),'MESCOMPA'),'S',CCESP_ENERIMCU) CCESP_ENERIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,1),'MESCOMPA'),'S',CCESM_ENERIMCU) CCESM_ENERIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,1),'MESCOMPA'),'S',CCESE_ENERIMCU) CCESE_ENERIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,2),'MESCOMPA'),'S',CCE_FEBRIMCU) CCE_FEBRIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,2),'MESCOMPA'),'S',CCESP_FEBRIMCU) CCESP_FEBRIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,2),'MESCOMPA'),'S',CCESM_FEBRIMCU) CCESM_FEBRIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,2),'MESCOMPA'),'S',CCESE_FEBRIMCU) CCESE_FEBRIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,3),'MESCOMPA'),'S',CCE_MARZIMCU) CCE_MARZIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,3),'MESCOMPA'),'S',CCESP_MARZIMCU) CCESP_MARZIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,3),'MESCOMPA'),'S',CCESM_MARZIMCU) CCESM_MARZIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,3),'MESCOMPA'),'S',CCESE_MARZIMCU) CCESE_MARZIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,4),'MESCOMPA'),'S',CCE_ABRIIMCU) CCE_ABRIIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,4),'MESCOMPA'),'S',CCESP_ABRIIMCU) CCESP_ABRIIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,4),'MESCOMPA'),'S',CCESM_ABRIIMCU) CCESM_ABRIIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,4),'MESCOMPA'),'S',CCESE_ABRIIMCU) CCESE_ABRIIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,5),'MESCOMPA'),'S',CCE_MAYOIMCU) CCE_MAYOIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,5),'MESCOMPA'),'S',CCESP_MAYOIMCU) CCESP_MAYOIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,5),'MESCOMPA'),'S',CCESM_MAYOIMCU) CCESM_MAYOIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,5),'MESCOMPA'),'S',CCESE_MAYOIMCU) CCESE_MAYOIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,6),'MESCOMPA'),'S',CCE_JUNIIMCU) CCE_JUNIIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,6),'MESCOMPA'),'S',CCESP_JUNIIMCU) CCESP_JUNIIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,6),'MESCOMPA'),'S',CCESM_JUNIIMCU) CCESM_JUNIIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,6),'MESCOMPA'),'S',CCESE_JUNIIMCU) CCESE_JUNIIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,7),'MESCOMPA'),'S',CCE_JULIIMCU) CCE_JULIIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,7),'MESCOMPA'),'S',CCESP_JULIIMCU) CCESP_JULIIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,7),'MESCOMPA'),'S',CCESM_JULIIMCU) CCESM_JULIIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,7),'MESCOMPA'),'S',CCESE_JULIIMCU) CCESE_JULIIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,8),'MESCOMPA'),'S',CCE_AGOSIMCU) CCE_AGOSIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,8),'MESCOMPA'),'S',CCESP_AGOSIMCU) CCESP_AGOSIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,8),'MESCOMPA'),'S',CCESM_AGOSIMCU) CCESM_AGOSIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,8),'MESCOMPA'),'S',CCESE_AGOSIMCU) CCESE_AGOSIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,9),'MESCOMPA'),'S',CCE_SEPTIMCU) CCE_SEPTIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,9),'MESCOMPA'),'S',CCESP_SEPTIMCU) CCESP_SEPTIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,9),'MESCOMPA'),'S',CCESM_SEPTIMCU) CCESM_SEPTIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,9),'MESCOMPA'),'S',CCESE_SEPTIMCU) CCESE_SEPTIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,10),'MESCOMPA'),'S',CCE_OCTUIMCU) CCE_OCTUIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,10),'MESCOMPA'),'S',CCESP_OCTUIMCU) CCESP_OCTUIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,10),'MESCOMPA'),'S',CCESM_OCTUIMCU) CCESM_OCTUIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,10),'MESCOMPA'),'S',CCESE_OCTUIMCU) CCESE_OCTUIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,11),'MESCOMPA'),'S',CCE_NOVIIMCU) CCE_NOVIIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,11),'MESCOMPA'),'S',CCESP_NOVIIMCU) CCESP_NOVIIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,11),'MESCOMPA'),'S',CCESM_NOVIIMCU) CCESM_NOVIIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,11),'MESCOMPA'),'S',CCESE_NOVIIMCU) CCESE_NOVIIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,12),'MESCOMPA'),'S',CCE_DICIIMCU) CCE_DICIIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,12),'MESCOMPA'),'S',CCESP_DICIIMCU) CCESP_DICIIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,12),'MESCOMPA'),'S',CCESM_DICIIMCU) CCESM_DICIIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,12),'MESCOMPA'),'S',CCESE_DICIIMCU) CCESE_DICIIMCU, 
                --ANN_COCOEXTRFormula(rAnnos.Anno);
                --ANN_CCE_TOTAL := ANN_CCE_ENERIMCU + ANN_CCE_FEBRIMCU + ANN_CCE_MARZIMCU + ANN_CCE_ABRIIMCU + ANN_CCE_MAYOIMCU + ANN_CCE_JUNIIMCU + ANN_CCE_JULIIMCU + ANN_CCE_AGOSIMCU + ANN_CCE_SEPTIMCU + ANN_CCE_OCTUIMCU + ANN_CCE_NOVIIMCU + ANN_CCE_DICIIMCU;
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,1),'MESCOMPA'),'S',NVL(CCE_ENERIMCU,0),0) + 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,2),'MESCOMPA'),'S',NVL(CCE_FEBRIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,3),'MESCOMPA'),'S',NVL(CCE_MARZIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,4),'MESCOMPA'),'S',NVL(CCE_ABRIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,5),'MESCOMPA'),'S',NVL(CCE_MAYOIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,6),'MESCOMPA'),'S',NVL(CCE_JUNIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,7),'MESCOMPA'),'S',NVL(CCE_JULIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,8),'MESCOMPA'),'S',NVL(CCE_AGOSIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,9),'MESCOMPA'),'S',NVL(CCE_SEPTIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,10),'MESCOMPA'),'S',NVL(CCE_OCTUIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,11),'MESCOMPA'),'S',NVL(CCE_NOVIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,12),'MESCOMPA'),'S',NVL(CCE_DICIIMCU,0),0)
                --CPE_ Costes comunes Extremadura
                ANN_CCE_TOTAL,
                --ANN_CCESP_TOTAL := ANN_CCESP_ENERIMCU + ANN_CCESP_FEBRIMCU + ANN_CCESP_MARZIMCU + ANN_CCESP_ABRIIMCU + ANN_CCESP_MAYOIMCU + ANN_CCESP_JUNIIMCU + ANN_CCESP_JULIIMCU + ANN_CCESP_AGOSIMCU + ANN_CCESP_SEPTIMCU + ANN_CCESP_OCTUIMCU + ANN_CCESP_NOVIIMCU + ANN_CCESP_DICIIMCU;
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,1),'MESCOMPA'),'S',NVL(CCESP_ENERIMCU,0),0) + 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,2),'MESCOMPA'),'S',NVL(CCESP_FEBRIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,3),'MESCOMPA'),'S',NVL(CCESP_MARZIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,4),'MESCOMPA'),'S',NVL(CCESP_ABRIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,5),'MESCOMPA'),'S',NVL(CCESP_MAYOIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,6),'MESCOMPA'),'S',NVL(CCESP_JUNIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,7),'MESCOMPA'),'S',NVL(CCESP_JULIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,8),'MESCOMPA'),'S',NVL(CCESP_AGOSIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,9),'MESCOMPA'),'S',NVL(CCESP_SEPTIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,10),'MESCOMPA'),'S',NVL(CCESP_OCTUIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,11),'MESCOMPA'),'S',NVL(CCESP_NOVIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,12),'MESCOMPA'),'S',NVL(CCESP_DICIIMCU,0),0)
                --CCESP_ Costes comunes Extremadura Reparto Pharma
                ANN_CCESP_TOTAL,
                --ANN_CCESM_TOTAL := ANN_CCESM_ENERIMCU + ANN_CCESM_FEBRIMCU + ANN_CCESM_MARZIMCU + ANN_CCESM_ABRIIMCU + ANN_CCESM_MAYOIMCU + ANN_CCESM_JUNIIMCU + ANN_CCESM_JULIIMCU + ANN_CCESM_AGOSIMCU + ANN_CCESM_SEPTIMCU + ANN_CCESM_OCTUIMCU + ANN_CCESM_NOVIIMCU + ANN_CCESM_DICIIMCU;
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,1),'MESCOMPA'),'S',NVL(CCESM_ENERIMCU,0),0) + 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,2),'MESCOMPA'),'S',NVL(CCESM_FEBRIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,3),'MESCOMPA'),'S',NVL(CCESM_MARZIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,4),'MESCOMPA'),'S',NVL(CCESM_ABRIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,5),'MESCOMPA'),'S',NVL(CCESM_MAYOIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,6),'MESCOMPA'),'S',NVL(CCESM_JUNIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,7),'MESCOMPA'),'S',NVL(CCESM_JULIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,8),'MESCOMPA'),'S',NVL(CCESM_AGOSIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,9),'MESCOMPA'),'S',NVL(CCESM_SEPTIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,10),'MESCOMPA'),'S',NVL(CCESM_OCTUIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,11),'MESCOMPA'),'S',NVL(CCESM_NOVIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,12),'MESCOMPA'),'S',NVL(CCESM_DICIIMCU,0),0)
                --CCESM_ Costes comunes Extremadura Reparto Manviel
                ANN_CCESM_TOTAL,
                --ANN_CCESE_TOTAL := ANN_CCESE_ENERIMCU + ANN_CCESE_FEBRIMCU + ANN_CCESE_MARZIMCU + ANN_CCESE_ABRIIMCU + ANN_CCESE_MAYOIMCU + ANN_CCESE_JUNIIMCU + ANN_CCESE_JULIIMCU + ANN_CCESE_AGOSIMCU + ANN_CCESE_SEPTIMCU + ANN_CCESE_OCTUIMCU + ANN_CCESE_NOVIIMCU + ANN_CCESE_DICIIMCU;
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,1),'MESCOMPA'),'S',NVL(CCESE_ENERIMCU,0),0) + 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,2),'MESCOMPA'),'S',NVL(CCESE_FEBRIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,3),'MESCOMPA'),'S',NVL(CCESE_MARZIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,4),'MESCOMPA'),'S',NVL(CCESE_ABRIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,5),'MESCOMPA'),'S',NVL(CCESE_MAYOIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,6),'MESCOMPA'),'S',NVL(CCESE_JUNIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,7),'MESCOMPA'),'S',NVL(CCESE_JULIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,8),'MESCOMPA'),'S',NVL(CCESE_AGOSIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,9),'MESCOMPA'),'S',NVL(CCESE_SEPTIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,10),'MESCOMPA'),'S',NVL(CCESE_OCTUIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,11),'MESCOMPA'),'S',NVL(CCESE_NOVIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,12),'MESCOMPA'),'S',NVL(CCESE_DICIIMCU,0),0)
                --CCESE_ Costes comunes Extremadura Reparto Extremadura
                ANN_CCESE_TOTAL,
                --
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,1),'MESCOMPA'),'S',NVL(CCPSP_ENERIMCU,0),0) + 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,2),'MESCOMPA'),'S',NVL(CCPSP_FEBRIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,3),'MESCOMPA'),'S',NVL(CCPSP_MARZIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,4),'MESCOMPA'),'S',NVL(CCPSP_ABRIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,5),'MESCOMPA'),'S',NVL(CCPSP_MAYOIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,6),'MESCOMPA'),'S',NVL(CCPSP_JUNIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,7),'MESCOMPA'),'S',NVL(CCPSP_JULIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,8),'MESCOMPA'),'S',NVL(CCPSP_AGOSIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,9),'MESCOMPA'),'S',NVL(CCPSP_SEPTIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,10),'MESCOMPA'),'S',NVL(CCPSP_OCTUIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,11),'MESCOMPA'),'S',NVL(CCPSP_NOVIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,12),'MESCOMPA'),'S',NVL(CCPSP_DICIIMCU,0),0) +
                --ANN_CCPSP_TOTAL +    
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,1),'MESCOMPA'),'S',NVL(CCMSP_ENERIMCU,0),0) + 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,2),'MESCOMPA'),'S',NVL(CCMSP_FEBRIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,3),'MESCOMPA'),'S',NVL(CCMSP_MARZIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,4),'MESCOMPA'),'S',NVL(CCMSP_ABRIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,5),'MESCOMPA'),'S',NVL(CCMSP_MAYOIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,6),'MESCOMPA'),'S',NVL(CCMSP_JUNIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,7),'MESCOMPA'),'S',NVL(CCMSP_JULIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,8),'MESCOMPA'),'S',NVL(CCMSP_AGOSIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,9),'MESCOMPA'),'S',NVL(CCMSP_SEPTIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,10),'MESCOMPA'),'S',NVL(CCMSP_OCTUIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,11),'MESCOMPA'),'S',NVL(CCMSP_NOVIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,12),'MESCOMPA'),'S',NVL(CCMSP_DICIIMCU,0),0) +
                --ANN_CCMSP_TOTAL +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,1),'MESCOMPA'),'S',NVL(CCESP_ENERIMCU,0),0) + 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,2),'MESCOMPA'),'S',NVL(CCESP_FEBRIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,3),'MESCOMPA'),'S',NVL(CCESP_MARZIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,4),'MESCOMPA'),'S',NVL(CCESP_ABRIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,5),'MESCOMPA'),'S',NVL(CCESP_MAYOIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,6),'MESCOMPA'),'S',NVL(CCESP_JUNIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,7),'MESCOMPA'),'S',NVL(CCESP_JULIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,8),'MESCOMPA'),'S',NVL(CCESP_AGOSIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,9),'MESCOMPA'),'S',NVL(CCESP_SEPTIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,10),'MESCOMPA'),'S',NVL(CCESP_OCTUIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,11),'MESCOMPA'),'S',NVL(CCESP_NOVIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,12),'MESCOMPA'),'S',NVL(CCESP_DICIIMCU,0),0)
                --ANN_CCESP_TOTAL
                --Total Costes comunes Reparto Pharma
                EST_COCOPHAR,
                --
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,1),'MESCOMPA'),'S',NVL(CCPSM_ENERIMCU,0),0) + 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,2),'MESCOMPA'),'S',NVL(CCPSM_FEBRIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,3),'MESCOMPA'),'S',NVL(CCPSM_MARZIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,4),'MESCOMPA'),'S',NVL(CCPSM_ABRIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,5),'MESCOMPA'),'S',NVL(CCPSM_MAYOIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,6),'MESCOMPA'),'S',NVL(CCPSM_JUNIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,7),'MESCOMPA'),'S',NVL(CCPSM_JULIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,8),'MESCOMPA'),'S',NVL(CCPSM_AGOSIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,9),'MESCOMPA'),'S',NVL(CCPSM_SEPTIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,10),'MESCOMPA'),'S',NVL(CCPSM_OCTUIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,11),'MESCOMPA'),'S',NVL(CCPSM_NOVIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,12),'MESCOMPA'),'S',NVL(CCPSM_DICIIMCU,0),0) + 
                --ANN_CCPSM_TOTAL +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,1),'MESCOMPA'),'S',NVL(CCMSM_ENERIMCU,0),0) + 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,2),'MESCOMPA'),'S',NVL(CCMSM_FEBRIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,3),'MESCOMPA'),'S',NVL(CCMSM_MARZIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,4),'MESCOMPA'),'S',NVL(CCMSM_ABRIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,5),'MESCOMPA'),'S',NVL(CCMSM_MAYOIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,6),'MESCOMPA'),'S',NVL(CCMSM_JUNIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,7),'MESCOMPA'),'S',NVL(CCMSM_JULIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,8),'MESCOMPA'),'S',NVL(CCMSM_AGOSIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,9),'MESCOMPA'),'S',NVL(CCMSM_SEPTIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,10),'MESCOMPA'),'S',NVL(CCMSM_OCTUIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,11),'MESCOMPA'),'S',NVL(CCMSM_NOVIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,12),'MESCOMPA'),'S',NVL(CCMSM_DICIIMCU,0),0) +
                --ANN_CCMSM_TOTAL +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,1),'MESCOMPA'),'S',NVL(CCESM_ENERIMCU,0),0) + 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,2),'MESCOMPA'),'S',NVL(CCESM_FEBRIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,3),'MESCOMPA'),'S',NVL(CCESM_MARZIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,4),'MESCOMPA'),'S',NVL(CCESM_ABRIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,5),'MESCOMPA'),'S',NVL(CCESM_MAYOIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,6),'MESCOMPA'),'S',NVL(CCESM_JUNIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,7),'MESCOMPA'),'S',NVL(CCESM_JULIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,8),'MESCOMPA'),'S',NVL(CCESM_AGOSIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,9),'MESCOMPA'),'S',NVL(CCESM_SEPTIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,10),'MESCOMPA'),'S',NVL(CCESM_OCTUIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,11),'MESCOMPA'),'S',NVL(CCESM_NOVIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,12),'MESCOMPA'),'S',NVL(CCESM_DICIIMCU,0),0)
                --ANN_CCESM_TOTAL
                --Total Costes comunes Reparto Manviel
                EST_COCOMANV,
                --
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,1),'MESCOMPA'),'S',NVL(CCPSE_ENERIMCU,0),0) + 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,2),'MESCOMPA'),'S',NVL(CCPSE_FEBRIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,3),'MESCOMPA'),'S',NVL(CCPSE_MARZIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,4),'MESCOMPA'),'S',NVL(CCPSE_ABRIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,5),'MESCOMPA'),'S',NVL(CCPSE_MAYOIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,6),'MESCOMPA'),'S',NVL(CCPSE_JUNIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,7),'MESCOMPA'),'S',NVL(CCPSE_JULIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,8),'MESCOMPA'),'S',NVL(CCPSE_AGOSIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,9),'MESCOMPA'),'S',NVL(CCPSE_SEPTIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,10),'MESCOMPA'),'S',NVL(CCPSE_OCTUIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,11),'MESCOMPA'),'S',NVL(CCPSE_NOVIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,12),'MESCOMPA'),'S',NVL(CCPSE_DICIIMCU,0),0) + 
                --ANN_CCPSE_TOTAL +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,1),'MESCOMPA'),'S',NVL(CCMSE_ENERIMCU,0),0) + 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,2),'MESCOMPA'),'S',NVL(CCMSE_FEBRIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,3),'MESCOMPA'),'S',NVL(CCMSE_MARZIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,4),'MESCOMPA'),'S',NVL(CCMSE_ABRIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,5),'MESCOMPA'),'S',NVL(CCMSE_MAYOIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,6),'MESCOMPA'),'S',NVL(CCMSE_JUNIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,7),'MESCOMPA'),'S',NVL(CCMSE_JULIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,8),'MESCOMPA'),'S',NVL(CCMSE_AGOSIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,9),'MESCOMPA'),'S',NVL(CCMSE_SEPTIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,10),'MESCOMPA'),'S',NVL(CCMSE_OCTUIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,11),'MESCOMPA'),'S',NVL(CCMSE_NOVIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,12),'MESCOMPA'),'S',NVL(CCMSE_DICIIMCU,0),0) + 
                --ANN_CCMSE_TOTAL +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,1),'MESCOMPA'),'S',NVL(CCESE_ENERIMCU,0),0) + 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,2),'MESCOMPA'),'S',NVL(CCESE_FEBRIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,3),'MESCOMPA'),'S',NVL(CCESE_MARZIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,4),'MESCOMPA'),'S',NVL(CCESE_ABRIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,5),'MESCOMPA'),'S',NVL(CCESE_MAYOIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,6),'MESCOMPA'),'S',NVL(CCESE_JUNIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,7),'MESCOMPA'),'S',NVL(CCESE_JULIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,8),'MESCOMPA'),'S',NVL(CCESE_AGOSIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,9),'MESCOMPA'),'S',NVL(CCESE_SEPTIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,10),'MESCOMPA'),'S',NVL(CCESE_OCTUIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,11),'MESCOMPA'),'S',NVL(CCESE_NOVIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,12),'MESCOMPA'),'S',NVL(CCESE_DICIIMCU,0),0)
                --ANN_CCESE_TOTAL
                --Total Costes comunes Reparto Extermadura
                EST_COCOEXTR,
                --Extremadura
                --CPP_ Coste propio Pharma Mes a Mes
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,1),'MESCOMPA'),'S',CPP_ENERIMCU) CPP_ENERIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,2),'MESCOMPA'),'S',CPP_FEBRIMCU) CPP_FEBRIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,3),'MESCOMPA'),'S',CPP_MARZIMCU) CPP_MARZIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,4),'MESCOMPA'),'S',CPP_ABRIIMCU) CPP_ABRIIMCU,
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,5),'MESCOMPA'),'S',CPP_MAYOIMCU) CPP_MAYOIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,6),'MESCOMPA'),'S',CPP_JUNIIMCU) CPP_JUNIIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,7),'MESCOMPA'),'S',CPP_JULIIMCU) CPP_JULIIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,8),'MESCOMPA'),'S',CPP_AGOSIMCU) CPP_AGOSIMCU,
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,9),'MESCOMPA'),'S',CPP_SEPTIMCU) CPP_SEPTIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,10),'MESCOMPA'),'S',CPP_OCTUIMCU) CPP_OCTUIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,11),'MESCOMPA'),'S',CPP_NOVIIMCU) CPP_NOVIIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,12),'MESCOMPA'),'S',CPP_DICIIMCU) CPP_DICIIMCU,
                --ANN_COPRPHARFormula(rAnnos.Anno);
                --ANN_CPP_TOTAL := ANN_CPP_ENERIMCU + ANN_CPP_FEBRIMCU + ANN_CPP_MARZIMCU + ANN_CPP_ABRIIMCU + ANN_CPP_MAYOIMCU + ANN_CPP_JUNIIMCU + ANN_CPP_JULIIMCU + ANN_CPP_AGOSIMCU + ANN_CPP_SEPTIMCU + ANN_CPP_OCTUIMCU + ANN_CPP_NOVIIMCU + ANN_CPP_DICIIMCU;
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,1),'MESCOMPA'),'S',NVL(CPP_ENERIMCU,0),0) + 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,2),'MESCOMPA'),'S',NVL(CPP_FEBRIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,3),'MESCOMPA'),'S',NVL(CPP_MARZIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,4),'MESCOMPA'),'S',NVL(CPP_ABRIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,5),'MESCOMPA'),'S',NVL(CPP_MAYOIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,6),'MESCOMPA'),'S',NVL(CPP_JUNIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,7),'MESCOMPA'),'S',NVL(CPP_JULIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,8),'MESCOMPA'),'S',NVL(CPP_AGOSIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,9),'MESCOMPA'),'S',NVL(CPP_SEPTIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,10),'MESCOMPA'),'S',NVL(CPP_OCTUIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,11),'MESCOMPA'),'S',NVL(CPP_NOVIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,12),'MESCOMPA'),'S',NVL(CPP_DICIIMCU,0),0)
                --CPP_ Coste propio Pharma
                ANN_CPP_TOTAL,
                --CPM_ Coste propio manviel Mes a Mes
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,1),'MESCOMPA'),'S',CPM_ENERIMCU) CPM_ENERIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,2),'MESCOMPA'),'S',CPM_FEBRIMCU) CPM_FEBRIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,3),'MESCOMPA'),'S',CPM_MARZIMCU) CPM_MARZIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,4),'MESCOMPA'),'S',CPM_ABRIIMCU) CPM_ABRIIMCU,
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,5),'MESCOMPA'),'S',CPM_MAYOIMCU) CPM_MAYOIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,6),'MESCOMPA'),'S',CPM_JUNIIMCU) CPM_JUNIIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,7),'MESCOMPA'),'S',CPM_JULIIMCU) CPM_JULIIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,8),'MESCOMPA'),'S',CPM_AGOSIMCU) CPM_AGOSIMCU,
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,9),'MESCOMPA'),'S',CPM_SEPTIMCU) CPM_SEPTIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,10),'MESCOMPA'),'S',CPM_OCTUIMCU) CPM_OCTUIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,11),'MESCOMPA'),'S',CPM_NOVIIMCU) CPM_NOVIIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,12),'MESCOMPA'),'S',CPM_DICIIMCU) CPM_DICIIMCU,
                --ANN_COPRMANVFormula(rAnnos.Anno);
                --ANN_CPM_TOTAL := ANN_CPM_ENERIMCU + ANN_CPM_FEBRIMCU + ANN_CPM_MARZIMCU + ANN_CPM_ABRIIMCU + ANN_CPM_MAYOIMCU + ANN_CPM_JUNIIMCU + ANN_CPM_JULIIMCU + ANN_CPM_AGOSIMCU + ANN_CPM_SEPTIMCU + ANN_CPM_OCTUIMCU + ANN_CPM_NOVIIMCU + ANN_CPM_DICIIMCU;
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,1),'MESCOMPA'),'S',NVL(CPM_ENERIMCU,0),0) + 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,2),'MESCOMPA'),'S',NVL(CPM_FEBRIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,3),'MESCOMPA'),'S',NVL(CPM_MARZIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,4),'MESCOMPA'),'S',NVL(CPM_ABRIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,5),'MESCOMPA'),'S',NVL(CPM_MAYOIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,6),'MESCOMPA'),'S',NVL(CPM_JUNIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,7),'MESCOMPA'),'S',NVL(CPM_JULIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,8),'MESCOMPA'),'S',NVL(CPM_AGOSIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,9),'MESCOMPA'),'S',NVL(CPM_SEPTIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,10),'MESCOMPA'),'S',NVL(CPM_OCTUIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,11),'MESCOMPA'),'S',NVL(CPM_NOVIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,12),'MESCOMPA'),'S',NVL(CPM_DICIIMCU,0),0)
                --Coste propio manviel
                ANN_CPM_TOTAL,
                --Extremadura
                --CPE_ Coste propio Extemadura Mes a Mes
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,1),'MESCOMPA'),'S',CPE_ENERIMCU) CPE_ENERIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,2),'MESCOMPA'),'S',CPE_FEBRIMCU) CPE_FEBRIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,3),'MESCOMPA'),'S',CPE_MARZIMCU) CPE_MARZIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,4),'MESCOMPA'),'S',CPE_ABRIIMCU) CPE_ABRIIMCU,
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,5),'MESCOMPA'),'S',CPE_MAYOIMCU) CPE_MAYOIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,6),'MESCOMPA'),'S',CPE_JUNIIMCU) CPE_JUNIIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,7),'MESCOMPA'),'S',CPE_JULIIMCU) CPE_JULIIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,8),'MESCOMPA'),'S',CPE_AGOSIMCU) CPE_AGOSIMCU,
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,9),'MESCOMPA'),'S',CPE_SEPTIMCU) CPE_SEPTIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,10),'MESCOMPA'),'S',CPE_OCTUIMCU) CPE_OCTUIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,11),'MESCOMPA'),'S',CPE_NOVIIMCU) CPE_NOVIIMCU, 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,12),'MESCOMPA'),'S',CPE_DICIIMCU) CPE_DICIIMCU,
                --ANN_COPREXTRFormula(rAnnos.Anno);
                --ANN_CPE_TOTAL := ANN_CPE_ENERIMCU + ANN_CPE_FEBRIMCU + ANN_CPE_MARZIMCU + ANN_CPE_ABRIIMCU + ANN_CPE_MAYOIMCU + ANN_CPE_JUNIIMCU + ANN_CPE_JULIIMCU + ANN_CPE_AGOSIMCU + ANN_CPE_SEPTIMCU + ANN_CPE_OCTUIMCU + ANN_CPE_NOVIIMCU + ANN_CPE_DICIIMCU;
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,1),'MESCOMPA'),'S',NVL(CPE_ENERIMCU,0),0) + 
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,2),'MESCOMPA'),'S',NVL(CPE_FEBRIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,3),'MESCOMPA'),'S',NVL(CPE_MARZIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,4),'MESCOMPA'),'S',NVL(CPE_ABRIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,5),'MESCOMPA'),'S',NVL(CPE_MAYOIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,6),'MESCOMPA'),'S',NVL(CPE_JUNIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,7),'MESCOMPA'),'S',NVL(CPE_JULIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,8),'MESCOMPA'),'S',NVL(CPE_AGOSIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,9),'MESCOMPA'),'S',NVL(CPE_SEPTIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,10),'MESCOMPA'),'S',NVL(CPE_OCTUIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,11),'MESCOMPA'),'S',NVL(CPE_NOVIIMCU,0),0) +
                DECODE(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(EST.ANNO,12),'MESCOMPA'),'S',NVL(CPE_DICIIMCU,0),0)
                --CPP_ Coste propio Extremadura
                ANN_CPE_TOTAL
                --Extremadura
                /*
                --
               IF rEstructuras.TIPOCOST IS NOT NULL THEN
                  nEST_CF_CM_TOTAL := EST_CM_TOTAL;
                  nEST_CF_CM_PHARMA := EST_CM_PHARMA;
                  nEST_CF_CM_MANVIEL := EST_CM_MANVIEL;
                  --Enteco Extremadura
                  nEST_CF_CM_EXTREMADURA := EST_CM_EXTREMADURA;
                  --Enteco Extremadura
                  nEST_CF_CPP_TOTAL := EST_CPP_TOTAL;
                  nEST_CF_CPM_TOTAL := EST_CPM_TOTAL;
                  --Enteco Extremadura
                  nEST_CF_CPE_TOTAL := EST_CPE_TOTAL;
                  --Enteco Extremadura
               ELSE
                  nEST_CF_CPM_TOTAL := EST_CPM_TOTAL_RRHH_05;
                  nEST_CF_CPP_TOTAL := EST_CPP_TOTAL_RRHH_10;
                  --Enteco Extremadura
                  nEST_CF_CPE_TOTAL := EST_CPE_TOTAL_RRHH_35;
                  --Enteco Extremadura
                  nEST_CF_CM_MANVIEL := EST_CM_MANVIEL_RRHH_05;
                  --Enteco Extremadura
                  nEST_CF_CM_EXTREMADURA := EST_CM_EXTREMADURA_RRHH_35;
                  --Enteco Extremadura
                  nEST_CF_CM_PHARMA := EST_CM_PHARMA_RRHH_10;
                  nEST_CF_CM_TOTAL := EST_CM_TOTAL_RRHH_01;
               END IF;
                */
                --nEST_TOTAPHAR := nEST_CF_CPP_TOTAL + nEST_CF_CM_PHARMA + EST_COCOPHAR;
   	            --nEST_TOTAMANV := nEST_CF_CPM_TOTAL + nEST_CF_CM_MANVIEL + EST_COCOMANV;
   	            --nEST_TOTAEXTR := nEST_CF_CPE_TOTAL + nEST_CF_CM_EXTREMADURA + EST_COCOEXTR;
         FROM (SELECT A.ANNO, EST.ESTRUCTU, EST.DEPARTAM, EST.SECCION, EST.SECCAUXI, EST.TIPOCOST FROM
              (SELECT EC.ESTRUCTU, EC.DEPARTAM, EC.SECCION, EC.SECCAUXI, EC.TIPOCOST
               FROM GNR_ESCCEMPR EC
               WHERE NOT EXISTS (SELECT 'X' FROM VALORES_LISTA EX WHERE EX.CODIGO = 'ANE_ESTREXCR' AND P_UTILIDAD.F_ValoCampo(EX.VALOR,'ESTRUCTURA') = EC.ESTRUCTU)
               GROUP BY EC.ESTRUCTU, EC.DEPARTAM, EC.SECCION, EC.SECCAUXI, EC.TIPOCOST
               UNION
               SELECT P_UTILIDAD.F_ValoCampo(EX.VALOR,'ESTRUCTURA') ESTRUCTU, DE.CODIGO DEPARTAM, SD.SECCION, NULL SECCAUXI, NULL TIPOCOST
               FROM VALORES_LISTA EX, GNR_DEPAEMPR DE, GNR_SPDEEMPR SD, GNR_SEPREMPR SP
               WHERE EX.CODIGO = 'ANE_ESTREXCR'
                 AND P_UTILIDAD.F_ValoCampo(EX.VALOR,'LISTADOS') = 'S'
                 AND DE.CODIGO != P_UTILIDAD.F_VALODEVA('CODESIDE')
                 --
                 AND DE.CODIGO = SD.DEPARTAM
                 AND SD.SECCION = SP.CODIGO
              ) EST,
              (SELECT DISTINCT ANNO FROM ANE_CODEANNO
               WHERE EMPRESA IN (SELECT VALOR FROM VALORES_LISTA WHERE CODIGO = 'GNR_EMPRACGR')) A) EST,--Estructuras Existentes
              GNR_DEPAEMPR D, GNR_SEPREMPR S, GNR_SEAUEMPR SA, GNR_TICOEMPR TC,
              --Importes de las cuentas asociadas a las estructuras mes a mes de Enteco Gestion para Costes de la Matriz
              (SELECT EC.ANNO,
                      EC.ESTRUCTU, EC.DEPARTAM, EC.SECCION, EC.SECCAUXI, EC.TIPOCOST,
                SUM(CREN.IMPOCUEN) CM_ENERIMCU, SUM(CRFE.IMPOCUEN) CM_FEBRIMCU, SUM(CRMA.IMPOCUEN) CM_MARZIMCU, SUM(CRAB.IMPOCUEN) CM_ABRIIMCU,
                SUM(CRMY.IMPOCUEN) CM_MAYOIMCU, SUM(CRJU.IMPOCUEN) CM_JUNIIMCU, SUM(CRJL.IMPOCUEN) CM_JULIIMCU, SUM(CRAG.IMPOCUEN) CM_AGOSIMCU,
                SUM(CRSE.IMPOCUEN) CM_SEPTIMCU, SUM(CROC.IMPOCUEN) CM_OCTUIMCU, SUM(CRNO.IMPOCUEN) CM_NOVIIMCU, SUM(CRDI.IMPOCUEN) CM_DICIIMCU
               FROM (SELECT A.ANNO,EC.EMPRESA,EC.CUENCONT,EC.DEPARTAM,EC.SECCION,EC.SECCAUXI,EC.TIPOCOST,EC.TIIMCOST,EC.INDUCTOR,EC.INDUCOMU,EC.ESTRUCTU,EC.TIPOORIG,EC.TIPOCATE,EC.INDUREPA
                     FROM GNR_ESCCEMPR EC,
                          (SELECT DISTINCT ANNO FROM ANE_CODEANNO
                           WHERE EMPRESA IN (SELECT VALOR FROM VALORES_LISTA WHERE CODIGO = 'GNR_EMPRACGR')) A) EC,
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'ENERO') CREN,
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'FEBRERO') CRFE,
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'MARZO') CRMA,
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'ABRIL') CRAB,
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'MAYO') CRMY,
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'JUNIO') CRJU,
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'JULIO') CRJL,
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'AGOSTO') CRAG,
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'SEPTIEMBRE') CRSE,
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'OCTUBRE') CROC,
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'NOVIEMBRE') CRNO,
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'DICIEMBRE') CRDI
               WHERE EC.EMPRESA = CREN.EMPRESA(+)
                 AND EC.ANNO = CREN.ANNO(+)
                 AND EC.CUENCONT = CREN.CUENCONT(+)
                 AND EC.EMPRESA = CRFE.EMPRESA(+)
                 AND EC.ANNO = CRFE.ANNO(+)
                 AND EC.CUENCONT = CRFE.CUENCONT(+)
                 AND EC.EMPRESA = CRMA.EMPRESA(+)
                 AND EC.ANNO = CRMA.ANNO(+)
                 AND EC.CUENCONT = CRMA.CUENCONT(+)
                 AND EC.EMPRESA = CRAB.EMPRESA(+)
                 AND EC.ANNO = CRAB.ANNO(+)
                 AND EC.CUENCONT = CRAB.CUENCONT(+)
                 AND EC.EMPRESA = CRMY.EMPRESA(+)
                 AND EC.ANNO = CRMY.ANNO(+)
                 AND EC.CUENCONT = CRMY.CUENCONT(+)
                 AND EC.EMPRESA = CRJU.EMPRESA(+)
                 AND EC.ANNO = CRJU.ANNO(+)
                 AND EC.CUENCONT = CRJU.CUENCONT(+)
                 AND EC.EMPRESA = CRJL.EMPRESA(+)
                 AND EC.ANNO = CRJL.ANNO(+)
                 AND EC.CUENCONT = CRJL.CUENCONT(+)
                 AND EC.EMPRESA = CRAG.EMPRESA(+)
                 AND EC.ANNO = CRAG.ANNO(+)
                 AND EC.CUENCONT = CRAG.CUENCONT(+)
                 AND EC.EMPRESA = CRSE.EMPRESA(+)
                 AND EC.ANNO = CRSE.ANNO(+)
                 AND EC.CUENCONT = CRSE.CUENCONT(+)
                 AND EC.EMPRESA = CROC.EMPRESA(+)
                 AND EC.ANNO = CROC.ANNO(+)
                 AND EC.CUENCONT = CROC.CUENCONT(+)
                 AND EC.EMPRESA = CRNO.EMPRESA(+)
                 AND EC.ANNO = CRNO.ANNO(+)
                 AND EC.CUENCONT = CRNO.CUENCONT(+)
                 AND EC.EMPRESA = CRDI.EMPRESA(+)
                 AND EC.ANNO = CRDI.ANNO(+)
                 AND EC.CUENCONT = CRDI.CUENCONT(+)
                 AND NOT EXISTS (SELECT 'X' FROM VALORES_LISTA EX WHERE EX.CODIGO = 'ANE_ESTREXCR' AND P_UTILIDAD.F_ValoCampo(EX.VALOR,'ESTRUCTURA') = EC.ESTRUCTU)
                 AND EC.EMPRESA = P_UTILIDAD.F_VALODEVA('EMPRGEST')--vEmprGest
               GROUP BY EC.ANNO,
                        EC.ESTRUCTU, EC.DEPARTAM, EC.SECCION, EC.SECCAUXI, EC.TIPOCOST
              ) CM,--Costes de la Matriz
              (SELECT EC.ANNO,
                EC.ESTRUCTU, EC.DEPARTAM, EC.SECCION, EC.SECCAUXI, EC.TIPOCOST,
                SUM(CREN.IMPOCUEN) CCP_ENERIMCU, SUM(CREN.IMPOCUEN * IENE.PORCSUR1) CCPSP_ENERIMCU, SUM(CREN.IMPOCUEN * IENE.PORCSUR2) CCPSM_ENERIMCU, SUM(CREN.IMPOCUEN * IENE.PORCSUR3) CCPSE_ENERIMCU,
                SUM(CRFE.IMPOCUEN) CCP_FEBRIMCU, SUM(CRFE.IMPOCUEN * IFEB.PORCSUR1) CCPSP_FEBRIMCU, SUM(CRFE.IMPOCUEN * IFEB.PORCSUR2) CCPSM_FEBRIMCU, SUM(CRFE.IMPOCUEN * IFEB.PORCSUR3) CCPSE_FEBRIMCU,
                SUM(CRMA.IMPOCUEN) CCP_MARZIMCU, SUM(CRMA.IMPOCUEN * IMAR.PORCSUR1) CCPSP_MARZIMCU, SUM(CRMA.IMPOCUEN * IMAR.PORCSUR2) CCPSM_MARZIMCU, SUM(CRMA.IMPOCUEN * IMAR.PORCSUR3) CCPSE_MARZIMCU,
                SUM(CRAB.IMPOCUEN) CCP_ABRIIMCU, SUM(CRAB.IMPOCUEN * IABR.PORCSUR1) CCPSP_ABRIIMCU, SUM(CRAB.IMPOCUEN * IABR.PORCSUR2) CCPSM_ABRIIMCU, SUM(CRAB.IMPOCUEN * IABR.PORCSUR3) CCPSE_ABRIIMCU,
                SUM(CRMY.IMPOCUEN) CCP_MAYOIMCU, SUM(CRMY.IMPOCUEN * IMAY.PORCSUR1) CCPSP_MAYOIMCU, SUM(CRMY.IMPOCUEN * IMAY.PORCSUR2) CCPSM_MAYOIMCU, SUM(CRMY.IMPOCUEN * IMAY.PORCSUR3) CCPSE_MAYOIMCU,
                SUM(CRJU.IMPOCUEN) CCP_JUNIIMCU, SUM(CRJU.IMPOCUEN * IJUN.PORCSUR1) CCPSP_JUNIIMCU, SUM(CRJU.IMPOCUEN * IJUN.PORCSUR2) CCPSM_JUNIIMCU, SUM(CRJU.IMPOCUEN * IJUN.PORCSUR3) CCPSE_JUNIIMCU,
                SUM(CRJL.IMPOCUEN) CCP_JULIIMCU, SUM(CRJL.IMPOCUEN * IJUL.PORCSUR1) CCPSP_JULIIMCU, SUM(CRJL.IMPOCUEN * IJUL.PORCSUR2) CCPSM_JULIIMCU, SUM(CRJL.IMPOCUEN * IJUL.PORCSUR3) CCPSE_JULIIMCU,
                SUM(CRAG.IMPOCUEN) CCP_AGOSIMCU, SUM(CRAG.IMPOCUEN * IAGO.PORCSUR1) CCPSP_AGOSIMCU, SUM(CRAG.IMPOCUEN * IAGO.PORCSUR2) CCPSM_AGOSIMCU, SUM(CRAG.IMPOCUEN * IAGO.PORCSUR3) CCPSE_AGOSIMCU,
                SUM(CRSE.IMPOCUEN) CCP_SEPTIMCU, SUM(CRSE.IMPOCUEN * ISEP.PORCSUR1) CCPSP_SEPTIMCU, SUM(CRSE.IMPOCUEN * ISEP.PORCSUR2) CCPSM_SEPTIMCU, SUM(CRSE.IMPOCUEN * ISEP.PORCSUR3) CCPSE_SEPTIMCU,
                SUM(CROC.IMPOCUEN) CCP_OCTUIMCU, SUM(CROC.IMPOCUEN * IOCT.PORCSUR1) CCPSP_OCTUIMCU, SUM(CROC.IMPOCUEN * IOCT.PORCSUR2) CCPSM_OCTUIMCU, SUM(CROC.IMPOCUEN * IOCT.PORCSUR3) CCPSE_OCTUIMCU,
                SUM(CRNO.IMPOCUEN) CCP_NOVIIMCU, SUM(CRNO.IMPOCUEN * INOV.PORCSUR1) CCPSP_NOVIIMCU, SUM(CRNO.IMPOCUEN * INOV.PORCSUR2) CCPSM_NOVIIMCU, SUM(CRNO.IMPOCUEN * INOV.PORCSUR3) CCPSE_NOVIIMCU,
                SUM(CRDI.IMPOCUEN) CCP_DICIIMCU, SUM(CRDI.IMPOCUEN * IDIC.PORCSUR1) CCPSP_DICIIMCU, SUM(CRDI.IMPOCUEN * IDIC.PORCSUR2) CCPSM_DICIIMCU, SUM(CRDI.IMPOCUEN * IDIC.PORCSUR3) CCPSE_DICIIMCU
               FROM (SELECT A.ANNO, EC.EMPRESA,EC.CUENCONT,EC.DEPARTAM,EC.SECCION,EC.SECCAUXI,EC.TIPOCOST,EC.TIIMCOST,EC.INDUCTOR,EC.INDUCOMU,EC.ESTRUCTU,EC.TIPOORIG,EC.TIPOCATE,EC.INDUREPA
                     FROM GNR_ESCCEMPR EC,
                          (SELECT DISTINCT ANNO FROM ANE_CODEANNO
                           WHERE EMPRESA IN (SELECT VALOR FROM VALORES_LISTA WHERE CODIGO = 'GNR_EMPRACGR')) A) EC, 
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'ENERO') CREN,
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'FEBRERO') CRFE,
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'MARZO') CRMA,
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'ABRIL') CRAB,
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'MAYO') CRMY,
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'JUNIO') CRJU,
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'JULIO') CRJL,
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'AGOSTO') CRAG,
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'SEPTIEMBRE') CRSE,
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'OCTUBRE') CROC,
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'NOVIEMBRE') CRNO,
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'DICIEMBRE') CRDI,
                    ANE_VAINRECO IENE, ANE_VAINRECO IFEB, ANE_VAINRECO IMAR, ANE_VAINRECO IABR,
                    ANE_VAINRECO IMAY, ANE_VAINRECO IJUN, ANE_VAINRECO IJUL, ANE_VAINRECO IAGO,
                    ANE_VAINRECO ISEP, ANE_VAINRECO IOCT, ANE_VAINRECO INOV, ANE_VAINRECO IDIC
               WHERE EC.EMPRESA = CREN.EMPRESA(+)
                 AND EC.ANNO = CREN.ANNO(+)
                 AND EC.CUENCONT = CREN.CUENCONT(+)
                 AND EC.EMPRESA = CRFE.EMPRESA(+)
                 AND EC.ANNO = CRFE.ANNO(+)
                 AND EC.CUENCONT = CRFE.CUENCONT(+)
                 AND EC.EMPRESA = CRMA.EMPRESA(+)
                 AND EC.ANNO = CRMA.ANNO(+)
                 AND EC.CUENCONT = CRMA.CUENCONT(+)
                 AND EC.EMPRESA = CRAB.EMPRESA(+)
                 AND EC.ANNO = CRAB.ANNO(+)
                 AND EC.CUENCONT = CRAB.CUENCONT(+)
                 AND EC.EMPRESA = CRMY.EMPRESA(+)
                 AND EC.ANNO = CRMY.ANNO(+)
                 AND EC.CUENCONT = CRMY.CUENCONT(+)
                 AND EC.EMPRESA = CRJU.EMPRESA(+)
                 AND EC.ANNO = CRJU.ANNO(+)
                 AND EC.CUENCONT = CRJU.CUENCONT(+)
                 AND EC.EMPRESA = CRJL.EMPRESA(+)
                 AND EC.ANNO = CRJL.ANNO(+)
                 AND EC.CUENCONT = CRJL.CUENCONT(+)
                 AND EC.EMPRESA = CRAG.EMPRESA(+)
                 AND EC.ANNO = CRAG.ANNO(+)
                 AND EC.CUENCONT = CRAG.CUENCONT(+)
                 AND EC.EMPRESA = CRSE.EMPRESA(+)
                 AND EC.ANNO = CRSE.ANNO(+)
                 AND EC.CUENCONT = CRSE.CUENCONT(+)
                 AND EC.EMPRESA = CROC.EMPRESA(+)
                 AND EC.ANNO = CROC.ANNO(+)
                 AND EC.CUENCONT = CROC.CUENCONT(+)
                 AND EC.EMPRESA = CRNO.EMPRESA(+)
                 AND EC.ANNO = CRNO.ANNO(+)
                 AND EC.CUENCONT = CRNO.CUENCONT(+)
                 AND EC.EMPRESA = CRDI.EMPRESA(+)
                 AND EC.ANNO = CRDI.ANNO(+)
                 AND EC.CUENCONT = CRDI.CUENCONT(+)
                 AND EC.INDUREPA = IENE.INDUREPA(+)
                 AND IENE.ANNO(+) = EC.ANNO
                 AND IENE.MES(+) = 'ENERO'
                 AND IENE.TIPO(+) = 'R'
                 AND EC.INDUREPA = IFEB.INDUREPA(+)
                 AND IFEB.ANNO(+) = EC.ANNO
                 AND IFEB.MES(+) = 'FEBRERO'
                 AND IFEB.TIPO(+) = 'R'
                 AND EC.INDUREPA = IMAR.INDUREPA(+)
                 AND IMAR.ANNO(+) = EC.ANNO
                 AND IMAR.MES(+) = 'MARZO'
                 AND IMAR.TIPO(+) = 'R'
                 AND EC.INDUREPA = IABR.INDUREPA(+)
                 AND IABR.ANNO(+) = EC.ANNO
                 AND IABR.MES(+) = 'ABRIL'
                 AND IABR.TIPO(+) = 'R'
                 AND EC.INDUREPA = IMAY.INDUREPA(+)
                 AND IMAY.ANNO(+) = EC.ANNO
                 AND IMAY.MES(+) = 'MAYO'
                 AND IMAY.TIPO(+) = 'R'
                 AND EC.INDUREPA = IJUN.INDUREPA(+)
                 AND IJUN.ANNO(+) = EC.ANNO
                 AND IJUN.MES(+) = 'JUNIO'
                 AND IJUN.TIPO(+) = 'R'
                 AND EC.INDUREPA = IJUL.INDUREPA(+)
                 AND IJUL.ANNO(+) = EC.ANNO
                 AND IJUL.MES(+) = 'JULIO'
                 AND IJUL.TIPO(+) = 'R'
                 AND EC.INDUREPA = IAGO.INDUREPA(+)
                 AND IAGO.ANNO(+) = EC.ANNO
                 AND IAGO.MES(+) = 'AGOSTO'
                 AND IAGO.TIPO(+) = 'R'
                 AND EC.INDUREPA = ISEP.INDUREPA(+)
                 AND ISEP.ANNO(+) = EC.ANNO
                 AND ISEP.MES(+) = 'SEPTIEMBRE'
                 AND ISEP.TIPO(+) = 'R'
                 AND EC.INDUREPA = IOCT.INDUREPA(+)
                 AND IOCT.ANNO(+) = EC.ANNO
                 AND IOCT.MES(+) = 'OCTUBRE'
                 AND IOCT.TIPO(+) = 'R'
                 AND EC.INDUREPA = INOV.INDUREPA(+)
                 AND INOV.ANNO(+) = EC.ANNO
                 AND INOV.MES(+) = 'NOVIEMBRE'
                 AND INOV.TIPO(+) = 'R'
                 AND EC.INDUREPA = IDIC.INDUREPA(+)
                 AND IDIC.ANNO(+) = EC.ANNO
                 AND IDIC.MES(+) = 'DICIEMBRE'
                 AND IDIC.TIPO(+) = 'R'
                 AND NOT EXISTS (SELECT 'X' FROM VALORES_LISTA EX WHERE EX.CODIGO = 'ANE_ESTREXCR' AND P_UTILIDAD.F_ValoCampo(EX.VALOR,'ESTRUCTURA') = EC.ESTRUCTU)
                 AND EC.EMPRESA = P_UTILIDAD.F_VALODEVA('EMPRPHAR')--vEmprPhar
                 AND EC.TIPOCATE = P_UTILIDAD.F_VALODEVA('TIPOCACC')--vTIPOCACC
               GROUP BY EC.ANNO,
                        EC.ESTRUCTU, EC.DEPARTAM, EC.SECCION, EC.SECCAUXI, EC.TIPOCOST
              ) CCP,--Costes Comnues Pharma
              (SELECT EC.ANNO,
                      EC.ESTRUCTU, EC.DEPARTAM, EC.SECCION, EC.SECCAUXI, EC.TIPOCOST,
                SUM(CREN.IMPOCUEN) CCM_ENERIMCU, SUM(CREN.IMPOCUEN * IENE.PORCSUR1) CCMSP_ENERIMCU, SUM(CREN.IMPOCUEN * IENE.PORCSUR2) CCMSM_ENERIMCU, SUM(CREN.IMPOCUEN * IENE.PORCSUR3) CCMSE_ENERIMCU,
                SUM(CRFE.IMPOCUEN) CCM_FEBRIMCU, SUM(CRFE.IMPOCUEN * IFEB.PORCSUR1) CCMSP_FEBRIMCU, SUM(CRFE.IMPOCUEN * IFEB.PORCSUR2) CCMSM_FEBRIMCU, SUM(CRFE.IMPOCUEN * IFEB.PORCSUR3) CCMSE_FEBRIMCU,
                SUM(CRMA.IMPOCUEN) CCM_MARZIMCU, SUM(CRMA.IMPOCUEN * IMAR.PORCSUR1) CCMSP_MARZIMCU, SUM(CRMA.IMPOCUEN * IMAR.PORCSUR2) CCMSM_MARZIMCU, SUM(CRMA.IMPOCUEN * IMAR.PORCSUR3) CCMSE_MARZIMCU,
                SUM(CRAB.IMPOCUEN) CCM_ABRIIMCU, SUM(CRAB.IMPOCUEN * IABR.PORCSUR1) CCMSP_ABRIIMCU, SUM(CRAB.IMPOCUEN * IABR.PORCSUR2) CCMSM_ABRIIMCU, SUM(CRAB.IMPOCUEN * IABR.PORCSUR3) CCMSE_ABRIIMCU,
                SUM(CRMY.IMPOCUEN) CCM_MAYOIMCU, SUM(CRMY.IMPOCUEN * IMAY.PORCSUR1) CCMSP_MAYOIMCU, SUM(CRMY.IMPOCUEN * IMAY.PORCSUR2) CCMSM_MAYOIMCU, SUM(CRMY.IMPOCUEN * IMAY.PORCSUR3) CCMSE_MAYOIMCU,
                SUM(CRJU.IMPOCUEN) CCM_JUNIIMCU, SUM(CRJU.IMPOCUEN * IJUN.PORCSUR1) CCMSP_JUNIIMCU, SUM(CRJU.IMPOCUEN * IJUN.PORCSUR2) CCMSM_JUNIIMCU, SUM(CRJU.IMPOCUEN * IJUN.PORCSUR3) CCMSE_JUNIIMCU,
                SUM(CRJL.IMPOCUEN) CCM_JULIIMCU, SUM(CRJL.IMPOCUEN * IJUL.PORCSUR1) CCMSP_JULIIMCU, SUM(CRJL.IMPOCUEN * IJUL.PORCSUR2) CCMSM_JULIIMCU, SUM(CRJL.IMPOCUEN * IJUL.PORCSUR3) CCMSE_JULIIMCU,
                SUM(CRAG.IMPOCUEN) CCM_AGOSIMCU, SUM(CRAG.IMPOCUEN * IAGO.PORCSUR1) CCMSP_AGOSIMCU, SUM(CRAG.IMPOCUEN * IAGO.PORCSUR2) CCMSM_AGOSIMCU, SUM(CRAG.IMPOCUEN * IAGO.PORCSUR3) CCMSE_AGOSIMCU,
                SUM(CRSE.IMPOCUEN) CCM_SEPTIMCU, SUM(CRSE.IMPOCUEN * ISEP.PORCSUR1) CCMSP_SEPTIMCU, SUM(CRSE.IMPOCUEN * ISEP.PORCSUR2) CCMSM_SEPTIMCU, SUM(CRSE.IMPOCUEN * ISEP.PORCSUR3) CCMSE_SEPTIMCU,
                SUM(CROC.IMPOCUEN) CCM_OCTUIMCU, SUM(CROC.IMPOCUEN * IOCT.PORCSUR1) CCMSP_OCTUIMCU, SUM(CROC.IMPOCUEN * IOCT.PORCSUR2) CCMSM_OCTUIMCU, SUM(CROC.IMPOCUEN * IOCT.PORCSUR3) CCMSE_OCTUIMCU,
                SUM(CRNO.IMPOCUEN) CCM_NOVIIMCU, SUM(CRNO.IMPOCUEN * INOV.PORCSUR1) CCMSP_NOVIIMCU, SUM(CRNO.IMPOCUEN * INOV.PORCSUR2) CCMSM_NOVIIMCU, SUM(CRNO.IMPOCUEN * INOV.PORCSUR3) CCMSE_NOVIIMCU,
                SUM(CRDI.IMPOCUEN) CCM_DICIIMCU, SUM(CRDI.IMPOCUEN * IDIC.PORCSUR1) CCMSP_DICIIMCU, SUM(CRDI.IMPOCUEN * IDIC.PORCSUR2) CCMSM_DICIIMCU, SUM(CRDI.IMPOCUEN * IDIC.PORCSUR3) CCMSE_DICIIMCU
               FROM (SELECT A.ANNO, EC.EMPRESA,EC.CUENCONT,EC.DEPARTAM,EC.SECCION,EC.SECCAUXI,EC.TIPOCOST,EC.TIIMCOST,EC.INDUCTOR,EC.INDUCOMU,EC.ESTRUCTU,EC.TIPOORIG,EC.TIPOCATE,EC.INDUREPA
                     FROM GNR_ESCCEMPR EC,
                          (SELECT DISTINCT ANNO FROM ANE_CODEANNO
                           WHERE EMPRESA IN (SELECT VALOR FROM VALORES_LISTA WHERE CODIGO = 'GNR_EMPRACGR')) A) EC, 
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'ENERO') CREN,
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'FEBRERO') CRFE,
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'MARZO') CRMA,
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'ABRIL') CRAB,
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'MAYO') CRMY,
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'JUNIO') CRJU,
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'JULIO') CRJL,
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'AGOSTO') CRAG,
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'SEPTIEMBRE') CRSE,
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'OCTUBRE') CROC,
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'NOVIEMBRE') CRNO,
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'DICIEMBRE') CRDI,
                    ANE_VAINRECO IENE, ANE_VAINRECO IFEB, ANE_VAINRECO IMAR, ANE_VAINRECO IABR,
                    ANE_VAINRECO IMAY, ANE_VAINRECO IJUN, ANE_VAINRECO IJUL, ANE_VAINRECO IAGO,
                    ANE_VAINRECO ISEP, ANE_VAINRECO IOCT, ANE_VAINRECO INOV, ANE_VAINRECO IDIC
               WHERE EC.EMPRESA = CREN.EMPRESA(+)
                 AND EC.ANNO = CREN.ANNO(+)
                 AND EC.CUENCONT = CREN.CUENCONT(+)
                 AND EC.EMPRESA = CRFE.EMPRESA(+)
                 AND EC.ANNO = CRFE.ANNO(+)
                 AND EC.CUENCONT = CRFE.CUENCONT(+)
                 AND EC.EMPRESA = CRMA.EMPRESA(+)
                 AND EC.ANNO = CRMA.ANNO(+)
                 AND EC.CUENCONT = CRMA.CUENCONT(+)
                 AND EC.EMPRESA = CRAB.EMPRESA(+)
                 AND EC.ANNO = CRAB.ANNO(+)
                 AND EC.CUENCONT = CRAB.CUENCONT(+)
                 AND EC.EMPRESA = CRMY.EMPRESA(+)
                 AND EC.ANNO = CRMY.ANNO(+)
                 AND EC.CUENCONT = CRMY.CUENCONT(+)
                 AND EC.EMPRESA = CRJU.EMPRESA(+)
                 AND EC.ANNO = CRJU.ANNO(+)
                 AND EC.CUENCONT = CRJU.CUENCONT(+)
                 AND EC.EMPRESA = CRJL.EMPRESA(+)
                 AND EC.ANNO = CRJL.ANNO(+)
                 AND EC.CUENCONT = CRJL.CUENCONT(+)
                 AND EC.EMPRESA = CRAG.EMPRESA(+)
                 AND EC.ANNO = CRAG.ANNO(+)
                 AND EC.CUENCONT = CRAG.CUENCONT(+)
                 AND EC.EMPRESA = CRSE.EMPRESA(+)
                 AND EC.ANNO = CRSE.ANNO(+)
                 AND EC.CUENCONT = CRSE.CUENCONT(+)
                 AND EC.EMPRESA = CROC.EMPRESA(+)
                 AND EC.ANNO = CROC.ANNO(+)
                 AND EC.CUENCONT = CROC.CUENCONT(+)
                 AND EC.EMPRESA = CRNO.EMPRESA(+)
                 AND EC.ANNO = CRNO.ANNO(+)
                 AND EC.CUENCONT = CRNO.CUENCONT(+)
                 AND EC.EMPRESA = CRDI.EMPRESA(+)
                 AND EC.ANNO = CRDI.ANNO(+)
                 AND EC.CUENCONT = CRDI.CUENCONT(+)
                 AND EC.INDUREPA = IENE.INDUREPA(+)
                 AND IENE.ANNO(+) = EC.ANNO
                 AND IENE.MES(+) = 'ENERO'
                 AND IENE.TIPO(+) = 'R'
                 AND EC.INDUREPA = IFEB.INDUREPA(+)
                 AND IFEB.ANNO(+) = EC.ANNO
                 AND IFEB.MES(+) = 'FEBRERO'
                 AND IFEB.TIPO(+) = 'R'
                 AND EC.INDUREPA = IMAR.INDUREPA(+)
                 AND IMAR.ANNO(+) = EC.ANNO
                 AND IMAR.MES(+) = 'MARZO'
                 AND IMAR.TIPO(+) = 'R'
                 AND EC.INDUREPA = IABR.INDUREPA(+)
                 AND IABR.ANNO(+) = EC.ANNO
                 AND IABR.MES(+) = 'ABRIL'
                 AND IABR.TIPO(+) = 'R'
                 AND EC.INDUREPA = IMAY.INDUREPA(+)
                 AND IMAY.ANNO(+) = EC.ANNO
                 AND IMAY.MES(+) = 'MAYO'
                 AND IMAY.TIPO(+) = 'R'
                 AND EC.INDUREPA = IJUN.INDUREPA(+)
                 AND IJUN.ANNO(+) = EC.ANNO
                 AND IJUN.MES(+) = 'JUNIO'
                 AND IJUN.TIPO(+) = 'R'
                 AND EC.INDUREPA = IJUL.INDUREPA(+)
                 AND IJUL.ANNO(+) = EC.ANNO
                 AND IJUL.MES(+) = 'JULIO'
                 AND IJUL.TIPO(+) = 'R'
                 AND EC.INDUREPA = IAGO.INDUREPA(+)
                 AND IAGO.ANNO(+) = EC.ANNO
                 AND IAGO.MES(+) = 'AGOSTO'
                 AND IAGO.TIPO(+) = 'R'
                 AND EC.INDUREPA = ISEP.INDUREPA(+)
                 AND ISEP.ANNO(+) = EC.ANNO
                 AND ISEP.MES(+) = 'SEPTIEMBRE'
                 AND ISEP.TIPO(+) = 'R'
                 AND EC.INDUREPA = IOCT.INDUREPA(+)
                 AND IOCT.ANNO(+) = EC.ANNO
                 AND IOCT.MES(+) = 'OCTUBRE'
                 AND IOCT.TIPO(+) = 'R'
                 AND EC.INDUREPA = INOV.INDUREPA(+)
                 AND INOV.ANNO(+) = EC.ANNO
                 AND INOV.MES(+) = 'NOVIEMBRE'
                 AND INOV.TIPO(+) = 'R'
                 AND EC.INDUREPA = IDIC.INDUREPA(+)
                 AND IDIC.ANNO(+) = EC.ANNO
                 AND IDIC.MES(+) = 'DICIEMBRE'
                 AND IDIC.TIPO(+) = 'R'
                 AND NOT EXISTS (SELECT 'X' FROM VALORES_LISTA EX WHERE EX.CODIGO = 'ANE_ESTREXCR' AND P_UTILIDAD.F_ValoCampo(EX.VALOR,'ESTRUCTURA') = EC.ESTRUCTU)
                 AND EC.EMPRESA = P_UTILIDAD.F_VALODEVA('EMPRMANV')--vEmprManv
                 AND EC.TIPOCATE = P_UTILIDAD.F_VALODEVA('TIPOCACC')--vTIPOCACC
               GROUP BY EC.ANNO,
                        EC.ESTRUCTU, EC.DEPARTAM, EC.SECCION, EC.SECCAUXI, EC.TIPOCOST
              ) CCM,--Costes Comnues Manviel
              --Costes Comunes Extremadura
              (SELECT EC.ANNO,
                      EC.ESTRUCTU, EC.DEPARTAM, EC.SECCION, EC.SECCAUXI, EC.TIPOCOST,
                SUM(CREN.IMPOCUEN) CCE_ENERIMCU, SUM(CREN.IMPOCUEN * IENE.PORCSUR1) CCESP_ENERIMCU, SUM(CREN.IMPOCUEN * IENE.PORCSUR2) CCESM_ENERIMCU, SUM(CREN.IMPOCUEN * IENE.PORCSUR3) CCESE_ENERIMCU,
                SUM(CRFE.IMPOCUEN) CCE_FEBRIMCU, SUM(CRFE.IMPOCUEN * IFEB.PORCSUR1) CCESP_FEBRIMCU, SUM(CRFE.IMPOCUEN * IFEB.PORCSUR2) CCESM_FEBRIMCU, SUM(CRFE.IMPOCUEN * IFEB.PORCSUR3) CCESE_FEBRIMCU,
                SUM(CRMA.IMPOCUEN) CCE_MARZIMCU, SUM(CRMA.IMPOCUEN * IMAR.PORCSUR1) CCESP_MARZIMCU, SUM(CRMA.IMPOCUEN * IMAR.PORCSUR2) CCESM_MARZIMCU, SUM(CRMA.IMPOCUEN * IMAR.PORCSUR3) CCESE_MARZIMCU,
                SUM(CRAB.IMPOCUEN) CCE_ABRIIMCU, SUM(CRAB.IMPOCUEN * IABR.PORCSUR1) CCESP_ABRIIMCU, SUM(CRAB.IMPOCUEN * IABR.PORCSUR2) CCESM_ABRIIMCU, SUM(CRAB.IMPOCUEN * IABR.PORCSUR3) CCESE_ABRIIMCU,
                SUM(CRMY.IMPOCUEN) CCE_MAYOIMCU, SUM(CRMY.IMPOCUEN * IMAY.PORCSUR1) CCESP_MAYOIMCU, SUM(CRMY.IMPOCUEN * IMAY.PORCSUR2) CCESM_MAYOIMCU, SUM(CRMY.IMPOCUEN * IMAY.PORCSUR3) CCESE_MAYOIMCU,
                SUM(CRJU.IMPOCUEN) CCE_JUNIIMCU, SUM(CRJU.IMPOCUEN * IJUN.PORCSUR1) CCESP_JUNIIMCU, SUM(CRJU.IMPOCUEN * IJUN.PORCSUR2) CCESM_JUNIIMCU, SUM(CRJU.IMPOCUEN * IJUN.PORCSUR3) CCESE_JUNIIMCU,
                SUM(CRJL.IMPOCUEN) CCE_JULIIMCU, SUM(CRJL.IMPOCUEN * IJUL.PORCSUR1) CCESP_JULIIMCU, SUM(CRJL.IMPOCUEN * IJUL.PORCSUR2) CCESM_JULIIMCU, SUM(CRJL.IMPOCUEN * IJUL.PORCSUR3) CCESE_JULIIMCU,
                SUM(CRAG.IMPOCUEN) CCE_AGOSIMCU, SUM(CRAG.IMPOCUEN * IAGO.PORCSUR1) CCESP_AGOSIMCU, SUM(CRAG.IMPOCUEN * IAGO.PORCSUR2) CCESM_AGOSIMCU, SUM(CRAG.IMPOCUEN * IAGO.PORCSUR3) CCESE_AGOSIMCU,
                SUM(CRSE.IMPOCUEN) CCE_SEPTIMCU, SUM(CRSE.IMPOCUEN * ISEP.PORCSUR1) CCESP_SEPTIMCU, SUM(CRSE.IMPOCUEN * ISEP.PORCSUR2) CCESM_SEPTIMCU, SUM(CRSE.IMPOCUEN * ISEP.PORCSUR3) CCESE_SEPTIMCU,
                SUM(CROC.IMPOCUEN) CCE_OCTUIMCU, SUM(CROC.IMPOCUEN * IOCT.PORCSUR1) CCESP_OCTUIMCU, SUM(CROC.IMPOCUEN * IOCT.PORCSUR2) CCESM_OCTUIMCU, SUM(CROC.IMPOCUEN * IOCT.PORCSUR3) CCESE_OCTUIMCU,
                SUM(CRNO.IMPOCUEN) CCE_NOVIIMCU, SUM(CRNO.IMPOCUEN * INOV.PORCSUR1) CCESP_NOVIIMCU, SUM(CRNO.IMPOCUEN * INOV.PORCSUR2) CCESM_NOVIIMCU, SUM(CRNO.IMPOCUEN * INOV.PORCSUR3) CCESE_NOVIIMCU,
                SUM(CRDI.IMPOCUEN) CCE_DICIIMCU, SUM(CRDI.IMPOCUEN * IDIC.PORCSUR1) CCESP_DICIIMCU, SUM(CRDI.IMPOCUEN * IDIC.PORCSUR2) CCESM_DICIIMCU, SUM(CRDI.IMPOCUEN * IDIC.PORCSUR3) CCESE_DICIIMCU
               FROM (SELECT A.ANNO,EC.EMPRESA,EC.CUENCONT,EC.DEPARTAM,EC.SECCION,EC.SECCAUXI,EC.TIPOCOST,EC.TIIMCOST,EC.INDUCTOR,EC.INDUCOMU,EC.ESTRUCTU,EC.TIPOORIG,EC.TIPOCATE,EC.INDUREPA
                     FROM GNR_ESCCEMPR EC,
                          (SELECT DISTINCT ANNO FROM ANE_CODEANNO
                           WHERE EMPRESA IN (SELECT VALOR FROM VALORES_LISTA WHERE CODIGO = 'GNR_EMPRACGR')) A) EC, 
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'ENERO') CREN,
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'FEBRERO') CRFE,
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'MARZO') CRMA,
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'ABRIL') CRAB,
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'MAYO') CRMY,
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'JUNIO') CRJU,
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'JULIO') CRJL,
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'AGOSTO') CRAG,
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'SEPTIEMBRE') CRSE,
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'OCTUBRE') CROC,
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'NOVIEMBRE') CRNO,
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'DICIEMBRE') CRDI,
                    ANE_VAINRECO IENE, ANE_VAINRECO IFEB, ANE_VAINRECO IMAR, ANE_VAINRECO IABR,
                    ANE_VAINRECO IMAY, ANE_VAINRECO IJUN, ANE_VAINRECO IJUL, ANE_VAINRECO IAGO,
                    ANE_VAINRECO ISEP, ANE_VAINRECO IOCT, ANE_VAINRECO INOV, ANE_VAINRECO IDIC
               WHERE EC.EMPRESA = CREN.EMPRESA(+)
                 AND EC.ANNO = CREN.ANNO(+)
                 AND EC.CUENCONT = CREN.CUENCONT(+)
                 AND EC.EMPRESA = CRFE.EMPRESA(+)
                 AND EC.ANNO = CRFE.ANNO(+)
                 AND EC.CUENCONT = CRFE.CUENCONT(+)
                 AND EC.EMPRESA = CRMA.EMPRESA(+)
                 AND EC.ANNO = CRMA.ANNO(+)
                 AND EC.CUENCONT = CRMA.CUENCONT(+)
                 AND EC.EMPRESA = CRAB.EMPRESA(+)
                 AND EC.ANNO = CRAB.ANNO(+)
                 AND EC.CUENCONT = CRAB.CUENCONT(+)
                 AND EC.EMPRESA = CRMY.EMPRESA(+)
                 AND EC.ANNO = CRMY.ANNO(+)
                 AND EC.CUENCONT = CRMY.CUENCONT(+)
                 AND EC.EMPRESA = CRJU.EMPRESA(+)
                 AND EC.ANNO = CRJU.ANNO(+)
                 AND EC.CUENCONT = CRJU.CUENCONT(+)
                 AND EC.EMPRESA = CRJL.EMPRESA(+)
                 AND EC.ANNO = CRJL.ANNO(+)
                 AND EC.CUENCONT = CRJL.CUENCONT(+)
                 AND EC.EMPRESA = CRAG.EMPRESA(+)
                 AND EC.ANNO = CRAG.ANNO(+)
                 AND EC.CUENCONT = CRAG.CUENCONT(+)
                 AND EC.EMPRESA = CRSE.EMPRESA(+)
                 AND EC.ANNO = CRSE.ANNO(+)
                 AND EC.CUENCONT = CRSE.CUENCONT(+)
                 AND EC.EMPRESA = CROC.EMPRESA(+)
                 AND EC.ANNO = CROC.ANNO(+)
                 AND EC.CUENCONT = CROC.CUENCONT(+)
                 AND EC.EMPRESA = CRNO.EMPRESA(+)
                 AND EC.ANNO = CRNO.ANNO(+)
                 AND EC.CUENCONT = CRNO.CUENCONT(+)
                 AND EC.EMPRESA = CRDI.EMPRESA(+)
                 AND EC.ANNO = CRDI.ANNO(+)
                 AND EC.CUENCONT = CRDI.CUENCONT(+)
                 AND EC.INDUREPA = IENE.INDUREPA(+)
                 AND IENE.ANNO(+) = EC.ANNO
                 AND IENE.MES(+) = 'ENERO'
                 AND IENE.TIPO(+) = 'R'
                 AND EC.INDUREPA = IFEB.INDUREPA(+)
                 AND IFEB.ANNO(+) = EC.ANNO
                 AND IFEB.MES(+) = 'FEBRERO'
                 AND IFEB.TIPO(+) = 'R'
                 AND EC.INDUREPA = IMAR.INDUREPA(+)
                 AND IMAR.ANNO(+) = EC.ANNO
                 AND IMAR.MES(+) = 'MARZO'
                 AND IMAR.TIPO(+) = 'R'
                 AND EC.INDUREPA = IABR.INDUREPA(+)
                 AND IABR.ANNO(+) = EC.ANNO
                 AND IABR.MES(+) = 'ABRIL'
                 AND IABR.TIPO(+) = 'R'
                 AND EC.INDUREPA = IMAY.INDUREPA(+)
                 AND IMAY.ANNO(+) = EC.ANNO
                 AND IMAY.MES(+) = 'MAYO'
                 AND IMAY.TIPO(+) = 'R'
                 AND EC.INDUREPA = IJUN.INDUREPA(+)
                 AND IJUN.ANNO(+) = EC.ANNO
                 AND IJUN.MES(+) = 'JUNIO'
                 AND IJUN.TIPO(+) = 'R'
                 AND EC.INDUREPA = IJUL.INDUREPA(+)
                 AND IJUL.ANNO(+) = EC.ANNO
                 AND IJUL.MES(+) = 'JULIO'
                 AND IJUL.TIPO(+) = 'R'
                 AND EC.INDUREPA = IAGO.INDUREPA(+)
                 AND IAGO.ANNO(+) = EC.ANNO
                 AND IAGO.MES(+) = 'AGOSTO'
                 AND IAGO.TIPO(+) = 'R'
                 AND EC.INDUREPA = ISEP.INDUREPA(+)
                 AND ISEP.ANNO(+) = EC.ANNO
                 AND ISEP.MES(+) = 'SEPTIEMBRE'
                 AND ISEP.TIPO(+) = 'R'
                 AND EC.INDUREPA = IOCT.INDUREPA(+)
                 AND IOCT.ANNO(+) = EC.ANNO
                 AND IOCT.MES(+) = 'OCTUBRE'
                 AND IOCT.TIPO(+) = 'R'
                 AND EC.INDUREPA = INOV.INDUREPA(+)
                 AND INOV.ANNO(+) = EC.ANNO
                 AND INOV.MES(+) = 'NOVIEMBRE'
                 AND INOV.TIPO(+) = 'R'
                 AND EC.INDUREPA = IDIC.INDUREPA(+)
                 AND IDIC.ANNO(+) = EC.ANNO
                 AND IDIC.MES(+) = 'DICIEMBRE'
                 AND IDIC.TIPO(+) = 'R'
                 AND NOT EXISTS (SELECT 'X' FROM VALORES_LISTA EX WHERE EX.CODIGO = 'ANE_ESTREXCR' AND P_UTILIDAD.F_ValoCampo(EX.VALOR,'ESTRUCTURA') = EC.ESTRUCTU)
                 AND EC.EMPRESA = P_UTILIDAD.F_VALODEVA('EMPREXTR')--vEmprExtr
                 AND EC.TIPOCATE = P_UTILIDAD.F_VALODEVA('TIPOCACC')--vTIPOCACC
               GROUP BY EC.ANNO,
                        EC.ESTRUCTU, EC.DEPARTAM, EC.SECCION, EC.SECCAUXI, EC.TIPOCOST
              ) CCE,
              --Costes Comunes Extremadura
              (SELECT EC.ANNO,
                      EC.ESTRUCTU, EC.DEPARTAM, EC.SECCION, EC.SECCAUXI, EC.TIPOCOST,
                SUM(CREN.IMPOCUEN) CPP_ENERIMCU, SUM(CRFE.IMPOCUEN) CPP_FEBRIMCU, SUM(CRMA.IMPOCUEN) CPP_MARZIMCU, SUM(CRAB.IMPOCUEN) CPP_ABRIIMCU,
                SUM(CRMY.IMPOCUEN) CPP_MAYOIMCU, SUM(CRJU.IMPOCUEN) CPP_JUNIIMCU, SUM(CRJL.IMPOCUEN) CPP_JULIIMCU, SUM(CRAG.IMPOCUEN) CPP_AGOSIMCU,
                SUM(CRSE.IMPOCUEN) CPP_SEPTIMCU, SUM(CROC.IMPOCUEN) CPP_OCTUIMCU, SUM(CRNO.IMPOCUEN) CPP_NOVIIMCU, SUM(CRDI.IMPOCUEN) CPP_DICIIMCU
               FROM (SELECT A.ANNO,EC.EMPRESA,EC.CUENCONT,EC.DEPARTAM,EC.SECCION,EC.SECCAUXI,EC.TIPOCOST,EC.TIIMCOST,EC.INDUCTOR,EC.INDUCOMU,EC.ESTRUCTU,EC.TIPOORIG,EC.TIPOCATE,EC.INDUREPA
                     FROM GNR_ESCCEMPR EC,
                          (SELECT DISTINCT ANNO FROM ANE_CODEANNO
                           WHERE EMPRESA IN (SELECT VALOR FROM VALORES_LISTA WHERE CODIGO = 'GNR_EMPRACGR')) A) EC, 
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'ENERO') CREN,
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'FEBRERO') CRFE,
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'MARZO') CRMA,
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'ABRIL') CRAB,
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'MAYO') CRMY,
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'JUNIO') CRJU,
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'JULIO') CRJL,
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'AGOSTO') CRAG,
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'SEPTIEMBRE') CRSE,
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'OCTUBRE') CROC,
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'NOVIEMBRE') CRNO,
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'DICIEMBRE') CRDI
               WHERE EC.EMPRESA = CREN.EMPRESA(+)
                 AND EC.ANNO = CREN.ANNO(+)
                 AND EC.CUENCONT = CREN.CUENCONT(+)
                 AND EC.EMPRESA = CRFE.EMPRESA(+)
                 AND EC.ANNO = CRFE.ANNO(+)
                 AND EC.CUENCONT = CRFE.CUENCONT(+)
                 AND EC.EMPRESA = CRMA.EMPRESA(+)
                 AND EC.ANNO = CRMA.ANNO(+)
                 AND EC.CUENCONT = CRMA.CUENCONT(+)
                 AND EC.EMPRESA = CRAB.EMPRESA(+)
                 AND EC.ANNO = CRAB.ANNO(+)
                 AND EC.CUENCONT = CRAB.CUENCONT(+)
                 AND EC.EMPRESA = CRMY.EMPRESA(+)
                 AND EC.ANNO = CRMY.ANNO(+)
                 AND EC.CUENCONT = CRMY.CUENCONT(+)
                 AND EC.EMPRESA = CRJU.EMPRESA(+)
                 AND EC.ANNO = CRJU.ANNO(+)
                 AND EC.CUENCONT = CRJU.CUENCONT(+)
                 AND EC.EMPRESA = CRJL.EMPRESA(+)
                 AND EC.ANNO = CRJL.ANNO(+)
                 AND EC.CUENCONT = CRJL.CUENCONT(+)
                 AND EC.EMPRESA = CRAG.EMPRESA(+)
                 AND EC.ANNO = CRAG.ANNO(+)
                 AND EC.CUENCONT = CRAG.CUENCONT(+)
                 AND EC.EMPRESA = CRSE.EMPRESA(+)
                 AND EC.ANNO = CRSE.ANNO(+)
                 AND EC.CUENCONT = CRSE.CUENCONT(+)
                 AND EC.EMPRESA = CROC.EMPRESA(+)
                 AND EC.ANNO = CROC.ANNO(+)
                 AND EC.CUENCONT = CROC.CUENCONT(+)
                 AND EC.EMPRESA = CRNO.EMPRESA(+)
                 AND EC.ANNO = CRNO.ANNO(+)
                 AND EC.CUENCONT = CRNO.CUENCONT(+)
                 AND EC.EMPRESA = CRDI.EMPRESA(+)
                 AND EC.ANNO = CRDI.ANNO(+)
                 AND EC.CUENCONT = CRDI.CUENCONT(+)
                 AND NOT EXISTS (SELECT 'X' FROM VALORES_LISTA EX WHERE EX.CODIGO = 'ANE_ESTREXCR' AND P_UTILIDAD.F_ValoCampo(EX.VALOR,'ESTRUCTURA') = EC.ESTRUCTU)
                 AND EC.EMPRESA = P_UTILIDAD.F_VALODEVA('EMPRPHAR')--vEmprPhar
                 AND EC.TIPOCATE = P_UTILIDAD.F_VALODEVA('TIPOCACP')--vTIPOCACP
               GROUP BY EC.ANNO,
                        EC.ESTRUCTU, EC.DEPARTAM, EC.SECCION, EC.SECCAUXI, EC.TIPOCOST
              ) CPP,--Costes Propios Pharma
              (SELECT EC.ANNO,
                      EC.ESTRUCTU, EC.DEPARTAM, EC.SECCION, EC.SECCAUXI, EC.TIPOCOST,
                SUM(CREN.IMPOCUEN) CPM_ENERIMCU, SUM(CRFE.IMPOCUEN) CPM_FEBRIMCU, SUM(CRMA.IMPOCUEN) CPM_MARZIMCU, SUM(CRAB.IMPOCUEN) CPM_ABRIIMCU,
                SUM(CRMY.IMPOCUEN) CPM_MAYOIMCU, SUM(CRJU.IMPOCUEN) CPM_JUNIIMCU, SUM(CRJL.IMPOCUEN) CPM_JULIIMCU, SUM(CRAG.IMPOCUEN) CPM_AGOSIMCU,
                SUM(CRSE.IMPOCUEN) CPM_SEPTIMCU, SUM(CROC.IMPOCUEN) CPM_OCTUIMCU, SUM(CRNO.IMPOCUEN) CPM_NOVIIMCU, SUM(CRDI.IMPOCUEN) CPM_DICIIMCU
               FROM (SELECT A.ANNO,EC.EMPRESA,EC.CUENCONT,EC.DEPARTAM,EC.SECCION,EC.SECCAUXI,EC.TIPOCOST,EC.TIIMCOST,EC.INDUCTOR,EC.INDUCOMU,EC.ESTRUCTU,EC.TIPOORIG,EC.TIPOCATE,EC.INDUREPA
                     FROM GNR_ESCCEMPR EC,
                          (SELECT DISTINCT ANNO FROM ANE_CODEANNO
                           WHERE EMPRESA IN (SELECT VALOR FROM VALORES_LISTA WHERE CODIGO = 'GNR_EMPRACGR')) A) EC, 
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'ENERO') CREN,(SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'FEBRERO') CRFE,
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'MARZO') CRMA,
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'ABRIL') CRAB,
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'MAYO') CRMY,
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'JUNIO') CRJU,
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'JULIO') CRJL,
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'AGOSTO') CRAG,
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'SEPTIEMBRE') CRSE,
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'OCTUBRE') CROC,
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'NOVIEMBRE') CRNO,
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'DICIEMBRE') CRDI
               WHERE EC.EMPRESA = CREN.EMPRESA(+)
                 AND EC.ANNO = CREN.ANNO(+)
                 AND EC.CUENCONT = CREN.CUENCONT(+)
                 AND EC.EMPRESA = CRFE.EMPRESA(+)
                 AND EC.ANNO = CRFE.ANNO(+)
                 AND EC.CUENCONT = CRFE.CUENCONT(+)
                 AND EC.EMPRESA = CRMA.EMPRESA(+)
                 AND EC.ANNO = CRMA.ANNO(+)
                 AND EC.CUENCONT = CRMA.CUENCONT(+)
                 AND EC.EMPRESA = CRAB.EMPRESA(+)
                 AND EC.ANNO = CRAB.ANNO(+)
                 AND EC.CUENCONT = CRAB.CUENCONT(+)
                 AND EC.EMPRESA = CRMY.EMPRESA(+)
                 AND EC.ANNO = CRMY.ANNO(+)
                 AND EC.CUENCONT = CRMY.CUENCONT(+)
                 AND EC.EMPRESA = CRJU.EMPRESA(+)
                 AND EC.ANNO = CRJU.ANNO(+)
                 AND EC.CUENCONT = CRJU.CUENCONT(+)
                 AND EC.EMPRESA = CRJL.EMPRESA(+)
                 AND EC.ANNO = CRJL.ANNO(+)
                 AND EC.CUENCONT = CRJL.CUENCONT(+)
                 AND EC.EMPRESA = CRAG.EMPRESA(+)
                 AND EC.ANNO = CRAG.ANNO(+)
                 AND EC.CUENCONT = CRAG.CUENCONT(+)
                 AND EC.EMPRESA = CRSE.EMPRESA(+)
                 AND EC.ANNO = CRSE.ANNO(+)
                 AND EC.CUENCONT = CRSE.CUENCONT(+)
                 AND EC.EMPRESA = CROC.EMPRESA(+)
                 AND EC.ANNO = CROC.ANNO(+)
                 AND EC.CUENCONT = CROC.CUENCONT(+)
                 AND EC.EMPRESA = CRNO.EMPRESA(+)
                 AND EC.ANNO = CRNO.ANNO(+)
                 AND EC.CUENCONT = CRNO.CUENCONT(+)
                 AND EC.EMPRESA = CRDI.EMPRESA(+)
                 AND EC.ANNO = CRDI.ANNO(+)
                 AND EC.CUENCONT = CRDI.CUENCONT(+)
                 AND NOT EXISTS (SELECT 'X' FROM VALORES_LISTA EX WHERE EX.CODIGO = 'ANE_ESTREXCR' AND P_UTILIDAD.F_ValoCampo(EX.VALOR,'ESTRUCTURA') = EC.ESTRUCTU)
                 AND EC.EMPRESA = P_UTILIDAD.F_VALODEVA('EMPRMANV')--vEmprManv
                 AND EC.TIPOCATE = P_UTILIDAD.F_VALODEVA('TIPOCACP')--vTIPOCACP
               GROUP BY EC.ANNO,
                        EC.ESTRUCTU, EC.DEPARTAM, EC.SECCION, EC.SECCAUXI, EC.TIPOCOST
              ) CPM,--Costes Propios Manviel
              --Costes Propios Extremadura
              (SELECT EC.ANNO,
                      EC.ESTRUCTU, EC.DEPARTAM, EC.SECCION, EC.SECCAUXI, EC.TIPOCOST,
                SUM(CREN.IMPOCUEN) CPE_ENERIMCU, SUM(CRFE.IMPOCUEN) CPE_FEBRIMCU, SUM(CRMA.IMPOCUEN) CPE_MARZIMCU, SUM(CRAB.IMPOCUEN) CPE_ABRIIMCU,
                SUM(CRMY.IMPOCUEN) CPE_MAYOIMCU, SUM(CRJU.IMPOCUEN) CPE_JUNIIMCU, SUM(CRJL.IMPOCUEN) CPE_JULIIMCU, SUM(CRAG.IMPOCUEN) CPE_AGOSIMCU,
                SUM(CRSE.IMPOCUEN) CPE_SEPTIMCU, SUM(CROC.IMPOCUEN) CPE_OCTUIMCU, SUM(CRNO.IMPOCUEN) CPE_NOVIIMCU, SUM(CRDI.IMPOCUEN) CPE_DICIIMCU
               FROM (SELECT A.ANNO,EC.EMPRESA,EC.CUENCONT,EC.DEPARTAM,EC.SECCION,EC.SECCAUXI,EC.TIPOCOST,EC.TIIMCOST,EC.INDUCTOR,EC.INDUCOMU,EC.ESTRUCTU,EC.TIPOORIG,EC.TIPOCATE,EC.INDUREPA
                     FROM GNR_ESCCEMPR EC,
                          (SELECT DISTINCT ANNO FROM ANE_CODEANNO
                           WHERE EMPRESA IN (SELECT VALOR FROM VALORES_LISTA WHERE CODIGO = 'GNR_EMPRACGR')) A) EC, 
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'ENERO') CREN,
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'FEBRERO') CRFE,
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'MARZO') CRMA,
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'ABRIL') CRAB,
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'MAYO') CRMY,
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'JUNIO') CRJU,
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'JULIO') CRJL,
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'AGOSTO') CRAG,
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'SEPTIEMBRE') CRSE,
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'OCTUBRE') CROC,
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'NOVIEMBRE') CRNO,
                    (SELECT EMPRESA, ANNO, CUENCONT, IMPOCUEN FROM ANE_CODEREAN
                     WHERE MES = 'DICIEMBRE') CRDI
               WHERE EC.EMPRESA = CREN.EMPRESA(+)
                 AND EC.ANNO = CREN.ANNO(+)
                 AND EC.CUENCONT = CREN.CUENCONT(+)
                 AND EC.EMPRESA = CRFE.EMPRESA(+)
                 AND EC.ANNO = CRFE.ANNO(+)
                 AND EC.CUENCONT = CRFE.CUENCONT(+)
                 AND EC.EMPRESA = CRMA.EMPRESA(+)
                 AND EC.ANNO = CRMA.ANNO(+)
                 AND EC.CUENCONT = CRMA.CUENCONT(+)
                 AND EC.EMPRESA = CRAB.EMPRESA(+)
                 AND EC.ANNO = CRAB.ANNO(+)
                 AND EC.CUENCONT = CRAB.CUENCONT(+)
                 AND EC.EMPRESA = CRMY.EMPRESA(+)
                 AND EC.ANNO = CRMY.ANNO(+)
                 AND EC.CUENCONT = CRMY.CUENCONT(+)
                 AND EC.EMPRESA = CRJU.EMPRESA(+)
                 AND EC.ANNO = CRJU.ANNO(+)
                 AND EC.CUENCONT = CRJU.CUENCONT(+)
                 AND EC.EMPRESA = CRJL.EMPRESA(+)
                 AND EC.ANNO = CRJL.ANNO(+)
                 AND EC.CUENCONT = CRJL.CUENCONT(+)
                 AND EC.EMPRESA = CRAG.EMPRESA(+)
                 AND EC.ANNO = CRAG.ANNO(+)
                 AND EC.CUENCONT = CRAG.CUENCONT(+)
                 AND EC.EMPRESA = CRSE.EMPRESA(+)
                 AND EC.ANNO = CRSE.ANNO(+)
                 AND EC.CUENCONT = CRSE.CUENCONT(+)
                 AND EC.EMPRESA = CROC.EMPRESA(+)
                 AND EC.ANNO = CROC.ANNO(+)
                 AND EC.CUENCONT = CROC.CUENCONT(+)
                 AND EC.EMPRESA = CRNO.EMPRESA(+)
                 AND EC.ANNO = CRNO.ANNO(+)
                 AND EC.CUENCONT = CRNO.CUENCONT(+)
                 AND EC.EMPRESA = CRDI.EMPRESA(+)
                 AND EC.ANNO = CRDI.ANNO(+)
                 AND EC.CUENCONT = CRDI.CUENCONT(+)
                 AND NOT EXISTS (SELECT 'X' FROM VALORES_LISTA EX WHERE EX.CODIGO = 'ANE_ESTREXCR' AND P_UTILIDAD.F_ValoCampo(EX.VALOR,'ESTRUCTURA') = EC.ESTRUCTU)
                 AND EC.EMPRESA = P_UTILIDAD.F_VALODEVA('EMPREXTR')--vEmprExtr
                 AND EC.TIPOCATE = P_UTILIDAD.F_VALODEVA('TIPOCACP')--vTIPOCACP
               GROUP BY EC.ANNO,
                        EC.ESTRUCTU, EC.DEPARTAM, EC.SECCION, EC.SECCAUXI, EC.TIPOCOST
              ) CPE,
              --Costes Propios Extremadura
              (--% Reparto Costes Matriz     
               SELECT ANNO, 
                   DECODE(NVL(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(ANNO),'CALCMEAN'),0),0,0,SUM(PORCSUR1)/P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(ANNO),'CALCMEAN')) PORECMPH, 
                   DECODE(NVL(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(ANNO),'CALCMEAN'),0),0,0,SUM(PORCSUR2)/P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(ANNO),'CALCMEAN')) PORECMMA, 
                   DECODE(NVL(P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(ANNO),'CALCMEAN'),0),0,0,SUM(PORCSUR3)/P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(ANNO),'CALCMEAN')) PORECMEX
               FROM ANE_PORECOMA
                 WHERE TIPO = 'R'
                   AND TO_NUMBER(ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(ANNO),'MESINIC')) <= TO_NUMBER(ANNO||DECODE(MES,'ENERO','01',
                                                                             'FEBRERO','02',
                                                                             'MARZO','03',
                                                                             'ABRIL','04',
                                                                             'MAYO','05',
                                                                             'JUNIO','06',
                                                                             'JULIO','07',
                                                                             'AGOSTO','08',
                                                                             'SEPTIEMBRE','09',
                                                                             'OCTUBRE','10',
                                                                             'NOVIEMBRE','11',
                                                                             'DICIEMBRE','12')) 
                   AND TO_NUMBER(ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(ANNO),'MESFINA')) >= TO_NUMBER(ANNO||DECODE(MES,'ENERO','01',
                                                                             'FEBRERO','02',
                                                                             'MARZO','03',
                                                                             'ABRIL','04',
                                                                             'MAYO','05',
                                                                             'JUNIO','06',
                                                                             'JULIO','07',
                                                                             'AGOSTO','08',
                                                                             'SEPTIEMBRE','09',
                                                                             'OCTUBRE','10',
                                                                             'NOVIEMBRE','11',
                                                                             'DICIEMBRE','12'))
               GROUP BY ANNO) PR,
        (SELECT EMPRESA, ANNO, ESTRUCTURA, SECCION, SUM(COSTE) COSTE FROM (
         SELECT CP.EMPRESA, CP.ANNO, P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA') ESTRUCTURA, CP.SECCION, SUM(CP.COSTE) COSTE FROM ANE_CONFCPDR CP, VALORES_LISTA CO, VALORES_LISTA CI
         WHERE CO.CODIGO = 'ANE_ESTREXCR'
           --AND P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA') = vEstructu
           AND P_UTILIDAD.F_ValoCampo(CO.VALOR,'COSTINCL') = CI.CODIGO
           AND CP.CONCEPTO = CI.VALOR
           AND CP.EMPRESA = P_UTILIDAD.F_VALODEVA('EMPRPHAR')--vEMPRPHAR
           --AND CP.ANNO = vAnno
           AND TO_NUMBER(ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(CP.ANNO),'MESINIC')) <= TO_NUMBER(CP.ANNO||DECODE(CP.MES,'ENERO','01',
                                                                                 'FEBRERO','02',
                                                                                 'MARZO','03',
                                                                                 'ABRIL','04',
                                                                                 'MAYO','05',
                                                                                 'JUNIO','06',
                                                                                 'JULIO','07',
                                                                                 'AGOSTO','08',
                                                                                 'SEPTIEMBRE','09',
                                                                                 'OCTUBRE','10',
                                                                                 'NOVIEMBRE','11',
                                                                                 'DICIEMBRE','12')) 
           AND TO_NUMBER(ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(CP.ANNO),'MESFINA')) >= TO_NUMBER(CP.ANNO||DECODE(CP.MES,'ENERO','01',
                                                                                 'FEBRERO','02',
                                                                                 'MARZO','03',
                                                                                 'ABRIL','04',
                                                                                 'MAYO','05',
                                                                                 'JUNIO','06',
                                                                                 'JULIO','07',
                                                                                 'AGOSTO','08',
                                                                                 'SEPTIEMBRE','09',
                                                                                 'OCTUBRE','10',
                                                                                 'NOVIEMBRE','11',
                                                                                 'DICIEMBRE','12'))
           --AND CP.SECCION = vSeccion
         GROUP BY CP.EMPRESA, CP.ANNO, P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA'), CP.SECCION
         UNION ALL
         SELECT CP.EMPRESA, CP.ANNO, P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA') ESTRUCTURA, P_UTILIDAD.F_ValoCampo(CD.VALOR,'CODIDEPA') SECCION, SUM(CP.COSTE) COSTE FROM PRD_CONFCPDR CP, VALORES_LISTA CO, VALORES_LISTA CI, VALORES_LISTA CD
         WHERE CO.CODIGO = 'ANE_ESTREXCR'
           --AND P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA') = vEstructu
           AND P_UTILIDAD.F_ValoCampo(CO.VALOR,'COSTINCL') = CI.CODIGO
           AND CP.CONCEPTO = CI.VALOR
           AND CD.CODIGO = 'PRD_SECCCMOP'
           --AND P_UTILIDAD.F_ValoCampo(CD.VALOR,'CODIDEPA') = vSeccion
           AND CP.EMPRESA = P_UTILIDAD.F_VALODEVA('EMPRPHAR')--vEMPRPHAR
           --AND CP.ANNO = vANNO
           AND TO_NUMBER(ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(CP.ANNO),'MESINIC')) <= TO_NUMBER(CP.ANNO||DECODE(CP.MES,'ENERO','01',
                                                                                 'FEBRERO','02',
                                                                                 'MARZO','03',
                                                                                 'ABRIL','04',
                                                                                 'MAYO','05',
                                                                                 'JUNIO','06',
                                                                                 'JULIO','07',
                                                                                 'AGOSTO','08',
                                                                                 'SEPTIEMBRE','09',
                                                                                 'OCTUBRE','10',
                                                                                 'NOVIEMBRE','11',
                                                                                 'DICIEMBRE','12')) 
           AND TO_NUMBER(ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(CP.ANNO),'MESFINA')) >= TO_NUMBER(CP.ANNO||DECODE(CP.MES,'ENERO','01',
                                                                                 'FEBRERO','02',
                                                                                 'MARZO','03',
                                                                                 'ABRIL','04',
                                                                                 'MAYO','05',
                                                                                 'JUNIO','06',
                                                                                 'JULIO','07',
                                                                                 'AGOSTO','08',
                                                                                 'SEPTIEMBRE','09',
                                                                                 'OCTUBRE','10',
                                                                                 'NOVIEMBRE','11',
                                                                                 'DICIEMBRE','12'))
           AND CP.TIPOMAQU = P_UTILIDAD.F_ValoCampo(CD.VALOR,'SECCION')
         GROUP BY CP.EMPRESA, CP.ANNO, P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA'), P_UTILIDAD.F_ValoCampo(CD.VALOR,'CODIDEPA')
         UNION ALL
         SELECT CP.EMPRESA, CP.ANNO, P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA') ESTRUCTURA, CP.SECCION, SUM(CP.COSTE) COSTE FROM ANE_CONFRCDR CP, VALORES_LISTA CO, VALORES_LISTA CI
         WHERE CO.CODIGO = 'ANE_ESTREXCR'
           --AND P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA') = vEstructu
           AND P_UTILIDAD.F_ValoCampo(CO.VALOR,'COSTINCL') = CI.CODIGO
           AND CP.CONCEPTO = CI.VALOR
           AND CP.EMPRESA = P_UTILIDAD.F_VALODEVA('EMPRPHAR')--vEMPRPHAR
           --AND CP.ANNO = vANNO
           AND TO_NUMBER(ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(CP.ANNO),'MESINIC')) <= TO_NUMBER(CP.ANNO||DECODE(CP.MES,'ENERO','01',
                                                                                 'FEBRERO','02',
                                                                                 'MARZO','03',
                                                                                 'ABRIL','04',
                                                                                 'MAYO','05',
                                                                                 'JUNIO','06',
                                                                                 'JULIO','07',
                                                                                 'AGOSTO','08',
                                                                                 'SEPTIEMBRE','09',
                                                                                 'OCTUBRE','10',
                                                                                 'NOVIEMBRE','11',
                                                                                 'DICIEMBRE','12')) 
           AND TO_NUMBER(ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(CP.ANNO),'MESFINA')) >= TO_NUMBER(CP.ANNO||DECODE(CP.MES,'ENERO','01',
                                                                                 'FEBRERO','02',
                                                                                 'MARZO','03',
                                                                                 'ABRIL','04',
                                                                                 'MAYO','05',
                                                                                 'JUNIO','06',
                                                                                 'JULIO','07',
                                                                                 'AGOSTO','08',
                                                                                 'SEPTIEMBRE','09',
                                                                                 'OCTUBRE','10',
                                                                                 'NOVIEMBRE','11',
                                                                                 'DICIEMBRE','12'))
           --AND CP.SECCION = vSeccion
         GROUP BY CP.EMPRESA, CP.ANNO, P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA'), CP.SECCION
         UNION ALL
         SELECT CP.EMPRESA, CP.ANNO, P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA') ESTRUCTURA, P_UTILIDAD.F_ValoCampo(CD.VALOR,'CODIDEPA') SECCION, SUM(CP.COSTE) COSTE FROM PRD_CONFRCDR CP, VALORES_LISTA CO, VALORES_LISTA CI, VALORES_LISTA CD
         WHERE CO.CODIGO = 'ANE_ESTREXCR'
           --AND P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA') = vEstructu
           AND P_UTILIDAD.F_ValoCampo(CO.VALOR,'COSTINCL') = CI.CODIGO
           AND CP.CONCEPTO = CI.VALOR
           AND CD.CODIGO = 'PRD_SECCCMOP'
           --AND P_UTILIDAD.F_ValoCampo(CD.VALOR,'CODIDEPA') = vSeccion
           AND CP.EMPRESA = P_UTILIDAD.F_VALODEVA('EMPRPHAR')--vEMPRPHAR
           --AND CP.ANNO = vANNO
           AND TO_NUMBER(ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(CP.ANNO),'MESINIC')) <= TO_NUMBER(CP.ANNO||DECODE(CP.MES,'ENERO','01',
                                                                                 'FEBRERO','02',
                                                                                 'MARZO','03',
                                                                                 'ABRIL','04',
                                                                                 'MAYO','05',
                                                                                 'JUNIO','06',
                                                                                 'JULIO','07',
                                                                                 'AGOSTO','08',
                                                                                 'SEPTIEMBRE','09',
                                                                                 'OCTUBRE','10',
                                                                                 'NOVIEMBRE','11',
                                                                                 'DICIEMBRE','12')) 
           AND TO_NUMBER(ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(CP.ANNO),'MESFINA')) >= TO_NUMBER(CP.ANNO||DECODE(CP.MES,'ENERO','01',
                                                                                 'FEBRERO','02',
                                                                                 'MARZO','03',
                                                                                 'ABRIL','04',
                                                                                 'MAYO','05',
                                                                                 'JUNIO','06',
                                                                                 'JULIO','07',
                                                                                 'AGOSTO','08',
                                                                                 'SEPTIEMBRE','09',
                                                                                 'OCTUBRE','10',
                                                                                 'NOVIEMBRE','11',
                                                                                 'DICIEMBRE','12'))
           AND CP.TIPOMAQU = P_UTILIDAD.F_ValoCampo(CD.VALOR,'SECCION')
         GROUP BY CP.EMPRESA, CP.ANNO, P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA'), P_UTILIDAD.F_ValoCampo(CD.VALOR,'CODIDEPA')
         --------------Costes Indirectos CMOP
         UNION ALL
         SELECT PER.EMPRESA, PER.ANNO, IND.ESTRUCTURA, PER.SECCION, IND.COSTINDI * (PER.NUMEOFIC + PER.NUMEAYUD) COSTE
         FROM
               (SELECT C.EMPRESA, C.ANNO, P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA') ESTRUCTURA, SUM(C.COSTE / I.NUMEPERS) COSTINDI 
                  FROM PRD_CONFCOIR C, VALORES_LISTA L, PRD_CONFINRE I, 
                       VALORES_LISTA CO, VALORES_LISTA CI
               WHERE C.CONCEPTO = P_UTILIDAD.F_VALOCAMPO(L.VALOR,'CONCEPTO')
                 AND C.EMPRESA = I.EMPRESA
                 AND C.ANNO = I.ANNO
                 AND C.MES = I.MES
                 AND P_UTILIDAD.F_VALOCAMPO(L.VALOR,'INDUCTOR') = I.INDUCTOR
                 AND L.CODIGO = 'PRD_COPRASIN'
                 AND CO.CODIGO = 'ANE_ESTREXCR'
                 --AND P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA') = vEstructu
                 AND P_UTILIDAD.F_ValoCampo(CO.VALOR,'COSTINCL') = CI.CODIGO
                 AND C.CONCEPTO = CI.VALOR
                 AND NVL(I.NUMEPERS,0) != 0
                 AND C.EMPRESA = P_UTILIDAD.F_VALODEVA('EMPRPHAR')--vEMPRPHAR
                 --AND C.ANNO = vAnno
                 AND TO_NUMBER(C.ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(C.ANNO),'MESINIC')) <= TO_NUMBER(C.Anno||DECODE(C.MES,'ENERO','01',
                                                                                 'FEBRERO','02',
                                                                                 'MARZO','03',
                                                                                 'ABRIL','04',
                                                                                 'MAYO','05',
                                                                                 'JUNIO','06',
                                                                                 'JULIO','07',
                                                                                 'AGOSTO','08',
                                                                                 'SEPTIEMBRE','09',
                                                                                 'OCTUBRE','10',
                                                                                 'NOVIEMBRE','11',
                                                                                 'DICIEMBRE','12')) 
                 AND TO_NUMBER(C.ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(C.ANNO),'MESFINA')) >= TO_NUMBER(C.Anno||DECODE(C.MES,'ENERO','01',
                                                                                 'FEBRERO','02',
                                                                                 'MARZO','03',
                                                                                 'ABRIL','04',
                                                                                 'MAYO','05',
                                                                                 'JUNIO','06',
                                                                                 'JULIO','07',
                                                                                 'AGOSTO','08',
                                                                                 'SEPTIEMBRE','09',
                                                                                 'OCTUBRE','10',
                                                                                 'NOVIEMBRE','11',
                                                                                 'DICIEMBRE','12'))
               GROUP BY C.EMPRESA, C.ANNO, P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA')) IND,
               (SELECT PL.EMPRESA, PL.ANNO, P_UTILIDAD.F_ValoCampo(CD.VALOR,'CODIDEPA') SECCION, PL.NUMEOFIC, PL.NUMEAYUD 
                FROM PRD_CONFPMSR PL, VALORES_LISTA CD
                WHERE CD.CODIGO = 'PRD_SECCCMOP'
                  AND PL.TIPOMAQU = P_UTILIDAD.F_ValoCampo(CD.VALOR,'SECCION')
                  --AND P_UTILIDAD.F_ValoCampo(CD.VALOR,'CODIDEPA') = vSeccion
                  AND PL.EMPRESA = P_UTILIDAD.F_VALODEVA('EMPRPHAR')--vEMPRPHAR
                  --AND PL.ANNO = vAnno
                  AND TO_NUMBER(PL.ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(PL.ANNO),'MESINIC')) <= TO_NUMBER(PL.Anno||DECODE(PL.MES,'ENERO','01',
                                                                                 'FEBRERO','02',
                                                                                 'MARZO','03',
                                                                                 'ABRIL','04',
                                                                                 'MAYO','05',
                                                                                 'JUNIO','06',
                                                                                 'JULIO','07',
                                                                                 'AGOSTO','08',
                                                                                 'SEPTIEMBRE','09',
                                                                                 'OCTUBRE','10',
                                                                                 'NOVIEMBRE','11',
                                                                                 'DICIEMBRE','12')) 
                  AND TO_NUMBER(PL.ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(PL.ANNO),'MESFINA')) >= TO_NUMBER(PL.Anno||DECODE(PL.MES,'ENERO','01',
                                                                                 'FEBRERO','02',
                                                                                 'MARZO','03',
                                                                                 'ABRIL','04',
                                                                                 'MAYO','05',
                                                                                 'JUNIO','06',
                                                                                 'JULIO','07',
                                                                                 'AGOSTO','08',
                                                                                 'SEPTIEMBRE','09',
                                                                                 'OCTUBRE','10',
                                                                                 'NOVIEMBRE','11',
                                                                                 'DICIEMBRE','12'))) PER
         WHERE PER.EMPRESA = IND.EMPRESA
           AND PER.ANNO = IND.ANNO
         --------------Costes Indirectos Departamentales Inductor diferente a Personal Uniformado
         UNION ALL
         SELECT PER.EMPRESA, PER.ANNO, IND.ESTRUCTURA, PER.SECCION, IND.COSTINDI * PER.NUMEPERS COSTE
         FROM
               (SELECT C.EMPRESA, C.ANNO, P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA') ESTRUCTURA, SUM(C.COSTE / I.NUMEPERS) COSTINDI 
                  FROM PRD_CONFCOIR C, VALORES_LISTA L, PRD_CONFINRE I, 
                       VALORES_LISTA CO, VALORES_LISTA CI
               WHERE C.CONCEPTO = P_UTILIDAD.F_VALOCAMPO(L.VALOR,'CONCEPTO')
                 AND C.EMPRESA = I.EMPRESA
                 AND C.ANNO = I.ANNO
                 AND C.MES = I.MES
                 AND P_UTILIDAD.F_VALOCAMPO(L.VALOR,'INDUCTOR') = I.INDUCTOR
                 AND L.CODIGO = 'PRD_COPRASIN'
                 AND CO.CODIGO = 'ANE_ESTREXCR'
                 --AND P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA') = vEstructu
                 AND P_UTILIDAD.F_ValoCampo(CO.VALOR,'COSTINCL') = CI.CODIGO
                 AND C.CONCEPTO = CI.VALOR
                 AND I.INDUCTOR != P_UTILIDAD.F_VALODEVA('INDUPEUN')--vINDUPEUN --PERSONAL UNIFORMADO
                 AND NVL(I.NUMEPERS,0) != 0
                 AND C.EMPRESA = P_UTILIDAD.F_VALODEVA('EMPRPHAR')--vEMPRPHAR
                 --AND C.ANNO = vAnno
                 AND TO_NUMBER(C.ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(C.ANNO),'MESINIC')) <= TO_NUMBER(C.Anno||DECODE(C.MES,'ENERO','01',
                                                                                 'FEBRERO','02',
                                                                                 'MARZO','03',
                                                                                 'ABRIL','04',
                                                                                 'MAYO','05',
                                                                                 'JUNIO','06',
                                                                                 'JULIO','07',
                                                                                 'AGOSTO','08',
                                                                                 'SEPTIEMBRE','09',
                                                                                 'OCTUBRE','10',
                                                                                 'NOVIEMBRE','11',
                                                                                 'DICIEMBRE','12')) 
                 AND TO_NUMBER(C.ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(C.ANNO),'MESFINA')) >= TO_NUMBER(C.Anno||DECODE(C.MES,'ENERO','01',
                                                                                 'FEBRERO','02',
                                                                                 'MARZO','03',
                                                                                 'ABRIL','04',
                                                                                 'MAYO','05',
                                                                                 'JUNIO','06',
                                                                                 'JULIO','07',
                                                                                 'AGOSTO','08',
                                                                                 'SEPTIEMBRE','09',
                                                                                 'OCTUBRE','10',
                                                                                 'NOVIEMBRE','11',
                                                                                 'DICIEMBRE','12'))
               GROUP BY C.EMPRESA, C.ANNO, P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA')) IND,
               (SELECT PL.EMPRESA, PL.ANNO, PL.SECCION, PL.NUMEPERS
                FROM ANE_CONFPMSR PL
                WHERE --PL.SECCION = vSeccion
                  --AND 
                       PL.EMPRESA = P_UTILIDAD.F_VALODEVA('EMPRPHAR')--vEMPRPHAR
                  --AND PL.ANNO = vAnno
                  AND TO_NUMBER(PL.ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(PL.ANNO),'MESINIC')) <= TO_NUMBER(PL.Anno||DECODE(PL.MES,'ENERO','01',
                                                                                 'FEBRERO','02',
                                                                                 'MARZO','03',
                                                                                 'ABRIL','04',
                                                                                 'MAYO','05',
                                                                                 'JUNIO','06',
                                                                                 'JULIO','07',
                                                                                 'AGOSTO','08',
                                                                                 'SEPTIEMBRE','09',
                                                                                 'OCTUBRE','10',
                                                                                 'NOVIEMBRE','11',
                                                                                 'DICIEMBRE','12')) 
                  AND TO_NUMBER(PL.ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(PL.ANNO),'MESFINA')) >= TO_NUMBER(PL.Anno||DECODE(PL.MES,'ENERO','01',
                                                                                 'FEBRERO','02',
                                                                                 'MARZO','03',
                                                                                 'ABRIL','04',
                                                                                 'MAYO','05',
                                                                                 'JUNIO','06',
                                                                                 'JULIO','07',
                                                                                 'AGOSTO','08',
                                                                                 'SEPTIEMBRE','09',
                                                                                 'OCTUBRE','10',
                                                                                 'NOVIEMBRE','11',
                                                                                 'DICIEMBRE','12'))) PER
         WHERE PER.EMPRESA = IND.EMPRESA
           AND PER.ANNO = IND.ANNO
         --------------Costes Indirectos Departamentales Inductor igual a Personal Uniformado
         UNION ALL
         SELECT PER.EMPRESA, PER.ANNO, IND.ESTRUCTURA, PER.SECCION, IND.COSTINDI * PER.NUMEPEUN COSTE
         FROM
               (SELECT C.EMPRESA, C.ANNO, P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA') ESTRUCTURA, SUM(C.COSTE / I.NUMEPERS) COSTINDI 
                  FROM PRD_CONFCOIR C, VALORES_LISTA L, PRD_CONFINRE I, 
                       VALORES_LISTA CO, VALORES_LISTA CI
               WHERE C.CONCEPTO = P_UTILIDAD.F_VALOCAMPO(L.VALOR,'CONCEPTO')
                 AND C.EMPRESA = I.EMPRESA
                 AND C.ANNO = I.ANNO
                 AND C.MES = I.MES
                 AND P_UTILIDAD.F_VALOCAMPO(L.VALOR,'INDUCTOR') = I.INDUCTOR
                 AND L.CODIGO = 'PRD_COPRASIN'
                 AND CO.CODIGO = 'ANE_ESTREXCR'
                 --AND P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA') = vEstructu
                 AND P_UTILIDAD.F_ValoCampo(CO.VALOR,'COSTINCL') = CI.CODIGO
                 AND C.CONCEPTO = CI.VALOR
                 AND I.INDUCTOR = P_UTILIDAD.F_VALODEVA('INDUPEUN')--vINDUPEUN --PERSONAL UNIFORMADO
                 AND NVL(I.NUMEPERS,0) != 0
                 AND C.EMPRESA = P_UTILIDAD.F_VALODEVA('EMPRPHAR')--vEMPRPHAR
                 --AND C.ANNO = vAnno
                 AND TO_NUMBER(C.ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(C.ANNO),'MESINIC')) <= TO_NUMBER(C.Anno||DECODE(C.MES,'ENERO','01',
                                                                                 'FEBRERO','02',
                                                                                 'MARZO','03',
                                                                                 'ABRIL','04',
                                                                                 'MAYO','05',
                                                                                 'JUNIO','06',
                                                                                 'JULIO','07',
                                                                                 'AGOSTO','08',
                                                                                 'SEPTIEMBRE','09',
                                                                                 'OCTUBRE','10',
                                                                                 'NOVIEMBRE','11',
                                                                                 'DICIEMBRE','12')) 
                 AND TO_NUMBER(C.ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(C.ANNO),'MESFINA')) >= TO_NUMBER(C.Anno||DECODE(C.MES,'ENERO','01',
                                                                                 'FEBRERO','02',
                                                                                 'MARZO','03',
                                                                                 'ABRIL','04',
                                                                                 'MAYO','05',
                                                                                 'JUNIO','06',
                                                                                 'JULIO','07',
                                                                                 'AGOSTO','08',
                                                                                 'SEPTIEMBRE','09',
                                                                                 'OCTUBRE','10',
                                                                                 'NOVIEMBRE','11',
                                                                                 'DICIEMBRE','12'))
               GROUP BY C.EMPRESA, C.ANNO, P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA')) IND,
               (SELECT PL.EMPRESA, PL.ANNO, PL.SECCION, PL.NUMEPEUN
                FROM ANE_CONFPMSR PL
                WHERE --PL.SECCION = vSeccion
                  --AND 
                      PL.EMPRESA = P_UTILIDAD.F_VALODEVA('EMPRPHAR')--vEMPRPHAR
                  --AND PL.ANNO = vAnno
                  AND TO_NUMBER(PL.ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(PL.ANNO),'MESINIC')) <= TO_NUMBER(PL.Anno||DECODE(PL.MES,'ENERO','01',
                                                                                 'FEBRERO','02',
                                                                                 'MARZO','03',
                                                                                 'ABRIL','04',
                                                                                 'MAYO','05',
                                                                                 'JUNIO','06',
                                                                                 'JULIO','07',
                                                                                 'AGOSTO','08',
                                                                                 'SEPTIEMBRE','09',
                                                                                 'OCTUBRE','10',
                                                                                 'NOVIEMBRE','11',
                                                                                 'DICIEMBRE','12')) 
                  AND TO_NUMBER(PL.ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(PL.ANNO),'MESFINA')) >= TO_NUMBER(PL.Anno||DECODE(PL.MES,'ENERO','01',
                                                                                 'FEBRERO','02',
                                                                                 'MARZO','03',
                                                                                 'ABRIL','04',
                                                                                 'MAYO','05',
                                                                                 'JUNIO','06',
                                                                                 'JULIO','07',
                                                                                 'AGOSTO','08',
                                                                                 'SEPTIEMBRE','09',
                                                                                 'OCTUBRE','10',
                                                                                 'NOVIEMBRE','11',
                                                                                 'DICIEMBRE','12'))) PER
         WHERE PER.EMPRESA = IND.EMPRESA
           AND PER.ANNO = IND.ANNO
         )
         GROUP BY EMPRESA, ANNO, ESTRUCTURA, SECCION) COSTRRHH_10,
        (SELECT EMPRESA, ANNO, ESTRUCTURA, SECCION, SUM(COSTE) COSTE FROM (
         SELECT CP.EMPRESA, CP.ANNO, P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA') ESTRUCTURA, CP.SECCION, SUM(CP.COSTE) COSTE FROM ANE_CONFCPDR CP, VALORES_LISTA CO, VALORES_LISTA CI
         WHERE CO.CODIGO = 'ANE_ESTREXCR'
           --AND P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA') = vEstructu
           AND P_UTILIDAD.F_ValoCampo(CO.VALOR,'COSTINCL') = CI.CODIGO
           AND CP.CONCEPTO = CI.VALOR
           AND CP.EMPRESA = P_UTILIDAD.F_VALODEVA('EMPRMANV')--vEMPRMANV
           --AND CP.ANNO = vAnno
           AND TO_NUMBER(ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(CP.ANNO),'MESINIC')) <= TO_NUMBER(CP.ANNO||DECODE(CP.MES,'ENERO','01',
                                                                                 'FEBRERO','02',
                                                                                 'MARZO','03',
                                                                                 'ABRIL','04',
                                                                                 'MAYO','05',
                                                                                 'JUNIO','06',
                                                                                 'JULIO','07',
                                                                                 'AGOSTO','08',
                                                                                 'SEPTIEMBRE','09',
                                                                                 'OCTUBRE','10',
                                                                                 'NOVIEMBRE','11',
                                                                                 'DICIEMBRE','12')) 
           AND TO_NUMBER(ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(CP.ANNO),'MESFINA')) >= TO_NUMBER(CP.ANNO||DECODE(CP.MES,'ENERO','01',
                                                                                 'FEBRERO','02',
                                                                                 'MARZO','03',
                                                                                 'ABRIL','04',
                                                                                 'MAYO','05',
                                                                                 'JUNIO','06',
                                                                                 'JULIO','07',
                                                                                 'AGOSTO','08',
                                                                                 'SEPTIEMBRE','09',
                                                                                 'OCTUBRE','10',
                                                                                 'NOVIEMBRE','11',
                                                                                 'DICIEMBRE','12'))
           --AND CP.SECCION = vSeccion
         GROUP BY CP.EMPRESA, CP.ANNO, P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA'), CP.SECCION
         UNION ALL
         SELECT CP.EMPRESA, CP.ANNO, P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA') ESTRUCTURA, P_UTILIDAD.F_ValoCampo(CD.VALOR,'CODIDEPA') SECCION, SUM(CP.COSTE) COSTE FROM PRD_CONFCPDR CP, VALORES_LISTA CO, VALORES_LISTA CI, VALORES_LISTA CD
         WHERE CO.CODIGO = 'ANE_ESTREXCR'
           --AND P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA') = vEstructu
           AND P_UTILIDAD.F_ValoCampo(CO.VALOR,'COSTINCL') = CI.CODIGO
           AND CP.CONCEPTO = CI.VALOR
           AND CD.CODIGO = 'PRD_SECCCMOP'
           --AND P_UTILIDAD.F_ValoCampo(CD.VALOR,'CODIDEPA') = vSeccion
           AND CP.EMPRESA = P_UTILIDAD.F_VALODEVA('EMPRMANV')--vEMPRMANV
           --AND CP.ANNO = vANNO
           AND TO_NUMBER(ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(CP.ANNO),'MESINIC')) <= TO_NUMBER(CP.ANNO||DECODE(CP.MES,'ENERO','01',
                                                                                 'FEBRERO','02',
                                                                                 'MARZO','03',
                                                                                 'ABRIL','04',
                                                                                 'MAYO','05',
                                                                                 'JUNIO','06',
                                                                                 'JULIO','07',
                                                                                 'AGOSTO','08',
                                                                                 'SEPTIEMBRE','09',
                                                                                 'OCTUBRE','10',
                                                                                 'NOVIEMBRE','11',
                                                                                 'DICIEMBRE','12')) 
           AND TO_NUMBER(ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(CP.ANNO),'MESFINA')) >= TO_NUMBER(CP.ANNO||DECODE(CP.MES,'ENERO','01',
                                                                                 'FEBRERO','02',
                                                                                 'MARZO','03',
                                                                                 'ABRIL','04',
                                                                                 'MAYO','05',
                                                                                 'JUNIO','06',
                                                                                 'JULIO','07',
                                                                                 'AGOSTO','08',
                                                                                 'SEPTIEMBRE','09',
                                                                                 'OCTUBRE','10',
                                                                                 'NOVIEMBRE','11',
                                                                                 'DICIEMBRE','12'))
           AND CP.TIPOMAQU = P_UTILIDAD.F_ValoCampo(CD.VALOR,'SECCION')
         GROUP BY CP.EMPRESA, CP.ANNO, P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA'), P_UTILIDAD.F_ValoCampo(CD.VALOR,'CODIDEPA')
         UNION ALL
         SELECT CP.EMPRESA, CP.ANNO, P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA') ESTRUCTURA, CP.SECCION, SUM(CP.COSTE) COSTE FROM ANE_CONFRCDR CP, VALORES_LISTA CO, VALORES_LISTA CI
         WHERE CO.CODIGO = 'ANE_ESTREXCR'
           --AND P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA') = vEstructu
           AND P_UTILIDAD.F_ValoCampo(CO.VALOR,'COSTINCL') = CI.CODIGO
           AND CP.CONCEPTO = CI.VALOR
           AND CP.EMPRESA = P_UTILIDAD.F_VALODEVA('EMPRMANV')--vEMPRMANV
           --AND CP.ANNO = vANNO
           AND TO_NUMBER(ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(CP.ANNO),'MESINIC')) <= TO_NUMBER(CP.ANNO||DECODE(CP.MES,'ENERO','01',
                                                                                 'FEBRERO','02',
                                                                                 'MARZO','03',
                                                                                 'ABRIL','04',
                                                                                 'MAYO','05',
                                                                                 'JUNIO','06',
                                                                                 'JULIO','07',
                                                                                 'AGOSTO','08',
                                                                                 'SEPTIEMBRE','09',
                                                                                 'OCTUBRE','10',
                                                                                 'NOVIEMBRE','11',
                                                                                 'DICIEMBRE','12')) 
           AND TO_NUMBER(ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(CP.ANNO),'MESFINA')) >= TO_NUMBER(CP.ANNO||DECODE(CP.MES,'ENERO','01',
                                                                                 'FEBRERO','02',
                                                                                 'MARZO','03',
                                                                                 'ABRIL','04',
                                                                                 'MAYO','05',
                                                                                 'JUNIO','06',
                                                                                 'JULIO','07',
                                                                                 'AGOSTO','08',
                                                                                 'SEPTIEMBRE','09',
                                                                                 'OCTUBRE','10',
                                                                                 'NOVIEMBRE','11',
                                                                                 'DICIEMBRE','12'))
           --AND CP.SECCION = vSeccion
         GROUP BY CP.EMPRESA, CP.ANNO, P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA'), CP.SECCION
         UNION ALL
         SELECT CP.EMPRESA, CP.ANNO, P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA') ESTRUCTURA, P_UTILIDAD.F_ValoCampo(CD.VALOR,'CODIDEPA') SECCION, SUM(CP.COSTE) COSTE FROM PRD_CONFRCDR CP, VALORES_LISTA CO, VALORES_LISTA CI, VALORES_LISTA CD
         WHERE CO.CODIGO = 'ANE_ESTREXCR'
           --AND P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA') = vEstructu
           AND P_UTILIDAD.F_ValoCampo(CO.VALOR,'COSTINCL') = CI.CODIGO
           AND CP.CONCEPTO = CI.VALOR
           AND CD.CODIGO = 'PRD_SECCCMOP'
           --AND P_UTILIDAD.F_ValoCampo(CD.VALOR,'CODIDEPA') = vSeccion
           AND CP.EMPRESA = P_UTILIDAD.F_VALODEVA('EMPRMANV')--vEMPRMANV
           --AND CP.ANNO = vANNO
           AND TO_NUMBER(ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(CP.ANNO),'MESINIC')) <= TO_NUMBER(CP.ANNO||DECODE(CP.MES,'ENERO','01',
                                                                                 'FEBRERO','02',
                                                                                 'MARZO','03',
                                                                                 'ABRIL','04',
                                                                                 'MAYO','05',
                                                                                 'JUNIO','06',
                                                                                 'JULIO','07',
                                                                                 'AGOSTO','08',
                                                                                 'SEPTIEMBRE','09',
                                                                                 'OCTUBRE','10',
                                                                                 'NOVIEMBRE','11',
                                                                                 'DICIEMBRE','12')) 
           AND TO_NUMBER(ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(CP.ANNO),'MESFINA')) >= TO_NUMBER(CP.ANNO||DECODE(CP.MES,'ENERO','01',
                                                                                 'FEBRERO','02',
                                                                                 'MARZO','03',
                                                                                 'ABRIL','04',
                                                                                 'MAYO','05',
                                                                                 'JUNIO','06',
                                                                                 'JULIO','07',
                                                                                 'AGOSTO','08',
                                                                                 'SEPTIEMBRE','09',
                                                                                 'OCTUBRE','10',
                                                                                 'NOVIEMBRE','11',
                                                                                 'DICIEMBRE','12'))
           AND CP.TIPOMAQU = P_UTILIDAD.F_ValoCampo(CD.VALOR,'SECCION')
         GROUP BY CP.EMPRESA, CP.ANNO, P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA'), P_UTILIDAD.F_ValoCampo(CD.VALOR,'CODIDEPA')
         --------------Costes Indirectos CMOP
         UNION ALL
         SELECT PER.EMPRESA, PER.ANNO, IND.ESTRUCTURA, PER.SECCION, IND.COSTINDI * (PER.NUMEOFIC + PER.NUMEAYUD) COSTE
         FROM
               (SELECT C.EMPRESA, C.ANNO, P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA') ESTRUCTURA, SUM(C.COSTE / I.NUMEPERS) COSTINDI 
                  FROM PRD_CONFCOIR C, VALORES_LISTA L, PRD_CONFINRE I, 
                       VALORES_LISTA CO, VALORES_LISTA CI
               WHERE C.CONCEPTO = P_UTILIDAD.F_VALOCAMPO(L.VALOR,'CONCEPTO')
                 AND C.EMPRESA = I.EMPRESA
                 AND C.ANNO = I.ANNO
                 AND C.MES = I.MES
                 AND P_UTILIDAD.F_VALOCAMPO(L.VALOR,'INDUCTOR') = I.INDUCTOR
                 AND L.CODIGO = 'PRD_COPRASIN'
                 AND CO.CODIGO = 'ANE_ESTREXCR'
                 --AND P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA') = vEstructu
                 AND P_UTILIDAD.F_ValoCampo(CO.VALOR,'COSTINCL') = CI.CODIGO
                 AND C.CONCEPTO = CI.VALOR
                 AND NVL(I.NUMEPERS,0) != 0
                 AND C.EMPRESA = P_UTILIDAD.F_VALODEVA('EMPRMANV')--vEMPRMANV
                 --AND C.ANNO = vAnno
                 AND TO_NUMBER(C.ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(C.ANNO),'MESINIC')) <= TO_NUMBER(C.Anno||DECODE(C.MES,'ENERO','01',
                                                                                 'FEBRERO','02',
                                                                                 'MARZO','03',
                                                                                 'ABRIL','04',
                                                                                 'MAYO','05',
                                                                                 'JUNIO','06',
                                                                                 'JULIO','07',
                                                                                 'AGOSTO','08',
                                                                                 'SEPTIEMBRE','09',
                                                                                 'OCTUBRE','10',
                                                                                 'NOVIEMBRE','11',
                                                                                 'DICIEMBRE','12')) 
                 AND TO_NUMBER(C.ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(C.ANNO),'MESFINA')) >= TO_NUMBER(C.Anno||DECODE(C.MES,'ENERO','01',
                                                                                 'FEBRERO','02',
                                                                                 'MARZO','03',
                                                                                 'ABRIL','04',
                                                                                 'MAYO','05',
                                                                                 'JUNIO','06',
                                                                                 'JULIO','07',
                                                                                 'AGOSTO','08',
                                                                                 'SEPTIEMBRE','09',
                                                                                 'OCTUBRE','10',
                                                                                 'NOVIEMBRE','11',
                                                                                 'DICIEMBRE','12'))
               GROUP BY C.EMPRESA, C.ANNO, P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA')) IND,
               (SELECT PL.EMPRESA, PL.ANNO, P_UTILIDAD.F_ValoCampo(CD.VALOR,'CODIDEPA') SECCION, PL.NUMEOFIC, PL.NUMEAYUD 
                FROM PRD_CONFPMSR PL, VALORES_LISTA CD
                WHERE CD.CODIGO = 'PRD_SECCCMOP'
                  AND PL.TIPOMAQU = P_UTILIDAD.F_ValoCampo(CD.VALOR,'SECCION')
                  --AND P_UTILIDAD.F_ValoCampo(CD.VALOR,'CODIDEPA') = vSeccion
                  AND PL.EMPRESA = P_UTILIDAD.F_VALODEVA('EMPRMANV')--vEMPRMANV
                  --AND PL.ANNO = vAnno
                  AND TO_NUMBER(PL.ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(PL.ANNO),'MESINIC')) <= TO_NUMBER(PL.Anno||DECODE(PL.MES,'ENERO','01',
                                                                                 'FEBRERO','02',
                                                                                 'MARZO','03',
                                                                                 'ABRIL','04',
                                                                                 'MAYO','05',
                                                                                 'JUNIO','06',
                                                                                 'JULIO','07',
                                                                                 'AGOSTO','08',
                                                                                 'SEPTIEMBRE','09',
                                                                                 'OCTUBRE','10',
                                                                                 'NOVIEMBRE','11',
                                                                                 'DICIEMBRE','12')) 
                  AND TO_NUMBER(PL.ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(PL.ANNO),'MESFINA')) >= TO_NUMBER(PL.Anno||DECODE(PL.MES,'ENERO','01',
                                                                                 'FEBRERO','02',
                                                                                 'MARZO','03',
                                                                                 'ABRIL','04',
                                                                                 'MAYO','05',
                                                                                 'JUNIO','06',
                                                                                 'JULIO','07',
                                                                                 'AGOSTO','08',
                                                                                 'SEPTIEMBRE','09',
                                                                                 'OCTUBRE','10',
                                                                                 'NOVIEMBRE','11',
                                                                                 'DICIEMBRE','12'))) PER
         WHERE PER.EMPRESA = IND.EMPRESA
           AND PER.ANNO = IND.ANNO
         --------------Costes Indirectos Departamentales Inductor diferente a Personal Uniformado
         UNION ALL
         SELECT PER.EMPRESA, PER.ANNO, IND.ESTRUCTURA, PER.SECCION, IND.COSTINDI * PER.NUMEPERS COSTE
         FROM
               (SELECT C.EMPRESA, C.ANNO, P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA') ESTRUCTURA, SUM(C.COSTE / I.NUMEPERS) COSTINDI 
                  FROM PRD_CONFCOIR C, VALORES_LISTA L, PRD_CONFINRE I, 
                       VALORES_LISTA CO, VALORES_LISTA CI
               WHERE C.CONCEPTO = P_UTILIDAD.F_VALOCAMPO(L.VALOR,'CONCEPTO')
                 AND C.EMPRESA = I.EMPRESA
                 AND C.ANNO = I.ANNO
                 AND C.MES = I.MES
                 AND P_UTILIDAD.F_VALOCAMPO(L.VALOR,'INDUCTOR') = I.INDUCTOR
                 AND L.CODIGO = 'PRD_COPRASIN'
                 AND CO.CODIGO = 'ANE_ESTREXCR'
                 --AND P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA') = vEstructu
                 AND P_UTILIDAD.F_ValoCampo(CO.VALOR,'COSTINCL') = CI.CODIGO
                 AND C.CONCEPTO = CI.VALOR
                 AND I.INDUCTOR != P_UTILIDAD.F_VALODEVA('INDUPEUN')--vINDUPEUN --PERSONAL UNIFORMADO
                 AND NVL(I.NUMEPERS,0) != 0
                 AND C.EMPRESA = P_UTILIDAD.F_VALODEVA('EMPRMANV')--vEMPRMANV
                 --AND C.ANNO = vAnno
                 AND TO_NUMBER(C.ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(C.ANNO),'MESINIC')) <= TO_NUMBER(C.Anno||DECODE(C.MES,'ENERO','01',
                                                                                 'FEBRERO','02',
                                                                                 'MARZO','03',
                                                                                 'ABRIL','04',
                                                                                 'MAYO','05',
                                                                                 'JUNIO','06',
                                                                                 'JULIO','07',
                                                                                 'AGOSTO','08',
                                                                                 'SEPTIEMBRE','09',
                                                                                 'OCTUBRE','10',
                                                                                 'NOVIEMBRE','11',
                                                                                 'DICIEMBRE','12')) 
                 AND TO_NUMBER(C.ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(C.ANNO),'MESFINA')) >= TO_NUMBER(C.Anno||DECODE(C.MES,'ENERO','01',
                                                                                 'FEBRERO','02',
                                                                                 'MARZO','03',
                                                                                 'ABRIL','04',
                                                                                 'MAYO','05',
                                                                                 'JUNIO','06',
                                                                                 'JULIO','07',
                                                                                 'AGOSTO','08',
                                                                                 'SEPTIEMBRE','09',
                                                                                 'OCTUBRE','10',
                                                                                 'NOVIEMBRE','11',
                                                                                 'DICIEMBRE','12'))
               GROUP BY C.EMPRESA, C.ANNO, P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA')) IND,
               (SELECT PL.EMPRESA, PL.ANNO, PL.SECCION, PL.NUMEPERS
                FROM ANE_CONFPMSR PL
                WHERE --PL.SECCION = vSeccion
                  --AND 
                       PL.EMPRESA = P_UTILIDAD.F_VALODEVA('EMPRMANV')--vEMPRMANV
                  --AND PL.ANNO = vAnno
                  AND TO_NUMBER(PL.ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(PL.ANNO),'MESINIC')) <= TO_NUMBER(PL.Anno||DECODE(PL.MES,'ENERO','01',
                                                                                 'FEBRERO','02',
                                                                                 'MARZO','03',
                                                                                 'ABRIL','04',
                                                                                 'MAYO','05',
                                                                                 'JUNIO','06',
                                                                                 'JULIO','07',
                                                                                 'AGOSTO','08',
                                                                                 'SEPTIEMBRE','09',
                                                                                 'OCTUBRE','10',
                                                                                 'NOVIEMBRE','11',
                                                                                 'DICIEMBRE','12')) 
                  AND TO_NUMBER(PL.ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(PL.ANNO),'MESFINA')) >= TO_NUMBER(PL.Anno||DECODE(PL.MES,'ENERO','01',
                                                                                 'FEBRERO','02',
                                                                                 'MARZO','03',
                                                                                 'ABRIL','04',
                                                                                 'MAYO','05',
                                                                                 'JUNIO','06',
                                                                                 'JULIO','07',
                                                                                 'AGOSTO','08',
                                                                                 'SEPTIEMBRE','09',
                                                                                 'OCTUBRE','10',
                                                                                 'NOVIEMBRE','11',
                                                                                 'DICIEMBRE','12'))) PER
         WHERE PER.EMPRESA = IND.EMPRESA
           AND PER.ANNO = IND.ANNO
         --------------Costes Indirectos Departamentales Inductor igual a Personal Uniformado
         UNION ALL
         SELECT PER.EMPRESA, PER.ANNO, IND.ESTRUCTURA, PER.SECCION, IND.COSTINDI * PER.NUMEPEUN COSTE
         FROM
               (SELECT C.EMPRESA, C.ANNO, P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA') ESTRUCTURA, SUM(C.COSTE / I.NUMEPERS) COSTINDI 
                  FROM PRD_CONFCOIR C, VALORES_LISTA L, PRD_CONFINRE I, 
                       VALORES_LISTA CO, VALORES_LISTA CI
               WHERE C.CONCEPTO = P_UTILIDAD.F_VALOCAMPO(L.VALOR,'CONCEPTO')
                 AND C.EMPRESA = I.EMPRESA
                 AND C.ANNO = I.ANNO
                 AND C.MES = I.MES
                 AND P_UTILIDAD.F_VALOCAMPO(L.VALOR,'INDUCTOR') = I.INDUCTOR
                 AND L.CODIGO = 'PRD_COPRASIN'
                 AND CO.CODIGO = 'ANE_ESTREXCR'
                 --AND P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA') = vEstructu
                 AND P_UTILIDAD.F_ValoCampo(CO.VALOR,'COSTINCL') = CI.CODIGO
                 AND C.CONCEPTO = CI.VALOR
                 AND I.INDUCTOR = P_UTILIDAD.F_VALODEVA('INDUPEUN')--vINDUPEUN --PERSONAL UNIFORMADO
                 AND NVL(I.NUMEPERS,0) != 0
                 AND C.EMPRESA = P_UTILIDAD.F_VALODEVA('EMPRMANV')--vEMPRMANV
                 --AND C.ANNO = vAnno
                 AND TO_NUMBER(C.ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(C.ANNO),'MESINIC')) <= TO_NUMBER(C.Anno||DECODE(C.MES,'ENERO','01',
                                                                                 'FEBRERO','02',
                                                                                 'MARZO','03',
                                                                                 'ABRIL','04',
                                                                                 'MAYO','05',
                                                                                 'JUNIO','06',
                                                                                 'JULIO','07',
                                                                                 'AGOSTO','08',
                                                                                 'SEPTIEMBRE','09',
                                                                                 'OCTUBRE','10',
                                                                                 'NOVIEMBRE','11',
                                                                                 'DICIEMBRE','12')) 
                 AND TO_NUMBER(C.ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(C.ANNO),'MESFINA')) >= TO_NUMBER(C.Anno||DECODE(C.MES,'ENERO','01',
                                                                                 'FEBRERO','02',
                                                                                 'MARZO','03',
                                                                                 'ABRIL','04',
                                                                                 'MAYO','05',
                                                                                 'JUNIO','06',
                                                                                 'JULIO','07',
                                                                                 'AGOSTO','08',
                                                                                 'SEPTIEMBRE','09',
                                                                                 'OCTUBRE','10',
                                                                                 'NOVIEMBRE','11',
                                                                                 'DICIEMBRE','12'))
               GROUP BY C.EMPRESA, C.ANNO, P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA')) IND,
               (SELECT PL.EMPRESA, PL.ANNO, PL.SECCION, PL.NUMEPEUN
                FROM ANE_CONFPMSR PL
                WHERE --PL.SECCION = vSeccion
                  --AND 
                      PL.EMPRESA = P_UTILIDAD.F_VALODEVA('EMPRMANV')--vEMPRMANV
                  --AND PL.ANNO = vAnno
                  AND TO_NUMBER(PL.ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(PL.ANNO),'MESINIC')) <= TO_NUMBER(PL.Anno||DECODE(PL.MES,'ENERO','01',
                                                                                 'FEBRERO','02',
                                                                                 'MARZO','03',
                                                                                 'ABRIL','04',
                                                                                 'MAYO','05',
                                                                                 'JUNIO','06',
                                                                                 'JULIO','07',
                                                                                 'AGOSTO','08',
                                                                                 'SEPTIEMBRE','09',
                                                                                 'OCTUBRE','10',
                                                                                 'NOVIEMBRE','11',
                                                                                 'DICIEMBRE','12')) 
                  AND TO_NUMBER(PL.ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(PL.ANNO),'MESFINA')) >= TO_NUMBER(PL.Anno||DECODE(PL.MES,'ENERO','01',
                                                                                 'FEBRERO','02',
                                                                                 'MARZO','03',
                                                                                 'ABRIL','04',
                                                                                 'MAYO','05',
                                                                                 'JUNIO','06',
                                                                                 'JULIO','07',
                                                                                 'AGOSTO','08',
                                                                                 'SEPTIEMBRE','09',
                                                                                 'OCTUBRE','10',
                                                                                 'NOVIEMBRE','11',
                                                                                 'DICIEMBRE','12'))) PER
         WHERE PER.EMPRESA = IND.EMPRESA
           AND PER.ANNO = IND.ANNO
         )
         GROUP BY EMPRESA, ANNO, ESTRUCTURA, SECCION) COSTRRHH_05,
        (SELECT EMPRESA, ANNO, ESTRUCTURA, SECCION, SUM(COSTE) COSTE FROM (
         SELECT CP.EMPRESA, CP.ANNO, P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA') ESTRUCTURA, CP.SECCION, SUM(CP.COSTE) COSTE FROM ANE_CONFCPDR CP, VALORES_LISTA CO, VALORES_LISTA CI
         WHERE CO.CODIGO = 'ANE_ESTREXCR'
           --AND P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA') = vEstructu
           AND P_UTILIDAD.F_ValoCampo(CO.VALOR,'COSTINCL') = CI.CODIGO
           AND CP.CONCEPTO = CI.VALOR
           AND CP.EMPRESA = P_UTILIDAD.F_VALODEVA('EMPREXTR')--vEMPREXTR
           --AND CP.ANNO = vAnno
           AND TO_NUMBER(ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(CP.ANNO),'MESINIC')) <= TO_NUMBER(CP.ANNO||DECODE(CP.MES,'ENERO','01',
                                                                                 'FEBRERO','02',
                                                                                 'MARZO','03',
                                                                                 'ABRIL','04',
                                                                                 'MAYO','05',
                                                                                 'JUNIO','06',
                                                                                 'JULIO','07',
                                                                                 'AGOSTO','08',
                                                                                 'SEPTIEMBRE','09',
                                                                                 'OCTUBRE','10',
                                                                                 'NOVIEMBRE','11',
                                                                                 'DICIEMBRE','12')) 
           AND TO_NUMBER(ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(CP.ANNO),'MESFINA')) >= TO_NUMBER(CP.ANNO||DECODE(CP.MES,'ENERO','01',
                                                                                 'FEBRERO','02',
                                                                                 'MARZO','03',
                                                                                 'ABRIL','04',
                                                                                 'MAYO','05',
                                                                                 'JUNIO','06',
                                                                                 'JULIO','07',
                                                                                 'AGOSTO','08',
                                                                                 'SEPTIEMBRE','09',
                                                                                 'OCTUBRE','10',
                                                                                 'NOVIEMBRE','11',
                                                                                 'DICIEMBRE','12'))
           --AND CP.SECCION = vSeccion
         GROUP BY CP.EMPRESA, CP.ANNO, P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA'), CP.SECCION
         UNION ALL
         SELECT CP.EMPRESA, CP.ANNO, P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA') ESTRUCTURA, P_UTILIDAD.F_ValoCampo(CD.VALOR,'CODIDEPA') SECCION, SUM(CP.COSTE) COSTE FROM PRD_CONFCPDR CP, VALORES_LISTA CO, VALORES_LISTA CI, VALORES_LISTA CD
         WHERE CO.CODIGO = 'ANE_ESTREXCR'
           --AND P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA') = vEstructu
           AND P_UTILIDAD.F_ValoCampo(CO.VALOR,'COSTINCL') = CI.CODIGO
           AND CP.CONCEPTO = CI.VALOR
           AND CD.CODIGO = 'PRD_SECCCMOP'
           --AND P_UTILIDAD.F_ValoCampo(CD.VALOR,'CODIDEPA') = vSeccion
           AND CP.EMPRESA = P_UTILIDAD.F_VALODEVA('EMPREXTR')--vEMPREXTR
           --AND CP.ANNO = vANNO
           AND TO_NUMBER(ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(CP.ANNO),'MESINIC')) <= TO_NUMBER(CP.ANNO||DECODE(CP.MES,'ENERO','01',
                                                                                 'FEBRERO','02',
                                                                                 'MARZO','03',
                                                                                 'ABRIL','04',
                                                                                 'MAYO','05',
                                                                                 'JUNIO','06',
                                                                                 'JULIO','07',
                                                                                 'AGOSTO','08',
                                                                                 'SEPTIEMBRE','09',
                                                                                 'OCTUBRE','10',
                                                                                 'NOVIEMBRE','11',
                                                                                 'DICIEMBRE','12')) 
           AND TO_NUMBER(ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(CP.ANNO),'MESFINA')) >= TO_NUMBER(CP.ANNO||DECODE(CP.MES,'ENERO','01',
                                                                                 'FEBRERO','02',
                                                                                 'MARZO','03',
                                                                                 'ABRIL','04',
                                                                                 'MAYO','05',
                                                                                 'JUNIO','06',
                                                                                 'JULIO','07',
                                                                                 'AGOSTO','08',
                                                                                 'SEPTIEMBRE','09',
                                                                                 'OCTUBRE','10',
                                                                                 'NOVIEMBRE','11',
                                                                                 'DICIEMBRE','12'))
           AND CP.TIPOMAQU = P_UTILIDAD.F_ValoCampo(CD.VALOR,'SECCION')
         GROUP BY CP.EMPRESA, CP.ANNO, P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA'), P_UTILIDAD.F_ValoCampo(CD.VALOR,'CODIDEPA')
         UNION ALL
         SELECT CP.EMPRESA, CP.ANNO, P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA') ESTRUCTURA, CP.SECCION, SUM(CP.COSTE) COSTE FROM ANE_CONFRCDR CP, VALORES_LISTA CO, VALORES_LISTA CI
         WHERE CO.CODIGO = 'ANE_ESTREXCR'
           --AND P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA') = vEstructu
           AND P_UTILIDAD.F_ValoCampo(CO.VALOR,'COSTINCL') = CI.CODIGO
           AND CP.CONCEPTO = CI.VALOR
           AND CP.EMPRESA = P_UTILIDAD.F_VALODEVA('EMPREXTR')--vEMPREXTR
           --AND CP.ANNO = vANNO
           AND TO_NUMBER(ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(CP.ANNO),'MESINIC')) <= TO_NUMBER(CP.ANNO||DECODE(CP.MES,'ENERO','01',
                                                                                 'FEBRERO','02',
                                                                                 'MARZO','03',
                                                                                 'ABRIL','04',
                                                                                 'MAYO','05',
                                                                                 'JUNIO','06',
                                                                                 'JULIO','07',
                                                                                 'AGOSTO','08',
                                                                                 'SEPTIEMBRE','09',
                                                                                 'OCTUBRE','10',
                                                                                 'NOVIEMBRE','11',
                                                                                 'DICIEMBRE','12')) 
           AND TO_NUMBER(ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(CP.ANNO),'MESFINA')) >= TO_NUMBER(CP.ANNO||DECODE(CP.MES,'ENERO','01',
                                                                                 'FEBRERO','02',
                                                                                 'MARZO','03',
                                                                                 'ABRIL','04',
                                                                                 'MAYO','05',
                                                                                 'JUNIO','06',
                                                                                 'JULIO','07',
                                                                                 'AGOSTO','08',
                                                                                 'SEPTIEMBRE','09',
                                                                                 'OCTUBRE','10',
                                                                                 'NOVIEMBRE','11',
                                                                                 'DICIEMBRE','12'))
           --AND CP.SECCION = vSeccion
         GROUP BY CP.EMPRESA, CP.ANNO, P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA'), CP.SECCION
         UNION ALL
         SELECT CP.EMPRESA, CP.ANNO, P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA') ESTRUCTURA, P_UTILIDAD.F_ValoCampo(CD.VALOR,'CODIDEPA') SECCION, SUM(CP.COSTE) COSTE FROM PRD_CONFRCDR CP, VALORES_LISTA CO, VALORES_LISTA CI, VALORES_LISTA CD
         WHERE CO.CODIGO = 'ANE_ESTREXCR'
           --AND P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA') = vEstructu
           AND P_UTILIDAD.F_ValoCampo(CO.VALOR,'COSTINCL') = CI.CODIGO
           AND CP.CONCEPTO = CI.VALOR
           AND CD.CODIGO = 'PRD_SECCCMOP'
           --AND P_UTILIDAD.F_ValoCampo(CD.VALOR,'CODIDEPA') = vSeccion
           AND CP.EMPRESA = P_UTILIDAD.F_VALODEVA('EMPREXTR')--vEMPREXTR
           --AND CP.ANNO = vANNO
           AND TO_NUMBER(ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(CP.ANNO),'MESINIC')) <= TO_NUMBER(CP.ANNO||DECODE(CP.MES,'ENERO','01',
                                                                                 'FEBRERO','02',
                                                                                 'MARZO','03',
                                                                                 'ABRIL','04',
                                                                                 'MAYO','05',
                                                                                 'JUNIO','06',
                                                                                 'JULIO','07',
                                                                                 'AGOSTO','08',
                                                                                 'SEPTIEMBRE','09',
                                                                                 'OCTUBRE','10',
                                                                                 'NOVIEMBRE','11',
                                                                                 'DICIEMBRE','12')) 
           AND TO_NUMBER(ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(CP.ANNO),'MESFINA')) >= TO_NUMBER(CP.ANNO||DECODE(CP.MES,'ENERO','01',
                                                                                 'FEBRERO','02',
                                                                                 'MARZO','03',
                                                                                 'ABRIL','04',
                                                                                 'MAYO','05',
                                                                                 'JUNIO','06',
                                                                                 'JULIO','07',
                                                                                 'AGOSTO','08',
                                                                                 'SEPTIEMBRE','09',
                                                                                 'OCTUBRE','10',
                                                                                 'NOVIEMBRE','11',
                                                                                 'DICIEMBRE','12'))
           AND CP.TIPOMAQU = P_UTILIDAD.F_ValoCampo(CD.VALOR,'SECCION')
         GROUP BY CP.EMPRESA, CP.ANNO, P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA'), P_UTILIDAD.F_ValoCampo(CD.VALOR,'CODIDEPA')
         --------------Costes Indirectos CMOP
         UNION ALL
         SELECT PER.EMPRESA, PER.ANNO, IND.ESTRUCTURA, PER.SECCION, IND.COSTINDI * (PER.NUMEOFIC + PER.NUMEAYUD) COSTE
         FROM
               (SELECT C.EMPRESA, C.ANNO, P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA') ESTRUCTURA, SUM(C.COSTE / I.NUMEPERS) COSTINDI 
                  FROM PRD_CONFCOIR C, VALORES_LISTA L, PRD_CONFINRE I, 
                       VALORES_LISTA CO, VALORES_LISTA CI
               WHERE C.CONCEPTO = P_UTILIDAD.F_VALOCAMPO(L.VALOR,'CONCEPTO')
                 AND C.EMPRESA = I.EMPRESA
                 AND C.ANNO = I.ANNO
                 AND C.MES = I.MES
                 AND P_UTILIDAD.F_VALOCAMPO(L.VALOR,'INDUCTOR') = I.INDUCTOR
                 AND L.CODIGO = 'PRD_COPRASIN'
                 AND CO.CODIGO = 'ANE_ESTREXCR'
                 --AND P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA') = vEstructu
                 AND P_UTILIDAD.F_ValoCampo(CO.VALOR,'COSTINCL') = CI.CODIGO
                 AND C.CONCEPTO = CI.VALOR
                 AND NVL(I.NUMEPERS,0) != 0
                 AND C.EMPRESA = P_UTILIDAD.F_VALODEVA('EMPREXTR')--vEMPREXTR
                 --AND C.ANNO = vAnno
                 AND TO_NUMBER(C.ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(C.ANNO),'MESINIC')) <= TO_NUMBER(C.Anno||DECODE(C.MES,'ENERO','01',
                                                                                 'FEBRERO','02',
                                                                                 'MARZO','03',
                                                                                 'ABRIL','04',
                                                                                 'MAYO','05',
                                                                                 'JUNIO','06',
                                                                                 'JULIO','07',
                                                                                 'AGOSTO','08',
                                                                                 'SEPTIEMBRE','09',
                                                                                 'OCTUBRE','10',
                                                                                 'NOVIEMBRE','11',
                                                                                 'DICIEMBRE','12')) 
                 AND TO_NUMBER(C.ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(C.ANNO),'MESFINA')) >= TO_NUMBER(C.Anno||DECODE(C.MES,'ENERO','01',
                                                                                 'FEBRERO','02',
                                                                                 'MARZO','03',
                                                                                 'ABRIL','04',
                                                                                 'MAYO','05',
                                                                                 'JUNIO','06',
                                                                                 'JULIO','07',
                                                                                 'AGOSTO','08',
                                                                                 'SEPTIEMBRE','09',
                                                                                 'OCTUBRE','10',
                                                                                 'NOVIEMBRE','11',
                                                                                 'DICIEMBRE','12'))
               GROUP BY C.EMPRESA, C.ANNO, P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA')) IND,
               (SELECT PL.EMPRESA, PL.ANNO, P_UTILIDAD.F_ValoCampo(CD.VALOR,'CODIDEPA') SECCION, PL.NUMEOFIC, PL.NUMEAYUD 
                FROM PRD_CONFPMSR PL, VALORES_LISTA CD
                WHERE CD.CODIGO = 'PRD_SECCCMOP'
                  AND PL.TIPOMAQU = P_UTILIDAD.F_ValoCampo(CD.VALOR,'SECCION')
                  --AND P_UTILIDAD.F_ValoCampo(CD.VALOR,'CODIDEPA') = vSeccion
                  AND PL.EMPRESA = P_UTILIDAD.F_VALODEVA('EMPREXTR')--vEMPREXTR
                  --AND PL.ANNO = vAnno
                  AND TO_NUMBER(PL.ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(PL.ANNO),'MESINIC')) <= TO_NUMBER(PL.Anno||DECODE(PL.MES,'ENERO','01',
                                                                                 'FEBRERO','02',
                                                                                 'MARZO','03',
                                                                                 'ABRIL','04',
                                                                                 'MAYO','05',
                                                                                 'JUNIO','06',
                                                                                 'JULIO','07',
                                                                                 'AGOSTO','08',
                                                                                 'SEPTIEMBRE','09',
                                                                                 'OCTUBRE','10',
                                                                                 'NOVIEMBRE','11',
                                                                                 'DICIEMBRE','12')) 
                  AND TO_NUMBER(PL.ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(PL.ANNO),'MESFINA')) >= TO_NUMBER(PL.Anno||DECODE(PL.MES,'ENERO','01',
                                                                                 'FEBRERO','02',
                                                                                 'MARZO','03',
                                                                                 'ABRIL','04',
                                                                                 'MAYO','05',
                                                                                 'JUNIO','06',
                                                                                 'JULIO','07',
                                                                                 'AGOSTO','08',
                                                                                 'SEPTIEMBRE','09',
                                                                                 'OCTUBRE','10',
                                                                                 'NOVIEMBRE','11',
                                                                                 'DICIEMBRE','12'))) PER
         WHERE PER.EMPRESA = IND.EMPRESA
           AND PER.ANNO = IND.ANNO
         --------------Costes Indirectos Departamentales Inductor diferente a Personal Uniformado
         UNION ALL
         SELECT PER.EMPRESA, PER.ANNO, IND.ESTRUCTURA, PER.SECCION, IND.COSTINDI * PER.NUMEPERS COSTE
         FROM
               (SELECT C.EMPRESA, C.ANNO, P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA') ESTRUCTURA, SUM(C.COSTE / I.NUMEPERS) COSTINDI 
                  FROM PRD_CONFCOIR C, VALORES_LISTA L, PRD_CONFINRE I, 
                       VALORES_LISTA CO, VALORES_LISTA CI
               WHERE C.CONCEPTO = P_UTILIDAD.F_VALOCAMPO(L.VALOR,'CONCEPTO')
                 AND C.EMPRESA = I.EMPRESA
                 AND C.ANNO = I.ANNO
                 AND C.MES = I.MES
                 AND P_UTILIDAD.F_VALOCAMPO(L.VALOR,'INDUCTOR') = I.INDUCTOR
                 AND L.CODIGO = 'PRD_COPRASIN'
                 AND CO.CODIGO = 'ANE_ESTREXCR'
                 --AND P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA') = vEstructu
                 AND P_UTILIDAD.F_ValoCampo(CO.VALOR,'COSTINCL') = CI.CODIGO
                 AND C.CONCEPTO = CI.VALOR
                 AND I.INDUCTOR != P_UTILIDAD.F_VALODEVA('INDUPEUN')--vINDUPEUN --PERSONAL UNIFORMADO
                 AND NVL(I.NUMEPERS,0) != 0
                 AND C.EMPRESA = P_UTILIDAD.F_VALODEVA('EMPREXTR')--vEMPREXTR
                 --AND C.ANNO = vAnno
                 AND TO_NUMBER(C.ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(C.ANNO),'MESINIC')) <= TO_NUMBER(C.Anno||DECODE(C.MES,'ENERO','01',
                                                                                 'FEBRERO','02',
                                                                                 'MARZO','03',
                                                                                 'ABRIL','04',
                                                                                 'MAYO','05',
                                                                                 'JUNIO','06',
                                                                                 'JULIO','07',
                                                                                 'AGOSTO','08',
                                                                                 'SEPTIEMBRE','09',
                                                                                 'OCTUBRE','10',
                                                                                 'NOVIEMBRE','11',
                                                                                 'DICIEMBRE','12')) 
                 AND TO_NUMBER(C.ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(C.ANNO),'MESFINA')) >= TO_NUMBER(C.Anno||DECODE(C.MES,'ENERO','01',
                                                                                 'FEBRERO','02',
                                                                                 'MARZO','03',
                                                                                 'ABRIL','04',
                                                                                 'MAYO','05',
                                                                                 'JUNIO','06',
                                                                                 'JULIO','07',
                                                                                 'AGOSTO','08',
                                                                                 'SEPTIEMBRE','09',
                                                                                 'OCTUBRE','10',
                                                                                 'NOVIEMBRE','11',
                                                                                 'DICIEMBRE','12'))
               GROUP BY C.EMPRESA, C.ANNO, P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA')) IND,
               (SELECT PL.EMPRESA, PL.ANNO, PL.SECCION, PL.NUMEPERS
                FROM ANE_CONFPMSR PL
                WHERE --PL.SECCION = vSeccion
                  --AND 
                       PL.EMPRESA = P_UTILIDAD.F_VALODEVA('EMPREXTR')--vEMPREXTR
                  --AND PL.ANNO = vAnno
                  AND TO_NUMBER(PL.ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(PL.ANNO),'MESINIC')) <= TO_NUMBER(PL.Anno||DECODE(PL.MES,'ENERO','01',
                                                                                 'FEBRERO','02',
                                                                                 'MARZO','03',
                                                                                 'ABRIL','04',
                                                                                 'MAYO','05',
                                                                                 'JUNIO','06',
                                                                                 'JULIO','07',
                                                                                 'AGOSTO','08',
                                                                                 'SEPTIEMBRE','09',
                                                                                 'OCTUBRE','10',
                                                                                 'NOVIEMBRE','11',
                                                                                 'DICIEMBRE','12')) 
                  AND TO_NUMBER(PL.ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(PL.ANNO),'MESFINA')) >= TO_NUMBER(PL.Anno||DECODE(PL.MES,'ENERO','01',
                                                                                 'FEBRERO','02',
                                                                                 'MARZO','03',
                                                                                 'ABRIL','04',
                                                                                 'MAYO','05',
                                                                                 'JUNIO','06',
                                                                                 'JULIO','07',
                                                                                 'AGOSTO','08',
                                                                                 'SEPTIEMBRE','09',
                                                                                 'OCTUBRE','10',
                                                                                 'NOVIEMBRE','11',
                                                                                 'DICIEMBRE','12'))) PER
         WHERE PER.EMPRESA = IND.EMPRESA
           AND PER.ANNO = IND.ANNO
         --------------Costes Indirectos Departamentales Inductor igual a Personal Uniformado
         UNION ALL
         SELECT PER.EMPRESA, PER.ANNO, IND.ESTRUCTURA, PER.SECCION, IND.COSTINDI * PER.NUMEPEUN COSTE
         FROM
               (SELECT C.EMPRESA, C.ANNO, P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA') ESTRUCTURA, SUM(C.COSTE / I.NUMEPERS) COSTINDI 
                  FROM PRD_CONFCOIR C, VALORES_LISTA L, PRD_CONFINRE I, 
                       VALORES_LISTA CO, VALORES_LISTA CI
               WHERE C.CONCEPTO = P_UTILIDAD.F_VALOCAMPO(L.VALOR,'CONCEPTO')
                 AND C.EMPRESA = I.EMPRESA
                 AND C.ANNO = I.ANNO
                 AND C.MES = I.MES
                 AND P_UTILIDAD.F_VALOCAMPO(L.VALOR,'INDUCTOR') = I.INDUCTOR
                 AND L.CODIGO = 'PRD_COPRASIN'
                 AND CO.CODIGO = 'ANE_ESTREXCR'
                 --AND P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA') = vEstructu
                 AND P_UTILIDAD.F_ValoCampo(CO.VALOR,'COSTINCL') = CI.CODIGO
                 AND C.CONCEPTO = CI.VALOR
                 AND I.INDUCTOR = P_UTILIDAD.F_VALODEVA('INDUPEUN')--vINDUPEUN --PERSONAL UNIFORMADO
                 AND NVL(I.NUMEPERS,0) != 0
                 AND C.EMPRESA = P_UTILIDAD.F_VALODEVA('EMPREXTR')--vEMPREXTR
                 --AND C.ANNO = vAnno
                 AND TO_NUMBER(C.ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(C.ANNO),'MESINIC')) <= TO_NUMBER(C.Anno||DECODE(C.MES,'ENERO','01',
                                                                                 'FEBRERO','02',
                                                                                 'MARZO','03',
                                                                                 'ABRIL','04',
                                                                                 'MAYO','05',
                                                                                 'JUNIO','06',
                                                                                 'JULIO','07',
                                                                                 'AGOSTO','08',
                                                                                 'SEPTIEMBRE','09',
                                                                                 'OCTUBRE','10',
                                                                                 'NOVIEMBRE','11',
                                                                                 'DICIEMBRE','12')) 
                 AND TO_NUMBER(C.ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(C.ANNO),'MESFINA')) >= TO_NUMBER(C.Anno||DECODE(C.MES,'ENERO','01',
                                                                                 'FEBRERO','02',
                                                                                 'MARZO','03',
                                                                                 'ABRIL','04',
                                                                                 'MAYO','05',
                                                                                 'JUNIO','06',
                                                                                 'JULIO','07',
                                                                                 'AGOSTO','08',
                                                                                 'SEPTIEMBRE','09',
                                                                                 'OCTUBRE','10',
                                                                                 'NOVIEMBRE','11',
                                                                                 'DICIEMBRE','12'))
               GROUP BY C.EMPRESA, C.ANNO, P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA')) IND,
               (SELECT PL.EMPRESA, PL.ANNO, PL.SECCION, PL.NUMEPEUN
                FROM ANE_CONFPMSR PL
                WHERE --PL.SECCION = vSeccion
                  --AND 
                      PL.EMPRESA = P_UTILIDAD.F_VALODEVA('EMPREXTR')--vEMPREXTR
                  --AND PL.ANNO = vAnno
                  AND TO_NUMBER(PL.ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(PL.ANNO),'MESINIC')) <= TO_NUMBER(PL.Anno||DECODE(PL.MES,'ENERO','01',
                                                                                 'FEBRERO','02',
                                                                                 'MARZO','03',
                                                                                 'ABRIL','04',
                                                                                 'MAYO','05',
                                                                                 'JUNIO','06',
                                                                                 'JULIO','07',
                                                                                 'AGOSTO','08',
                                                                                 'SEPTIEMBRE','09',
                                                                                 'OCTUBRE','10',
                                                                                 'NOVIEMBRE','11',
                                                                                 'DICIEMBRE','12')) 
                  AND TO_NUMBER(PL.ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(PL.ANNO),'MESFINA')) >= TO_NUMBER(PL.Anno||DECODE(PL.MES,'ENERO','01',
                                                                                 'FEBRERO','02',
                                                                                 'MARZO','03',
                                                                                 'ABRIL','04',
                                                                                 'MAYO','05',
                                                                                 'JUNIO','06',
                                                                                 'JULIO','07',
                                                                                 'AGOSTO','08',
                                                                                 'SEPTIEMBRE','09',
                                                                                 'OCTUBRE','10',
                                                                                 'NOVIEMBRE','11',
                                                                                 'DICIEMBRE','12'))) PER
         WHERE PER.EMPRESA = IND.EMPRESA
           AND PER.ANNO = IND.ANNO
         )
         GROUP BY EMPRESA, ANNO, ESTRUCTURA, SECCION) COSTRRHH_35,
        (SELECT EMPRESA, ANNO, ESTRUCTURA, SECCION, SUM(COSTE) COSTE FROM (
         SELECT CP.EMPRESA, CP.ANNO, P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA') ESTRUCTURA, CP.SECCION, SUM(CP.COSTE) COSTE FROM ANE_CONFCPDR CP, VALORES_LISTA CO, VALORES_LISTA CI
         WHERE CO.CODIGO = 'ANE_ESTREXCR'
           --AND P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA') = vEstructu
           AND P_UTILIDAD.F_ValoCampo(CO.VALOR,'COSTINCL') = CI.CODIGO
           AND CP.CONCEPTO = CI.VALOR
           AND CP.EMPRESA = P_UTILIDAD.F_VALODEVA('EMPRGEST')--vEMPRGEST
           --AND CP.ANNO = vAnno
           AND TO_NUMBER(ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(CP.ANNO),'MESINIC')) <= TO_NUMBER(CP.ANNO||DECODE(CP.MES,'ENERO','01',
                                                                                 'FEBRERO','02',
                                                                                 'MARZO','03',
                                                                                 'ABRIL','04',
                                                                                 'MAYO','05',
                                                                                 'JUNIO','06',
                                                                                 'JULIO','07',
                                                                                 'AGOSTO','08',
                                                                                 'SEPTIEMBRE','09',
                                                                                 'OCTUBRE','10',
                                                                                 'NOVIEMBRE','11',
                                                                                 'DICIEMBRE','12')) 
           AND TO_NUMBER(ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(CP.ANNO),'MESFINA')) >= TO_NUMBER(CP.ANNO||DECODE(CP.MES,'ENERO','01',
                                                                                 'FEBRERO','02',
                                                                                 'MARZO','03',
                                                                                 'ABRIL','04',
                                                                                 'MAYO','05',
                                                                                 'JUNIO','06',
                                                                                 'JULIO','07',
                                                                                 'AGOSTO','08',
                                                                                 'SEPTIEMBRE','09',
                                                                                 'OCTUBRE','10',
                                                                                 'NOVIEMBRE','11',
                                                                                 'DICIEMBRE','12'))
           --AND CP.SECCION = vSeccion
         GROUP BY CP.EMPRESA, CP.ANNO, P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA'), CP.SECCION
         UNION ALL
         SELECT CP.EMPRESA, CP.ANNO, P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA') ESTRUCTURA, P_UTILIDAD.F_ValoCampo(CD.VALOR,'CODIDEPA') SECCION, SUM(CP.COSTE) COSTE FROM PRD_CONFCPDR CP, VALORES_LISTA CO, VALORES_LISTA CI, VALORES_LISTA CD
         WHERE CO.CODIGO = 'ANE_ESTREXCR'
           --AND P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA') = vEstructu
           AND P_UTILIDAD.F_ValoCampo(CO.VALOR,'COSTINCL') = CI.CODIGO
           AND CP.CONCEPTO = CI.VALOR
           AND CD.CODIGO = 'PRD_SECCCMOP'
           --AND P_UTILIDAD.F_ValoCampo(CD.VALOR,'CODIDEPA') = vSeccion
           AND CP.EMPRESA = P_UTILIDAD.F_VALODEVA('EMPRGEST')--vEMPRGEST
           --AND CP.ANNO = vANNO
           AND TO_NUMBER(ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(CP.ANNO),'MESINIC')) <= TO_NUMBER(CP.ANNO||DECODE(CP.MES,'ENERO','01',
                                                                                 'FEBRERO','02',
                                                                                 'MARZO','03',
                                                                                 'ABRIL','04',
                                                                                 'MAYO','05',
                                                                                 'JUNIO','06',
                                                                                 'JULIO','07',
                                                                                 'AGOSTO','08',
                                                                                 'SEPTIEMBRE','09',
                                                                                 'OCTUBRE','10',
                                                                                 'NOVIEMBRE','11',
                                                                                 'DICIEMBRE','12')) 
           AND TO_NUMBER(ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(CP.ANNO),'MESFINA')) >= TO_NUMBER(CP.ANNO||DECODE(CP.MES,'ENERO','01',
                                                                                 'FEBRERO','02',
                                                                                 'MARZO','03',
                                                                                 'ABRIL','04',
                                                                                 'MAYO','05',
                                                                                 'JUNIO','06',
                                                                                 'JULIO','07',
                                                                                 'AGOSTO','08',
                                                                                 'SEPTIEMBRE','09',
                                                                                 'OCTUBRE','10',
                                                                                 'NOVIEMBRE','11',
                                                                                 'DICIEMBRE','12'))
           AND CP.TIPOMAQU = P_UTILIDAD.F_ValoCampo(CD.VALOR,'SECCION')
         GROUP BY CP.EMPRESA, CP.ANNO, P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA'), P_UTILIDAD.F_ValoCampo(CD.VALOR,'CODIDEPA')
         UNION ALL
         SELECT CP.EMPRESA, CP.ANNO, P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA') ESTRUCTURA, CP.SECCION, SUM(CP.COSTE) COSTE FROM ANE_CONFRCDR CP, VALORES_LISTA CO, VALORES_LISTA CI
         WHERE CO.CODIGO = 'ANE_ESTREXCR'
           --AND P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA') = vEstructu
           AND P_UTILIDAD.F_ValoCampo(CO.VALOR,'COSTINCL') = CI.CODIGO
           AND CP.CONCEPTO = CI.VALOR
           AND CP.EMPRESA = P_UTILIDAD.F_VALODEVA('EMPRGEST')--vEMPRGEST
           --AND CP.ANNO = vANNO
           AND TO_NUMBER(ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(CP.ANNO),'MESINIC')) <= TO_NUMBER(CP.ANNO||DECODE(CP.MES,'ENERO','01',
                                                                                 'FEBRERO','02',
                                                                                 'MARZO','03',
                                                                                 'ABRIL','04',
                                                                                 'MAYO','05',
                                                                                 'JUNIO','06',
                                                                                 'JULIO','07',
                                                                                 'AGOSTO','08',
                                                                                 'SEPTIEMBRE','09',
                                                                                 'OCTUBRE','10',
                                                                                 'NOVIEMBRE','11',
                                                                                 'DICIEMBRE','12')) 
           AND TO_NUMBER(ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(CP.ANNO),'MESFINA')) >= TO_NUMBER(CP.ANNO||DECODE(CP.MES,'ENERO','01',
                                                                                 'FEBRERO','02',
                                                                                 'MARZO','03',
                                                                                 'ABRIL','04',
                                                                                 'MAYO','05',
                                                                                 'JUNIO','06',
                                                                                 'JULIO','07',
                                                                                 'AGOSTO','08',
                                                                                 'SEPTIEMBRE','09',
                                                                                 'OCTUBRE','10',
                                                                                 'NOVIEMBRE','11',
                                                                                 'DICIEMBRE','12'))
           --AND CP.SECCION = vSeccion
         GROUP BY CP.EMPRESA, CP.ANNO, P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA'), CP.SECCION
         UNION ALL
         SELECT CP.EMPRESA, CP.ANNO, P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA') ESTRUCTURA, P_UTILIDAD.F_ValoCampo(CD.VALOR,'CODIDEPA') SECCION, SUM(CP.COSTE) COSTE FROM PRD_CONFRCDR CP, VALORES_LISTA CO, VALORES_LISTA CI, VALORES_LISTA CD
         WHERE CO.CODIGO = 'ANE_ESTREXCR'
           --AND P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA') = vEstructu
           AND P_UTILIDAD.F_ValoCampo(CO.VALOR,'COSTINCL') = CI.CODIGO
           AND CP.CONCEPTO = CI.VALOR
           AND CD.CODIGO = 'PRD_SECCCMOP'
           --AND P_UTILIDAD.F_ValoCampo(CD.VALOR,'CODIDEPA') = vSeccion
           AND CP.EMPRESA = P_UTILIDAD.F_VALODEVA('EMPRGEST')--vEMPRGEST
           --AND CP.ANNO = vANNO
           AND TO_NUMBER(ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(CP.ANNO),'MESINIC')) <= TO_NUMBER(CP.ANNO||DECODE(CP.MES,'ENERO','01',
                                                                                 'FEBRERO','02',
                                                                                 'MARZO','03',
                                                                                 'ABRIL','04',
                                                                                 'MAYO','05',
                                                                                 'JUNIO','06',
                                                                                 'JULIO','07',
                                                                                 'AGOSTO','08',
                                                                                 'SEPTIEMBRE','09',
                                                                                 'OCTUBRE','10',
                                                                                 'NOVIEMBRE','11',
                                                                                 'DICIEMBRE','12')) 
           AND TO_NUMBER(ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(CP.ANNO),'MESFINA')) >= TO_NUMBER(CP.ANNO||DECODE(CP.MES,'ENERO','01',
                                                                                 'FEBRERO','02',
                                                                                 'MARZO','03',
                                                                                 'ABRIL','04',
                                                                                 'MAYO','05',
                                                                                 'JUNIO','06',
                                                                                 'JULIO','07',
                                                                                 'AGOSTO','08',
                                                                                 'SEPTIEMBRE','09',
                                                                                 'OCTUBRE','10',
                                                                                 'NOVIEMBRE','11',
                                                                                 'DICIEMBRE','12'))
           AND CP.TIPOMAQU = P_UTILIDAD.F_ValoCampo(CD.VALOR,'SECCION')
         GROUP BY CP.EMPRESA, CP.ANNO, P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA'), P_UTILIDAD.F_ValoCampo(CD.VALOR,'CODIDEPA')
         --------------Costes Indirectos CMOP
         UNION ALL
         SELECT PER.EMPRESA, PER.ANNO, IND.ESTRUCTURA, PER.SECCION, IND.COSTINDI * (PER.NUMEOFIC + PER.NUMEAYUD) COSTE
         FROM
               (SELECT C.EMPRESA, C.ANNO, P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA') ESTRUCTURA, SUM(C.COSTE / I.NUMEPERS) COSTINDI 
                  FROM PRD_CONFCOIR C, VALORES_LISTA L, PRD_CONFINRE I, 
                       VALORES_LISTA CO, VALORES_LISTA CI
               WHERE C.CONCEPTO = P_UTILIDAD.F_VALOCAMPO(L.VALOR,'CONCEPTO')
                 AND C.EMPRESA = I.EMPRESA
                 AND C.ANNO = I.ANNO
                 AND C.MES = I.MES
                 AND P_UTILIDAD.F_VALOCAMPO(L.VALOR,'INDUCTOR') = I.INDUCTOR
                 AND L.CODIGO = 'PRD_COPRASIN'
                 AND CO.CODIGO = 'ANE_ESTREXCR'
                 --AND P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA') = vEstructu
                 AND P_UTILIDAD.F_ValoCampo(CO.VALOR,'COSTINCL') = CI.CODIGO
                 AND C.CONCEPTO = CI.VALOR
                 AND NVL(I.NUMEPERS,0) != 0
                 AND C.EMPRESA = P_UTILIDAD.F_VALODEVA('EMPRGEST')--vEMPRGEST
                 --AND C.ANNO = vAnno
                 AND TO_NUMBER(C.ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(C.ANNO),'MESINIC')) <= TO_NUMBER(C.Anno||DECODE(C.MES,'ENERO','01',
                                                                                 'FEBRERO','02',
                                                                                 'MARZO','03',
                                                                                 'ABRIL','04',
                                                                                 'MAYO','05',
                                                                                 'JUNIO','06',
                                                                                 'JULIO','07',
                                                                                 'AGOSTO','08',
                                                                                 'SEPTIEMBRE','09',
                                                                                 'OCTUBRE','10',
                                                                                 'NOVIEMBRE','11',
                                                                                 'DICIEMBRE','12')) 
                 AND TO_NUMBER(C.ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(C.ANNO),'MESFINA')) >= TO_NUMBER(C.Anno||DECODE(C.MES,'ENERO','01',
                                                                                 'FEBRERO','02',
                                                                                 'MARZO','03',
                                                                                 'ABRIL','04',
                                                                                 'MAYO','05',
                                                                                 'JUNIO','06',
                                                                                 'JULIO','07',
                                                                                 'AGOSTO','08',
                                                                                 'SEPTIEMBRE','09',
                                                                                 'OCTUBRE','10',
                                                                                 'NOVIEMBRE','11',
                                                                                 'DICIEMBRE','12'))
               GROUP BY C.EMPRESA, C.ANNO, P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA')) IND,
               (SELECT PL.EMPRESA, PL.ANNO, P_UTILIDAD.F_ValoCampo(CD.VALOR,'CODIDEPA') SECCION, PL.NUMEOFIC, PL.NUMEAYUD 
                FROM PRD_CONFPMSR PL, VALORES_LISTA CD
                WHERE CD.CODIGO = 'PRD_SECCCMOP'
                  AND PL.TIPOMAQU = P_UTILIDAD.F_ValoCampo(CD.VALOR,'SECCION')
                  --AND P_UTILIDAD.F_ValoCampo(CD.VALOR,'CODIDEPA') = vSeccion
                  AND PL.EMPRESA = P_UTILIDAD.F_VALODEVA('EMPRGEST')--vEMPRGEST
                  --AND PL.ANNO = vAnno
                  AND TO_NUMBER(PL.ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(PL.ANNO),'MESINIC')) <= TO_NUMBER(PL.Anno||DECODE(PL.MES,'ENERO','01',
                                                                                 'FEBRERO','02',
                                                                                 'MARZO','03',
                                                                                 'ABRIL','04',
                                                                                 'MAYO','05',
                                                                                 'JUNIO','06',
                                                                                 'JULIO','07',
                                                                                 'AGOSTO','08',
                                                                                 'SEPTIEMBRE','09',
                                                                                 'OCTUBRE','10',
                                                                                 'NOVIEMBRE','11',
                                                                                 'DICIEMBRE','12')) 
                  AND TO_NUMBER(PL.ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(PL.ANNO),'MESFINA')) >= TO_NUMBER(PL.Anno||DECODE(PL.MES,'ENERO','01',
                                                                                 'FEBRERO','02',
                                                                                 'MARZO','03',
                                                                                 'ABRIL','04',
                                                                                 'MAYO','05',
                                                                                 'JUNIO','06',
                                                                                 'JULIO','07',
                                                                                 'AGOSTO','08',
                                                                                 'SEPTIEMBRE','09',
                                                                                 'OCTUBRE','10',
                                                                                 'NOVIEMBRE','11',
                                                                                 'DICIEMBRE','12'))) PER
         WHERE PER.EMPRESA = IND.EMPRESA
           AND PER.ANNO = IND.ANNO
         --------------Costes Indirectos Departamentales Inductor diferente a Personal Uniformado
         UNION ALL
         SELECT PER.EMPRESA, PER.ANNO, IND.ESTRUCTURA, PER.SECCION, IND.COSTINDI * PER.NUMEPERS COSTE
         FROM
               (SELECT C.EMPRESA, C.ANNO, P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA') ESTRUCTURA, SUM(C.COSTE / I.NUMEPERS) COSTINDI 
                  FROM PRD_CONFCOIR C, VALORES_LISTA L, PRD_CONFINRE I, 
                       VALORES_LISTA CO, VALORES_LISTA CI
               WHERE C.CONCEPTO = P_UTILIDAD.F_VALOCAMPO(L.VALOR,'CONCEPTO')
                 AND C.EMPRESA = I.EMPRESA
                 AND C.ANNO = I.ANNO
                 AND C.MES = I.MES
                 AND P_UTILIDAD.F_VALOCAMPO(L.VALOR,'INDUCTOR') = I.INDUCTOR
                 AND L.CODIGO = 'PRD_COPRASIN'
                 AND CO.CODIGO = 'ANE_ESTREXCR'
                 --AND P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA') = vEstructu
                 AND P_UTILIDAD.F_ValoCampo(CO.VALOR,'COSTINCL') = CI.CODIGO
                 AND C.CONCEPTO = CI.VALOR
                 AND I.INDUCTOR != P_UTILIDAD.F_VALODEVA('INDUPEUN')--vINDUPEUN --PERSONAL UNIFORMADO
                 AND NVL(I.NUMEPERS,0) != 0
                 AND C.EMPRESA = P_UTILIDAD.F_VALODEVA('EMPRGEST')--vEMPRGEST
                 --AND C.ANNO = vAnno
                 AND TO_NUMBER(C.ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(C.ANNO),'MESINIC')) <= TO_NUMBER(C.Anno||DECODE(C.MES,'ENERO','01',
                                                                                 'FEBRERO','02',
                                                                                 'MARZO','03',
                                                                                 'ABRIL','04',
                                                                                 'MAYO','05',
                                                                                 'JUNIO','06',
                                                                                 'JULIO','07',
                                                                                 'AGOSTO','08',
                                                                                 'SEPTIEMBRE','09',
                                                                                 'OCTUBRE','10',
                                                                                 'NOVIEMBRE','11',
                                                                                 'DICIEMBRE','12')) 
                 AND TO_NUMBER(C.ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(C.ANNO),'MESFINA')) >= TO_NUMBER(C.Anno||DECODE(C.MES,'ENERO','01',
                                                                                 'FEBRERO','02',
                                                                                 'MARZO','03',
                                                                                 'ABRIL','04',
                                                                                 'MAYO','05',
                                                                                 'JUNIO','06',
                                                                                 'JULIO','07',
                                                                                 'AGOSTO','08',
                                                                                 'SEPTIEMBRE','09',
                                                                                 'OCTUBRE','10',
                                                                                 'NOVIEMBRE','11',
                                                                                 'DICIEMBRE','12'))
               GROUP BY C.EMPRESA, C.ANNO, P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA')) IND,
               (SELECT PL.EMPRESA, PL.ANNO, PL.SECCION, PL.NUMEPERS
                FROM ANE_CONFPMSR PL
                WHERE --PL.SECCION = vSeccion
                  --AND 
                       PL.EMPRESA = P_UTILIDAD.F_VALODEVA('EMPRGEST')--vEMPRGEST
                  --AND PL.ANNO = vAnno
                  AND TO_NUMBER(PL.ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(PL.ANNO),'MESINIC')) <= TO_NUMBER(PL.Anno||DECODE(PL.MES,'ENERO','01',
                                                                                 'FEBRERO','02',
                                                                                 'MARZO','03',
                                                                                 'ABRIL','04',
                                                                                 'MAYO','05',
                                                                                 'JUNIO','06',
                                                                                 'JULIO','07',
                                                                                 'AGOSTO','08',
                                                                                 'SEPTIEMBRE','09',
                                                                                 'OCTUBRE','10',
                                                                                 'NOVIEMBRE','11',
                                                                                 'DICIEMBRE','12')) 
                  AND TO_NUMBER(PL.ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(PL.ANNO),'MESFINA')) >= TO_NUMBER(PL.Anno||DECODE(PL.MES,'ENERO','01',
                                                                                 'FEBRERO','02',
                                                                                 'MARZO','03',
                                                                                 'ABRIL','04',
                                                                                 'MAYO','05',
                                                                                 'JUNIO','06',
                                                                                 'JULIO','07',
                                                                                 'AGOSTO','08',
                                                                                 'SEPTIEMBRE','09',
                                                                                 'OCTUBRE','10',
                                                                                 'NOVIEMBRE','11',
                                                                                 'DICIEMBRE','12'))) PER
         WHERE PER.EMPRESA = IND.EMPRESA
           AND PER.ANNO = IND.ANNO
         --------------Costes Indirectos Departamentales Inductor igual a Personal Uniformado
         UNION ALL
         SELECT PER.EMPRESA, PER.ANNO, IND.ESTRUCTURA, PER.SECCION, IND.COSTINDI * PER.NUMEPEUN COSTE
         FROM
               (SELECT C.EMPRESA, C.ANNO, P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA') ESTRUCTURA, SUM(C.COSTE / I.NUMEPERS) COSTINDI 
                  FROM PRD_CONFCOIR C, VALORES_LISTA L, PRD_CONFINRE I, 
                       VALORES_LISTA CO, VALORES_LISTA CI
               WHERE C.CONCEPTO = P_UTILIDAD.F_VALOCAMPO(L.VALOR,'CONCEPTO')
                 AND C.EMPRESA = I.EMPRESA
                 AND C.ANNO = I.ANNO
                 AND C.MES = I.MES
                 AND P_UTILIDAD.F_VALOCAMPO(L.VALOR,'INDUCTOR') = I.INDUCTOR
                 AND L.CODIGO = 'PRD_COPRASIN'
                 AND CO.CODIGO = 'ANE_ESTREXCR'
                 --AND P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA') = vEstructu
                 AND P_UTILIDAD.F_ValoCampo(CO.VALOR,'COSTINCL') = CI.CODIGO
                 AND C.CONCEPTO = CI.VALOR
                 AND I.INDUCTOR = P_UTILIDAD.F_VALODEVA('INDUPEUN')--vINDUPEUN --PERSONAL UNIFORMADO
                 AND NVL(I.NUMEPERS,0) != 0
                 AND C.EMPRESA = P_UTILIDAD.F_VALODEVA('EMPRGEST')--vEMPRGEST
                 --AND C.ANNO = vAnno
                 AND TO_NUMBER(C.ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(C.ANNO),'MESINIC')) <= TO_NUMBER(C.Anno||DECODE(C.MES,'ENERO','01',
                                                                                 'FEBRERO','02',
                                                                                 'MARZO','03',
                                                                                 'ABRIL','04',
                                                                                 'MAYO','05',
                                                                                 'JUNIO','06',
                                                                                 'JULIO','07',
                                                                                 'AGOSTO','08',
                                                                                 'SEPTIEMBRE','09',
                                                                                 'OCTUBRE','10',
                                                                                 'NOVIEMBRE','11',
                                                                                 'DICIEMBRE','12')) 
                 AND TO_NUMBER(C.ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(C.ANNO),'MESFINA')) >= TO_NUMBER(C.Anno||DECODE(C.MES,'ENERO','01',
                                                                                 'FEBRERO','02',
                                                                                 'MARZO','03',
                                                                                 'ABRIL','04',
                                                                                 'MAYO','05',
                                                                                 'JUNIO','06',
                                                                                 'JULIO','07',
                                                                                 'AGOSTO','08',
                                                                                 'SEPTIEMBRE','09',
                                                                                 'OCTUBRE','10',
                                                                                 'NOVIEMBRE','11',
                                                                                 'DICIEMBRE','12'))
               GROUP BY C.EMPRESA, C.ANNO, P_UTILIDAD.F_ValoCampo(CO.VALOR,'ESTRUCTURA')) IND,
               (SELECT PL.EMPRESA, PL.ANNO, PL.SECCION, PL.NUMEPEUN
                FROM ANE_CONFPMSR PL
                WHERE --PL.SECCION = vSeccion
                  --AND 
                      PL.EMPRESA = P_UTILIDAD.F_VALODEVA('EMPRGEST')--vEMPRGEST
                  --AND PL.ANNO = vAnno
                  AND TO_NUMBER(PL.ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(PL.ANNO),'MESINIC')) <= TO_NUMBER(PL.Anno||DECODE(PL.MES,'ENERO','01',
                                                                                 'FEBRERO','02',
                                                                                 'MARZO','03',
                                                                                 'ABRIL','04',
                                                                                 'MAYO','05',
                                                                                 'JUNIO','06',
                                                                                 'JULIO','07',
                                                                                 'AGOSTO','08',
                                                                                 'SEPTIEMBRE','09',
                                                                                 'OCTUBRE','10',
                                                                                 'NOVIEMBRE','11',
                                                                                 'DICIEMBRE','12')) 
                  AND TO_NUMBER(PL.ANNO||P_UTILIDAD.F_ValoCampo(ANALESTA.P_ANE_MERMLAMI_PRAG.F_RANGO_ACUMULADO(PL.ANNO),'MESFINA')) >= TO_NUMBER(PL.Anno||DECODE(PL.MES,'ENERO','01',
                                                                                 'FEBRERO','02',
                                                                                 'MARZO','03',
                                                                                 'ABRIL','04',
                                                                                 'MAYO','05',
                                                                                 'JUNIO','06',
                                                                                 'JULIO','07',
                                                                                 'AGOSTO','08',
                                                                                 'SEPTIEMBRE','09',
                                                                                 'OCTUBRE','10',
                                                                                 'NOVIEMBRE','11',
                                                                                 'DICIEMBRE','12'))) PER
         WHERE PER.EMPRESA = IND.EMPRESA
           AND PER.ANNO = IND.ANNO
         )
         GROUP BY EMPRESA, ANNO, ESTRUCTURA, SECCION) COSTRRHH_01
         WHERE EST.ANNO = PR.ANNO(+)
           AND EST.ANNO = CM.ANNO(+)
           AND EST.ESTRUCTU = CM.ESTRUCTU(+)
           AND EST.ANNO = CCP.ANNO(+)
           AND EST.ESTRUCTU = CCP.ESTRUCTU(+)
           AND EST.ANNO = CCM.ANNO(+)
           AND EST.ESTRUCTU = CCM.ESTRUCTU(+)
           AND EST.ANNO = CCE.ANNO(+)
           AND EST.ESTRUCTU = CCE.ESTRUCTU(+)
           AND EST.ANNO = CPP.ANNO(+)
           AND EST.ESTRUCTU = CPP.ESTRUCTU(+)
           AND EST.ANNO = CPM.ANNO(+)
           AND EST.ESTRUCTU = CPM.ESTRUCTU(+)
           AND EST.ANNO = CPE.ANNO(+)
           AND EST.ESTRUCTU = CPE.ESTRUCTU(+)
           --
           AND EST.ANNO = COSTRRHH_10.ANNO(+)
           AND EST.ESTRUCTU = COSTRRHH_10.ESTRUCTURA(+)
           AND EST.SECCION = COSTRRHH_10.SECCION(+) 
           AND EST.ANNO = COSTRRHH_05.ANNO(+)
           AND EST.ESTRUCTU = COSTRRHH_05.ESTRUCTURA(+)
           AND EST.SECCION = COSTRRHH_05.SECCION(+) 
           AND EST.ANNO = COSTRRHH_35.ANNO(+)
           AND EST.ESTRUCTU = COSTRRHH_35.ESTRUCTURA(+)
           AND EST.SECCION = COSTRRHH_35.SECCION(+) 
           AND EST.ANNO = COSTRRHH_01.ANNO(+)
           AND EST.ESTRUCTU = COSTRRHH_01.ESTRUCTURA(+)
           AND EST.SECCION = COSTRRHH_01.SECCION(+)
           --
		   AND EST.DEPARTAM = D.CODIGO(+)
		   AND EST.SECCION = S.CODIGO(+)
		   AND EST.SECCAUXI = SA.CODIGO(+)
		   AND EST.TIPOCOST = TC.CODIGO(+);
